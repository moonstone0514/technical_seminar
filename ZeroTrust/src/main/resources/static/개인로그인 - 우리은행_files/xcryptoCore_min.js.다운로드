(function(){var b="forge";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var c=true;define=function(g,f){f(require,module);};}else{if(typeof forge==="undefined"){forge={disableNativeCode:false,options:{usePureJavaScript:false}};}return;}}var e;var a=function(f,g){g.exports=function(l){var m=e.map(function(n){return f(n);});l=l||{};l.defined=l.defined||{};if(l.defined[b]){return l[b];}l.defined[b]=true;for(var h=0;h<m.length;++h){m[h](l);}return l;};g.exports.disableNativeCode=false;g.exports(g.exports);};var d=define;define=function(g,f){e=typeof g==="string"?f.slice(2):g.slice(2);if(c){delete define;return d.apply(null,Array.prototype.slice.call(arguments,0));}define=d;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./aes","./aesCipherSuites","./asn1","./cipher","./cipherModes","./debug","./des","./hmac","./kem","./log","./md","./mgf1","./pbkdf2","./pem","./pkcs7","./pkcs1","./pkcs12","./pki","./prime","./prng","./pss","./random","./rc2","./ssh","./task","./tls","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();var sofo={crypto:{},pki:{},utils:{},tls:{},cms:{},storage:{},cmp:{},open:{},xcs:{},error:{}};(function(){function c(w){var r=w.util=w.util||{};(function(){if(typeof process!=="undefined"&&process.nextTick){r.nextTick=process.nextTick;if(typeof setImmediate==="function"){r.setImmediate=setImmediate;}else{r.setImmediate=r.nextTick;}return;}if(typeof setImmediate==="function"){r.setImmediate=function(){return setImmediate.apply(undefined,arguments);};r.nextTick=function(G){return setImmediate(G);};return;}r.setImmediate=function(G){setTimeout(G,0);};if(typeof window!=="undefined"&&typeof window.postMessage==="function"){var E="forge.setImmediate";var C=[];r.setImmediate=function(G){C.push(G);if(C.length===1){window.postMessage(E,"*");}};function B(G){if(G.source===window&&G.data===E){G.stopPropagation();var H=C.slice();C.length=0;H.forEach(function(I){I();});}}window.addEventListener("message",B,true);}if(typeof MutationObserver!=="undefined"){var A=Date.now();var z=true;var F=document.createElement("div");var C=[];new MutationObserver(function(){var G=C.slice();C.length=0;G.forEach(function(H){H();});}).observe(F,{attributes:true});var D=r.setImmediate;r.setImmediate=function(G){if(Date.now()-A>15){A=Date.now();D(G);}else{C.push(G);if(C.length===1){F.setAttribute("a",z=!z);}}};}r.nextTick=r.setImmediate;})();r.isArray=Array.isArray||function(z){return Object.prototype.toString.call(z)==="[object Array]";};r.isArrayBuffer=function(z){return typeof ArrayBuffer!=="undefined"&&z instanceof ArrayBuffer;};r.isArrayBufferView=function(z){return z&&r.isArrayBuffer(z.buffer)&&z.byteLength!==undefined;};r.ByteBuffer=n;function n(A){this.data="";this.read=0;if(typeof A==="string"){this.data=A;}else{if(r.isArrayBuffer(A)||r.isArrayBufferView(A)){var z=new Uint8Array(A);try{this.data=String.fromCharCode.apply(null,z);}catch(C){for(var B=0;B<z.length;++B){this.putByte(z[B]);}}}else{if(A instanceof n||typeof A==="object"&&typeof A.data==="string"&&typeof A.read==="number"){this.data=A.data;this.read=A.read;}}}this._constructedStringLength=0;}r.ByteStringBuffer=n;var p=4096;r.ByteStringBuffer.prototype._optimizeConstructedString=function(z){this._constructedStringLength+=z;if(this._constructedStringLength>p){this.data.substr(0,1);this._constructedStringLength=0;}};r.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read;};r.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0;};r.ByteStringBuffer.prototype.putByte=function(z){return this.putBytes(String.fromCharCode(z));};r.ByteStringBuffer.prototype.fillWithByte=function(z,B){z=String.fromCharCode(z);var A=this.data;while(B>0){if(B&1){A+=z;}B>>>=1;if(B>0){z+=z;}}this.data=A;this._optimizeConstructedString(B);return this;};r.ByteStringBuffer.prototype.putBytes=function(z){this.data+=z;this._optimizeConstructedString(z.length);return this;};r.ByteStringBuffer.prototype.putString=function(z){return this.putBytes(r.encodeUtf8(z));};r.ByteStringBuffer.prototype.putInt16=function(z){return this.putBytes(String.fromCharCode(z>>8&255)+String.fromCharCode(z&255));};r.ByteStringBuffer.prototype.putInt24=function(z){return this.putBytes(String.fromCharCode(z>>16&255)+String.fromCharCode(z>>8&255)+String.fromCharCode(z&255));};r.ByteStringBuffer.prototype.putInt32=function(z){return this.putBytes(String.fromCharCode(z>>24&255)+String.fromCharCode(z>>16&255)+String.fromCharCode(z>>8&255)+String.fromCharCode(z&255));};r.ByteStringBuffer.prototype.putInt16Le=function(z){return this.putBytes(String.fromCharCode(z&255)+String.fromCharCode(z>>8&255));};r.ByteStringBuffer.prototype.putInt24Le=function(z){return this.putBytes(String.fromCharCode(z&255)+String.fromCharCode(z>>8&255)+String.fromCharCode(z>>16&255));};r.ByteStringBuffer.prototype.putInt32Le=function(z){return this.putBytes(String.fromCharCode(z&255)+String.fromCharCode(z>>8&255)+String.fromCharCode(z>>16&255)+String.fromCharCode(z>>24&255));};r.ByteStringBuffer.prototype.putInt=function(A,B){var z="";do{B-=8;z+=String.fromCharCode(A>>B&255);}while(B>0);return this.putBytes(z);};r.ByteStringBuffer.prototype.putSignedInt=function(z,A){if(z<0){z+=2<<A-1;}return this.putInt(z,A);};r.ByteStringBuffer.prototype.putBuffer=function(z){return this.putBytes(z.getBytes());};r.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++);};r.ByteStringBuffer.prototype.getInt16=function(){var z=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);this.read+=2;return z;};r.ByteStringBuffer.prototype.getInt24=function(){var z=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);this.read+=3;return z;};r.ByteStringBuffer.prototype.getInt32=function(){var z=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);this.read+=4;return z;};r.ByteStringBuffer.prototype.getInt16Le=function(){var z=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;this.read+=2;return z;};r.ByteStringBuffer.prototype.getInt24Le=function(){var z=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;this.read+=3;return z;};r.ByteStringBuffer.prototype.getInt32Le=function(){var z=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;this.read+=4;return z;};r.ByteStringBuffer.prototype.getInt=function(A){var z=0;do{z=(z<<8)+this.data.charCodeAt(this.read++);A-=8;}while(A>0);return z;};r.ByteStringBuffer.prototype.getSignedInt=function(B){var A=this.getInt(B);var z=2<<B-2;if(A>=z){A-=z<<1;}return A;};r.ByteStringBuffer.prototype.getBytes=function(z){var A;if(z){z=Math.min(this.length(),z);A=this.data.slice(this.read,this.read+z);this.read+=z;}else{if(z===0){A="";}else{A=this.read===0?this.data:this.data.slice(this.read);this.clear();}}return A;};r.ByteStringBuffer.prototype.bytes=function(z){return typeof z==="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+z);};r.ByteStringBuffer.prototype.at=function(z){return this.data.charCodeAt(this.read+z);};r.ByteStringBuffer.prototype.setAt=function(A,z){this.data=this.data.substr(0,this.read+A)+String.fromCharCode(z)+this.data.substr(this.read+A+1);return this;};r.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1);};r.ByteStringBuffer.prototype.copy=function(){var z=r.createBuffer(this.data);z.read=this.read;return z;};r.ByteStringBuffer.prototype.compact=function(){if(this.read>0){this.data=this.data.slice(this.read);this.read=0;}return this;};r.ByteStringBuffer.prototype.clear=function(){this.data="";this.read=0;return this;};r.ByteStringBuffer.prototype.truncate=function(A){var z=Math.max(0,this.length()-A);this.data=this.data.substr(this.read,z);this.read=0;return this;};r.ByteStringBuffer.prototype.toHex=function(){var B="";for(var A=this.read;A<this.data.length;++A){var z=this.data.charCodeAt(A);if(z<16){B+="0";}B+=z.toString(16);}return B;};r.ByteStringBuffer.prototype.toString=function(){return r.decodeUtf8(this.bytes());};function o(A,B){B=B||{};this.read=B.readOffset||0;this.growSize=B.growSize||1024;var z=r.isArrayBuffer(A);var C=r.isArrayBufferView(A);if(z||C){if(z){this.data=new DataView(A);}else{this.data=new DataView(A.buffer,A.byteOffset,A.byteLength);}this.write="writeOffset" in B?B.writeOffset:this.data.byteLength;return;}this.data=new DataView(new ArrayBuffer(0));this.write=0;if(A!==null&&A!==undefined){this.putBytes(A);}if("writeOffset" in B){this.write=B.writeOffset;}}r.DataBuffer=o;r.DataBuffer.prototype.length=function(){return this.write-this.read;};r.DataBuffer.prototype.isEmpty=function(){return this.length()<=0;};r.DataBuffer.prototype.accommodate=function(z,C){if(this.length()>=z){return this;}C=Math.max(C||this.growSize,z);var A=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);var B=new Uint8Array(this.length()+C);B.set(A);this.data=new DataView(B.buffer);return this;};r.DataBuffer.prototype.putByte=function(z){this.accommodate(1);this.data.setUint8(this.write++,z);return this;};r.DataBuffer.prototype.fillWithByte=function(z,B){this.accommodate(B);for(var A=0;A<B;++A){this.data.setUint8(z);}return this;};r.DataBuffer.prototype.putBytes=function(B,C){if(r.isArrayBufferView(B)){var D=new Uint8Array(B.buffer,B.byteOffset,B.byteLength);var z=D.byteLength-D.byteOffset;this.accommodate(z);var E=new Uint8Array(this.data.buffer,this.write);E.set(D);this.write+=z;return this;}if(r.isArrayBuffer(B)){var D=new Uint8Array(B);this.accommodate(D.byteLength);var E=new Uint8Array(this.data.buffer);E.set(D,this.write);this.write+=D.byteLength;return this;}if(B instanceof r.DataBuffer||typeof B==="object"&&typeof B.read==="number"&&typeof B.write==="number"&&r.isArrayBufferView(B.data)){var D=new Uint8Array(B.data.byteLength,B.read,B.length());this.accommodate(D.byteLength);var E=new Uint8Array(B.data.byteLength,this.write);E.set(D);this.write+=D.byteLength;return this;}if(B instanceof r.ByteStringBuffer){B=B.data;C="binary";}C=C||"binary";if(typeof B==="string"){var A;if(C==="hex"){this.accommodate(Math.ceil(B.length/2));A=new Uint8Array(this.data.buffer,this.write);this.write+=r.binary.hex.decode(B,A,this.write);return this;}if(C==="base64"){this.accommodate(Math.ceil(B.length/4)*3);A=new Uint8Array(this.data.buffer,this.write);this.write+=r.binary.base64.decode(B,A,this.write);return this;}if(C==="utf8"){B=r.encodeUtf8(B);C="binary";}if(C==="binary"||C==="raw"){this.accommodate(B.length);A=new Uint8Array(this.data.buffer,this.write);this.write+=r.binary.raw.decode(A);return this;}if(C==="utf16"){this.accommodate(B.length*2);A=new Uint16Array(this.data.buffer,this.write);this.write+=r.text.utf16.encode(A);return this;}throw new Error("Invalid encoding: "+C);}throw Error("Invalid parameter: "+B);};r.DataBuffer.prototype.putBuffer=function(z){this.putBytes(z);z.clear();return this;};r.DataBuffer.prototype.putString=function(z){return this.putBytes(z,"utf16");};r.DataBuffer.prototype.putInt16=function(z){this.accommodate(2);this.data.setInt16(this.write,z);this.write+=2;return this;};r.DataBuffer.prototype.putInt24=function(z){this.accommodate(3);this.data.setInt16(this.write,z>>8&65535);this.data.setInt8(this.write,z>>16&255);this.write+=3;return this;};r.DataBuffer.prototype.putInt32=function(z){this.accommodate(4);this.data.setInt32(this.write,z);this.write+=4;return this;};r.DataBuffer.prototype.putInt16Le=function(z){this.accommodate(2);this.data.setInt16(this.write,z,true);this.write+=2;return this;};r.DataBuffer.prototype.putInt24Le=function(z){this.accommodate(3);this.data.setInt8(this.write,z>>16&255);this.data.setInt16(this.write,z>>8&65535,true);this.write+=3;return this;};r.DataBuffer.prototype.putInt32Le=function(z){this.accommodate(4);this.data.setInt32(this.write,z,true);this.write+=4;return this;};r.DataBuffer.prototype.putInt=function(z,A){this.accommodate(A/8);do{A-=8;this.data.setInt8(this.write++,z>>A&255);}while(A>0);return this;};r.DataBuffer.prototype.putSignedInt=function(z,A){this.accommodate(A/8);if(z<0){z+=2<<A-1;}return this.putInt(z,A);};r.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++);};r.DataBuffer.prototype.getInt16=function(){var z=this.data.getInt16(this.read);this.read+=2;return z;};r.DataBuffer.prototype.getInt24=function(){var z=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);this.read+=3;return z;};r.DataBuffer.prototype.getInt32=function(){var z=this.data.getInt32(this.read);this.read+=4;return z;};r.DataBuffer.prototype.getInt16Le=function(){var z=this.data.getInt16(this.read,true);this.read+=2;return z;};r.DataBuffer.prototype.getInt24Le=function(){var z=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,true)<<8;this.read+=3;return z;};r.DataBuffer.prototype.getInt32Le=function(){var z=this.data.getInt32(this.read,true);this.read+=4;return z;};r.DataBuffer.prototype.getInt=function(A){var z=0;do{z=(z<<8)+this.data.getInt8(this.read++);A-=8;}while(A>0);return z;};r.DataBuffer.prototype.getSignedInt=function(B){var A=this.getInt(B);var z=2<<B-2;if(A>=z){A-=z<<1;}return A;};r.DataBuffer.prototype.getBytes=function(z){var A;if(z){z=Math.min(this.length(),z);A=this.data.slice(this.read,this.read+z);this.read+=z;}else{if(z===0){A="";}else{A=this.read===0?this.data:this.data.slice(this.read);this.clear();}}return A;};r.DataBuffer.prototype.bytes=function(z){return typeof z==="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+z);};r.DataBuffer.prototype.at=function(z){return this.data.getUint8(this.read+z);};r.DataBuffer.prototype.setAt=function(A,z){this.data.setUint8(A,z);return this;};r.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1);};r.DataBuffer.prototype.copy=function(){return new r.DataBuffer(this);};r.DataBuffer.prototype.compact=function(){if(this.read>0){var z=new Uint8Array(this.data.buffer,this.read);var A=new Uint8Array(z.byteLength);A.set(z);this.data=new DataView(A);this.write-=this.read;this.read=0;}return this;};r.DataBuffer.prototype.clear=function(){this.data=new DataView(new ArrayBuffer(0));this.read=this.write=0;return this;};r.DataBuffer.prototype.truncate=function(z){this.write=Math.max(0,this.length()-z);this.read=Math.min(this.read,this.write);return this;};r.DataBuffer.prototype.toHex=function(){var B="";for(var A=this.read;A<this.data.byteLength;++A){var z=this.data.getUint8(A);if(z<16){B+="0";}B+=z.toString(16);}return B;};r.DataBuffer.prototype.toString=function(A){var z=new Uint8Array(this.data,this.read,this.length());A=A||"utf8";if(A==="binary"||A==="raw"){return r.binary.raw.encode(z);}if(A==="hex"){return r.binary.hex.encode(z);}if(A==="base64"){return r.binary.base64.encode(z);}if(A==="utf8"){return r.text.utf8.decode(z);}if(A==="utf16"){return r.text.utf16.decode(z);}throw new Error("Invalid encoding: "+A);};r.createBuffer=function(z,A){A=A||"raw";if(z!==undefined&&A==="utf8"){z=r.encodeUtf8(z);}return new r.ByteBuffer(z);};r.fillString=function(B,A){var z="";while(A>0){if(A&1){z+=B;}A>>>=1;if(A>0){B+=B;}}return z;};r.xorBytes=function(E,B,G){var A="";var z="";var D="";var C=0;var F=0;for(;G>0;--G,++C){z=E.charCodeAt(C)^B.charCodeAt(C);if(F>=10){A+=D;D="";F=0;}D+=String.fromCharCode(z);++F;}A+=D;return A;};r.hexToBytes=function(A){var B="";var z=0;if(A.length&1==1){z=1;B+=String.fromCharCode(parseInt(A.charAt(0),16));}for(;z<A.length;z+=2){B+=String.fromCharCode(parseInt(A.substr(z,2),16));}return B;};r.bytesToHex=function(z){return r.createBuffer(z).toHex();};r.int32ToBytes=function(z){return String.fromCharCode(z>>24&255)+String.fromCharCode(z>>16&255)+String.fromCharCode(z>>8&255)+String.fromCharCode(z&255);};var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var y=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];r.encode64=function(C,G){var z="";var B="";var F,D,A;var E=0;while(E<C.length){F=C.charCodeAt(E++);D=C.charCodeAt(E++);A=C.charCodeAt(E++);z+=g.charAt(F>>2);z+=g.charAt((F&3)<<4|D>>4);if(isNaN(D)){z+="==";}else{z+=g.charAt((D&15)<<2|A>>6);z+=isNaN(A)?"=":g.charAt(A&63);}if(G&&z.length>G){B+=z.substr(0,G)+"\r\n";z=z.substr(G);}}B+=z;return B;};r.decode64=function(A){A=A.replace(/[^A-Za-z0-9\+\/\=]/g,"");var z="";var F,E,D,C;var B=0;while(B<A.length){F=y[A.charCodeAt(B++)-43];E=y[A.charCodeAt(B++)-43];D=y[A.charCodeAt(B++)-43];C=y[A.charCodeAt(B++)-43];z+=String.fromCharCode(F<<2|E>>4);if(D!==64){z+=String.fromCharCode((E&15)<<4|D>>2);if(C!==64){z+=String.fromCharCode((D&3)<<6|C);}}}return z;};r.encode64url=function(A){var z=this.encode64(A);return z.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"");};r.decode64url=function(B){var A="";var C="=";var z=B.replace(/-/gi,"+");z=z.replace(/_/gi,"/");String.prototype.repeat=function(D){let str="";for(let i=0;i<D;i++){str+=this;}return str;};if(z.length%4!=0){z+=C.repeat(4-z.length%4);}A=this.decode64(z);return A;};r.encodeUtf8=function(z){return unescape(encodeURIComponent(z));};r.decodeUtf8=function(z){return decodeURIComponent(escape(z));};r.binary={raw:{},hex:{},base64:{}};r.binary.raw.encode=function(z){return String.fromCharCode.apply(null,z);};r.binary.raw.decode=function(E,z,D){var B=z;if(!B){B=new Uint8Array(E.length);}D=D||0;var A=D;for(var C=0;C<E.length;++C){B[A++]=E.charCodeAt(C);}return z?A-D:B;};r.binary.hex.encode=r.bytesToHex;r.binary.hex.decode=function(D,z,E){var B=z;if(!B){B=new Uint8Array(Math.ceil(D.length/2));}E=E||0;var C=0,A=E;if(D.length&1){C=1;B[A++]=parseInt(D.charAt(0),16);}for(;C<D.length;C+=2){B[A++]=parseInt(D.substr(C,2),16);}return z?A-E:B;};r.binary.base64.encode=function(C,G){var z="";var B="";var F,D,A;var E=0;while(E<C.byteLength){F=C[E++];D=C[E++];A=C[E++];z+=g.charAt(F>>2);z+=g.charAt((F&3)<<4|D>>4);if(isNaN(D)){z+="==";}else{z+=g.charAt((D&15)<<2|A>>6);z+=isNaN(A)?"=":g.charAt(A&63);}if(G&&z.length>G){B+=z.substr(0,G)+"\r\n";z=z.substr(G);}}B+=z;return B;};r.binary.base64.decode=function(E,z,B){var C=z;if(!C){C=new Uint8Array(Math.ceil(E.length/4)*3);}E=E.replace(/[^A-Za-z0-9\+\/\=]/g,"");B=B||0;var I,H,G,F;var D=0,A=B;while(D<E.length){I=y[E.charCodeAt(D++)-43];H=y[E.charCodeAt(D++)-43];G=y[E.charCodeAt(D++)-43];F=y[E.charCodeAt(D++)-43];C[A++]=I<<2|H>>4;if(G!==64){C[A++]=(H&15)<<4|G>>2;if(F!==64){C[A++]=(G&3)<<6|F;}}}return z?A-B:C.subarray(0,A);};r.text={utf8:{},utf16:{}};r.text.utf8.encode=function(E,z,D){E=r.encodeUtf8(E);var B=z;if(!B){B=new Uint8Array(E.length);}D=D||0;var A=D;for(var C=0;C<E.length;++C){B[A++]=E.charCodeAt(C);}return z?A-D:B;};r.text.utf8.decode=function(z){return r.decodeUtf8(String.fromCharCode.apply(null,z));};r.text.utf16.encode=function(G,B,F){var D=B;if(!D){D=new Uint8Array(G.length*2);}var z=new Uint16Array(D.buffer);F=F||0;var C=F;var A=F;for(var E=0;E<G.length;++E){z[A++]=G.charCodeAt(E);C+=2;}return B?C-F:D;};r.text.utf16.decode=function(z){return String.fromCharCode.apply(null,new Uint16Array(z.buffer));};r.deflate=function(C,A,B){A=r.decode64(C.deflate(r.encode64(A)).rval);if(B){var D=2;var z=A.charCodeAt(1);if(z&32){D=6;}A=A.substring(D,A.length-4);}return A;};r.inflate=function(B,z,A){var C=B.inflate(r.encode64(z)).rval;return C===null?null:r.decode64(C);};var l=function(B,E,D,A){if(!B){throw new Error("WebStorage not available.");}var C;if(B._id!==null&&typeof B._id!=="undefined"){if(D===null){B.onConnect().then(function(){return B.del(E);}).then(function(F){C=F;if(typeof C==="undefined"){A(0);}})["catch"](function(F){throw F;A(-1);});}else{D=r.encode64(JSON.stringify(D));B.onConnect().then(function(){return B.set(E,D);}).then(function(F){C=F;if(typeof C==="undefined"){A(0);}})["catch"](function(F){throw F;A(-1);});}}else{if(D===null){C=B.removeItem(E);}else{D=r.encode64(JSON.stringify(D));C=B.setItem(E,D);}if(typeof C==="undefined"||C.rval===true){return A(0);}}if(typeof C!=="undefined"&&C.rval!==true){var z=new Error(C.error.message);z.id=C.error.id;z.name=C.error.name;throw z;}};var q=function(B,D,A){if(!B){throw new Error("WebStorage not available.");}var C=null;if(B._id!==null&&typeof B._id!=="undefined"){B.onConnect().then(function(){return B.get(D);}).then(function(E){C=E;if(A!==undefined){if(C!==null){C=JSON.parse(r.decode64(C));}A(C);}});}else{C=B.getItem(D);if(B.init){if(C.rval===null){if(C.error){var z=new Error(C.error.message);z.id=C.error.id;z.name=C.error.name;throw z;}C=null;}else{C=C.rval;}}if(C!==null){C=JSON.parse(r.decode64(C));}return A(C);}};var v=function(D,F,B,E,A,C){var z=function(G){if(G===null){G={};}G[B]=E;return l(D,F,G,C);};return q(D,F,z);};var h=function(D,E,B,A,C){var z=function(F){if(F!==null){F=B in F?F[B]:null;}return C(F);};return q(D,E,z);};var m=function(D,E,B,A,C){var z=function(G){if(G!==null&&B in G){delete G[B];var F=true;for(var H in G){F=false;break;}if(F){G=null;}l(D,E,G,C);}};q(D,E,z);};var t=function(B,C,z,A){l(B,C,null,A);};var s=function(A,E,I,F){var C=null;if(typeof I==="undefined"){I=["web","flash"];}var G;var B=false;var z=null;for(var H in I){G=I[H];try{if(G==="local"){E[0]=localStorage;C=A.apply(this,E);B=true;}else{if(G==="session"){E[0]=sessionStorage;C=A.apply(this,E);B=true;}else{if(G==="crossweb"){if(E[0]===null){throw new Error("Cross local storage object not available.");}C=A.apply(this,E);B=true;}else{throw new Error("Unsupported storage type.");}}}}catch(D){z=D;}if(B){break;}}if(!B){throw z;}return C;};r.setItem=function(C,E,A,D,z,B){return s(v,arguments,z,B);};r.getItem=function(C,D,A,z,B){return s(h,arguments,z,B);};r.removeItem=function(C,D,A,z,B){s(m,arguments,z,B);};r.clearItems=function(B,C,z,A){s(t,arguments,z,A);};r.parseUrl=function(C){var B=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;B.lastIndex=0;var z=B.exec(C);var A=z===null?null:{full:C,scheme:z[1],host:z[2],port:z[3],path:z[4]};if(A){A.fullHost=A.host;if(A.port){if(A.port!==80&&A.scheme==="http"){A.fullHost+=":"+A.port;}else{if(A.port!==443&&A.scheme==="https"){A.fullHost+=":"+A.port;}}}else{if(A.scheme==="http"){A.port=80;}else{if(A.scheme==="https"){A.port=443;}}}A.full=A.scheme+"://"+A.fullHost;}return A;};var u=null;r.getQueryVariables=function(z){var B=function(F){var G={};var E=F.split("&");for(var D=0;D<E.length;D++){var I=E[D].indexOf("=");var C;var H;if(I>0){C=E[D].substring(0,I);H=E[D].substring(I+1);}else{C=E[D];H=null;}if(!(C in G)){G[C]=[];}if(!(C in Object.prototype)&&H!==null){G[C].push(unescape(H));}}return G;};var A;if(typeof z==="undefined"){if(u===null){if(typeof window!=="undefined"&&window.location&&window.location.search){u=B(window.location.search.substring(1));}else{u={};}}A=u;}else{A=B(z);}return A;};r.parseFragment=function(B){var A=B;var z="";var E=B.indexOf("?");if(E>0){A=B.substring(0,E);z=B.substring(E+1);}var D=A.split("/");if(D.length>0&&D[0]===""){D.shift();}var C=z===""?{}:r.getQueryVariables(z);return{pathString:A,queryString:z,path:D,query:C};};r.makeRequest=function(A){var B=r.parseFragment(A);var z={path:B.pathString,query:B.queryString,getPath:function(C){return typeof C==="undefined"?B.path:B.path[C];},getQuery:function(C,D){var E;if(typeof C==="undefined"){E=B.query;}else{E=B.query[C];if(E&&typeof D!=="undefined"){E=E[D];}}return E;},getQueryLast:function(D,C){var F;var E=z.getQuery(D);if(E){F=E[E.length-1];}else{F=C;}return F;}};return z;};r.makeLink=function(C,B,A){C=jQuery.isArray(C)?C.join("/"):C;var z=jQuery.param(B||{});A=A||"";return C+(z.length>0?"?"+z:"")+(A.length>0?"#"+A:"");};r.setPath=function(B,E,F){if(typeof B==="object"&&B!==null){var C=0;var A=E.length;while(C<A){var D=E[C++];if(C==A){B[D]=F;}else{var z=D in B;if(!z||z&&typeof B[D]!=="object"||z&&B[D]===null){B[D]={};}B=B[D];}}}};r.getPath=function(C,F,B){var D=0;var A=F.length;var z=true;while(z&&D<A&&typeof C==="object"&&C!==null){var E=F[D++];z=E in C;if(z){C=C[E];}}return z?C:B;};r.deletePath=function(A,D){if(typeof A==="object"&&A!==null){var B=0;var z=D.length;while(B<z){var C=D[B++];if(B==z){delete A[C];}else{if(!(C in A)||typeof A[C]!=="object"||A[C]===null){break;}A=A[C];}}}};r.isEmpty=function(z){for(var A in z){if(z.hasOwnProperty(A)){return false;}}return true;};r.format=function(G){var C=/%./g;var B;var A;var z=0;var F=[];var E=0;while(B=C.exec(G)){A=G.substring(E,C.lastIndex-2);if(A.length>0){F.push(A);}E=C.lastIndex;var D=B[0][1];switch(D){case "s":case "o":if(z<arguments.length){F.push(arguments[z++ +1]);}else{F.push("<?>");}break;case "%":F.push("%");break;default:F.push("<%"+D+"?>");}}F.push(G.substring(E));return F.join("");};r.formatNumber=function(C,A,H,B){var z=C,G=isNaN(A=Math.abs(A))?2:A;var F=H===undefined?",":H;var I=B===undefined?".":B,J=z<0?"-":"";var E=parseInt(z=Math.abs(+z||0).toFixed(G),10)+"";var D=E.length>3?E.length%3:0;return J+(D?E.substr(0,D)+I:"")+E.substr(D).replace(/(\d{3})(?=\d)/g,"$1"+I)+(G?F+Math.abs(z-E).toFixed(G).slice(2):"");};r.formatSize=function(z){if(z>=1073741824){z=r.formatNumber(z/1073741824,2,".","")+" GiB";}else{if(z>=1048576){z=r.formatNumber(z/1048576,2,".","")+" MiB";}else{if(z>=1024){z=r.formatNumber(z/1024,0)+" KiB";}else{z=r.formatNumber(z,0)+" bytes";}}}return z;};r.bytesFromIP=function(z){if(z.indexOf(".")!==-1){return r.bytesFromIPv4(z);}if(z.indexOf(":")!==-1){return r.bytesFromIPv6(z);}return null;};r.bytesFromIPv4=function(C){C=C.split(".");if(C.length!==4){return null;}var z=r.createBuffer();for(var B=0;B<C.length;++B){var A=parseInt(C[B],10);if(isNaN(A)){return null;}z.putByte(A);}return z.getBytes();};r.bytesFromIPv6=function(E){var D=0;E=E.split(":").filter(function(F){if(F.length===0){++D;}return true;});var B=(8-E.length+D)*2;var z=r.createBuffer();for(var C=0;C<8;++C){if(!E[C]||E[C].length===0){z.fillWithByte(0,B);B=0;continue;}var A=r.hexToBytes(E[C]);if(A.length<2){z.putByte(0);}z.putBytes(A);}return z.getBytes();};r.bytesToIP=function(z){if(z.length===4){return r.bytesToIPv4(z);}if(z.length===16){return r.bytesToIPv6(z);}return null;};r.bytesToIPv4=function(z){if(z.length!==4){return null;}var B=[];for(var A=0;A<z.length;++A){B.push(z.charCodeAt(A));}return B.join(".");};r.bytesToIPv6=function(H){if(H.length!==16){return null;}var B=[];var G=[];var C=0;for(var A=0;A<H.length;A+=2){var z=r.bytesToHex(H[A]+H[A+1]);while(z[0]==="0"&&z!=="0"){z=z.substr(1);}if(z==="0"){var F=G[G.length-1];var D=B.length;if(!F||D!==F.end+1){G.push({start:D,end:D});}else{F.end=D;if(F.end-F.start>G[C].end-G[C].start){C=G.length-1;}}}B.push(z);}if(G.length>0){var E=G[C];if(E.end-E.start>0){B.splice(E.start,E.end-E.start+1,"");if(E.start===0){B.unshift("");}if(E.end===7){B.push("");}}}return B.join(":");};r.estimateCores=function(A,E){if(typeof A==="function"){E=A;A={};}A=A||{};if("cores" in r&&!A.update){return E(null,r.cores);}if(typeof navigator!=="undefined"&&"hardwareConcurrency" in navigator&&navigator.hardwareConcurrency>0){r.cores=navigator.hardwareConcurrency;return E(null,r.cores);}if(typeof Worker==="undefined"){r.cores=1;return E(null,r.cores);}if(typeof Blob==="undefined"){r.cores=2;return E(null,r.cores);}var z=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(H){var F=Date.now();var G=F+4;while(Date.now()<G){}self.postMessage({st:F,et:G});});}.toString(),")()"],{type:"application/javascript"}));B([],5,16);function B(F,H,G){if(H===0){var I=Math.floor(F.reduce(function(K,J){return K+J;},0)/F.length);r.cores=Math.max(1,I);URL.revokeObjectURL(z);return E(null,r.cores);}C(G,function(K,J){F.push(D(G,J));B(F,H-1,G);});}function C(G,K){var F=[];var I=[];for(var H=0;H<G;++H){var J=new Worker(z);J.addEventListener("message",function(M){I.push(M.data);if(I.length===G){for(var L=0;L<G;++L){F[L].terminate();}K(null,I);}});F.push(J);}for(var H=0;H<G;++H){F[H].postMessage(H);}}function D(H,K){var L=[];for(var M=0;M<H;++M){var I=K[M];var G=L[M]=[];for(var J=0;J<H;++J){if(M===J){continue;}var F=K[J];if(I.st>F.st&&I.st<F.et||F.st>I.st&&F.st<I.et){G.push(J);}}}return L.reduce(function(N,O){return Math.max(N,O.length);},0);}};}var b="util";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(h){var g=h.asn1=h.asn1||{};g.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};g.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};g.create=function(s,p,r,q){if(h.util.isArray(q)){var o=[];for(var n=0;n<q.length;++n){if(q[n]!==undefined){o.push(q[n]);}}q=o;}return{tagClass:s,type:p,constructed:r,composed:r||h.util.isArray(q),value:q};};var l=g.getBerValueLength=function(n){var o=n.getByte();if(o===128){return undefined;}var q;var p=o&128;if(!p){q=o;}else{q=n.getInt((o&127)<<3);}return q;};g.fromDer=function(E,C){if(C===undefined){C=true;}if(typeof E==="string"){E=h.util.createBuffer(E);}if(E.length()<2){var A=new Error("Too few bytes to parse DER.");A.bytes=E.length();throw A;}var B=E.getByte();var u=B&192;var z=B&31;var p=l(E);if(E.length()<p){if(C){var A=new Error("Too few bytes to read ASN.1 value.");A.detail=E.length()+" < "+p;throw A;}p=E.length();}var D;var s=(B&32)===32;var y=s;if(!y&&u===g.Class.UNIVERSAL&&z===g.Type.BITSTRING&&p>1){var o=E.read;var q=E.getByte();if(q===0){B=E.getByte();var r=B&192;if(r===g.Class.UNIVERSAL||r===g.Class.CONTEXT_SPECIFIC){try{var v=l(E);y=v===p-(E.read-o);if(y){++o;--p;}}catch(w){console.log("Exception : sf_asn1 - fromDer");}}}E.read=o;}if(y){D=[];if(p===undefined){for(;;){if(E.bytes(2)===String.fromCharCode(0,0)){E.getBytes(2);break;}D.push(g.fromDer(E,C));}}else{var n=E.length();while(p>0){D.push(g.fromDer(E,C));p-=n-E.length();n=E.length();}}}else{if(p===undefined){if(C){throw new Error("Non-constructed ASN.1 object of indefinite length.");}p=E.length();}if(z===g.Type.BMPSTRING){D="";for(var t=0;t<p;t+=2){D+=String.fromCharCode(E.getInt16());}}else{D=E.getBytes(p);}}return g.create(u,z,s,D);};g.toDer=function(t){var p=h.util.createBuffer();var q=t.tagClass|t.type;var s=h.util.createBuffer();if(t.composed){if(t.constructed){if(g.Type.OCTETSTRING!=q){q|=32;}}else{s.putByte(0);}for(var r=0;r<t.value.length;++r){if(t.value[r]!==undefined){s.putBuffer(g.toDer(t.value[r]));}}}else{if(t.type===g.Type.BMPSTRING){for(var r=0;r<t.value.length;++r){s.putInt16(t.value.charCodeAt(r));}}else{s.putBytes(t.value);}}p.putByte(q);if(s.length()<=127){p.putByte(s.length()&127);}else{var o=s.length();var n="";do{n+=String.fromCharCode(o&255);o=o>>>8;}while(o>0);p.putByte(n.length|128);for(var r=n.length-1;r>=0;--r){p.putByte(n.charCodeAt(r));}}p.putBuffer(s);return p;};g.oidToDer=function(q){var v=q.split(".");var w=h.util.createBuffer();w.putByte(40*parseInt(v[0],10)+parseInt(v[1],10));var u,o,t,s;for(var r=2;r<v.length;++r){u=true;o=[];t=parseInt(v[r],10);do{s=t&127;t=t>>>7;if(!u){s|=128;}o.push(s);u=false;}while(t>0);for(var p=o.length-1;p>=0;--p){w.putByte(o[p]);}}return w;};g.derToOid=function(o){var p;if(typeof o==="string"){o=h.util.createBuffer(o);}var n=o.getByte();p=Math.floor(n/40)+"."+n%40;var q=0;while(o.length()>0){n=o.getByte();q=q<<7;if(n&128){q+=n&127;}else{p+="."+(q+n);q=0;}}return p;};g.utcTimeToDate=function(y){var p=new Date;var w=parseInt(y.substr(0,2),10);w=w>=50?1900+w:2000+w;var z=parseInt(y.substr(2,2),10)-1;var u=parseInt(y.substr(4,2),10);var q=parseInt(y.substr(6,2),10);var s=parseInt(y.substr(8,2),10);var A=0;if(y.length>11){var v=y.charAt(10);var r=10;if(v!=="+"&&v!=="-"){A=parseInt(y.substr(10,2),10);r+=2;}}p.setUTCFullYear(w,z,u);p.setUTCHours(q,s,A,0);if(r){v=y.charAt(r);if(v==="+"||v==="-"){var n=parseInt(y.substr(r+1,2),10);var o=parseInt(y.substr(r+4,2),10);var t=n*60+o;t*=60000;if(v==="+"){p.setTime(+p-t);}else{p.setTime(+p+t);}}}return p;};g.generalizedTimeToDate=function(z){var r=new Date;var s=parseInt(z.substr(0,4),10);var B=parseInt(z.substr(4,2),10)-1;var y=parseInt(z.substr(6,2),10);var t=parseInt(z.substr(8,2),10);var v=parseInt(z.substr(10,2),10);var C=parseInt(z.substr(12,2),10);var q=0;var w=0;var p=false;if(z.charAt(z.length-1)==="Z"){p=true;}var u=z.length-5,A=z.charAt(u);if(A==="+"||A==="-"){var n=parseInt(z.substr(u+1,2),10);var o=parseInt(z.substr(u+4,2),10);w=n*60+o;w*=60000;if(A==="+"){w*=-1;}p=true;}if(z.charAt(14)==="."){q=parseFloat(z.substr(14),10)*1000;}if(p){r.setUTCFullYear(s,B,y);r.setUTCHours(t,v,C,q);r.setTime(+r+w);}else{r.setFullYear(s,B,y);r.setHours(t,v,C,q);}return r;};g.dateToUtcTime=function(n){if(typeof n==="string"){return n;}var q="";var p=[];p.push((""+n.getUTCFullYear()).substr(2));p.push(""+(n.getUTCMonth()+1));p.push(""+n.getUTCDate());p.push(""+n.getUTCHours());p.push(""+n.getUTCMinutes());p.push(""+n.getUTCSeconds());for(var o=0;o<p.length;++o){if(p[o].length<2){q+="0";}q+=p[o];}q+="Z";return q;};g.dateToGeneralizedTime=function(n){if(typeof n==="string"){return n;}var q="";var p=[];p.push(""+n.getUTCFullYear());p.push(""+(n.getUTCMonth()+1));p.push(""+n.getUTCDate());p.push(""+n.getUTCHours());p.push(""+n.getUTCMinutes());p.push(""+n.getUTCSeconds());for(var o=0;o<p.length;++o){if(p[o].length<2){q+="0";}q+=p[o];}q+="Z";return q;};g.integerToDer=function(n){var p=h.util.createBuffer();if(n>=-128&&n<128){return p.putSignedInt(n,8);}if(n>=-32768&&n<32768){return p.putSignedInt(n,16);}if(n>=-8388608&&n<8388608){return p.putSignedInt(n,24);}if(n>=-2147483648&&n<2147483648){return p.putSignedInt(n,32);}var o=new Error("Integer too large; max is 32-bits.");o.integer=n;throw o;};g.derToInteger=function(o){if(typeof o==="string"){o=h.util.createBuffer(o);}var p=o.length()*8;if(p>32){throw new Error("Integer too large; max is 32-bits.");}return o.getSignedInt(p);};g.validate=function(s,o,n,t){var r=false;if((s.tagClass===o.tagClass||typeof o.tagClass==="undefined")&&(s.type===o.type||typeof o.type==="undefined")){if(s.constructed===o.constructed||typeof o.constructed==="undefined"){r=true;if(o.value&&h.util.isArray(o.value)){var p=0;for(var q=0;r&&q<o.value.length;++q){r=o.value[q].optional||false;if(s.value[p]){r=g.validate(s.value[p],o.value[q],n,t);if(r){++p;}else{if(o.value[q].optional){r=true;}}}if(!r&&t){t.push("["+o.name+"] "+'Tag class "'+o.tagClass+'", type "'+o.type+'" expected value length "'+o.value.length+'", got "'+s.value.length+'"');}}}if(r&&n){if(o.capture){n[o.capture]=s.value;}if(o.captureAsn1){n[o.captureAsn1]=s;}}}else{if(t){t.push("["+o.name+"] "+'Expected constructed "'+o.constructed+'", got "'+s.constructed+'"');}}}else{if(t){if(s.tagClass!==o.tagClass){t.push("["+o.name+"] "+'Expected tag class "'+o.tagClass+'", got "'+s.tagClass+'"');}if(s.type!==o.type){t.push("["+o.name+"] "+'Expected type "'+o.type+'", got "'+s.type+'"');}}}return r;};var m=/[^\\u0000-\\u00ff]/;g.prettyPrint=function(r,o,v){var t="";o=o||0;v=v||2;if(o>0){t+="\n";}var p="";for(var s=0;s<o*v;++s){p+=" ";}t+=p+"Tag: ";switch(r.tagClass){case g.Class.UNIVERSAL:t+="Universal:";break;case g.Class.APPLICATION:t+="Application:";break;case g.Class.CONTEXT_SPECIFIC:t+="Context-Specific:";break;case g.Class.PRIVATE:t+="Private:";break;default:}if(r.tagClass===g.Class.UNIVERSAL){t+=r.type;switch(r.type){case g.Type.NONE:t+=" (None)";break;case g.Type.BOOLEAN:t+=" (Boolean)";break;case g.Type.BITSTRING:t+=" (Bit string)";break;case g.Type.INTEGER:t+=" (Integer)";break;case g.Type.OCTETSTRING:t+=" (Octet string)";break;case g.Type.NULL:t+=" (Null)";break;case g.Type.OID:t+=" (Object Identifier)";break;case g.Type.ODESC:t+=" (Object Descriptor)";break;case g.Type.EXTERNAL:t+=" (External or Instance of)";break;case g.Type.REAL:t+=" (Real)";break;case g.Type.ENUMERATED:t+=" (Enumerated)";break;case g.Type.EMBEDDED:t+=" (Embedded PDV)";break;case g.Type.UTF8:t+=" (UTF8)";break;case g.Type.ROID:t+=" (Relative Object Identifier)";break;case g.Type.SEQUENCE:t+=" (Sequence)";break;case g.Type.SET:t+=" (Set)";break;case g.Type.PRINTABLESTRING:t+=" (Printable String)";break;case g.Type.IA5String:t+=" (IA5String (ASCII))";break;case g.Type.UTCTIME:t+=" (UTC time)";break;case g.Type.GENERALIZEDTIME:t+=" (Generalized time)";break;case g.Type.BMPSTRING:t+=" (BMP String)";break;default:}}else{t+=r.type;}t+="\n";t+=p+"Constructed: "+r.constructed+"\n";if(r.composed){var w=0;var n="";for(var s=0;s<r.value.length;++s){if(r.value[s]!==undefined){w+=1;n+=g.prettyPrint(r.value[s],o+1,v);if(s+1<r.value.length){n+=",";}}}t+=p+"Sub values: "+w+n;}else{t+=p+"Value: ";if(r.type===g.Type.OID){var q=g.derToOid(r.value);t+=q;if(h.pki&&h.pki.oids){if(q in h.pki.oids){t+=" ("+h.pki.oids[q]+") ";}}}if(r.type===g.Type.INTEGER){try{t+=g.derToInteger(r.value);}catch(u){t+="0x"+h.util.bytesToHex(r.value);}}else{if(r.type===g.Type.OCTETSTRING){if(!m.test(r.value)){t+="("+r.value+") ";}t+="0x"+h.util.bytesToHex(r.value);}else{if(r.type===g.Type.UTF8){t+=h.util.decodeUtf8(r.value);}else{if(r.type===g.Type.PRINTABLESTRING||r.type===g.Type.IA5String){t+=r.value;}else{if(m.test(r.value)){t+="0x"+h.util.bytesToHex(r.value);}else{if(r.value.length===0){t+="[null]";}else{t+=r.value;}}}}}}}return t;};}var b="asn1";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./util","./oids"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(h){h.pki=h.pki||{};var g=h.pki.oids=h.oids=h.oids||{};g["1.2.840.113549.1.1.1"]="rsaEncryption";g["rsaEncryption"]="1.2.840.113549.1.1.1";g["1.2.840.113549.1.1.4"]="md5WithRSAEncryption";g["md5WithRSAEncryption"]="1.2.840.113549.1.1.4";g["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption";g["sha1WithRSAEncryption"]="1.2.840.113549.1.1.5";g["1.2.840.113549.1.1.7"]="RSAES-OAEP";g["RSAES-OAEP"]="1.2.840.113549.1.1.7";g["1.2.840.113549.1.1.8"]="mgf1";g["mgf1"]="1.2.840.113549.1.1.8";g["1.2.840.113549.1.1.9"]="pSpecified";g["pSpecified"]="1.2.840.113549.1.1.9";g["1.2.840.113549.1.1.10"]="RSASSA-PSS";g["RSASSA-PSS"]="1.2.840.113549.1.1.10";g["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption";g["sha256WithRSAEncryption"]="1.2.840.113549.1.1.11";g["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption";g["sha384WithRSAEncryption"]="1.2.840.113549.1.1.12";g["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption";g["sha512WithRSAEncryption"]="1.2.840.113549.1.1.13";g["1.3.14.3.2.7"]="desCBC";g["desCBC"]="1.3.14.3.2.7";g["1.3.14.3.2.26"]="sha1";g["sha1"]="1.3.14.3.2.26";g["2.16.840.1.101.3.4.2.1"]="sha256";g["sha256"]="2.16.840.1.101.3.4.2.1";g["2.16.840.1.101.3.4.2.2"]="sha384";g["sha384"]="2.16.840.1.101.3.4.2.2";g["2.16.840.1.101.3.4.2.3"]="sha512";g["sha512"]="2.16.840.1.101.3.4.2.3";g["1.2.840.113549.2.5"]="md5";g["md5"]="1.2.840.113549.2.5";g["1.2.840.113549.1.7.1"]="data";g["data"]="1.2.840.113549.1.7.1";g["1.2.840.113549.1.7.2"]="signedData";g["signedData"]="1.2.840.113549.1.7.2";g["1.2.840.113549.1.7.3"]="envelopedData";g["envelopedData"]="1.2.840.113549.1.7.3";g["1.2.840.113549.1.7.4"]="signedAndEnvelopedData";g["signedAndEnvelopedData"]="1.2.840.113549.1.7.4";g["1.2.840.113549.1.7.5"]="digestedData";g["digestedData"]="1.2.840.113549.1.7.5";g["1.2.840.113549.1.7.6"]="encryptedData";g["encryptedData"]="1.2.840.113549.1.7.6";g["1.2.840.113549.1.9.1"]="emailAddress";g["emailAddress"]="1.2.840.113549.1.9.1";g["1.2.840.113549.1.9.2"]="unstructuredName";g["unstructuredName"]="1.2.840.113549.1.9.2";g["1.2.840.113549.1.9.3"]="contentType";g["contentType"]="1.2.840.113549.1.9.3";g["1.2.840.113549.1.9.4"]="messageDigest";g["messageDigest"]="1.2.840.113549.1.9.4";g["1.2.840.113549.1.9.5"]="signingTime";g["signingTime"]="1.2.840.113549.1.9.5";g["1.2.840.113549.1.9.6"]="counterSignature";g["counterSignature"]="1.2.840.113549.1.9.6";g["1.2.840.113549.1.9.7"]="challengePassword";g["challengePassword"]="1.2.840.113549.1.9.7";g["1.2.840.113549.1.9.8"]="unstructuredAddress";g["unstructuredAddress"]="1.2.840.113549.1.9.8";g["1.2.840.113549.1.9.14"]="extensionRequest";g["extensionRequest"]="1.2.840.113549.1.9.14";g["1.2.840.113549.1.9.20"]="friendlyName";g["friendlyName"]="1.2.840.113549.1.9.20";g["1.2.840.113549.1.9.21"]="localKeyId";g["localKeyId"]="1.2.840.113549.1.9.21";g["1.2.840.113549.1.9.22.1"]="x509Certificate";g["x509Certificate"]="1.2.840.113549.1.9.22.1";g["1.2.840.113549.1.12.10.1.1"]="keyBag";g["keyBag"]="1.2.840.113549.1.12.10.1.1";g["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag";g["pkcs8ShroudedKeyBag"]="1.2.840.113549.1.12.10.1.2";g["1.2.840.113549.1.12.10.1.3"]="certBag";g["certBag"]="1.2.840.113549.1.12.10.1.3";g["1.2.840.113549.1.12.10.1.4"]="crlBag";g["crlBag"]="1.2.840.113549.1.12.10.1.4";g["1.2.840.113549.1.12.10.1.5"]="secretBag";g["secretBag"]="1.2.840.113549.1.12.10.1.5";g["1.2.840.113549.1.12.10.1.6"]="safeContentsBag";g["safeContentsBag"]="1.2.840.113549.1.12.10.1.6";g["1.2.840.113549.1.5.13"]="pkcs5PBES2";g["pkcs5PBES2"]="1.2.840.113549.1.5.13";g["1.2.840.113549.1.5.12"]="pkcs5PBKDF2";g["pkcs5PBKDF2"]="1.2.840.113549.1.5.12";g["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4";g["pbeWithSHAAnd128BitRC4"]="1.2.840.113549.1.12.1.1";g["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4";g["pbeWithSHAAnd40BitRC4"]="1.2.840.113549.1.12.1.2";g["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC";g["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3";g["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC";g["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4";g["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC";g["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5";g["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC";g["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6";g["1.2.840.113549.3.7"]="des-EDE3-CBC";g["des-EDE3-CBC"]="1.2.840.113549.3.7";g["2.16.840.1.101.3.4.1.2"]="aes128-CBC";g["aes128-CBC"]="2.16.840.1.101.3.4.1.2";g["2.16.840.1.101.3.4.1.22"]="aes192-CBC";g["aes192-CBC"]="2.16.840.1.101.3.4.1.22";g["2.16.840.1.101.3.4.1.42"]="aes256-CBC";g["aes256-CBC"]="2.16.840.1.101.3.4.1.42";g["2.5.4.3"]="commonName";g["commonName"]="2.5.4.3";g["2.5.4.5"]="serialName";g["serialName"]="2.5.4.5";g["2.5.4.6"]="countryName";g["countryName"]="2.5.4.6";g["2.5.4.7"]="localityName";g["localityName"]="2.5.4.7";g["2.5.4.8"]="stateOrProvinceName";g["stateOrProvinceName"]="2.5.4.8";g["2.5.4.10"]="organizationName";g["organizationName"]="2.5.4.10";g["2.5.4.11"]="organizationalUnitName";g["organizationalUnitName"]="2.5.4.11";g["2.16.840.1.113730.1.1"]="nsCertType";g["nsCertType"]="2.16.840.1.113730.1.1";g["2.5.29.1"]="authorityKeyIdentifier";g["2.5.29.2"]="keyAttributes";g["2.5.29.3"]="certificatePolicies";g["2.5.29.4"]="keyUsageRestriction";g["2.5.29.5"]="policyMapping";g["2.5.29.6"]="subtreesConstraint";g["2.5.29.7"]="subjectAltName";g["2.5.29.8"]="issuerAltName";g["2.5.29.9"]="subjectDirectoryAttributes";g["2.5.29.10"]="basicConstraints";g["2.5.29.11"]="nameConstraints";g["2.5.29.12"]="policyConstraints";g["2.5.29.13"]="basicConstraints";g["2.5.29.14"]="subjectKeyIdentifier";g["subjectKeyIdentifier"]="2.5.29.14";g["2.5.29.15"]="keyUsage";g["keyUsage"]="2.5.29.15";g["2.5.29.16"]="privateKeyUsagePeriod";g["2.5.29.17"]="subjectAltName";g["subjectAltName"]="2.5.29.17";g["2.5.29.18"]="issuerAltName";g["issuerAltName"]="2.5.29.18";g["2.5.29.19"]="basicConstraints";g["basicConstraints"]="2.5.29.19";g["2.5.29.20"]="cRLNumber";g["2.5.29.21"]="cRLReason";g["2.5.29.22"]="expirationDate";g["2.5.29.23"]="instructionCode";g["2.5.29.24"]="invalidityDate";g["2.5.29.25"]="cRLDistributionPoints";g["2.5.29.26"]="issuingDistributionPoint";g["2.5.29.27"]="deltaCRLIndicator";g["2.5.29.28"]="issuingDistributionPoint";g["2.5.29.29"]="certificateIssuer";g["2.5.29.30"]="nameConstraints";g["2.5.29.31"]="cRLDistributionPoints";g["2.5.29.32"]="certificatePolicies";g["2.5.29.33"]="policyMappings";g["2.5.29.34"]="policyConstraints";g["2.5.29.35"]="authorityKeyIdentifier";g["authorityKeyIdentifier"]="2.5.29.35";g["2.5.29.36"]="policyConstraints";g["2.5.29.37"]="extKeyUsage";g["extKeyUsage"]="2.5.29.37";g["2.5.29.46"]="freshestCRL";g["2.5.29.54"]="inhibitAnyPolicy";g["1.3.6.1.5.5.7.3.1"]="serverAuth";g["serverAuth"]="1.3.6.1.5.5.7.3.1";g["1.3.6.1.5.5.7.3.2"]="clientAuth";g["clientAuth"]="1.3.6.1.5.5.7.3.2";g["1.3.6.1.5.5.7.3.3"]="codeSigning";g["codeSigning"]="1.3.6.1.5.5.7.3.3";g["1.3.6.1.5.5.7.3.4"]="emailProtection";g["emailProtection"]="1.3.6.1.5.5.7.3.4";g["1.3.6.1.5.5.7.3.8"]="timeStamping";g["timeStamping"]="1.3.6.1.5.5.7.3.8";}var b="oids";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(h){var o=h.sha1=h.sha1||{};h.md=h.md||{};h.md.algorithms=h.md.algorithms||{};h.md.sha1=h.md.algorithms.sha1=o;o.create=function(){if(!l){n();}var p=null;var s=h.util.createBuffer();var q=new Array(80);var r={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};r.start=function(){r.messageLength=0;r.fullMessageLength=r.messageLength64=[];var t=r.messageLengthSize/4;for(var u=0;u<t;++u){r.fullMessageLength.push(0);}s=h.util.createBuffer();p={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520};return r;};r.start();r.update=function(w,v){if(v==="utf8"){w=h.util.encodeUtf8(w);}var t=w.length;r.messageLength+=t;t=[t/4294967296>>>0,t>>>0];for(var u=r.fullMessageLength.length-1;u>=0;--u){r.fullMessageLength[u]+=t[1];t[1]=t[0]+(r.fullMessageLength[u]/4294967296>>>0);r.fullMessageLength[u]=r.fullMessageLength[u]>>>0;t[0]=t[1]/4294967296>>>0;}s.putBytes(w);g(p,q,s);if(s.read>2048||s.length()===0){s.compact();}return r;};r.digest=function(){var A=h.util.createBuffer();A.putBytes(s.bytes());var u=r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize;var t=u&r.blockLength-1;A.putBytes(m.substr(0,r.blockLength-t));var y=h.util.createBuffer();var z,D;var C=r.fullMessageLength[0]*8;for(var v=0;v<r.fullMessageLength.length;++v){z=r.fullMessageLength[v+1]*8;D=z/4294967296>>>0;C+=D;A.putInt32(C>>>0);C=z;}var B={h0:p.h0,h1:p.h1,h2:p.h2,h3:p.h3,h4:p.h4};g(B,q,A);var w=h.util.createBuffer();w.putInt32(B.h0);w.putInt32(B.h1);w.putInt32(B.h2);w.putInt32(B.h3);w.putInt32(B.h4);return w;};return r;};var m=null;var l=false;function n(){m=String.fromCharCode(128);m+=h.util.fillString(String.fromCharCode(0),64);l=true;}function g(D,B,E){var C,A,z,y,v,u,r,p;var q=E.length();while(q>=64){A=D.h0;z=D.h1;y=D.h2;v=D.h3;u=D.h4;for(p=0;p<16;++p){C=E.getInt32();B[p]=C;r=v^z&(y^v);C=(A<<5|A>>>27)+r+u+1518500249+C;u=v;v=y;y=z<<30|z>>>2;z=A;A=C;}for(;p<20;++p){C=B[p-3]^B[p-8]^B[p-14]^B[p-16];C=C<<1|C>>>31;B[p]=C;r=v^z&(y^v);C=(A<<5|A>>>27)+r+u+1518500249+C;u=v;v=y;y=z<<30|z>>>2;z=A;A=C;}for(;p<32;++p){C=B[p-3]^B[p-8]^B[p-14]^B[p-16];C=C<<1|C>>>31;B[p]=C;r=z^y^v;C=(A<<5|A>>>27)+r+u+1859775393+C;u=v;v=y;y=z<<30|z>>>2;z=A;A=C;}for(;p<40;++p){C=B[p-6]^B[p-16]^B[p-28]^B[p-32];C=C<<2|C>>>30;B[p]=C;r=z^y^v;C=(A<<5|A>>>27)+r+u+1859775393+C;u=v;v=y;y=z<<30|z>>>2;z=A;A=C;}for(;p<60;++p){C=B[p-6]^B[p-16]^B[p-28]^B[p-32];C=C<<2|C>>>30;B[p]=C;r=z&y|v&(z^y);C=(A<<5|A>>>27)+r+u+2400959708+C;u=v;v=y;y=z<<30|z>>>2;z=A;A=C;}for(;p<80;++p){C=B[p-6]^B[p-16]^B[p-28]^B[p-32];C=C<<2|C>>>30;B[p]=C;r=z^y^v;C=(A<<5|A>>>27)+r+u+3395469782+C;u=v;v=y;y=z<<30|z>>>2;z=A;A=C;}D.h0=D.h0+A|0;D.h1=D.h1+z|0;D.h2=D.h2+y|0;D.h3=D.h3+v|0;D.h4=D.h4+u|0;q-=64;}}}var b="sha1";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(g){var h=g.hmac=g.hmac||{};h.create=function(){var p=null;var n=null;var o=null;var l=null;var m={};m.start=function(u,s){if(u!==null){if(typeof u==="string"){u=u.toLowerCase();if(u in g.md.algorithms){n=g.md.algorithms[u].create();}else{throw new Error('Unknown hash algorithm "'+u+'"');}}else{n=u;}}if(s===null){s=p;}else{if(typeof s==="string"){s=g.util.createBuffer(s);}else{if(g.util.isArray(s)){var r=s;s=g.util.createBuffer();for(var q=0;q<r.length;++q){s.putByte(r[q]);}}}var t=s.length();if(t>n.blockLength){n.start();n.update(s.bytes());s=n.digest();}o=g.util.createBuffer();l=g.util.createBuffer();t=s.length();for(var q=0;q<t;++q){var r=s.at(q);o.putByte(54^r);l.putByte(92^r);}if(t<n.blockLength){var r=n.blockLength-t;for(var q=0;q<r;++q){o.putByte(54);l.putByte(92);}}p=s;o=o.bytes();l=l.bytes();}n.start();n.update(o);};m.update=function(q){n.update(q);};m.getMac=function(){var q=n.digest().bytes();n.start();n.update(l);n.update(q);return n.digest();};m.digest=m.getMac;return m;};}var b="hmac";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./md","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(p){var m=p.md5=p.md5||{};p.md=p.md||{};p.md.algorithms=p.md.algorithms||{};p.md.md5=p.md.algorithms.md5=m;m.create=function(){if(!h){n();}var s=null;var v=p.util.createBuffer();var t=new Array(16);var u={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};u.start=function(){u.messageLength=0;u.fullMessageLength=u.messageLength64=[];var w=u.messageLengthSize/4;for(var y=0;y<w;++y){u.fullMessageLength.push(0);}v=p.util.createBuffer();s={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878};return u;};u.start();u.update=function(A,z){if(z==="utf8"){A=p.util.encodeUtf8(A);}var w=A.length;u.messageLength+=w;w=[w/4294967296>>>0,w>>>0];for(var y=u.fullMessageLength.length-1;y>=0;--y){u.fullMessageLength[y]+=w[1];w[1]=w[0]+(u.fullMessageLength[y]/4294967296>>>0);u.fullMessageLength[y]=u.fullMessageLength[y]>>>0;w[0]=w[1]/4294967296>>>0;}v.putBytes(A);q(s,t,v);if(v.read>2048||v.length()===0){v.compact();}return u;};u.digest=function(){var w=p.util.createBuffer();w.putBytes(v.bytes());var A=u.fullMessageLength[u.fullMessageLength.length-1]+u.messageLengthSize;var E=A&u.blockLength-1;w.putBytes(o.substr(0,u.blockLength-E));var B,D=0;for(var z=u.fullMessageLength.length-1;z>=0;--z){B=u.fullMessageLength[z]*8+D;D=B/4294967296>>>0;w.putInt32Le(B>>>0);}var y={h0:s.h0,h1:s.h1,h2:s.h2,h3:s.h3};q(y,t,w);var C=p.util.createBuffer();C.putInt32Le(y.h0);C.putInt32Le(y.h1);C.putInt32Le(y.h2);C.putInt32Le(y.h3);return C;};return u;};var o=null;var l=null;var r=null;var g=null;var h=false;function n(){o=String.fromCharCode(128);o+=p.util.fillString(String.fromCharCode(0),64);l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9];r=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21];g=new Array(64);for(var s=0;s<64;++s){g[s]=Math.floor(Math.abs(Math.sin(s+1))*4294967296);}h=true;}function q(G,E,H){var F,D,C,B,A,z,u,v;var y=H.length();while(y>=64){D=G.h0;C=G.h1;B=G.h2;A=G.h3;for(v=0;v<16;++v){E[v]=H.getInt32Le();z=A^C&(B^A);F=D+z+g[v]+E[v];u=r[v];D=A;A=B;B=C;C+=F<<u|F>>>32-u;}for(;v<32;++v){z=B^A&(C^B);F=D+z+g[v]+E[l[v]];u=r[v];D=A;A=B;B=C;C+=F<<u|F>>>32-u;}for(;v<48;++v){z=C^B^A;F=D+z+g[v]+E[l[v]];u=r[v];D=A;A=B;B=C;C+=F<<u|F>>>32-u;}for(;v<64;++v){z=B^(C|~A);F=D+z+g[v]+E[l[v]];u=r[v];D=A;A=B;B=C;C+=F<<u|F>>>32-u;}G.h0=G.h0+D|0;G.h1=G.h1+C|0;G.h2=G.h2+B|0;G.h3=G.h3+A|0;y-=64;}}}var b="md5";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(h){var o=h.sha256=h.sha256||{};h.md=h.md||{};h.md.algorithms=h.md.algorithms||{};h.md.sha256=h.md.algorithms.sha256=o;o.create=function(){if(!m){p();}var q=null;var t=h.util.createBuffer();var r=new Array(64);var s={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};s.start=function(){s.messageLength=0;s.fullMessageLength=s.messageLength64=[];var u=s.messageLengthSize/4;for(var v=0;v<u;++v){s.fullMessageLength.push(0);}t=h.util.createBuffer();q={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225};return s;};s.start();s.update=function(y,w){if(w==="utf8"){y=h.util.encodeUtf8(y);}var u=y.length;s.messageLength+=u;u=[u/4294967296>>>0,u>>>0];for(var v=s.fullMessageLength.length-1;v>=0;--v){s.fullMessageLength[v]+=u[1];u[1]=u[0]+(s.fullMessageLength[v]/4294967296>>>0);s.fullMessageLength[v]=s.fullMessageLength[v]>>>0;u[0]=u[1]/4294967296>>>0;}t.putBytes(y);g(q,r,t);if(t.read>2048||t.length()===0){t.compact();}return s;};s.digest=function(){var B=h.util.createBuffer();B.putBytes(t.bytes());var v=s.fullMessageLength[s.fullMessageLength.length-1]+s.messageLengthSize;var u=v&s.blockLength-1;B.putBytes(n.substr(0,s.blockLength-u));var z=h.util.createBuffer();var A,E;var D=s.fullMessageLength[0]*8;for(var w=0;w<s.fullMessageLength.length;++w){A=s.fullMessageLength[w+1]*8;E=A/4294967296>>>0;D+=E;B.putInt32(D>>>0);D=A;}var C={h0:q.h0,h1:q.h1,h2:q.h2,h3:q.h3,h4:q.h4,h5:q.h5,h6:q.h6,h7:q.h7};g(C,r,B);var y=h.util.createBuffer();y.putInt32(C.h0);y.putInt32(C.h1);y.putInt32(C.h2);y.putInt32(C.h3);y.putInt32(C.h4);y.putInt32(C.h5);y.putInt32(C.h6);y.putInt32(C.h7);return y;};return s;};var n=null;var m=false;var l=null;function p(){n=String.fromCharCode(128);n+=h.util.fillString(String.fromCharCode(0),64);l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];m=true;}function g(A,y,B){var v,u,t,r,z,q,C,L,K,J,I,H,G,F,E;var D=B.length();while(D>=64){for(C=0;C<16;++C){y[C]=B.getInt32();}for(;C<64;++C){v=y[C-2];v=(v>>>17|v<<15)^(v>>>19|v<<13)^v>>>10;u=y[C-15];u=(u>>>7|u<<25)^(u>>>18|u<<14)^u>>>3;y[C]=v+y[C-7]+u+y[C-16]|0;}L=A.h0;K=A.h1;J=A.h2;I=A.h3;H=A.h4;G=A.h5;F=A.h6;E=A.h7;for(C=0;C<64;++C){r=(H>>>6|H<<26)^(H>>>11|H<<21)^(H>>>25|H<<7);z=F^H&(G^F);t=(L>>>2|L<<30)^(L>>>13|L<<19)^(L>>>22|L<<10);q=L&K|J&(L^K);v=E+r+z+l[C]+y[C];u=t+q;E=F;F=G;G=H;H=I+v|0;I=J;J=K;K=L;L=v+u|0;}A.h0=A.h0+L|0;A.h1=A.h1+K|0;A.h2=A.h2+J|0;A.h3=A.h3+I|0;A.h4=A.h4+H|0;A.h5=A.h5+G|0;A.h6=A.h6+F|0;A.h7=A.h7+E|0;D-=64;}}}var b="sha256";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(q){var g=q.sha512=q.sha512||{};q.md=q.md||{};q.md.algorithms=q.md.algorithms||{};q.md.sha512=q.md.algorithms.sha512=g;var h=q.sha384=q.sha512.sha384=q.sha512.sha384||{};h.create=function(){return g.create("SHA-384");};q.md.sha384=q.md.algorithms.sha384=h;q.sha512.sha256=q.sha512.sha256||{create:function(){return g.create("SHA-512/256");}};q.md["sha512/256"]=q.md.algorithms["sha512/256"]=q.sha512.sha256;q.sha512.sha224=q.sha512.sha224||{create:function(){return g.create("SHA-512/224");}};q.md["sha512/224"]=q.md.algorithms["sha512/224"]=q.sha512.sha224;g.create=function(u){if(!n){o();}if(typeof u==="undefined"){u="SHA-512";}if(!(u in m)){throw new Error("Invalid SHA-512 algorithm: "+u);}var t=m[u];var z=null;var y=q.util.createBuffer();var v=new Array(80);for(var s=0;s<80;++s){v[s]=new Array(2);}var w={algorithm:u.replace("-","").toLowerCase(),blockLength:128,digestLength:64,messageLength:0,fullMessageLength:null,messageLengthSize:16};w.start=function(){w.messageLength=0;w.fullMessageLength=w.messageLength128=[];var A=w.messageLengthSize/4;for(var B=0;B<A;++B){w.fullMessageLength.push(0);}y=q.util.createBuffer();z=new Array(t.length);for(var B=0;B<t.length;++B){z[B]=t[B].slice(0);}return w;};w.start();w.update=function(D,C){if(C==="utf8"){D=q.util.encodeUtf8(D);}var A=D.length;w.messageLength+=A;A=[A/4294967296>>>0,A>>>0];for(var B=w.fullMessageLength.length-1;B>=0;--B){w.fullMessageLength[B]+=A[1];A[1]=A[0]+(w.fullMessageLength[B]/4294967296>>>0);w.fullMessageLength[B]=w.fullMessageLength[B]>>>0;A[0]=A[1]/4294967296>>>0;}y.putBytes(D);r(z,v,y);if(y.read>2048||y.length()===0){y.compact();}return w;};w.digest=function(){var I=q.util.createBuffer();I.putBytes(y.bytes());var B=w.fullMessageLength[w.fullMessageLength.length-1]+w.messageLengthSize;var A=B&w.blockLength-1;I.putBytes(p.substr(0,w.blockLength-A));var G=q.util.createBuffer();var H,K;var J=w.fullMessageLength[0]*8;for(var D=0;D<w.fullMessageLength.length;++D){H=w.fullMessageLength[D+1]*8;K=H/4294967296>>>0;J+=K;I.putInt32(J>>>0);J=H;}var F=new Array(z.length);for(var D=0;D<z.length;++D){F[D]=z[D].slice(0);}r(F,v,I);var E=q.util.createBuffer();var C;if(u==="SHA-512"){C=F.length;}else{if(u==="SHA-384"){C=F.length-2;}else{C=F.length-4;}}for(var D=0;D<C;++D){E.putInt32(F[D][0]);if(D!==C-1||u!=="SHA-512/224"){E.putInt32(F[D][1]);}}return E;};return w;};var p=null;var n=false;var l=null;var m=null;function o(){p=String.fromCharCode(128);p+=q.util.fillString(String.fromCharCode(0),128);l=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]];m={};m["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]];m["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]];m["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]];m["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]];n=true;}function r(Z,X,E){var G,ag;var W,H;var y,ac;var P,C;var M,z;var v,aa;var Y,J;var A,ab;var Q,B;var t,R;var K,u;var ad,L;var D,ae;var T,F;var af,ah,O,S,N,V,U;var I=E.length();while(I>=128){for(af=0;af<16;++af){X[af][0]=E.getInt32()>>>0;X[af][1]=E.getInt32()>>>0;}for(;af<80;++af){S=X[af-2];ah=S[0];O=S[1];G=((ah>>>19|O<<13)^(O>>>29|ah<<3)^ah>>>6)>>>0;ag=((ah<<13|O>>>19)^(O<<3|ah>>>29)^(ah<<26|O>>>6))>>>0;V=X[af-15];ah=V[0];O=V[1];W=((ah>>>1|O<<31)^(ah>>>8|O<<24)^ah>>>7)>>>0;H=((ah<<31|O>>>1)^(ah<<24|O>>>8)^(ah<<25|O>>>7))>>>0;N=X[af-7];U=X[af-16];O=ag+N[1]+H+U[1];X[af][0]=G+N[0]+W+U[0]+(O/4294967296>>>0)>>>0;X[af][1]=O>>>0;}Y=Z[0][0];J=Z[0][1];A=Z[1][0];ab=Z[1][1];Q=Z[2][0];B=Z[2][1];t=Z[3][0];R=Z[3][1];K=Z[4][0];u=Z[4][1];ad=Z[5][0];L=Z[5][1];D=Z[6][0];ae=Z[6][1];T=Z[7][0];F=Z[7][1];for(af=0;af<80;++af){P=((K>>>14|u<<18)^(K>>>18|u<<14)^(u>>>9|K<<23))>>>0;C=((K<<18|u>>>14)^(K<<14|u>>>18)^(u<<23|K>>>9))>>>0;M=(D^K&(ad^D))>>>0;z=(ae^u&(L^ae))>>>0;y=((Y>>>28|J<<4)^(J>>>2|Y<<30)^(J>>>7|Y<<25))>>>0;ac=((Y<<4|J>>>28)^(J<<30|Y>>>2)^(J<<25|Y>>>7))>>>0;v=(Y&A|Q&(Y^A))>>>0;aa=(J&ab|B&(J^ab))>>>0;O=F+C+z+l[af][1]+X[af][1];G=T+P+M+l[af][0]+X[af][0]+(O/4294967296>>>0)>>>0;ag=O>>>0;O=ac+aa;W=y+v+(O/4294967296>>>0)>>>0;H=O>>>0;T=D;F=ae;D=ad;ae=L;ad=K;L=u;O=R+ag;K=t+G+(O/4294967296>>>0)>>>0;u=O>>>0;t=Q;R=B;Q=A;B=ab;A=Y;ab=J;O=ag+H;Y=G+W+(O/4294967296>>>0)>>>0;J=O>>>0;}O=Z[0][1]+J;Z[0][0]=Z[0][0]+Y+(O/4294967296>>>0)>>>0;Z[0][1]=O>>>0;O=Z[1][1]+ab;Z[1][0]=Z[1][0]+A+(O/4294967296>>>0)>>>0;Z[1][1]=O>>>0;O=Z[2][1]+B;Z[2][0]=Z[2][0]+Q+(O/4294967296>>>0)>>>0;Z[2][1]=O>>>0;O=Z[3][1]+R;Z[3][0]=Z[3][0]+t+(O/4294967296>>>0)>>>0;Z[3][1]=O>>>0;O=Z[4][1]+u;Z[4][0]=Z[4][0]+K+(O/4294967296>>>0)>>>0;Z[4][1]=O>>>0;O=Z[5][1]+L;Z[5][0]=Z[5][0]+ad+(O/4294967296>>>0)>>>0;Z[5][1]=O>>>0;O=Z[6][1]+ae;Z[6][0]=Z[6][0]+D+(O/4294967296>>>0)>>>0;Z[6][1]=O>>>0;O=Z[7][1]+F;Z[7][0]=Z[7][0]+T+(O/4294967296>>>0)>>>0;Z[7][1]=O>>>0;I-=128;}}}var b="sha512";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(h){var n=h.has160=h.has160||{};h.md=h.md||{};h.md.algorithms=h.md.algorithms||{};h.md.has160=h.md.algorithms.has160=n;n.create=function(){var q=null;var s=[];var p=0;var r={algorithm:"has160",blockLength:64,digestLength:20};r.start=function(){this._state=[1732584193,4023233417,2562383102,271733878,3285377520];this._input=[];this._pos=0;return r;};r.start();r.update=function(v,u){this._input=this._input.concat(o.str2byteArray(v));var t=r.blockLength;while(this._pos+t<=this._input.length){g(this._input.slice(this._pos,this._pos+t),this._state,this._input.length);this._pos+=t;}return this;};r.digest=function(){m(this._input,this._pos);var t=r.blockLength;while(this._pos<this._input.length){g(this._input.slice(this._pos,this._pos+t),this._state,this._input.length);this._pos+=t;}var v=l(r.digestLength,this._state);v=o.byteArray2str(v);this._reset();var u=h.util.createBuffer();u.putBytes(v);return u;};r._reset=function(){this._pos=0;this._input=[];this._state=null;};return r;};function g(F,E,A){var D=o.safeAdd32;var C=o.rotl32;function r(K,H,R,Q,P,t,O){P=D(D(D(P,C(K,O)),Q^H&(R^Q)),t);H=C(H,10);return[H,P];}function w(K,H,R,Q,P,t,O){P=D(D(D(D(P,C(K,O)),H^R^Q),t),1518500249);H=C(H,17);return[H,P];}function N(K,H,R,Q,P,t,O){P=D(D(D(D(P,C(K,O)),R^(H|~Q)),t),1859775393);H=C(H,25);return[H,P];}function q(K,H,R,Q,P,t,O){P=D(D(D(D(P,C(K,O)),H^R^Q),t),2400959708);H=C(H,30);return[H,P];}var M,L,J,I,G,p=new Array(16),s,v;var u=E;var z=[];var y=A;for(var B=0;B<y/4;B++){z[B]=o.load32(F,B*4);}M=u[0];L=u[1];J=u[2];I=u[3];G=u[4];p[0]=z[8]^z[9]^z[10]^z[11];p[1]=z[12]^z[13]^z[14]^z[15];p[2]=z[0]^z[1]^z[2]^z[3];p[3]=z[4]^z[5]^z[6]^z[7];p[4]=z[11]^z[14]^z[1]^z[4];p[5]=z[7]^z[10]^z[13]^z[0];p[6]=z[3]^z[6]^z[9]^z[12];p[7]=z[15]^z[2]^z[5]^z[8];p[8]=z[4]^z[13]^z[6]^z[15];p[9]=z[8]^z[1]^z[10]^z[3];p[10]=z[12]^z[5]^z[14]^z[7];p[11]=z[0]^z[9]^z[2]^z[11];p[12]=z[15]^z[10]^z[5]^z[0];p[13]=z[11]^z[6]^z[1]^z[12];p[14]=z[7]^z[2]^z[13]^z[8];p[15]=z[3]^z[14]^z[9]^z[4];v=r(M,L,J,I,G,p[0],5);L=v[0];G=v[1];v=r(G,M,L,J,I,z[0],11);M=v[0];I=v[1];v=r(I,G,M,L,J,z[1],7);G=v[0];J=v[1];v=r(J,I,G,M,L,z[2],15);I=v[0];L=v[1];v=r(L,J,I,G,M,z[3],6);J=v[0];M=v[1];v=r(M,L,J,I,G,p[1],13);L=v[0];G=v[1];v=r(G,M,L,J,I,z[4],8);M=v[0];I=v[1];v=r(I,G,M,L,J,z[5],14);G=v[0];J=v[1];v=r(J,I,G,M,L,z[6],7);I=v[0];L=v[1];v=r(L,J,I,G,M,z[7],12);J=v[0];M=v[1];v=r(M,L,J,I,G,p[2],9);L=v[0];G=v[1];v=r(G,M,L,J,I,z[8],11);M=v[0];I=v[1];v=r(I,G,M,L,J,z[9],8);G=v[0];J=v[1];v=r(J,I,G,M,L,z[10],15);I=v[0];L=v[1];v=r(L,J,I,G,M,z[11],6);J=v[0];M=v[1];v=r(M,L,J,I,G,p[3],12);L=v[0];G=v[1];v=r(G,M,L,J,I,z[12],9);M=v[0];I=v[1];v=r(I,G,M,L,J,z[13],14);G=v[0];J=v[1];v=r(J,I,G,M,L,z[14],5);I=v[0];L=v[1];v=r(L,J,I,G,M,z[15],13);J=v[0];M=v[1];v=w(M,L,J,I,G,p[4],5);L=v[0];G=v[1];v=w(G,M,L,J,I,z[3],11);M=v[0];I=v[1];v=w(I,G,M,L,J,z[6],7);G=v[0];J=v[1];v=w(J,I,G,M,L,z[9],15);I=v[0];L=v[1];v=w(L,J,I,G,M,z[12],6);J=v[0];M=v[1];v=w(M,L,J,I,G,p[5],13);L=v[0];G=v[1];v=w(G,M,L,J,I,z[15],8);M=v[0];I=v[1];v=w(I,G,M,L,J,z[2],14);G=v[0];J=v[1];v=w(J,I,G,M,L,z[5],7);I=v[0];L=v[1];v=w(L,J,I,G,M,z[8],12);J=v[0];M=v[1];v=w(M,L,J,I,G,p[6],9);L=v[0];G=v[1];v=w(G,M,L,J,I,z[11],11);M=v[0];I=v[1];v=w(I,G,M,L,J,z[14],8);G=v[0];J=v[1];v=w(J,I,G,M,L,z[1],15);I=v[0];L=v[1];v=w(L,J,I,G,M,z[4],6);J=v[0];M=v[1];v=w(M,L,J,I,G,p[7],12);L=v[0];G=v[1];v=w(G,M,L,J,I,z[7],9);M=v[0];I=v[1];v=w(I,G,M,L,J,z[10],14);G=v[0];J=v[1];v=w(J,I,G,M,L,z[13],5);I=v[0];L=v[1];v=w(L,J,I,G,M,z[0],13);J=v[0];M=v[1];v=N(M,L,J,I,G,p[8],5);L=v[0];G=v[1];v=N(G,M,L,J,I,z[12],11);M=v[0];I=v[1];v=N(I,G,M,L,J,z[5],7);G=v[0];J=v[1];v=N(J,I,G,M,L,z[14],15);I=v[0];L=v[1];v=N(L,J,I,G,M,z[7],6);J=v[0];M=v[1];v=N(M,L,J,I,G,p[9],13);L=v[0];G=v[1];v=N(G,M,L,J,I,z[0],8);M=v[0];I=v[1];v=N(I,G,M,L,J,z[9],14);G=v[0];J=v[1];v=N(J,I,G,M,L,z[2],7);I=v[0];L=v[1];v=N(L,J,I,G,M,z[11],12);J=v[0];M=v[1];v=N(M,L,J,I,G,p[10],9);L=v[0];G=v[1];v=N(G,M,L,J,I,z[4],11);M=v[0];I=v[1];v=N(I,G,M,L,J,z[13],8);G=v[0];J=v[1];v=N(J,I,G,M,L,z[6],15);I=v[0];L=v[1];v=N(L,J,I,G,M,z[15],6);J=v[0];M=v[1];v=N(M,L,J,I,G,p[11],12);L=v[0];G=v[1];v=N(G,M,L,J,I,z[8],9);M=v[0];I=v[1];v=N(I,G,M,L,J,z[1],14);G=v[0];J=v[1];v=N(J,I,G,M,L,z[10],5);I=v[0];L=v[1];v=N(L,J,I,G,M,z[3],13);J=v[0];M=v[1];v=q(M,L,J,I,G,p[12],5);L=v[0];G=v[1];v=q(G,M,L,J,I,z[7],11);M=v[0];I=v[1];v=q(I,G,M,L,J,z[2],7);G=v[0];J=v[1];v=q(J,I,G,M,L,z[13],15);I=v[0];L=v[1];v=q(L,J,I,G,M,z[8],6);J=v[0];M=v[1];v=q(M,L,J,I,G,p[13],13);L=v[0];G=v[1];v=q(G,M,L,J,I,z[3],8);M=v[0];I=v[1];v=q(I,G,M,L,J,z[14],14);G=v[0];J=v[1];v=q(J,I,G,M,L,z[9],7);I=v[0];L=v[1];v=q(L,J,I,G,M,z[4],12);J=v[0];M=v[1];v=q(M,L,J,I,G,p[14],9);L=v[0];G=v[1];v=q(G,M,L,J,I,z[15],11);M=v[0];I=v[1];v=q(I,G,M,L,J,z[10],8);G=v[0];J=v[1];v=q(J,I,G,M,L,z[5],15);I=v[0];L=v[1];v=q(L,J,I,G,M,z[0],6);J=v[0];M=v[1];v=q(M,L,J,I,G,p[15],12);L=v[0];G=v[1];v=q(G,M,L,J,I,z[11],9);M=v[0];I=v[1];v=q(I,G,M,L,J,z[6],14);G=v[0];J=v[1];v=q(J,I,G,M,L,z[1],5);I=v[0];L=v[1];v=q(L,J,I,G,M,z[12],13);J=v[0];M=v[1];u[0]=D(u[0],M);u[1]=D(u[1],L);u[2]=D(u[2],J);u[3]=D(u[3],I);u[4]=D(u[4],G);E=u;}function m(q,p){var u=q.length;var t=u-p;q[p+t]=128;t++;if(t>56){while(t<64){q[p+t]=0;t++;}t=0;p+=64;}while(t<56){q[p+t]=0;t++;}var s=new Array(8);o.store64(s,0,0,u*8);for(var r=0;r<s.length;r++){q.push(s[r]);}}function l(r,s){var q=r;var p=new Array(q);for(var t=0;t<q/4;t++){o.store32(p,t*4,s[t]);}s=null;return p;}var o={rotl32:function(p,q){if(q<32){return p<<q|p>>>32-q;}else{return x;}},load32:function(p,q){return p[q]|p[q+1]<<8|p[q+2]<<16|p[q+3]<<24;},store32:function(q,r,p){q.splice(r,4,p&255,p>>>8&255,p>>>16&255,p>>>24&255);},store64:function(q,r,p,s){q.splice(r,4,s&255,s>>>8&255,s>>>16&255,s>>>24&255);q.splice(r+4,4,p&255,p>>>8&255,p>>>16&255,p>>>24&255);},safeAdd32:function(q,s){var r=(q&65535)+(s&65535);var p=(q>>>16)+(s>>>16)+(r>>>16);return(p&65535)<<16|r&65535;},byteArray2str:function(q){var p="",r=0;while(r<q.length){p+=String.fromCharCode(q[r++]&255);}return p;},str2byteArray:function(q){var p=[],r=0;while(r<q.length){p[r]=q.charCodeAt(r);r++;}return p;}};}var b="has160";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(l){var h=l.asn1;var g=l.pki=l.pki||{};g.pemToDer=function(m){var n=l.pem.decode(m)[0];if(n.procType&&n.procType.type==="ENCRYPTED"){throw new Error("Could not convert PEM to DER; PEM is encrypted.");}return l.util.createBuffer(n.body);};g.privateKeyFromPem=function(n){var p=l.pem.decode(n)[0];if(p.type!=="PRIVATE KEY"&&p.type!=="RSA PRIVATE KEY"){var m=new Error("Could not convert private key from PEM; PEM "+'header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');m.headerType=p.type;throw m;}if(p.procType&&p.procType.type==="ENCRYPTED"){throw new Error("Could not convert private key from PEM; PEM is encrypted.");}var o=h.fromDer(p.body);return g.privateKeyFromAsn1(o);};g.privateKeyToPem=function(m,o){var n={type:"RSA PRIVATE KEY",body:h.toDer(g.privateKeyToAsn1(m)).getBytes()};return l.pem.encode(n,{maxline:o});};g.privateKeyInfoToPem=function(m,o){var n={type:"PRIVATE KEY",body:h.toDer(m).getBytes()};return l.pem.encode(n,{maxline:o});};}var b="pki";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./asn1","./oids","./pbe","./pem","./pbkdf2","./pkcs12","./pss","./rsa","./util","./x509"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(a0){var bk;var aZ=244837814094590;var aN=(aZ&16777215)==15715070;function a9(bp,bo,bq){this.data=[];if(bp!=null){if("number"==typeof bp){this.fromNumber(bp,bo,bq);}else{if(bo==null&&"string"!=typeof bp){this.fromString(bp,256);}else{this.fromString(bp,bo);}}}}function v(){return new a9(null);}function g(bs,bo,bp,br,bu,bt){while(--bt>=0){var bq=bo*this.data[bs++]+bp.data[br]+bu;bu=Math.floor(bq/67108864);bp.data[br++]=bq&67108863;}return bu;}function bm(bs,bx,by,br,bv,bo){var bu=bx&32767,bw=bx>>15;while(--bo>=0){var bq=this.data[bs]&32767;var bt=this.data[bs++]>>15;var bp=bw*bq+bt*bu;bq=bu*bq+((bp&32767)<<15)+by.data[br]+(bv&1073741823);bv=(bq>>>30)+(bp>>>15)+bw*bt+(bv>>>30);by.data[br++]=bq&1073741823;}return bv;}function bl(bs,bx,by,br,bv,bo){var bu=bx&16383,bw=bx>>14;while(--bo>=0){var bq=this.data[bs]&16383;var bt=this.data[bs++]>>14;var bp=bw*bq+bt*bu;bq=bu*bq+((bp&16383)<<14)+by.data[br]+bv;bv=(bq>>28)+(bp>>14)+bw*bt;by.data[br++]=bq&268435455;}return bv;}if(typeof navigator==="undefined"){a9.prototype.am=bl;bk=28;}else{if(aN&&navigator.appName=="Microsoft Internet Explorer"){a9.prototype.am=bm;bk=30;}else{if(aN&&navigator.appName!="Netscape"){a9.prototype.am=g;bk=26;}else{a9.prototype.am=bl;bk=28;}}}a9.prototype.DB=bk;a9.prototype.DM=(1<<bk)-1;a9.prototype.DV=1<<bk;var aO=52;a9.prototype.FV=Math.pow(2,aO);a9.prototype.F1=aO-bk;a9.prototype.F2=2*bk-aO;var aV="0123456789abcdefghijklmnopqrstuvwxyz";var aY=new Array;var a7,L;a7="0".charCodeAt(0);for(L=0;L<=9;++L){aY[a7++]=L;}a7="a".charCodeAt(0);for(L=10;L<36;++L){aY[a7++]=L;}a7="A".charCodeAt(0);for(L=10;L<36;++L){aY[a7++]=L;}function bn(bo){return aV.charAt(bo);}function V(bp,bo){var bq=aY[bp.charCodeAt(bo)];return bq==null?-1:bq;}function aM(bp){for(var bo=this.t-1;bo>=0;--bo){bp.data[bo]=this.data[bo];}bp.t=this.t;bp.s=this.s;}function F(bo){this.t=1;this.s=bo<0?-1:0;if(bo>0){this.data[0]=bo;}else{if(bo<-1){this.data[0]=bo+this.DV;}else{this.t=0;}}}function m(bo){var bp=v();bp.fromInt(bo);return bp;}function O(bu,bp){var br;if(bp==16){br=4;}else{if(bp==8){br=3;}else{if(bp==256){br=8;}else{if(bp==2){br=1;}else{if(bp==32){br=5;}else{if(bp==4){br=2;}else{this.fromRadix(bu,bp);return;}}}}}}this.t=0;this.s=0;var bt=bu.length,bq=false,bs=0;while(--bt>=0){var bo=br==8?bu[bt]&255:V(bu,bt);if(bo<0){if(bu.charAt(bt)=="-"){bq=true;}continue;}bq=false;if(bs==0){this.data[this.t++]=bo;}else{if(bs+br>this.DB){this.data[this.t-1]|=(bo&(1<<this.DB-bs)-1)<<bs;this.data[this.t++]=bo>>this.DB-bs;}else{this.data[this.t-1]|=bo<<bs;}}bs+=br;if(bs>=this.DB){bs-=this.DB;}}if(br==8&&(bu[0]&128)!=0){this.s=-1;if(bs>0){this.data[this.t-1]|=(1<<this.DB-bs)-1<<bs;}}this.clamp();if(bq){a9.ZERO.subTo(this,this);}}function ap(){var bo=this.s&this.DM;while(this.t>0&&this.data[this.t-1]==bo){--this.t;}}function H(bp){if(this.s<0){return "-"+this.negate().toString(bp);}var bq;if(bp==16){bq=4;}else{if(bp==8){bq=3;}else{if(bp==2){bq=1;}else{if(bp==32){bq=5;}else{if(bp==4){bq=2;}else{return this.toRadix(bp);}}}}}var bs=(1<<bq)-1,bv,bo=false,bt="",br=this.t;var bu=this.DB-br*this.DB%bq;if(br-->0){if(bu<this.DB&&(bv=this.data[br]>>bu)>0){bo=true;bt=bn(bv);}while(br>=0){if(bu<bq){bv=(this.data[br]&(1<<bu)-1)<<bq-bu;bv|=this.data[--br]>>(bu+=this.DB-bq);}else{bv=this.data[br]>>(bu-=bq)&bs;if(bu<=0){bu+=this.DB;--br;}}if(bv>0){bo=true;}if(bo){bt+=bn(bv);}}}return bo?bt:"0";}function au(){var bo=v();a9.ZERO.subTo(this,bo);return bo;}function a3(){return this.s<0?this.negate():this;}function af(bo){var bq=this.s-bo.s;if(bq!=0){return bq;}var bp=this.t;bq=bp-bo.t;if(bq!=0){return this.s<0?-bq:bq;}while(--bp>=0){if((bq=this.data[bp]-bo.data[bp])!=0){return bq;}}return 0;}function B(bo){var bq=1,bp;if((bp=bo>>>16)!=0){bo=bp;bq+=16;}if((bp=bo>>8)!=0){bo=bp;bq+=8;}if((bp=bo>>4)!=0){bo=bp;bq+=4;}if((bp=bo>>2)!=0){bo=bp;bq+=2;}if((bp=bo>>1)!=0){bo=bp;bq+=1;}return bq;}function K(){if(this.t<=0){return 0;}return this.DB*(this.t-1)+B(this.data[this.t-1]^this.s&this.DM);}function a8(bq,bp){var bo;for(bo=this.t-1;bo>=0;--bo){bp.data[bo+bq]=this.data[bo];}for(bo=bq-1;bo>=0;--bo){bp.data[bo]=0;}bp.t=this.t+bq;bp.s=this.s;}function aL(bq,bp){for(var bo=bq;bo<this.t;++bo){bp.data[bo-bq]=this.data[bo];}bp.t=Math.max(this.t-bq,0);bp.s=this.s;}function J(bw,br){var bp=bw%this.DB;var bo=this.DB-bp;var bu=(1<<bo)-1;var bt=Math.floor(bw/this.DB),bv=this.s<<bp&this.DM,bq;for(bq=this.t-1;bq>=0;--bq){br.data[bq+bt+1]=this.data[bq]>>bo|bv;bv=(this.data[bq]&bu)<<bp;}for(bq=bt-1;bq>=0;--bq){br.data[bq]=0;}br.data[bt]=bv;br.t=this.t+bt+1;br.s=this.s;br.clamp();}function C(bv,br){br.s=this.s;var bt=Math.floor(bv/this.DB);if(bt>=this.t){br.t=0;return;}var bp=bv%this.DB;var bo=this.DB-bp;var bu=(1<<bp)-1;br.data[0]=this.data[bt]>>bp;for(var bq=bt+1;bq<this.t;++bq){br.data[bq-bt-1]|=(this.data[bq]&bu)<<bo;br.data[bq-bt]=this.data[bq]>>bp;}if(bp>0){br.data[this.t-bt-1]|=(this.s&bu)<<bo;}br.t=this.t-bt;br.clamp();}function aP(bp,br){var bq=0,bs=0,bo=Math.min(bp.t,this.t);while(bq<bo){bs+=this.data[bq]-bp.data[bq];br.data[bq++]=bs&this.DM;bs>>=this.DB;}if(bp.t<this.t){bs-=bp.s;while(bq<this.t){bs+=this.data[bq];br.data[bq++]=bs&this.DM;bs>>=this.DB;}bs+=this.s;}else{bs+=this.s;while(bq<bp.t){bs-=bp.data[bq];br.data[bq++]=bs&this.DM;bs>>=this.DB;}bs-=bp.s;}br.s=bs<0?-1:0;if(bs<-1){br.data[bq++]=this.DV+bs;}else{if(bs>0){br.data[bq++]=bs;}}br.t=bq;br.clamp();}function aa(bp,br){var bo=this.abs(),bs=bp.abs();var bq=bo.t;br.t=bq+bs.t;while(--bq>=0){br.data[bq]=0;}for(bq=0;bq<bs.t;++bq){br.data[bq+bo.t]=bo.am(0,bs.data[bq],br,bq,0,bo.t);}br.s=0;br.clamp();if(this.s!=bp.s){a9.ZERO.subTo(br,br);}}function ar(bq){var bo=this.abs();var bp=bq.t=2*bo.t;while(--bp>=0){bq.data[bp]=0;}for(bp=0;bp<bo.t-1;++bp){var br=bo.am(bp,bo.data[bp],bq,2*bp,0,1);if((bq.data[bp+bo.t]+=bo.am(bp+1,2*bo.data[bp],bq,2*bp+1,br,bo.t-bp-1))>=bo.DV){bq.data[bp+bo.t]-=bo.DV;bq.data[bp+bo.t+1]=1;}}if(bq.t>0){bq.data[bq.t-1]+=bo.am(bp,bo.data[bp],bq,2*bp,0,1);}bq.s=0;bq.clamp();}function ab(bx,bu,bt){var bD=bx.abs();if(bD.t<=0){return;}var bv=this.abs();if(bv.t<bD.t){if(bu!=null){bu.fromInt(0);}if(bt!=null){this.copyTo(bt);}return;}if(bt==null){bt=v();}var br=v(),bo=this.s,bw=bx.s;var bC=this.DB-B(bD.data[bD.t-1]);if(bC>0){bD.lShiftTo(bC,br);bv.lShiftTo(bC,bt);}else{bD.copyTo(br);bv.copyTo(bt);}var bz=br.t;var bp=br.data[bz-1];if(bp==0){return;}var by=bp*(1<<this.F1)+(bz>1?br.data[bz-2]>>this.F2:0);var bG=this.FV/by,bF=(1<<this.F1)/by,bE=1<<this.F2;var bB=bt.t,bA=bB-bz,bs=bu==null?v():bu;br.dlShiftTo(bA,bs);if(bt.compareTo(bs)>=0){bt.data[bt.t++]=1;bt.subTo(bs,bt);}a9.ONE.dlShiftTo(bz,bs);bs.subTo(br,br);while(br.t<bz){br.data[br.t++]=0;}while(--bA>=0){var bq=bt.data[--bB]==bp?this.DM:Math.floor(bt.data[bB]*bG+(bt.data[bB-1]+bE)*bF);if((bt.data[bB]+=br.am(0,bq,bt,bA,0,bz))<bq){br.dlShiftTo(bA,bs);bt.subTo(bs,bt);while(bt.data[bB]<--bq){bt.subTo(bs,bt);}}}if(bu!=null){bt.drShiftTo(bz,bu);if(bo!=bw){a9.ZERO.subTo(bu,bu);}}bt.t=bz;bt.clamp();if(bC>0){bt.rShiftTo(bC,bt);}if(bo<0){a9.ZERO.subTo(bt,bt);}}function ao(bo){var bp=v();this.abs().divRemTo(bo,null,bp);if(this.s<0&&bp.compareTo(a9.ZERO)>0){bo.subTo(bp,bp);}return bp;}function aj(bo){this.m=bo;}function aH(bo){if(bo.s<0||bo.compareTo(this.m)>=0){return bo.mod(this.m);}else{return bo;}}function a2(bo){return bo;}function ah(bo){bo.divRemTo(this.m,null,bo);}function ag(bo,bq,bp){bo.multiplyTo(bq,bp);this.reduce(bp);}function be(bo,bp){bo.squareTo(bp);this.reduce(bp);}aj.prototype.convert=aH;aj.prototype.revert=a2;aj.prototype.reduce=ah;aj.prototype.mulTo=ag;aj.prototype.sqrTo=be;function X(){if(this.t<1){return 0;}var bo=this.data[0];if((bo&1)==0){return 0;}var bp=bo&3;bp=bp*(2-(bo&15)*bp)&15;bp=bp*(2-(bo&255)*bp)&255;bp=bp*(2-((bo&65535)*bp&65535))&65535;bp=bp*(2-bo*bp%this.DV)%this.DV;return bp>0?this.DV-bp:-bp;}function q(bo){this.m=bo;this.mp=bo.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<bo.DB-15)-1;this.mt2=2*bo.t;}function a1(bo){var bp=v();bo.abs().dlShiftTo(this.m.t,bp);bp.divRemTo(this.m,null,bp);if(bo.s<0&&bp.compareTo(a9.ZERO)>0){this.m.subTo(bp,bp);}return bp;}function bc(bo){var bp=v();bo.copyTo(bp);this.reduce(bp);return bp;}function aq(bo){while(bo.t<=this.mt2){bo.data[bo.t++]=0;}for(var bq=0;bq<this.m.t;++bq){var bp=bo.data[bq]&32767;var br=bp*this.mpl+((bp*this.mph+(bo.data[bq]>>15)*this.mpl&this.um)<<15)&bo.DM;bp=bq+this.m.t;bo.data[bp]+=this.m.am(0,br,bo,bq,0,this.m.t);while(bo.data[bp]>=bo.DV){bo.data[bp]-=bo.DV;bo.data[++bp]++;}}bo.clamp();bo.drShiftTo(this.m.t,bo);if(bo.compareTo(this.m)>=0){bo.subTo(this.m,bo);}}function a4(bo,bp){bo.squareTo(bp);this.reduce(bp);}function U(bo,bq,bp){bo.multiplyTo(bq,bp);this.reduce(bp);}q.prototype.convert=a1;q.prototype.revert=bc;q.prototype.reduce=aq;q.prototype.mulTo=U;q.prototype.sqrTo=a4;function w(){return(this.t>0?this.data[0]&1:this.s)==0;}function P(bt,bu){if(bt>4294967295||bt<1){return a9.ONE;}var bs=v(),bo=v(),br=bu.convert(this),bq=B(bt)-1;br.copyTo(bs);while(--bq>=0){bu.sqrTo(bs,bo);if((bt&1<<bq)>0){bu.mulTo(bo,br,bs);}else{var bp=bs;bs=bo;bo=bp;}}return bu.revert(bs);}function a6(bp,bo){var bq;if(bp<256||bo.isEven()){bq=new aj(bo);}else{bq=new q(bo);}return this.exp(bp,bq);}a9.prototype.copyTo=aM;a9.prototype.fromInt=F;a9.prototype.fromString=O;a9.prototype.clamp=ap;a9.prototype.dlShiftTo=a8;a9.prototype.drShiftTo=aL;a9.prototype.lShiftTo=J;a9.prototype.rShiftTo=C;a9.prototype.subTo=aP;a9.prototype.multiplyTo=aa;a9.prototype.squareTo=ar;a9.prototype.divRemTo=ab;a9.prototype.invDigit=X;a9.prototype.isEven=w;a9.prototype.exp=P;a9.prototype.toString=H;a9.prototype.negate=au;a9.prototype.abs=a3;a9.prototype.compareTo=af;a9.prototype.bitLength=K;a9.prototype.mod=ao;a9.prototype.modPowInt=a6;a9.ZERO=m(0);a9.ONE=m(1);function t(){var bo=v();this.copyTo(bo);return bo;}function ad(){if(this.s<0){if(this.t==1){return this.data[0]-this.DV;}else{if(this.t==0){return-1;}}}else{if(this.t==1){return this.data[0];}else{if(this.t==0){return 0;}}}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0];}function aW(){return this.t==0?this.s:this.data[0]<<24>>24;}function at(){return this.t==0?this.s:this.data[0]<<16>>16;}function aJ(bo){return Math.floor(Math.LN2*this.DB/Math.log(bo));}function ba(){if(this.s<0){return-1;}else{if(this.t<=0||this.t==1&&this.data[0]<=0){return 0;}else{return 1;}}}function S(bo){if(bo==null){bo=10;}if(this.signum()==0||bo<2||bo>36){return "0";}var bq=this.chunkSize(bo);var bp=Math.pow(bo,bq);var bt=m(bp),bu=v(),bs=v(),br="";this.divRemTo(bt,bu,bs);while(bu.signum()>0){br=(bp+bs.intValue()).toString(bo).substr(1)+br;bu.divRemTo(bt,bu,bs);}return bs.intValue().toString(bo)+br;}function aA(bw,bt){this.fromInt(0);if(bt==null){bt=10;}var br=this.chunkSize(bt);var bs=Math.pow(bt,br),bq=false,bo=0,bv=0;for(var bp=0;bp<bw.length;++bp){var bu=V(bw,bp);if(bu<0){if(bw.charAt(bp)=="-"&&this.signum()==0){bq=true;}continue;}bv=bt*bv+bu;if(++bo>=br){this.dMultiply(bs);this.dAddOffset(bv,0);bo=0;bv=0;}}if(bo>0){this.dMultiply(Math.pow(bt,bo));this.dAddOffset(bv,0);}if(bq){a9.ZERO.subTo(this,this);}}function aT(bq,bp,bs){if("number"==typeof bp){if(bq<2){this.fromInt(1);}else{this.fromNumber(bq,bs);if(!this.testBit(bq-1)){this.bitwiseTo(a9.ONE.shiftLeft(bq-1),al,this);}if(this.isEven()){this.dAddOffset(1,0);}while(!this.isProbablePrime(bp)){this.dAddOffset(2,0);if(this.bitLength()>bq){this.subTo(a9.ONE.shiftLeft(bq-1),this);}}}}else{var bo=new Array,br=bq&7;bo.length=(bq>>3)+1;bp.nextBytes(bo);if(br>0){bo[0]&=(1<<br)-1;}else{bo[0]=0;}this.fromString(bo,256);}}function bh(){var bp=this.t,bq=new Array;bq[0]=this.s;var br=this.DB-bp*this.DB%8,bs,bo=0;if(bp-->0){if(br<this.DB&&(bs=this.data[bp]>>br)!=(this.s&this.DM)>>br){bq[bo++]=bs|this.s<<this.DB-br;}while(bp>=0){if(br<8){bs=(this.data[bp]&(1<<br)-1)<<8-br;bs|=this.data[--bp]>>(br+=this.DB-8);}else{bs=this.data[bp]>>(br-=8)&255;if(br<=0){br+=this.DB;--bp;}}if((bs&128)!=0){bs|=-256;}if(bo==0&&(this.s&128)!=(bs&128)){++bo;}if(bo>0||bs!=this.s){bq[bo++]=bs;}}}return bq;}function aw(bo){return this.compareTo(bo)==0;}function ae(bo){return this.compareTo(bo)<0?this:bo;}function aF(bo){return this.compareTo(bo)>0?this:bo;}function aU(bp,bt,br){var bq,bs,bo=Math.min(bp.t,this.t);for(bq=0;bq<bo;++bq){br.data[bq]=bt(this.data[bq],bp.data[bq]);}if(bp.t<this.t){bs=bp.s&this.DM;for(bq=bo;bq<this.t;++bq){br.data[bq]=bt(this.data[bq],bs);}br.t=this.t;}else{bs=this.s&this.DM;for(bq=bo;bq<bp.t;++bq){br.data[bq]=bt(bs,bp.data[bq]);}br.t=bp.t;}br.s=bt(this.s,bp.s);br.clamp();}function T(bo,bp){return bo&bp;}function bj(bo){var bp=v();this.bitwiseTo(bo,T,bp);return bp;}function al(bo,bp){return bo|bp;}function aK(bo){var bp=v();this.bitwiseTo(bo,al,bp);return bp;}function Y(bo,bp){return bo^bp;}function o(bo){var bp=v();this.bitwiseTo(bo,Y,bp);return bp;}function M(bo,bp){return bo&~bp;}function D(bo){var bp=v();this.bitwiseTo(bo,M,bp);return bp;}function Z(){var bp=v();for(var bo=0;bo<this.t;++bo){bp.data[bo]=this.DM&~this.data[bo];}bp.t=this.t;bp.s=~this.s;return bp;}function N(bp){var bo=v();if(bp<0){this.rShiftTo(-bp,bo);}else{this.lShiftTo(bp,bo);}return bo;}function bi(bp){var bo=v();if(bp<0){this.lShiftTo(-bp,bo);}else{this.rShiftTo(bp,bo);}return bo;}function z(bo){if(bo==0){return-1;}var bp=0;if((bo&65535)==0){bo>>=16;bp+=16;}if((bo&255)==0){bo>>=8;bp+=8;}if((bo&15)==0){bo>>=4;bp+=4;}if((bo&3)==0){bo>>=2;bp+=2;}if((bo&1)==0){++bp;}return bp;}function G(){for(var bo=0;bo<this.t;++bo){if(this.data[bo]!=0){return bo*this.DB+z(this.data[bo]);}}if(this.s<0){return this.t*this.DB;}return-1;}function a5(bo){var bp=0;while(bo!=0){bo&=bo-1;++bp;}return bp;}function aS(){var bq=0,bo=this.s&this.DM;for(var bp=0;bp<this.t;++bp){bq+=a5(this.data[bp]^bo);}return bq;}function aQ(bp){var bo=Math.floor(bp/this.DB);if(bo>=this.t){return this.s!=0;}return(this.data[bo]&1<<bp%this.DB)!=0;}function ac(bq,bp){var bo=a9.ONE.shiftLeft(bq);this.bitwiseTo(bo,bp,bo);return bo;}function W(bo){return this.changeBit(bo,al);}function E(bo){return this.changeBit(bo,M);}function l(bo){return this.changeBit(bo,Y);}function aB(bp,br){var bq=0,bs=0,bo=Math.min(bp.t,this.t);while(bq<bo){bs+=this.data[bq]+bp.data[bq];br.data[bq++]=bs&this.DM;bs>>=this.DB;}if(bp.t<this.t){bs+=bp.s;while(bq<this.t){bs+=this.data[bq];br.data[bq++]=bs&this.DM;bs>>=this.DB;}bs+=this.s;}else{bs+=this.s;while(bq<bp.t){bs+=bp.data[bq];br.data[bq++]=bs&this.DM;bs>>=this.DB;}bs+=bp.s;}br.s=bs<0?-1:0;if(bs>0){br.data[bq++]=bs;}else{if(bs<-1){br.data[bq++]=this.DV+bs;}}br.t=bq;br.clamp();}function aD(bo){var bp=v();this.addTo(bo,bp);return bp;}function bb(bo){var bp=v();this.subTo(bo,bp);return bp;}function av(bo){var bp=v();this.multiplyTo(bo,bp);return bp;}function n(bo){var bp=v();this.divRemTo(bo,bp,null);return bp;}function s(bo){var bp=v();this.divRemTo(bo,null,bp);return bp;}function aR(bo){var bq=v(),bp=v();this.divRemTo(bo,bq,bp);return new Array(bq,bp);}function y(bo){this.data[this.t]=this.am(0,bo-1,this,0,0,this.t);++this.t;this.clamp();}function an(bp,bo){if(bp==0){return;}while(this.t<=bo){this.data[this.t++]=0;}this.data[bo]+=bp;while(this.data[bo]>=this.DV){this.data[bo]-=this.DV;if(++bo>=this.t){this.data[this.t++]=0;}++this.data[bo];}}function aC(){}function aX(bo){return bo;}function A(bo,bq,bp){bo.multiplyTo(bq,bp);}function aI(bo,bp){bo.squareTo(bp);}aC.prototype.convert=aX;aC.prototype.revert=aX;aC.prototype.mulTo=A;aC.prototype.sqrTo=aI;function Q(bo){return this.exp(bo,new aC);}function u(bo,bs,br){var bq=Math.min(this.t+bo.t,bs);br.s=0;br.t=bq;while(bq>0){br.data[--bq]=0;}var bp;for(bp=br.t-this.t;bq<bp;++bq){br.data[bq+this.t]=this.am(0,bo.data[bq],br,bq,0,this.t);}for(bp=Math.min(bo.t,bs);bq<bp;++bq){this.am(0,bo.data[bq],br,bq,0,bs-bq);}br.clamp();}function p(bo,br,bq){--br;var bp=bq.t=this.t+bo.t-br;bq.s=0;while(--bp>=0){bq.data[bp]=0;}for(bp=Math.max(br-this.t,0);bp<bo.t;++bp){bq.data[this.t+bp-br]=this.am(br-bp,bo.data[bp],bq,0,0,this.t+bp-br);}bq.clamp();bq.drShiftTo(1,bq);}function R(bo){this.r2=v();this.q3=v();a9.ONE.dlShiftTo(2*bo.t,this.r2);this.mu=this.r2.divide(bo);this.m=bo;}function ai(bo){if(bo.s<0||bo.t>2*this.m.t){return bo.mod(this.m);}else{if(bo.compareTo(this.m)<0){return bo;}else{var bp=v();bo.copyTo(bp);this.reduce(bp);return bp;}}}function am(bo){return bo;}function bf(bo){bo.drShiftTo(this.m.t-1,this.r2);if(bo.t>this.m.t+1){bo.t=this.m.t+1;bo.clamp();}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(bo.compareTo(this.r2)<0){bo.dAddOffset(1,this.m.t+1);}bo.subTo(this.r2,bo);while(bo.compareTo(this.m)>=0){bo.subTo(this.m,bo);}}function ax(bo,bp){bo.squareTo(bp);this.reduce(bp);}function bg(bo,bq,bp){bo.multiplyTo(bq,bp);this.reduce(bp);}R.prototype.convert=ai;R.prototype.revert=am;R.prototype.reduce=bf;R.prototype.mulTo=bg;R.prototype.sqrTo=ax;function aG(bx,bs){var bv=bx.bitLength(),bt,bp=m(1),bA;if(bv<=0){return bp;}else{if(bv<18){bt=1;}else{if(bv<48){bt=3;}else{if(bv<144){bt=4;}else{if(bv<768){bt=5;}else{bt=6;}}}}}if(bv<8){bA=new aj(bs);}else{if(bs.isEven()){bA=new R(bs);}else{bA=new q(bs);}}var bw=new Array,br=3,by=bt-1,bo=(1<<bt)-1;bw[1]=bA.convert(this);if(bt>1){var bD=v();bA.sqrTo(bw[1],bD);while(br<=bo){bw[br]=v();bA.mulTo(bD,bw[br-2],bw[br]);br+=2;}}var bu=bx.t-1,bB,bz=true,bq=v(),bC;bv=B(bx.data[bu])-1;while(bu>=0){if(bv>=by){bB=bx.data[bu]>>bv-by&bo;}else{bB=(bx.data[bu]&(1<<bv+1)-1)<<by-bv;if(bu>0){bB|=bx.data[bu-1]>>this.DB+bv-by;}}br=bt;while((bB&1)==0){bB>>=1;--br;}if((bv-=br)<0){bv+=this.DB;--bu;}if(bz){bw[bB].copyTo(bp);bz=false;}else{while(br>1){bA.sqrTo(bp,bq);bA.sqrTo(bq,bp);br-=2;}if(br>0){bA.sqrTo(bp,bq);}else{bC=bp;bp=bq;bq=bC;}bA.mulTo(bq,bw[bB],bp);}while(bu>=0&&(bx.data[bu]&1<<bv)==0){bA.sqrTo(bp,bq);bC=bp;bp=bq;bq=bC;if(--bv<0){bv=this.DB-1;--bu;}}}return bA.revert(bp);}function bd(bp){var bo=this.s<0?this.negate():this.clone();var bt=bp.s<0?bp.negate():bp.clone();if(bo.compareTo(bt)<0){var br=bo;bo=bt;bt=br;}var bq=bo.getLowestSetBit(),bs=bt.getLowestSetBit();if(bs<0){return bo;}if(bq<bs){bs=bq;}if(bs>0){bo.rShiftTo(bs,bo);bt.rShiftTo(bs,bt);}while(bo.signum()>0){if((bq=bo.getLowestSetBit())>0){bo.rShiftTo(bq,bo);}if((bq=bt.getLowestSetBit())>0){bt.rShiftTo(bq,bt);}if(bo.compareTo(bt)>=0){bo.subTo(bt,bo);bo.rShiftTo(1,bo);}else{bt.subTo(bo,bt);bt.rShiftTo(1,bt);}}if(bs>0){bt.lShiftTo(bs,bt);}return bt;}function I(br){if(br<=0){return 0;}var bq=this.DV%br,bp=this.s<0?br-1:0;if(this.t>0){if(bq==0){bp=this.data[0]%br;}else{for(var bo=this.t-1;bo>=0;--bo){bp=(bq*bp+this.data[bo])%br;}}}return bp;}function h(bp){var bt=bp.isEven();if(this.isEven()&&bt||bp.signum()==0){return a9.ZERO;}var bs=bp.clone(),br=this.clone();var bq=m(1),bo=m(0),bv=m(0),bu=m(1);while(bs.signum()!=0){while(bs.isEven()){bs.rShiftTo(1,bs);if(bt){if(!bq.isEven()||!bo.isEven()){bq.addTo(this,bq);bo.subTo(bp,bo);}bq.rShiftTo(1,bq);}else{if(!bo.isEven()){bo.subTo(bp,bo);}}bo.rShiftTo(1,bo);}while(br.isEven()){br.rShiftTo(1,br);if(bt){if(!bv.isEven()||!bu.isEven()){bv.addTo(this,bv);bu.subTo(bp,bu);}bv.rShiftTo(1,bv);}else{if(!bu.isEven()){bu.subTo(bp,bu);}}bu.rShiftTo(1,bu);}if(bs.compareTo(br)>=0){bs.subTo(br,bs);if(bt){bq.subTo(bv,bq);}bo.subTo(bu,bo);}else{br.subTo(bs,br);if(bt){bv.subTo(bq,bv);}bu.subTo(bo,bu);}}if(br.compareTo(a9.ONE)!=0){return a9.ZERO;}if(bu.compareTo(bp)>=0){return bu.subtract(bp);}if(bu.signum()<0){bu.addTo(bp,bu);}else{return bu;}if(bu.signum()<0){return bu.add(bp);}else{return bu;}}var ay=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];var az=(1<<26)/ay[ay.length-1];function ak(bs){var br,bp=this.abs();if(bp.t==1&&bp.data[0]<=ay[ay.length-1]){for(br=0;br<ay.length;++br){if(bp.data[0]==ay[br]){return true;}}return false;}if(bp.isEven()){return false;}br=1;while(br<ay.length){var bo=ay[br],bq=br+1;while(bq<ay.length&&bo<az){bo*=ay[bq++];}bo=bp.modInt(bo);while(br<bq){if(bo%ay[br++]==0){return false;}}}return bp.millerRabin(bs);}function r(bw){var bs=this.subtract(a9.ONE);var bp=bs.getLowestSetBit();if(bp<=0){return false;}var bo=bs.shiftRight(bp);var bv=aE();var bu;for(var br=0;br<bw;++br){do{bu=new a9(this.bitLength(),bv);}while(bu.compareTo(a9.ONE)<=0||bu.compareTo(bs)>=0);var bt=bu.modPow(bo,this);if(bt.compareTo(a9.ONE)!=0&&bt.compareTo(bs)!=0){var bq=1;while(bq++<bp&&bt.compareTo(bs)!=0){bt=bt.modPowInt(2,this);if(bt.compareTo(a9.ONE)==0){return false;}}if(bt.compareTo(bs)!=0){return false;}}}return true;}function aE(){return{nextBytes:function(bo){for(var bp=0;bp<bo.length;++bp){bo[bp]=parseInt((window.crypto||window.msCrypto).getRandomValues(new Uint8Array(1))[0]);}}};}a9.probablePrime=function(bq,bp,br){if(typeof br=="undefined"||br==null){br=1;}var bo=new a9(bq,bp);if(!bo.testBit(bq-1)){bo.bitwiseTo(a9.ONE.shiftLeft(bq-1),al,bo);}if(bo.isEven()){bo.dAddOffset(1,0);}while(!bo.isProbablePrime(br)){bo.dAddOffset(2,0);if(bo.bitLength()>bq){bo.subTo(a9.ONE.shiftLeft(bq-1),bo);}}return bo;};a9.random=function(bp,bo){return new a9(bp,bo);};a9.prototype.chunkSize=aJ;a9.prototype.toRadix=S;a9.prototype.fromRadix=aA;a9.prototype.fromNumber=aT;a9.prototype.bitwiseTo=aU;a9.prototype.changeBit=ac;a9.prototype.addTo=aB;a9.prototype.dMultiply=y;a9.prototype.dAddOffset=an;a9.prototype.multiplyLowerTo=u;a9.prototype.multiplyUpperTo=p;a9.prototype.modInt=I;a9.prototype.millerRabin=r;a9.prototype.clone=t;a9.prototype.intValue=ad;a9.prototype.byteValue=aW;a9.prototype.shortValue=at;a9.prototype.signum=ba;a9.prototype.toByteArray=bh;a9.prototype.equals=aw;a9.prototype.min=ae;a9.prototype.max=aF;a9.prototype.and=bj;a9.prototype.or=aK;a9.prototype.xor=o;a9.prototype.andNot=D;a9.prototype.not=Z;a9.prototype.shiftLeft=N;a9.prototype.shiftRight=bi;a9.prototype.getLowestSetBit=G;a9.prototype.bitCount=aS;a9.prototype.testBit=aQ;a9.prototype.setBit=W;a9.prototype.clearBit=E;a9.prototype.flipBit=l;a9.prototype.add=aD;a9.prototype.subtract=bb;a9.prototype.multiply=av;a9.prototype.divide=n;a9.prototype.remainder=s;a9.prototype.divideAndRemainder=aR;a9.prototype.modPow=aG;a9.prototype.modInverse=h;a9.prototype.pow=Q;a9.prototype.gcd=bd;a9.prototype.isProbablePrime=ak;a0.jsbn=a0.jsbn||{};a0.jsbn.BigInteger=a9;}var b="jsbn";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(q){if(typeof l==="undefined"){var l=q.jsbn.BigInteger;}var m=q.asn1;var o=q.pki=q.pki||{};o.pbe=q.pbe=q.pbe||{};var g=o.oids;var h={name:"EncryptedPrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:false,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:false,capture:"encryptedData"}]};var p={name:"PBES2Algorithms",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:false,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.params.salt",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:false,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,onstructed:true,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:false,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:false,capture:"encIv"}]}]};var r={name:"pkcs-12PbeParams",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:true,value:[{name:"pkcs-12PbeParams.salt",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:false,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:false,capture:"iterations"}]};o.encryptPrivateKeyInfo=function(E,t,v){v=v||{};v.saltSize=v.saltSize||8;v.count=v.count||2048;v.algorithm=v.algorithm||"aes128";var u=q.random.getBytesSync(v.saltSize);var B=v.count;var A=m.integerToDer(B);var G;var y;var J;if(v.algorithm.indexOf("aes")===0||v.algorithm==="des"){var D,z,F;switch(v.algorithm){case "aes128":G=16;D=16;z=g["aes128-CBC"];F=q.aes.createEncryptionCipher;break;case "aes192":G=24;D=16;z=g["aes192-CBC"];F=q.aes.createEncryptionCipher;break;case "aes256":G=32;D=16;z=g["aes256-CBC"];F=q.aes.createEncryptionCipher;break;case "des":G=8;D=8;z=g["desCBC"];F=q.des.createEncryptionCipher;break;default:var H=new Error("Cannot encrypt private key. Unknown encryption algorithm.");H.algorithm=v.algorithm;throw H;}var I=q.pkcs5.pbkdf2(t,u,B,G);var w=q.random.getBytesSync(D);var s=F(I);s.start(w);s.update(m.toDer(E));s.finish();J=s.output.getBytes();y=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.OID,false,m.oidToDer(g["pkcs5PBES2"]).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.OID,false,m.oidToDer(g["pkcs5PBKDF2"]).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,false,u),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,A.getBytes())])]),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.OID,false,m.oidToDer(z).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,false,w)])])]);}else{if(v.algorithm==="3des"){G=24;var C=new q.util.ByteBuffer(u);var I=o.pbe.generatePkcs12Key(t,C,1,B,G);var w=o.pbe.generatePkcs12Key(t,C,2,B,G);var s=q.des.createEncryptionCipher(I);s.start(w);s.update(m.toDer(E));s.finish();J=s.output.getBytes();y=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.OID,false,m.oidToDer(g["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,false,u),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,false,A.getBytes())])]);}else{var H=new Error("Cannot encrypt private key. Unknown encryption algorithm.");H.algorithm=v.algorithm;throw H;}}var K=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,true,[y,m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,false,J)]);return K;};o.decryptPrivateKeyInfo=function(t,A){var u=null;var B={};var z=[];if(!m.validate(t,h,B,z)){var y=new Error("Cannot read encrypted private key. "+"ASN.1 object is not a supported EncryptedPrivateKeyInfo.");y.errors=z;throw y;}var s=m.derToOid(B.encryptionOid);var w=o.pbe.getCipher(s,B.encryptionParams,A);var v=q.util.createBuffer(B.encryptedData);w.update(v);if(w.finish()){u=m.fromDer(w.output);}return u;};o.encryptedPrivateKeyToPem=function(s,u){var t={type:"ENCRYPTED PRIVATE KEY",body:m.toDer(s).getBytes()};return q.pem.encode(t,{maxline:u});};o.encryptedPrivateKeyFromPem=function(t){var u=q.pem.decode(t)[0];if(u.type!=="ENCRYPTED PRIVATE KEY"){var s=new Error("Could not convert encrypted private key from PEM; "+'PEM header type is "ENCRYPTED PRIVATE KEY".');s.headerType=u.type;throw s;}if(u.procType&&u.procType.type==="ENCRYPTED"){throw new Error("Could not convert encrypted private key from PEM; "+"PEM is encrypted.");}return m.fromDer(u.body);};o.encryptRsaPrivateKey=function(y,B,D){D=D||{};if(!D.legacy){var u=o.wrapRsaPrivateKey(o.privateKeyToAsn1(y));u=o.encryptPrivateKeyInfo(u,B,D);return o.encryptedPrivateKeyToPem(u);}var z;var t;var E;var C;switch(D.algorithm){case "aes128":z="AES-128-CBC";E=16;t=q.random.getBytesSync(16);C=q.aes.createEncryptionCipher;break;case "aes192":z="AES-192-CBC";E=24;t=q.random.getBytesSync(16);C=q.aes.createEncryptionCipher;break;case "aes256":z="AES-256-CBC";E=32;t=q.random.getBytesSync(16);C=q.aes.createEncryptionCipher;break;case "3des":z="DES-EDE3-CBC";E=24;t=q.random.getBytesSync(8);C=q.des.createEncryptionCipher;break;case "des":z="DES-CBC";E=8;t=q.random.getBytesSync(8);C=q.des.createEncryptionCipher;break;default:var A=new Error("Could not encrypt RSA private key; unsupported "+'encryption algorithm "'+D.algorithm+'".');A.algorithm=D.algorithm;throw A;}var w=q.pbe.opensslDeriveBytes(B,t.substr(0,8),E);var v=C(w);v.start(t);v.update(m.toDer(o.privateKeyToAsn1(y)));v.finish();var s={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:z,parameters:q.util.bytesToHex(t).toUpperCase()},body:v.output.getBytes()};return q.pem.encode(s);};o.decryptRsaPrivateKey=function(v,A){var u=null;var s=q.pem.decode(v)[0];if(s.type!=="ENCRYPTED PRIVATE KEY"&&s.type!=="PRIVATE KEY"&&s.type!=="RSA PRIVATE KEY"){var z=new Error("Could not convert private key from PEM; PEM header type "+'is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');z.headerType=z;throw z;}if(s.procType&&s.procType.type==="ENCRYPTED"){var C;var B;switch(s.dekInfo.algorithm){case "DES-CBC":C=8;B=q.des.createDecryptionCipher;break;case "DES-EDE3-CBC":C=24;B=q.des.createDecryptionCipher;break;case "AES-128-CBC":C=16;B=q.aes.createDecryptionCipher;break;case "AES-192-CBC":C=24;B=q.aes.createDecryptionCipher;break;case "AES-256-CBC":C=32;B=q.aes.createDecryptionCipher;break;case "RC2-40-CBC":C=5;B=function(D){return q.rc2.createDecryptionCipher(D,40);};break;case "RC2-64-CBC":C=8;B=function(D){return q.rc2.createDecryptionCipher(D,64);};break;case "RC2-128-CBC":C=16;B=function(D){return q.rc2.createDecryptionCipher(D,128);};break;default:var z=new Error("Could not decrypt private key; unsupported "+'encryption algorithm "'+s.dekInfo.algorithm+'".');z.algorithm=s.dekInfo.algorithm;throw z;}var t=q.util.hexToBytes(s.dekInfo.parameters);var y=q.pbe.opensslDeriveBytes(A,t.substr(0,8),C);var w=B(y);w.start(t);w.update(q.util.createBuffer(s.body));if(w.finish()){u=w.output.getBytes();}else{return u;}}else{u=s.body;}if(s.type==="ENCRYPTED PRIVATE KEY"){u=o.decryptPrivateKeyInfo(m.fromDer(u),A);}else{u=m.fromDer(u);}if(u!==null){u=o.privateKeyFromAsn1(u);}return u;};o.pbe.generatePkcs12Key=function(t,w,O,Y,R,ad){var W,U;if(typeof ad==="undefined"||ad===null){ad=q.md.sha1.create();}var J=ad.digestLength;var H=ad.blockLength;var G=new q.util.ByteBuffer;var aa=new q.util.ByteBuffer;if(t!==null&&t!==undefined){for(U=0;U<t.length;U++){aa.putInt16(t.charCodeAt(U));}aa.putInt16(0);}var Q=aa.length();var K=w.length();var L=new q.util.ByteBuffer;L.fillWithByte(O,H);var y=H*Math.ceil(K/H);var z=new q.util.ByteBuffer;for(U=0;U<y;U++){z.putByte(w.at(U%K));}var T=H*Math.ceil(Q/H);var A=new q.util.ByteBuffer;for(U=0;U<T;U++){A.putByte(aa.at(U%Q));}var E=z;E.putBuffer(A);var ab=Math.ceil(R/J);for(var X=1;X<=ab;X++){var Z=new q.util.ByteBuffer;Z.putBytes(L.bytes());Z.putBytes(E.bytes());for(var ac=0;ac<Y;ac++){ad.start();ad.update(Z.getBytes());Z=ad.digest();}var N=new q.util.ByteBuffer;for(U=0;U<H;U++){N.putByte(Z.at(U%J));}var V=Math.ceil(K/H)+Math.ceil(Q/H);var M=new q.util.ByteBuffer;for(W=0;W<V;W++){var F=new q.util.ByteBuffer(E.getBytes(H));var C=511;for(U=N.length()-1;U>=0;U--){C=C>>8;C+=N.at(U)+F.at(U);F.setAt(U,C&255);}M.putBuffer(F);}E=M;G.putBuffer(Z);}G.truncate(G.length()-R);return G;};o.pbe.getCipher=function(u,v,t){switch(u){case o.oids["pkcs5PBES2"]:return o.pbe.getCipherForPBES2(u,v,t);case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case o.oids["pbewithSHAAnd40BitRC2-CBC"]:return o.pbe.getCipherForPKCS12PBE(u,v,t);default:var s=new Error("Cannot read encrypted PBE data block. Unsupported OID.");s.oid=u;s.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"];throw s;}};o.pbe.getCipherForPBES2=function(s,u,E){var F={};var C=[];if(!m.validate(u,p,F,C)){var B=new Error("Cannot read password-based-encryption algorithm "+"parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");B.errors=C;throw B;}s=m.derToOid(F.kdfOid);if(s!==o.oids["pkcs5PBKDF2"]){var B=new Error("Cannot read encrypted private key. "+"Unsupported key derivation function OID.");B.oid=s;B.supportedOids=["pkcs5PBKDF2"];throw B;}s=m.derToOid(F.encOid);if(s!==o.oids["aes128-CBC"]&&s!==o.oids["aes192-CBC"]&&s!==o.oids["aes256-CBC"]&&s!==o.oids["des-EDE3-CBC"]&&s!==o.oids["desCBC"]&&s!==o.oids["seedCBC"]&&s!==o.oids["aria-CBC"]){var B=new Error("Cannot read encrypted private key. "+"Unsupported encryption scheme OID.");B.oid=s;B.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC","seedCBC","aria-CBC"];throw B;}var v=F.kdfSalt;var A=q.util.createBuffer(F.kdfIterationCount);A=A.getInt(A.length()<<3);var G;var D;var w;switch(o.oids[s]){case "aes128-CBC":G=16;D=q.aes.createDecryptionCipher;break;case "aes192-CBC":G=24;D=q.aes.createDecryptionCipher;break;case "aes256-CBC":G=32;D=q.aes.createDecryptionCipher;break;case "des-EDE3-CBC":G=24;D=q.des.createDecryptionCipher;break;case "desCBC":G=8;D=q.des.createDecryptionCipher;break;case "seedCBC":G=16;w="CBC";D=q.seed.createDecryptionCipher;break;case "aria-CBC":G=16;D=q.aria.createDecryptionCipher;break;default:}var z=q.pkcs5.pbkdf2(E,v,A,G);var t=F.encIv;var y=D(z,w);y.start(t);return y;};o.pbe.getCipherForPKCS12PBE=function(t,v,D){var E={};var A=[];if(!m.validate(v,r,E,A)){var z=new Error("Cannot read password-based-encryption algorithm "+"parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");z.errors=A;throw z;}var w=q.util.createBuffer(E.salt);var y=q.util.createBuffer(E.iterations);y=y.getInt(y.length()<<3);var F,s,C;switch(t){case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:F=24;s=8;C=q.des.startDecrypting;break;case o.oids["pbewithSHAAnd40BitRC2-CBC"]:F=5;s=8;C=function(I,H){var G=q.rc2.createDecryptionCipher(I,40);G.start(H,null);return G;};break;default:var z=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");z.oid=t;throw z;}var B=o.pbe.generatePkcs12Key(D,w,1,y,F);var u=o.pbe.generatePkcs12Key(D,w,2,y,s);return C(B,u);};o.pbe.opensslDeriveBytes=function(t,v,s,z){if(typeof z==="undefined"||z===null){z=q.md.md5.create();}if(v===null){v="";}var y=[n(z,t+v)];for(var w=16,u=1;w<s;++u,w+=16){y.push(n(z,y[u-1]+t+v));}return y.join("").substr(0,s);};function n(t,s){return t.start().update(s).digest().getBytes();}}var b="pbe";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./aes","./asn1","./des","./md","./oids","./pem","./pbkdf2","./random","./rc2","./rsa","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(g){var l=g.pem=g.pem||{};l.encode=function(q,n){n=n||{};var p="-----BEGIN "+q.type+"-----\r\n";var r;if(q.procType){r={name:"Proc-Type",values:[String(q.procType.version),q.procType.type]};p+=h(r);}if(q.contentDomain){r={name:"Content-Domain",values:[q.contentDomain]};p+=h(r);}if(q.dekInfo){r={name:"DEK-Info",values:[q.dekInfo.algorithm]};if(q.dekInfo.parameters){r.values.push(q.dekInfo.parameters);}p+=h(r);}if(q.headers){for(var o=0;o<q.headers.length;++o){p+=h(q.headers[o]);}}if(q.procType){p+="\r\n";}p+=g.util.encode64(q.body,n.maxline||64)+"\r\n";p+="-----END "+q.type+"-----\r\n";return p;};l.decode=function(w){var t=[];var o=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g;var v=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/;var A=/\r?\n/;var u;while(true){u=o.exec(w);if(!u){break;}var p={type:u[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:g.util.decode64(u[3])};t.push(p);if(!u[2]){continue;}var C=u[2].split(A);var z=0;while(u&&z<C.length){var B=C[z].replace(/\s+$/,"");for(var n=z+1;n<C.length;++n){var s=C[n];if(!/\s/.test(s[0])){break;}B+=s;z=n;}u=B.match(v);if(u){var r={name:u[1],values:[]};var y=u[2].split(",");for(var q=0;q<y.length;++q){r.values.push(m(y[q]));}if(!p.procType){if(r.name!=="Proc-Type"){throw new Error("Invalid PEM formatted message. The first "+'encapsulated header must be "Proc-Type".');}else{if(r.values.length!==2){throw new Error('Invalid PEM formatted message. The "Proc-Type" '+"header must have two subfields.");}}p.procType={version:y[0],type:y[1]};}else{if(!p.contentDomain&&r.name==="Content-Domain"){p.contentDomain=y[0]||"";}else{if(!p.dekInfo&&r.name==="DEK-Info"){if(r.values.length===0){throw new Error('Invalid PEM formatted message. The "DEK-Info" '+"header must have at least one subfield.");}p.dekInfo={algorithm:y[0],parameters:y[1]||null};}else{p.headers.push(r);}}}}++z;}if(p.procType==="ENCRYPTED"&&!p.dekInfo){throw new Error('Invalid PEM formatted message. The "DEK-Info" '+'header must be present if "Proc-Type" is "ENCRYPTED".');}}if(t.length===0){throw new Error("Invalid PEM formatted message.");}return t;};function h(u){var t=u.name+": ";var n=[];var p=function(w,v){return " "+v;};for(var o=0;o<u.values.length;++o){n.push(u.values[o].replace(/^(\S+\r\n)/,p));}t+=n.join(",")+"\r\n";var r=0;var q=-1;for(var o=0;o<t.length;++o,++r){if(r>65&&q!==-1){var s=t[q];if(s===","){++q;t=t.substr(0,q)+"\r\n "+t.substr(q);}else{t=t.substr(0,q)+"\r\n"+s+t.substr(q+1);}r=o-q-1;q=-1;++o;}else{if(t[o]===" "||t[o]==="\t"||t[o]===","){q=o;}}}return t;}function m(n){return n.replace(/^\s+/,"");}}var b="pem";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(q){if(typeof B==="undefined"){var B=q.jsbn.BigInteger;}var s=q.asn1;q.pki=q.pki||{};q.pki.rsa=q.rsa=q.rsa||{};var h=q.pki;var C=sofo.storage;var g=[6,4,2,4,2,4,6,2];var r={name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"PrivateKeyInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:false,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:false,capture:"privateKey"}]};var y={name:"RSAPrivateKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"RSAPrivateKey.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"privateKeyCoefficient"}]};var u={name:"RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"RSAPublicKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:false,capture:"publicKeyExponent"}]};var z=q.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:false,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:false,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:true,optional:true,captureAsn1:"rsaPublicKey"}]}]};var v=function(H){var G;if(H.algorithm in h.oids){G=h.oids[H.algorithm];}else{var F=new Error("Unknown message digest algorithm.");F.algorithm=H.algorithm;throw F;}var K=s.oidToDer(G).getBytes();var J=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[]);var E=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[]);E.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,false,K));E.value.push(s.create(s.Class.UNIVERSAL,s.Type.NULL,false,""));var I=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,false,H.digest().getBytes());J.value.push(E);J.value.push(I);return s.toDer(J).getBytes();};var w=function(E,F,J){if(J){return E.modPow(F.e,F.n);}if(!F.p||!F.q){return E.modPow(F.d,F.n);}if(!F.dP){F.dP=F.d.mod(F.p.subtract(B.ONE));}if(!F.dQ){F.dQ=F.d.mod(F.q.subtract(B.ONE));}if(!F.qInv){F.qInv=F.q.modInverse(F.p);}var I;do{I=new B(q.util.bytesToHex(q.random.getBytes(F.n.bitLength()/8)),16);}while(I.compareTo(F.n)>=0||!I.gcd(F.n).equals(B.ONE));E=E.multiply(I.modPow(F.e,F.n)).mod(F.n);var H=E.mod(F.p).modPow(F.dP,F.p);var G=E.mod(F.q).modPow(F.dQ,F.q);while(H.compareTo(G)<0){H=H.add(F.p);}var K=H.subtract(G).multiply(F.qInv).mod(F.p).multiply(F.q).add(G);K=K.multiply(I.modInverse(F.n)).mod(F.n);return K;};h.rsa.encrypt=function(F,N,O){var H=O;var J;var G=Math.ceil(N.n.bitLength()/8);if(O!==false&&O!==true){H=O===2;J=A(F,N,O);}else{J=q.util.createBuffer();J.putBytes(F);}var M=new B(J.toHex(),16);var L=w(M,N,H);var K=L.toString(16);var I=q.util.createBuffer();var E=G-Math.ceil(K.length/2);while(E>0){I.putByte(0);--E;}I.putBytes(q.util.hexToBytes(K));return I.getBytes();};h.rsa.decrypt=function(I,N,H,G){var F=Math.ceil(N.n.bitLength()/8);if(I.length!==F){var K=new Error("Encrypted message length is invalid.");K.length=I.length;K.expected=F;throw K;}var L=new B(q.util.createBuffer(I).toHex(),16);if(L.compareTo(N.n)>=0){throw new Error("Encrypted message is invalid.");}var M=w(L,N,H);var O=M.toString(16);var J=q.util.createBuffer();var E=F-Math.ceil(O.length/2);while(E>0){J.putByte(0);--E;}J.putBytes(q.util.hexToBytes(O));if(G!==false){return p(J.getBytes(),N,H);}return J.getBytes();};h.rsa.createKeyPairGenerationState=function(I,K,G){if(typeof I==="string"){I=parseInt(I,10);}I=I||2048;G=G||{};var H=G.prng||q.random;var E={nextBytes:function(M){var L=H.getBytesSync(M.length);for(var N=0;N<M.length;++N){M[N]=L.charCodeAt(N);}}};var F=G.algorithm||"PRIMEINC";var J;if(F==="PRIMEINC"){J={algorithm:F,state:0,bits:I,rng:E,eInt:K||65537,e:new B(null),p:null,q:null,qBits:I>>1,pBits:I-(I>>1),pqState:0,num:null,keys:null};J.e.fromInt(J.eInt);}else{throw new Error("Invalid key generation algorithm: "+F);}return J;};h.rsa.stepKeyPairGenerationState=function(E,G){if(!("algorithm" in E)){E.algorithm="PRIMEINC";}var I=new B(null);I.fromInt(30);var K=0;var H=function(P,Q){return P|Q;};var L=+new Date;var J;var N=0;while(E.keys===null&&(G<=0||N<G)){if(E.state===0){var O=E.p===null?E.pBits:E.qBits;var F=O-1;if(E.pqState===0){E.num=new B(O,E.rng);if(!E.num.testBit(F)){E.num.bitwiseTo(B.ONE.shiftLeft(F),H,E.num);}E.num.dAddOffset(31-E.num.mod(I).byteValue(),0);K=0;++E.pqState;}else{if(E.pqState===1){if(E.num.bitLength()>O){E.pqState=0;}else{if(E.num.isProbablePrime(m(E.num.bitLength()))){++E.pqState;}else{E.num.dAddOffset(g[K++%8],0);}}}else{if(E.pqState===2){E.pqState=E.num.subtract(B.ONE).gcd(E.e).compareTo(B.ONE)===0?3:0;}else{if(E.pqState===3){E.pqState=0;if(E.p===null){E.p=E.num;}else{E.q=E.num;}if(E.p!==null&&E.q!==null){++E.state;}E.num=null;}}}}}else{if(E.state===1){if(E.p.compareTo(E.q)<0){E.num=E.p;E.p=E.q;E.q=E.num;}++E.state;}else{if(E.state===2){E.p1=E.p.subtract(B.ONE);E.q1=E.q.subtract(B.ONE);E.phi=E.p1.multiply(E.q1);++E.state;}else{if(E.state===3){if(E.phi.gcd(E.e).compareTo(B.ONE)===0){++E.state;}else{E.p=null;E.q=null;E.state=0;}}else{if(E.state===4){E.n=E.p.multiply(E.q);if(E.n.bitLength()===E.bits){++E.state;}else{E.q=null;E.state=0;}}else{if(E.state===5){var M=E.e.modInverse(E.phi);E.keys={privateKey:h.rsa.setPrivateKey(E.n,E.e,M,E.p,E.q,M.mod(E.p1),M.mod(E.q1),E.q.modInverse(E.p)),publicKey:h.rsa.setPublicKey(E.n,E.e)};}}}}}}J=+new Date;N+=J-L;L=J;}return E.keys!==null;};h.rsa.generateKeyPair=function(I,K,E,L){if(arguments.length===1){if(typeof I==="object"){E=I;I=undefined;}else{if(typeof I==="function"){L=I;I=undefined;}}}else{if(arguments.length===2){if(typeof I==="number"){if(typeof K==="function"){L=K;K=undefined;}else{if(typeof K!=="number"){E=K;K=undefined;}}}else{E=I;L=K;I=undefined;K=undefined;}}else{if(arguments.length===3){if(typeof K==="number"){if(typeof E==="function"){L=E;E=undefined;}}else{L=E;E=K;K=undefined;}}}}E=E||{};if(I===undefined){I=E.bits||2048;}if(K===undefined){K=E.e||65537;}var G=E.algorithmName||"RSASSA-PKCS1-v1_5";if(!q.options.usePureJavaScript&&L&&I>=256&&I<=16384&&(K===65537||K===3)){if(n("generateKey")&&n("exportKey")){if(G=="RSASSA-PKCS1-v1_5"){return(window.crypto||window.msCrypto).subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:I,publicExponent:l(K),hash:{name:"SHA-256"}},true,["sign","verify"]).then(function(M){return(window.crypto||window.msCrypto).subtle.exportKey("pkcs8",M.privateKey);}).then(undefined,function(M){L(M);}).then(function(O){if(O){var M=sofo.pki.privateKeyFromAsn1(s.fromDer(q.util.createBuffer(O)));var N=M.key;L(null,{privateKey:N,publicKey:h.setRsaPublicKey(N.n,N.e)});}});}else{if(G=="RSA-OAEP"){var F;return(window.crypto||window.msCrypto).subtle.generateKey({name:"RSA-OAEP",modulusLength:I,publicExponent:l(K),hash:{name:"SHA-256"}},false,["encrypt","decrypt"]).then(function(M){F=M;return(window.crypto||window.msCrypto).subtle.exportKey("spki",M.publicKey);}).then(undefined,function(M){L(M);}).then(function(N){if(N){var M=q.pki.rsa.publicKeyFromAsn1forCryptoKey(q.asn1.fromDer(q.util.createBuffer(N)));var O=M;L(null,{privateKey:F.privateKey,publicKey:F.publicKey,publicKeyPkcs7:h.setRsaPublicKey(O.n,O.e)});}});}}}if(D("generateKey")&&D("exportKey")){if(G=="RSASSA-PKCS1-v1_5"){var J=window.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:I,publicExponent:l(K),hash:{name:"SHA-256"}},true,["sign","verify"]);J.oncomplete=function(M){var O=M.target.result;var N=window.msCrypto.subtle.exportKey("pkcs8",O.privateKey);N.oncomplete=function(S){var R=S.target.result;var P=sofo.pki.privateKeyFromAsn1(s.fromDer(q.util.createBuffer(R)));var Q=P.key;L(null,{privateKey:Q,publicKey:h.setRsaPublicKey(Q.n,Q.e)});};N.onerror=function(P){L(P);};};J.onerror=function(M){L(M);};return;}else{if(G=="RSA-OAEP"){var J=window.msCrypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:I,publicExponent:l(K),hash:{name:"SHA-256"}},false,["encrypt","decrypt"]);J.oncomplete=function(M){var O=M.target.result;var N=window.msCrypto.subtle.exportKey("spki",O.publicKey);N.oncomplete=function(R){var Q=R.target.result;var P=q.pki.rsa.publicKeyFromAsn1forCryptoKey(q.asn1.fromDer(q.util.createBuffer(Q)));var S=P;L(null,{privateKey:O.privateKey,publicKey:O.publicKey,publicKeyPkcs7:h.setRsaPublicKey(S.n,S.e)});};N.onerror=function(P){L(P);};};J.onerror=function(M){L(M);};return;}}}}var H=h.rsa.createKeyPairGenerationState(I,K,E);if(!L){h.rsa.stepKeyPairGenerationState(H,0);return H.keys;}o(H,E,L);};h.setRsaPublicKey=h.rsa.setPublicKey=function(I,G,F){var E={n:I,e:G,obj:F,bit:0,rsa:true};var H=I.bitLength();if(H<=0){E.bit=0;}if(H<=1024){E.bit=1024;}else{if(H<=2048){E.bit=2048;}else{if(H<=3072){E.bit=3072;}else{if(H<=4096){E.bit=4096;}else{E.bit=H;}}}}E.encrypt=function(L,K,J){if(typeof K==="string"){K=K.toUpperCase();}else{if(K===undefined){K="RSAES-PKCS1-V1_5";}}if(K==="RSAES-PKCS1-V1_5"){K={encode:function(N,O,P){return A(N,O,2).getBytes();}};}else{if(K==="RSA-OAEP"||K==="RSAES-OAEP"){K={encode:function(N,O){return q.pkcs1.encode_rsa_oaep(O,N,J);}};}else{if(["RAW","NONE","NULL",null].indexOf(K)!==-1){K={encode:function(N){return N;}};}else{if(typeof K==="string"){throw new Error('Unsupported encryption scheme: "'+K+'".');}}}}var M=K.encode(L,E,true);return h.rsa.encrypt(M,E,true);};E.verify=function(M,J,K){if(typeof K==="string"){K=K.toUpperCase();}else{if(K===undefined){K="RSASSA-PKCS1-V1_5";}}if(K==="RSASSA-PKCS1-V1_5"){K={verify:function(P,O){O=p(O,E,true);var N=s.fromDer(O);return P===N.value[1].value;}};}else{if(K==="NONE"||K==="NULL"||K===null){K={verify:function(O,N){N=p(N,E,true);return O===N;}};}}var L=h.rsa.decrypt(J,E,true,false);return K.verify(M,L,E.n.bitLength());};return E;};h.setRsaPrivateKey=h.rsa.setPrivateKey=function(G,H,I,F,E,K,J,M){var L={rsa:true,n:G,e:H,d:I,p:F,q:E,dP:K,dQ:J,qInv:M};L.decrypt=function(P,O,N){if(typeof O==="string"){O=O.toUpperCase();}else{if(O===undefined){O="RSAES-PKCS1-V1_5";}}var Q=h.rsa.decrypt(P,L,false,false);if(O==="RSAES-PKCS1-V1_5"){O={decode:p};}else{if(O==="RSA-OAEP"||O==="RSAES-OAEP"){O={decode:function(S,R){return q.pkcs1.decode_rsa_oaep(R,S,N);}};}else{if(["RAW","NONE","NULL",null].indexOf(O)!==-1){O={decode:function(R){return R;}};}else{throw new Error('Unsupported encryption scheme: "'+O+'".');}}}return O.decode(Q,L,false);};L.sign=function(P,O){var N=false;if(typeof O==="string"){O=O.toUpperCase();}if(O===undefined||O==="RSASSA-PKCS1-V1_5"){O={encode:v};N=1;}else{if(O==="NONE"||O==="NULL"||O===null){O={encode:function(){return P;}};N=1;}}var Q=O.encode(P,L.n.bitLength());return h.rsa.encrypt(Q,L,N);};return L;};h.wrapRsaPrivateKey=function(E,F){if(!F){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.OID,false,s.oidToDer(q.pki.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,false,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,false,s.toDer(E).getBytes())]);}else{return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.OID,false,s.oidToDer(q.pki.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,false,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,false,s.toDer(E).getBytes()),s.create(s.Class.CONTEXT_SPECIFIC,0,true,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.OID,false,s.oidToDer(q.pki.oids.randomNum).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,true,[s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,false,String.fromCharCode(0)+F)])])])]);}};h.rsa.privateKeyFromAsn1=function(I,L){var Q={};var O=[];Q={};O=[];if(!s.validate(I,y,Q,O)){var H=new Error("Cannot read private key. "+"ASN.1 object does not contain an RSAPrivateKey.");H.errors=O;throw H;}var G,J,K,F,E,N,M,R;G=q.util.createBuffer(Q.privateKeyModulus).toHex();J=q.util.createBuffer(Q.privateKeyPublicExponent).toHex();K=q.util.createBuffer(Q.privateKeyPrivateExponent).toHex();F=q.util.createBuffer(Q.privateKeyPrime1).toHex();E=q.util.createBuffer(Q.privateKeyPrime2).toHex();N=q.util.createBuffer(Q.privateKeyExponent1).toHex();M=q.util.createBuffer(Q.privateKeyExponent2).toHex();R=q.util.createBuffer(Q.privateKeyCoefficient).toHex();var P=h.setRsaPrivateKey(new B(G,16),new B(J,16),new B(K,16),new B(F,16),new B(E,16),new B(N,16),new B(M,16),new B(R,16));return{key:P,randomNum:L};};h.privateKeyToAsn1=h.privateKeyToRSAPrivateKey=function(E){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,t(E.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,t(E.e)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,t(E.d)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,t(E.p)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,t(E.q)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,t(E.dP)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,t(E.dQ)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,t(E.qInv))]);};h.rsa.publicKeyFromAsn1=function(H){var E={};var J=[];if(!s.validate(H,u,E,J)){var F=new Error("Cannot read public key. "+"ASN.1 object does not contain an RSAPublicKey.");F.errors=J;throw F;}var I=q.util.createBuffer(E.publicKeyModulus).toHex();var G=q.util.createBuffer(E.publicKeyExponent).toHex();return q.pki.setRsaPublicKey(new B(I,16),new B(G,16),q.util.bytesToHex(s.toDer(H).getBytes()));};h.rsa.publicKeyFromAsn1forCryptoKey=function(I){var E={};var K=[];if(s.validate(I,z,E,K)){var G=s.derToOid(E.publicKeyOid);if(G!==h.oids.rsaEncryption){var F=new Error("Cannot read public key. Unknown OID.");F.oid=G;throw F;}I=E.rsaPublicKey;}K=[];if(!s.validate(I,u,E,K)){var F=new Error("Cannot read public key. "+"ASN.1 object does not contain an RSAPublicKey.");F.errors=K;throw F;}var J=q.util.createBuffer(E.publicKeyModulus).toHex();var H=q.util.createBuffer(E.publicKeyExponent).toHex();return h.setRsaPublicKey(new B(J,16),new B(H,16));};h.rsa.publicKeyToAsn1=h.rsa.publicKeyToSubjectPublicKeyInfo=function(E){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.OID,false,s.oidToDer(h.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,false,"")]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,false,[h.publicKeyToRSAPublicKey(E)])]);};h.publicKeyToRSAPublicKey=function(E){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,true,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,t(E.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,false,t(E.e))]);};function A(G,M,N){var K=q.util.createBuffer();var I=Math.ceil(M.n.bitLength()/8);if(G.length>I-11){var L=new Error("Message is too long for PKCS#1 v1.5 padding.");L.length=G.length;L.max=I-11;throw L;}K.putByte(0);K.putByte(N);var H=I-3-G.length;var E;if(N===0||N===1){E=N===0?0:255;for(var J=0;J<H;++J){K.putByte(E);}}else{while(H>0){var F=0;var O=q.random.getBytes(H);for(var J=0;J<H;++J){E=O.charCodeAt(J);if(E===0){++F;}else{K.putByte(E);}}H=F;}}K.putByte(0);K.putBytes(G);return K;}function p(E,N,I,H){var G=Math.ceil(N.n.bitLength()/8);var L=q.util.createBuffer(E);var K=L.getByte();var O=L.getByte();if(K!==0||I&&O!==0&&O!==1||!I&&O!=2||I&&O===0&&typeof H==="undefined"){throw new Error("Encryption block is invalid.");}var F=0;if(O===0){F=G-3-H;for(var J=0;J<F;++J){if(L.getByte()!==0){throw new Error("Encryption block is invalid.");}}}else{if(O===1){F=0;while(L.length()>1){if(L.getByte()!==255){--L.read;break;}++F;}}else{if(O===2){F=0;while(L.length()>1){if(L.getByte()===0){--L.read;break;}++F;}}}}var M=L.getByte();if(M!==0||F!==G-3-L.length()){throw new Error("Encryption block is invalid.");}return L.getBytes();}function o(I,F,K){if(typeof F==="function"){K=F;F={};}F=F||{};var H={algorithm:{name:F.algorithm||"PRIMEINC",options:{workers:F.workers||2,workLoad:F.workLoad||100,workerScript:F.workerScript}}};if("prng" in F){H.prng=F.prng;}if(F.workers==0){delete H.algorithm.options.workers;}E();function E(){J(I.pBits,function(M,L){if(M){return K(M);}I.p=L;if(I.q!==null){return G(M,I.q);}J(I.qBits,G);});}function J(L,M){q.prime.generateProbablePrime(L,H,M);}function G(N,L){if(N){return K(N);}I.q=L;if(I.p.compareTo(I.q)<0){var M=I.p;I.p=I.q;I.q=M;}if(I.p.subtract(B.ONE).gcd(I.e).compareTo(B.ONE)!==0){I.p=null;E();return;}if(I.q.subtract(B.ONE).gcd(I.e).compareTo(B.ONE)!==0){I.q=null;J(I.qBits,G);return;}I.p1=I.p.subtract(B.ONE);I.q1=I.q.subtract(B.ONE);I.phi=I.p1.multiply(I.q1);if(I.phi.gcd(I.e).compareTo(B.ONE)!==0){I.p=I.q=null;E();return;}I.n=I.p.multiply(I.q);if(I.n.bitLength()!==I.bits){I.q=null;J(I.qBits,G);return;}var O=I.e.modInverse(I.phi);I.keys={privateKey:h.rsa.setPrivateKey(I.n,I.e,O,I.p,I.q,O.mod(I.p1),O.mod(I.q1),I.q.modInverse(I.p)),publicKey:h.rsa.setPublicKey(I.n,I.e)};K(null,I.keys);}}function t(E){var F=E.toString(16);if(F[0]>="8"){F="00"+F;}return q.util.hexToBytes(F);}function m(E){if(E<=100){return 27;}if(E<=150){return 18;}if(E<=200){return 15;}if(E<=250){return 12;}if(E<=300){return 9;}if(E<=350){return 8;}if(E<=400){return 7;}if(E<=500){return 6;}if(E<=600){return 5;}if(E<=800){return 4;}if(E<=1250){return 3;}return 2;}function n(E){return typeof window!=="undefined"&&C.getAPNIndexedDBEnable()&&typeof window.crypto==="object"&&typeof window.crypto.subtle==="object"&&typeof window.crypto.subtle[E]==="function"&&typeof window.crypto.webkitSubtle==="undefined";}function D(E){return typeof window!=="undefined"&&C.getAPNIndexedDBEnable()&&typeof window.msCrypto==="object"&&typeof window.msCrypto.subtle==="object"&&typeof window.msCrypto.subtle[E]==="function";}function l(E){var G=q.util.hexToBytes(E.toString(16));var F=new Uint8Array(G.length);for(var H=0;H<G.length;++H){F[H]=G.charCodeAt(H);}return F;}}var b="rsa";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./asn1","./jsbn","./oids","./pkcs1","./prime","./random","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(q){if(typeof h==="undefined"){var h=q.jsbn.BigInteger;}var l=q.asn1;q.pki.oids["1.2.410.200004.1.1"]="kcdsa";q.pki.oids["kcdsa"]="1.2.410.200004.1.1";q.pki.oids["1.2.410.200004.1.2"]="has160";q.pki.oids["has160"]="1.2.410.200004.1.2";q.pki.oids["1.2.410.200004.1.8"]="kcdsaWithHAS160";q.pki.oids["kcdsaWithHAS160"]="1.2.410.200004.1.8";q.pki.oids["1.2.410.200004.1.9"]="kcdsaWithSHA1";q.pki.oids["kcdsaWithSHA1"]="1.2.410.200004.1.9";q.pki.oids["1.2.410.200004.1.21"]="kcdsa1";q.pki.oids["kcdsa1"]="1.2.410.200004.1.21";q.pki.oids["1.2.410.200004.1.22"]="kcdsa1WithHAS160";q.pki.oids["kcdsa1WithHAS160"]="1.2.410.200004.1.22";q.pki.oids["1.2.410.200004.1.23"]="kcdsa1WithSHA1";q.pki.oids["kcdsa1WithSHA1"]="1.2.410.200004.1.23";q.pki.oids["1.2.410.200004.1.38"]="kcdsa1WithSHA256";q.pki.oids["kcdsa1WithSHA256"]="1.2.410.200004.1.38";q.pki=q.pki||{};q.pki.kcdsa=q.kcdsa=q.kcdsa||{};var n=q.pki;var o={name:"PrivateKeyInfo",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,value:[{name:"PrivateKeyInfo.version",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:false,capture:"privateKeyOid"},{name:"AlgorithmIdentifier.parameters",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,captureAsn1:"parameters",optional:true}]},{name:"PrivateKeyInfo",tagClass:l.Class.UNIVERSAL,type:l.Type.OCTETSTRING,constructed:false,capture:"privateKey"},{name:"PrivateKeyInfo.attributes",tagClass:l.Class.CONTEXT_SPECIFIC,type:0,constructed:true,captureAsn1:"attributes",optional:true}]};var r={name:"KCDSAParameters",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,value:[{name:"KCDSAParameters.p",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"p"},{name:"KCDSAParameters.q",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"q"},{name:"KCDSAParameters.g",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"g"},{name:"KCDSAParameters.j",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"j",optional:true},{name:"KCDSAParameters.validationParams",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,optional:true,value:[{name:"ValidationParams.seed",tagClass:l.Class.UNIVERSAL,type:l.Type.OCTETSTRING,constructed:false,capture:"seed"},{name:"ValidationParams.count",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"count"}]}]};var s={name:"KCDSAPrivateKey",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"x"};var m={name:"KCDSAPublicKey",tagClass:l.Class.UNIVERSAL,type:l.Type.INTEGER,constructed:false,capture:"y"};var p={name:"SubjectPublicKeyInfo",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:l.Class.UNIVERSAL,type:l.Type.OID,constructed:false,capture:"publicKeyOid"},{name:"AlgorithmIdentifier.parameters",tagClass:l.Class.UNIVERSAL,type:l.Type.SEQUENCE,constructed:true,captureAsn1:"parameters",optional:true}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:l.Class.UNIVERSAL,type:l.Type.BITSTRING,constructed:false,capture:"publicKey"}]};n.setKcdsaPublicKey=n.kcdsa.setPublicKey=function(u,t,B,w,A,C,D,z){var E={p:u,q:t,g:B,j:w,seed:A,count:C,y:D,obj:z,bit:0,kcdsa:true};var v=D.bitLength();if(v<=0){E.bit=0;}else{if(v<=1024){E.bit=1024;}else{if(v<=2048){E.bit=2048;}else{if(v<=3072){E.bit=3072;}else{if(v<=4096){E.bit=4096;}else{E.bit=v;}}}}}E.verify=function(Y,V,R,Q){var I=new q.jsbn.BigInteger(q.util.createBuffer(R).toHex(),16);var X=new q.jsbn.BigInteger(q.util.createBuffer(Q).toHex(),16);if(!(I.compareTo(h.ZERO)>0&&X.compareTo(h.ZERO)>0&&E.q.compareTo(X)>0)){return false;}var U;switch(q.pki.oids[Y]){case q.pki.oids.md5:case q.pki.oids.sha1:case q.pki.oids.sha256:case q.pki.oids.has160:U=64*8;break;case q.pki.oids.sha384:case q.pki.oids.sha512:U=128*8;break;default:throw new Error("unknown message digest algorithm: "+Y);}var M=E.y.mod(q.jsbn.BigInteger.ONE.shiftLeft(U));var P=q.util.createBuffer();P.putBytes(q.util.hexToBytes(M.toString(16)));var J=P.getBytes();var y=q.md[Y].create();y.start();y.update(J);y.update(V);var W=y.digest().getBytes();var F=new q.jsbn.BigInteger(q.util.createBuffer(W).toHex(),16);var G=I.xor(F).mod(E.q);var T=E.y.modPow(X,E.p);var S=E.g.modPow(G,E.p);var N=T.multiply(S).mod(E.p);var O=q.util.createBuffer();O.putBytes(q.util.hexToBytes(N.toString(16)));var Z=O.getBytes();var H=q.md[Y].create();H.start();H.update(Z);var L=H.digest().getBytes();var K=new q.jsbn.BigInteger(q.util.createBuffer(L).toHex(),16);return K.compareTo(I)==0;};return E;};n.setKcdsaPrivateKey=n.kcdsa.setPrivateKey=function(B,A,z,v,u,y,t){var w={kcdsa:true,p:B,q:A,g:z,j:v,seed:u,count:y,x:t};w.sign=function(T,P,D){var Q;do{Q=new q.jsbn.BigInteger(q.util.bytesToHex(q.random.getBytes(w.q.bitLength()/8)),16);}while(Q.compareTo(q.jsbn.BigInteger.ZERO)<=0||Q.compareTo(w.q)>=0);var I=w.g.modPow(Q,w.p);var K=q.util.createBuffer();K.putBytes(q.util.hexToBytes(I.toString(16)));var U=K.getBytes();var J=q.md[T].create();J.start().update(U);var N=J.digest().getBytes();var O;switch(q.pki.oids[T]){case q.pki.oids.md5:case q.pki.oids.sha1:case q.pki.oids.sha256:case q.pki.oids.has160:O=64*8;break;case q.pki.oids.sha384:case q.pki.oids.sha512:O=128*8;break;default:throw new Error("unknown message digest algorithm: "+T);}var H=D.mod(q.jsbn.BigInteger.ONE.shiftLeft(O));var L=q.util.createBuffer();L.putBytes(q.util.hexToBytes(H.toString(16)));var G=L.getBytes();var C=q.md[T].create();C.start();C.update(G);C.update(P);var R=C.digest().getBytes();var F=new q.jsbn.BigInteger(q.util.createBuffer(N).toHex(),16);var E=new q.jsbn.BigInteger(q.util.createBuffer(R).toHex(),16);var S=F.xor(E).mod(w.q);var M=w.x.multiply(Q.subtract(S)).mod(w.q);return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,false,String.fromCharCode(0)+N),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,g(M))]);};return w;};n.wrapKcdsaPrivateKey=function(t,v,u){if(!u){return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,l.integerToDer(0).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.OID,false,l.oidToDer(q.pki.oids.kcdsa1).getBytes()),v]),l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,false,l.toDer(t).getBytes())]);}else{return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,l.integerToDer(0).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.OID,false,l.oidToDer(q.pki.oids.kcdsa1).getBytes()),v]),l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,false,l.toDer(t).getBytes()),l.create(l.Class.CONTEXT_SPECIFIC,0,true,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.OID,false,l.oidToDer(q.pki.oids.randomNum).getBytes()),l.create(l.Class.UNIVERSAL,l.Type.SET,true,[l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,false,String.fromCharCode(0)+u)])])])]);}};n.parametersToAsn1=function(t){if(t.j&&t.seed&&t.count){return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,g(t.p)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,g(t.q)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,g(t.g)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,g(t.j)),l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.OCTETSTRING,false,g(t.seed)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,q.util.hexToBytes(t.count))])]);}else{return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,g(t.p)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,g(t.q)),l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,g(t.g))]);}};n.kcdsa.privateKeyFromAsn1=function(z,v,D){var H={};var F=[];if(!l.validate(v,r,H,F)){var w=new Error("Cannot read private key. "+"ASN.1 object does not contain an KCDSAParameters.");w.errors=F;throw w;}var u,t,B,y,A,C;u=q.util.createBuffer(H.p).toHex();t=q.util.createBuffer(H.q).toHex();B=q.util.createBuffer(H.g).toHex();if(H.j){y=q.util.createBuffer(H.j).toHex();}if(H.seed){A=q.util.createBuffer(H.seed).toHex();}if(H.count){C=q.util.createBuffer(H.count).toHex();}H={};F=[];if(!l.validate(z,s,H,F)){var w=new Error("Cannot read private key. "+"ASN.1 object does not contain an KCDSAPrivateKey.");w.errors=F;throw w;}var E=q.util.createBuffer(H.x).toHex();var G=n.setKcdsaPrivateKey(new h(u,16),new h(t,16),new h(B,16),new h(y,16),new h(A,16),C,new h(E,16));return{key:G,randomNum:D};};n.privateKeyToKCDSAPrivateKey=function(t){return l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,g(t.x));};n.kcdsa.publicKeyFromAsn1=function(A,v){var H={};var G=[];if(!l.validate(v,r,H,G)){var w=new Error("Cannot read private key. "+"ASN.1 object does not contain an KCDSAParameters.");w.errors=G;throw w;}var u,t,C,z,B,D;u=q.util.createBuffer(H.p).toHex();t=q.util.createBuffer(H.q).toHex();C=q.util.createBuffer(H.g).toHex();if(H.j){z=q.util.createBuffer(H.j).toHex();}if(H.seed){B=q.util.createBuffer(H.seed).toHex();}if(H.count){D=q.util.createBuffer(H.count).toHex();}H={};G=[];if(!l.validate(A,m,H,G)){var E=new Error("Cannot read public key. "+"ASN.1 object does not contain an KCDSA PublicKey.");E.errors=G;throw E;}var F=q.util.createBuffer(H.y).toHex();return n.setKcdsaPublicKey(new h(u,16),new h(t,16),new h(C,16),new h(z,16),new h(B,16),D,new h(F,16),q.util.bytesToHex(l.toDer(A).getBytes()));};n.kcdsa.keyParameterFromAsn1=function(v){var E={};var D=[];if(!l.validate(v,r,E,D)){var w=new Error("Cannot read private key. "+"ASN.1 object does not contain an KCDSAParameters.");w.errors=D;throw w;}var u,t,A,y,z,B;u=q.util.createBuffer(E.p).toHex();t=q.util.createBuffer(E.q).toHex();A=q.util.createBuffer(E.g).toHex();if(E.j){y=q.util.createBuffer(E.j).toHex();}if(E.seed){z=q.util.createBuffer(E.seed).toHex();}if(E.count){B=q.util.createBuffer(E.count).toHex();}var C={p:new h(u,16),q:new h(t,16),g:new h(A,16),j:new h(y,16),seed:new h(z,16),count:B};return C;};n.kcdsa.generateKeyPair=function(t){var z=new q.random.createInstance;var B=new q.jsbn.BigInteger;var w=10;do{B.fromNumber(t.q.bitLength(),z);}while(B.compareTo(q.jsbn.BigInteger.ZERO)<=0||B.compareTo(t.q)>=0);var v=t.g.modPow(B.modInverse(t.q),t.p);var C=v.toString(16);var A=new h(C,16);var u=t.p.bitLength()+7>>>3;var D={privateKey:n.kcdsa.setPrivateKey(t.p,t.q,t.g,t.j,t.seed,t.count,B),publicKey:n.kcdsa.setPublicKey(t.p,t.q,t.g,t.j,t.seed,t.count,A)};return D;};n.kcdsa.generateParameters=function(N,A,t,v,w){w=w||"hex";function F(P,R,Q){var y=Math.ceil((Q+7&4294967288)/8);var O=0;var T=false;var S="";while(!T){P.start();P.update(R);P.update([O&255]);S+=P.digest().getBytes();if(S.length>=y){T=true;}O++;}return S.slice(0,y);}A=A||160;if(N<1024||N>4096||N%8){throw new Error("INVALID_BITLENGTH");}if(A<160||A>256||A%32){throw new Error("INVALID_BITLENGTH");}if(N>=2048&&A<224){throw new Error("INVALID_BITLENGTH");}t=t||"sha-256";if(N>=2048&&t=="has-160"){throw new Error("UNFIT_HASH");}var M=1;var J=false;var C=new h("2",16);var E=0;var u;var D=96-N/32;if(t=="sha-1"){u=q.md.sha1.create();}else{if(t=="sha-256"){u=q.md.sha256.create();}else{throw new Error("NOTSUPPORT_hashAlgorithm_parameter");}}while(!J){if(E==0||E>=D){if(v){v=F(u,v,N);}else{v=F(u,Date.now().toString(),N);}var z=q.random;z.collect(v);E=0;console.log(q.util.createBuffer(v).toHex());}var I=h.probablePrime(N-A,z,M);var G;do{G=h.probablePrime(A,z,M);}while(!G.isProbablePrime(M));var H=G.multiply(I).multiply(C).add(h.ONE);if(H.testBit(N-1)&&H.isProbablePrime(M)){J=true;break;}E++;}var B=I.multiply(C);do{var K=h.random(N,z);if(K.compareTo(H.subtract(h.ONE))>=0||K.compareTo(h.ONE)<=0){continue;}var L=K.modPow(B,H);}while(!L||L.compareTo(h.ONE)<=0);switch(w){case "object":return{p:H,q:G,g:L};case "hex":default:return{p:H.toString(16),q:G.toString(16),g:L.toString(16)};}};n.kcdsa.publicKeyToAsn1=n.kcdsa.publicKeyToSubjectPublicKeyInfo=function(t){return l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.SEQUENCE,true,[l.create(l.Class.UNIVERSAL,l.Type.OID,false,l.oidToDer(q.pki.oids.kcdsa1).getBytes()),n.parametersToAsn1(t)]),l.create(l.Class.UNIVERSAL,l.Type.BITSTRING,false,[n.publicKeyToKCDSAPublicKey(t)])]);};n.publicKeyToKCDSAPublicKey=function(t){return l.create(l.Class.UNIVERSAL,l.Type.INTEGER,false,g(t.y));};function g(t){var u=t.toString(16);if(u[0]>="8"){u="00"+u;}return q.util.hexToBytes(u);}}var b="kcdsa";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./asn1","./md","./jsbn","./oids","./pkcs1","./prime","./random","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(s){var u=s.asn1;var m=s.pki=s.pki||{};var o=m.oids;var w={};w["CN"]=o["commonName"];w["commonName"]="CN";w["C"]=o["countryName"];w["countryName"]="C";w["L"]=o["localityName"];w["localityName"]="L";w["ST"]=o["stateOrProvinceName"];w["stateOrProvinceName"]="ST";w["O"]=o["organizationName"];w["organizationName"]="O";w["OU"]=o["organizationalUnitName"];w["organizationalUnitName"]="OU";w["E"]=o["emailAddress"];w["emailAddress"]="E";var z=s.pki.rsa.publicKeyValidator;var y={name:"Certificate",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:u.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:false,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:false,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:false,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:u.Class.UNIVERSAL,optional:true,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:u.Class.UNIVERSAL,type:u.Type.UTCTIME,constructed:false,optional:true,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:u.Class.UNIVERSAL,type:u.Type.GENERALIZEDTIME,constructed:false,optional:true,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:u.Class.UNIVERSAL,type:u.Type.UTCTIME,constructed:false,optional:true,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:u.Class.UNIVERSAL,type:u.Type.GENERALIZEDTIME,constructed:false,optional:true,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,captureAsn1:"certSubject"},z,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:u.Class.CONTEXT_SPECIFIC,type:1,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:u.Class.UNIVERSAL,type:u.Type.BITSTRING,constructed:false,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:u.Class.CONTEXT_SPECIFIC,type:2,constructed:true,optional:true,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:u.Class.UNIVERSAL,type:u.Type.BITSTRING,constructed:false,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:u.Class.CONTEXT_SPECIFIC,type:3,constructed:true,captureAsn1:"certExtensions",optional:true}]},{name:"Certificate.signatureAlgorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:false,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:u.Class.UNIVERSAL,optional:true,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:u.Class.UNIVERSAL,type:u.Type.BITSTRING,constructed:false,capture:"certSignature"}]};var v={name:"rsapss",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,value:[{name:"rsapss.hashAlgorithm",tagClass:u.Class.CONTEXT_SPECIFIC,type:0,constructed:true,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:u.Class.UNIVERSAL,type:u.Class.SEQUENCE,constructed:true,optional:true,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:false,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:u.Class.CONTEXT_SPECIFIC,type:1,constructed:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:u.Class.UNIVERSAL,type:u.Class.SEQUENCE,constructed:true,optional:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:false,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:false,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:u.Class.CONTEXT_SPECIFIC,type:2,optional:true,value:[{name:"rsapss.saltLength.saltLength",tagClass:u.Class.UNIVERSAL,type:u.Class.INTEGER,constructed:false,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:u.Class.CONTEXT_SPECIFIC,type:3,optional:true,value:[{name:"rsapss.trailer.trailer",tagClass:u.Class.UNIVERSAL,type:u.Class.INTEGER,constructed:false,capture:"trailer"}]}]};var n={name:"CertificationRequestInfo",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:u.Class.UNIVERSAL,type:u.Type.INTEGER,constructed:false,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,captureAsn1:"certificationRequestInfoSubject"},z,{name:"CertificationRequestInfo.attributes",tagClass:u.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:false},{name:"CertificationRequestInfo.attributes.value",tagClass:u.Class.UNIVERSAL,type:u.Type.SET,constructed:true}]}]}]};var t={name:"CertificationRequest",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,captureAsn1:"csr",value:[n,{name:"CertificationRequest.signatureAlgorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.SEQUENCE,constructed:true,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:u.Class.UNIVERSAL,type:u.Type.OID,constructed:false,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:u.Class.UNIVERSAL,optional:true,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:u.Class.UNIVERSAL,type:u.Type.BITSTRING,constructed:false,capture:"csrSignature"}]};m.RDNAttributesAsArray=function(G,F){var I=[];var J,C,H;for(var D=0;D<G.value.length;++D){J=G.value[D];for(var E=0;E<J.value.length;++E){H={};C=J.value[E];H.type=u.derToOid(C.value[0].value);H.value=C.value[1].value;H.valueTagClass=C.value[1].type;if(H.type in o){H.name=o[H.type];if(H.name in w){H.shortName=w[H.name];}}if(F){F.update(H.type);F.update(H.value);}I.push(H);}}return I;};m.CRIAttributesAsArray=function(E){var H=[];for(var G=0;G<E.length;++G){var K=E[G];var I=u.derToOid(K.value[0].value);var J=K.value[1].value;for(var D=0;D<J.length;++D){var F={};F.type=I;F.value=J[D].value;F.valueTagClass=J[D].type;if(F.type in o){F.name=o[F.type];if(F.name in w){F.shortName=w[F.name];}}if(F.type===o.extensionRequest){F.extensions=[];for(var C=0;C<F.value.length;++C){F.extensions.push(m.certificateExtensionFromAsn1(F.value[C]));}}H.push(F);}}return H;};function l(G,D){if(typeof D==="string"){D={shortName:D};}var F=null;var C;for(var E=0;F===null&&E<G.attributes.length;++E){C=G.attributes[E];if(D.type&&D.type===C.type){F=C;}else{if(D.name&&D.name===C.name){F=C;}else{if(D.shortName&&D.shortName===C.shortName){F=C;}}}}return F;}var h=function(F,G,C){var H={};if(F!==o["RSASSA-PSS"]){return H;}if(C){H={hash:{algorithmOid:o["sha1"]},mgf:{algorithmOid:o["mgf1"],hash:{algorithmOid:o["sha1"]}},saltLength:20};}var D={};var I=[];if(!u.validate(G,v,D,I)){var E=new Error("Cannot read RSASSA-PSS parameter block.");E.errors=I;throw E;}if(D.hashOid!==undefined){H.hash=H.hash||{};H.hash.algorithmOid=u.derToOid(D.hashOid);}if(D.maskGenOid!==undefined){H.mgf=H.mgf||{};H.mgf.algorithmOid=u.derToOid(D.maskGenOid);H.mgf.hash=H.mgf.hash||{};H.mgf.hash.algorithmOid=u.derToOid(D.maskGenHashOid);}if(D.saltLength!==undefined){H.saltLength=D.saltLength.charCodeAt(0);}return H;};m.certificateFromPem=function(E,H,C){var G=s.pem.decode(E)[0];if(G.type!=="CERTIFICATE"&&G.type!=="X509 CERTIFICATE"&&G.type!=="TRUSTED CERTIFICATE"){var D=new Error("Could not convert certificate from PEM; PEM header type "+'is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');D.headerType=G.type;throw D;}if(G.procType&&G.procType.type==="ENCRYPTED"){throw new Error("Could not convert certificate from PEM; PEM is encrypted.");}var F=u.fromDer(G.body,C);return m.certificateFromAsn1(F,H);};m.certificateToPem=function(C,E){var D={type:"CERTIFICATE",body:u.toDer(m.certificateToAsn1(C)).getBytes()};return s.pem.encode(D,{maxline:E});};m.publicKeyFromPem=function(D){var F=s.pem.decode(D)[0];if(F.type!=="PUBLIC KEY"&&F.type!=="RSA PUBLIC KEY"){var C=new Error("Could not convert public key from PEM; PEM header "+'type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');C.headerType=F.type;throw C;}if(F.procType&&F.procType.type==="ENCRYPTED"){throw new Error("Could not convert public key from PEM; PEM is encrypted.");}var E=u.fromDer(F.body);return m.publicKeyFromAsn1(E);};m.publicKeyToPem=function(C,E){var D={type:"PUBLIC KEY",body:u.toDer(sofo.pki.publicKeyToAsn1(C)).getBytes()};return s.pem.encode(D,{maxline:E});};m.publicKeyToRSAPublicKeyPem=function(C,E){var D={type:"RSA PUBLIC KEY",body:u.toDer(m.publicKeyToRSAPublicKey(C)).getBytes()};return s.pem.encode(D,{maxline:E});};m.getPublicKeyFingerprint=function(E,D){D=D||{};var H=D.md||s.md.sha1.create();var F=D.type||"RSAPublicKey";var C;switch(F){case "RSAPublicKey":C=u.toDer(m.publicKeyToRSAPublicKey(E)).getBytes();break;case "SubjectPublicKeyInfo":C=u.toDer(sofo.pki.publicKeyToAsn1(E)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+D.type+'".');}H.start();H.update(C);var I=H.digest();if(D.encoding==="hex"){var G=I.toHex();if(D.delimiter){return G.match(/.{2}/g).join(D.delimiter);}return G;}else{if(D.encoding==="binary"){return I.getBytes();}else{if(D.encoding){throw new Error('Unknown encoding "'+D.encoding+'".');}}}return I;};m.certificationRequestFromPem=function(E,H,C){var G=s.pem.decode(E)[0];if(G.type!=="CERTIFICATE REQUEST"){var D=new Error("Could not convert certification request from PEM; "+'PEM header type is not "CERTIFICATE REQUEST".');D.headerType=G.type;throw D;}if(G.procType&&G.procType.type==="ENCRYPTED"){throw new Error("Could not convert certification request from PEM; "+"PEM is encrypted.");}var F=u.fromDer(G.body,C);return m.certificationRequestFromAsn1(F,H);};m.certificationRequestToPem=function(C,E){var D={type:"CERTIFICATE REQUEST",body:u.toDer(m.certificationRequestToAsn1(C)).getBytes()};return s.pem.encode(D,{maxline:E});};m.createCertificate=function(){var C={};C.version=2;C.serialNumber="00";C.signatureOid=null;C.signature=null;C.siginfo={};C.siginfo.algorithmOid=null;C.validity={};C.validity.notBefore=new Date;C.validity.notAfter=new Date;C.issuer={};C.issuer.getField=function(D){return l(C.issuer,D);};C.issuer.addField=function(D){p([D]);C.issuer.attributes.push(D);};C.issuer.attributes=[];C.issuer.hash=null;C.subject={};C.subject.getField=function(D){return l(C.subject,D);};C.subject.addField=function(D){p([D]);C.subject.attributes.push(D);};C.subject.attributes=[];C.subject.hash=null;C.extensions=[];C.publicKey=null;C.md=null;C.setSubject=function(D,E){p(D);C.subject.attributes=D;delete C.subject.uniqueId;if(E){C.subject.uniqueId=E;}C.subject.hash=null;};C.setIssuer=function(D,E){p(D);C.issuer.attributes=D;delete C.issuer.uniqueId;if(E){C.issuer.uniqueId=E;}C.issuer.hash=null;};C.setExtensions=function(E){for(var D=0;D<E.length;++D){q(E[D],{cert:C});}C.extensions=E;};C.getExtension=function(D){if(typeof D==="string"){D={name:D};}var G=null;var F;for(var E=0;G===null&&E<C.extensions.length;++E){F=C.extensions[E];if(D.id&&F.id===D.id){G=F;}else{if(D.name&&F.name===D.name){G=F;}}}return G;};C.sign=function(F,G){C.md=G||s.md.sha1.create();var H=o[C.md.algorithm+"WithRSAEncryption"];if(!H){var E=new Error("Could not compute certificate digest. "+"Unknown message digest algorithm OID.");E.algorithm=C.md.algorithm;throw E;}C.signatureOid=C.siginfo.algorithmOid=H;C.tbsCertificate=m.getTBSCertificate(C);var D=u.toDer(C.tbsCertificate);C.md.update(D.getBytes());C.signature=F.sign(C.md);};C.verify=function(E){var I=false;if(!C.issued(E)){var J=E.issuer;var K=C.subject;var L=new Error("The parent certificate did not issue the given child "+"certificate; the child certificate's issuer does not match the "+"parent's subject.");L.expectedIssuer=J.attributes;L.actualIssuer=K.attributes;throw L;}var M=E.md;if(M===null){if(E.signatureOid in o){var F=o[E.signatureOid];switch(F){case "sha1WithRSAEncryption":M=s.md.sha1.create();break;case "md5WithRSAEncryption":M=s.md.md5.create();break;case "sha256WithRSAEncryption":M=s.md.sha256.create();break;case "sha512WithRSAEncryption":M=s.md.sha512.create();break;case "RSASSA-PSS":M=s.md.sha256.create();break;default:}}if(M===null){var L=new Error("Could not compute certificate digest. "+"Unknown signature OID.");L.signatureOid=E.signatureOid;throw L;}var N=E.tbsCertificate||m.getTBSCertificate(E);var O=u.toDer(N);M.update(O.getBytes());}if(M!==null){var D;switch(E.signatureOid){case o.sha1WithRSAEncryption:D=undefined;break;case o["RSASSA-PSS"]:var H,G;H=o[E.signatureParameters.mgf.hash.algorithmOid];if(H===undefined||s.md[H]===undefined){var L=new Error("Unsupported MGF hash function.");L.oid=E.signatureParameters.mgf.hash.algorithmOid;L.name=H;throw L;}G=o[E.signatureParameters.mgf.algorithmOid];if(G===undefined||s.mgf[G]===undefined){var L=new Error("Unsupported MGF function.");L.oid=E.signatureParameters.mgf.algorithmOid;L.name=G;throw L;}G=s.mgf[G].create(s.md[H].create());H=o[E.signatureParameters.hash.algorithmOid];if(H===undefined||s.md[H]===undefined){throw{message:"Unsupported RSASSA-PSS hash function.",oid:E.signatureParameters.hash.algorithmOid,name:H};}D=s.pss.create(s.md[H].create(),G,E.signatureParameters.saltLength);break;default:}I=C.publicKey.verify(M.digest().getBytes(),E.signature,D);}return I;};C.isIssuer=function(G){var I=false;var E=C.issuer;var F=G.subject;if(E.hash&&F.hash){I=E.hash===F.hash;}else{if(E.attributes.length===F.attributes.length){I=true;var D,H;for(var J=0;I&&J<E.attributes.length;++J){D=E.attributes[J];H=F.attributes[J];if(D.type!==H.type||D.value!==H.value){I=false;}}}}return I;};C.issued=function(D){return D.isIssuer(C);};C.generateSubjectKeyIdentifier=function(){return m.getPublicKeyFingerprint(C.publicKey,{type:"RSAPublicKey"});};C.verifySubjectKeyIdentifier=function(){var G=o["subjectKeyIdentifier"];for(var E=0;E<C.extensions.length;++E){var F=C.extensions[E];if(F.id===G){var D=C.generateSubjectKeyIdentifier().getBytes();return s.util.hexToBytes(F.subjectKeyIdentifier)===D;}}return false;};return C;};m.certificateFromAsn1=function(I,P){var Q={};var O=[];if(!u.validate(I,y,Q,O)){var M=new Error("Cannot read X.509 certificate. "+"ASN.1 object is not an X509v3 Certificate.");M.errors=O;throw M;}if(typeof Q.certSignature!=="string"){var F="\0";for(var J=0;J<Q.certSignature.length;++J){F+=u.toDer(Q.certSignature[J]).getBytes();}Q.certSignature=F;}var G=u.derToOid(Q.publicKeyOid);if(G!==m.oids["rsaEncryption"]&&G!==m.oids["kcdsa1"]){throw new Error("Cannot read public key. OID is invalid.");}var H=m.createCertificate();H.version=Q.certVersion?Q.certVersion.charCodeAt(0):0;var C=s.util.createBuffer(Q.certSerialNumber);H.serialNumber=C.toHex();H.signatureOid=s.asn1.derToOid(Q.certSignatureOid);H.signatureParameters=h(H.signatureOid,Q.certSignatureParams,true);H.siginfo.algorithmOid=s.asn1.derToOid(Q.certinfoSignatureOid);H.siginfo.parameters=h(H.siginfo.algorithmOid,Q.certinfoSignatureParams,false);var D=s.util.createBuffer(Q.certSignature);++D.read;H.signature=D.getBytes();var L=[];if(Q.certValidity1UTCTime!==undefined){L.push(u.utcTimeToDate(Q.certValidity1UTCTime));}if(Q.certValidity2GeneralizedTime!==undefined){L.push(u.generalizedTimeToDate(Q.certValidity2GeneralizedTime));}if(Q.certValidity3UTCTime!==undefined){L.push(u.utcTimeToDate(Q.certValidity3UTCTime));}if(Q.certValidity4GeneralizedTime!==undefined){L.push(u.generalizedTimeToDate(Q.certValidity4GeneralizedTime));}if(L.length>2){throw new Error("Cannot read notBefore/notAfter validity times; more "+"than two times were provided in the certificate.");}if(L.length<2){throw new Error("Cannot read notBefore/notAfter validity times; they "+"were not provided as either UTCTime or GeneralizedTime.");}H.validity.notBefore=L[0];H.validity.notAfter=L[1];H.tbsCertificate=Q.tbsCertificate;if(P){H.md=null;if(H.signatureOid in o){var E=o[H.signatureOid];switch(E){case "sha1WithRSAEncryption":H.md=s.md.sha1.create();break;case "md5WithRSAEncryption":H.md=s.md.md5.create();break;case "sha256WithRSAEncryption":H.md=s.md.sha256.create();break;case "sha512WithRSAEncryption":H.md=s.md.sha512.create();break;case "RSASSA-PSS":H.md=s.md.sha256.create();break;default:}}if(H.md===null){var M=new Error("Could not compute certificate digest. "+"Unknown signature OID.");M.signatureOid=H.signatureOid;throw M;}var R=u.toDer(H.tbsCertificate);H.md.update(R.getBytes());}var K=s.md.sha1.create();H.issuer.getField=function(S){return l(H.issuer,S);};H.issuer.addField=function(S){p([S]);H.issuer.attributes.push(S);};H.issuer.attributes=m.RDNAttributesAsArray(Q.certIssuer,K);if(Q.certIssuerUniqueId){H.issuer.uniqueId=Q.certIssuerUniqueId;}H.issuer.hash=K.digest().toHex();var N=s.md.sha1.create();H.subject.getField=function(S){return l(H.subject,S);};H.subject.addField=function(S){p([S]);H.subject.attributes.push(S);};H.subject.attributes=m.RDNAttributesAsArray(Q.certSubject,N);if(Q.certSubjectUniqueId){H.subject.uniqueId=Q.certSubjectUniqueId;}H.subject.hash=N.digest().toHex();if(Q.certExtensions){H.extensions=m.certificateExtensionsFromAsn1(Q.certExtensions);}else{H.extensions=[];}H.publicKey=sofo.pki.publicKeyFromAsn1(Q.subjectPublicKeyInfo);H.publicKeyOid=G;return H;};m.certificateExtensionsFromAsn1=function(E){var G=[];for(var D=0;D<E.value.length;++D){var C=E.value[D];for(var F=0;F<C.value.length;++F){G.push(m.certificateExtensionFromAsn1(C.value[F]));}}return G;};m.certificateExtensionFromAsn1=function(D){var I={};I.id=u.derToOid(D.value[0].value);I.critical=false;if(D.value[1].type===u.Type.BOOLEAN){I.critical=D.value[1].value.charCodeAt(0)!==0;I.value=D.value[2].value;}else{I.value=D.value[1].value;}if(I.id in o){I.name=o[I.id];if(I.name==="keyUsage"){var K=u.fromDer(I.value);var L=0;var J=0;if(K.value.length>1){L=K.value.charCodeAt(1);J=K.value.length>2?K.value.charCodeAt(2):0;}I.digitalSignature=(L&128)===128;I.nonRepudiation=(L&64)===64;I.keyEncipherment=(L&32)===32;I.dataEncipherment=(L&16)===16;I.keyAgreement=(L&8)===8;I.keyCertSign=(L&4)===4;I.cRLSign=(L&2)===2;I.encipherOnly=(L&1)===1;I.decipherOnly=(J&128)===128;}else{if(I.name==="basicConstraints"){var K=u.fromDer(I.value);if(K.value.length>0&&K.value[0].type===u.Type.BOOLEAN){I.cA=K.value[0].value.charCodeAt(0)!==0;}else{I.cA=false;}var M=null;if(K.value.length>0&&K.value[0].type===u.Type.INTEGER){M=K.value[0].value;}else{if(K.value.length>1){M=K.value[1].value;}}if(M!==null){I.pathLenConstraint=u.derToInteger(M);}}else{if(I.name==="extKeyUsage"){var K=u.fromDer(I.value);for(var H=0;H<K.value.length;++H){var F=u.derToOid(K.value[H].value);if(F in o){I[o[F]]=true;}else{I[F]=true;}}}else{if(I.name==="nsCertType"){var K=u.fromDer(I.value);var L=0;if(K.value.length>1){L=K.value.charCodeAt(1);}I.client=(L&128)===128;I.server=(L&64)===64;I.email=(L&32)===32;I.objsign=(L&16)===16;I.reserved=(L&8)===8;I.sslCA=(L&4)===4;I.emailCA=(L&2)===2;I.objCA=(L&1)===1;}else{if(I.name==="subjectAltName"||I.name==="issuerAltName"){I.altNames=[];var G;var K=u.fromDer(I.value);for(var E=0;E<K.value.length;++E){G=K.value[E];var C={type:G.type,value:G.value};I.altNames.push(C);switch(G.type){case 1:case 2:case 6:break;case 7:C.ip=s.util.bytesToIP(G.value);break;case 8:C.oid=u.derToOid(G.value);break;default:}}}else{if(I.name==="subjectKeyIdentifier"){var K=u.fromDer(I.value);I.subjectKeyIdentifier=s.util.bytesToHex(K.value);}}}}}}}return I;};m.certificationRequestFromAsn1=function(E,L){var M={};var K=[];if(!u.validate(E,t,M,K)){var I=new Error("Cannot read PKCS#10 certificate request. "+"ASN.1 object is not a PKCS#10 CertificationRequest.");I.errors=K;throw I;}if(typeof M.csrSignature!=="string"){var H="\0";for(var F=0;F<M.csrSignature.length;++F){H+=u.toDer(M.csrSignature[F]).getBytes();}M.csrSignature=H;}var D=u.derToOid(M.publicKeyOid);if(D!==m.oids.rsaEncryption){throw new Error("Cannot read public key. OID is not RSA.");}var G=m.createCertificationRequest();G.version=M.csrVersion?M.csrVersion.charCodeAt(0):0;G.signatureOid=s.asn1.derToOid(M.csrSignatureOid);G.signatureParameters=h(G.signatureOid,M.csrSignatureParams,true);G.siginfo.algorithmOid=s.asn1.derToOid(M.csrSignatureOid);G.siginfo.parameters=h(G.siginfo.algorithmOid,M.csrSignatureParams,false);var C=s.util.createBuffer(M.csrSignature);++C.read;G.signature=C.getBytes();G.certificationRequestInfo=M.certificationRequestInfo;if(L){G.md=null;if(G.signatureOid in o){var D=o[G.signatureOid];switch(D){case "sha1WithRSAEncryption":G.md=s.md.sha1.create();break;case "md5WithRSAEncryption":G.md=s.md.md5.create();break;case "sha256WithRSAEncryption":G.md=s.md.sha256.create();break;case "sha512WithRSAEncryption":G.md=s.md.sha512.create();break;case "RSASSA-PSS":G.md=s.md.sha256.create();break;default:}}if(G.md===null){var I=new Error("Could not compute certification request digest. "+"Unknown signature OID.");I.signatureOid=G.signatureOid;throw I;}var N=u.toDer(G.certificationRequestInfo);G.md.update(N.getBytes());}var J=s.md.sha1.create();G.subject.getField=function(O){return l(G.subject,O);};G.subject.addField=function(O){p([O]);G.subject.attributes.push(O);};G.subject.attributes=m.RDNAttributesAsArray(M.certificationRequestInfoSubject,J);G.subject.hash=J.digest().toHex();G.publicKey=m.publicKeyFromAsn1(M.subjectPublicKeyInfo);G.getAttribute=function(O){return l(G,O);};G.addAttribute=function(O){p([O]);G.attributes.push(O);};G.attributes=m.CRIAttributesAsArray(M.certificationRequestInfoAttributes||[]);return G;};m.createCertificationRequest=function(){var C={};C.version=0;C.signatureOid=null;C.signature=null;C.siginfo={};C.siginfo.algorithmOid=null;C.subject={};C.subject.getField=function(D){return l(C.subject,D);};C.subject.addField=function(D){p([D]);C.subject.attributes.push(D);};C.subject.attributes=[];C.subject.hash=null;C.publicKey=null;C.attributes=[];C.getAttribute=function(D){return l(C,D);};C.addAttribute=function(D){p([D]);C.attributes.push(D);};C.md=null;C.setSubject=function(D){p(D);C.subject.attributes=D;C.subject.hash=null;};C.setAttributes=function(D){p(D);C.attributes=D;};C.sign=function(F,G){C.md=G||s.md.sha1.create();var H=o[C.md.algorithm+"WithRSAEncryption"];if(!H){var E=new Error("Could not compute certification request digest. "+"Unknown message digest algorithm OID.");E.algorithm=C.md.algorithm;throw E;}C.signatureOid=C.siginfo.algorithmOid=H;C.certificationRequestInfo=m.getCertificationRequestInfo(C);var D=u.toDer(C.certificationRequestInfo);C.md.update(D.getBytes());C.signature=F.sign(C.md);};C.verify=function(){var I=false;var K=C.md;if(K===null){if(C.signatureOid in o){var E=o[C.signatureOid];switch(E){case "sha1WithRSAEncryption":K=s.md.sha1.create();break;case "md5WithRSAEncryption":K=s.md.md5.create();break;case "sha256WithRSAEncryption":K=s.md.sha256.create();break;case "sha512WithRSAEncryption":K=s.md.sha512.create();break;case "RSASSA-PSS":K=s.md.sha256.create();break;default:}}if(K===null){var J=new Error("Could not compute certification request digest. "+"Unknown signature OID.");J.signatureOid=C.signatureOid;throw J;}var F=C.certificationRequestInfo||m.getCertificationRequestInfo(C);var L=u.toDer(F);K.update(L.getBytes());}if(K!==null){var D;switch(C.signatureOid){case o.sha1WithRSAEncryption:break;case o["RSASSA-PSS"]:var H,G;H=o[C.signatureParameters.mgf.hash.algorithmOid];if(H===undefined||s.md[H]===undefined){var J=new Error("Unsupported MGF hash function.");J.oid=C.signatureParameters.mgf.hash.algorithmOid;J.name=H;throw J;}G=o[C.signatureParameters.mgf.algorithmOid];if(G===undefined||s.mgf[G]===undefined){var J=new Error("Unsupported MGF function.");J.oid=C.signatureParameters.mgf.algorithmOid;J.name=G;throw J;}G=s.mgf[G].create(s.md[H].create());H=o[C.signatureParameters.hash.algorithmOid];if(H===undefined||s.md[H]===undefined){var J=new Error("Unsupported RSASSA-PSS hash function.");J.oid=C.signatureParameters.hash.algorithmOid;J.name=H;throw J;}D=s.pss.create(s.md[H].create(),G,C.signatureParameters.saltLength);break;default:}I=C.publicKey.verify(K.digest().getBytes(),C.signature,D);}return I;};return C;};function r(I){var H=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[]);var C,J;var D=I.attributes;for(var E=0;E<D.length;++E){C=D[E];var G=C.value;var F=u.Type.PRINTABLESTRING;if("valueTagClass" in C){F=C.valueTagClass;if(F===u.Type.UTF8){G=s.util.encodeUtf8(G);G=s.util.decodeUtf8(G);}}J=u.create(u.Class.UNIVERSAL,u.Type.SET,true,[u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[u.create(u.Class.UNIVERSAL,u.Type.OID,false,u.oidToDer(C.type).getBytes()),u.create(u.Class.UNIVERSAL,F,false,G)])]);H.value.push(J);}return H;}function g(D){var G={};for(var E=0;E<D.length;++E){var C=D[E];if(C.shortName&&(C.valueTagClass===u.Type.UTF8||C.valueTagClass===u.Type.PRINTABLESTRING||C.valueTagClass===u.Type.IA5STRING)){var F=C.value;if(C.valueTagClass===u.Type.UTF8){F=s.util.encodeUtf8(C.value);}if(!(C.shortName in G)){G[C.shortName]=F;}else{if(s.util.isArray(G[C.shortName])){G[C.shortName].push(F);}else{G[C.shortName]=[G[C.shortName],F];}}}}return G;}function p(E){var C;for(var F=0;F<E.length;++F){C=E[F];if(typeof C.name==="undefined"){if(C.type&&C.type in m.oids){C.name=m.oids[C.type];}else{if(C.shortName&&C.shortName in w){C.name=m.oids[w[C.shortName]];}}}if(typeof C.type==="undefined"){if(C.name&&C.name in m.oids){C.type=m.oids[C.name];}else{var D=new Error("Attribute type not specified.");D.attribute=C;throw D;}}if(typeof C.shortName==="undefined"){if(C.name&&C.name in w){C.shortName=w[C.name];}}if(C.type===o.extensionRequest){C.valueConstructed=true;C.valueTagClass=u.Type.SEQUENCE;if(!C.value&&C.extensions){C.value=[];for(var G=0;G<C.extensions.length;++G){C.value.push(m.certificateExtensionToAsn1(q(C.extensions[G])));}}}if(typeof C.value==="undefined"){var D=new Error("Attribute value not specified.");D.attribute=C;throw D;}}}function q(I,Q){Q=Q||{};if(typeof I.name==="undefined"){if(I.id&&I.id in m.oids){I.name=m.oids[I.id];}}if(typeof I.id==="undefined"){if(I.name&&I.name in m.oids){I.id=m.oids[I.name];}else{var J=new Error("Extension ID not specified.");J.extension=I;throw J;}}if(typeof I.value!=="undefined"){return I;}if(I.name==="keyUsage"){var F=0;var L=0;var K=0;if(I.digitalSignature){L|=128;F=7;}if(I.nonRepudiation){L|=64;F=6;}if(I.keyEncipherment){L|=32;F=5;}if(I.dataEncipherment){L|=16;F=4;}if(I.keyAgreement){L|=8;F=3;}if(I.keyCertSign){L|=4;F=2;}if(I.cRLSign){L|=2;F=1;}if(I.encipherOnly){L|=1;F=0;}if(I.decipherOnly){K|=128;F=7;}var M=String.fromCharCode(F);if(K!==0){M+=String.fromCharCode(L)+String.fromCharCode(K);}else{if(L!==0){M+=String.fromCharCode(L);}}I.value=u.create(u.Class.UNIVERSAL,u.Type.BITSTRING,false,M);}else{if(I.name==="basicConstraints"){I.value=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[]);if(I.cA){I.value.value.push(u.create(u.Class.UNIVERSAL,u.Type.BOOLEAN,false,String.fromCharCode(255)));}if("pathLenConstraint" in I){I.value.value.push(u.create(u.Class.UNIVERSAL,u.Type.INTEGER,false,u.integerToDer(I.pathLenConstraint).getBytes()));}}else{if(I.name==="extKeyUsage"){I.value=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[]);var P=I.value.value;for(var N in I){if(I[N]!==true){continue;}if(N in o){P.push(u.create(u.Class.UNIVERSAL,u.Type.OID,false,u.oidToDer(o[N]).getBytes()));}else{if(N.indexOf(".")!==-1){P.push(u.create(u.Class.UNIVERSAL,u.Type.OID,false,u.oidToDer(N).getBytes()));}}}}else{if(I.name==="nsCertType"){var F=0;var L=0;if(I.client){L|=128;F=7;}if(I.server){L|=64;F=6;}if(I.email){L|=32;F=5;}if(I.objsign){L|=16;F=4;}if(I.reserved){L|=8;F=3;}if(I.sslCA){L|=4;F=2;}if(I.emailCA){L|=2;F=1;}if(I.objCA){L|=1;F=0;}var M=String.fromCharCode(F);if(L!==0){M+=String.fromCharCode(L);}I.value=u.create(u.Class.UNIVERSAL,u.Type.BITSTRING,false,M);}else{if(I.name==="subjectAltName"||I.name==="issuerAltName"){I.value=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[]);var C;for(var E=0;E<I.altNames.length;++E){C=I.altNames[E];var M=C.value;if(C.type===7&&C.ip){M=s.util.bytesFromIP(C.ip);if(M===null){var J=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');J.extension=I;throw J;}}else{if(C.type===8){if(C.oid){M=u.oidToDer(u.oidToDer(C.oid));}else{M=u.oidToDer(M);}}}I.value.value.push(u.create(u.Class.CONTEXT_SPECIFIC,C.type,false,M));}}else{if(I.name==="subjectKeyIdentifier"&&Q.cert){var D=Q.cert.generateSubjectKeyIdentifier();I.subjectKeyIdentifier=D.toHex();I.value=u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,false,D.getBytes());}else{if(I.name==="authorityKeyIdentifier"&&Q.cert){I.value=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[]);var P=I.value.value;if(I.keyIdentifier){var H=I.keyIdentifier===true?Q.cert.generateSubjectKeyIdentifier().getBytes():I.keyIdentifier;P.push(u.create(u.Class.CONTEXT_SPECIFIC,0,false,H));}if(I.authorityCertIssuer){var O=[u.create(u.Class.CONTEXT_SPECIFIC,4,true,[r(I.authorityCertIssuer===true?Q.cert.issuer:I.authorityCertIssuer)])];P.push(u.create(u.Class.CONTEXT_SPECIFIC,1,true,O));}if(I.serialNumber){var G=s.util.hexToBytes(I.serialNumber===true?Q.cert.serialNumber:I.serialNumber);P.push(u.create(u.Class.CONTEXT_SPECIFIC,2,false,G));}}}}}}}}if(typeof I.value==="undefined"){var J=new Error("Extension value not specified.");J.extension=I;throw J;}return I;}function A(C,E){switch(C){case o["RSASSA-PSS"]:var D=[];if(E.hash.algorithmOid!==undefined){D.push(u.create(u.Class.CONTEXT_SPECIFIC,0,true,[u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[u.create(u.Class.UNIVERSAL,u.Type.OID,false,u.oidToDer(E.hash.algorithmOid).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.NULL,false,"")])]));}if(E.mgf.algorithmOid!==undefined){D.push(u.create(u.Class.CONTEXT_SPECIFIC,1,true,[u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[u.create(u.Class.UNIVERSAL,u.Type.OID,false,u.oidToDer(E.mgf.algorithmOid).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[u.create(u.Class.UNIVERSAL,u.Type.OID,false,u.oidToDer(E.mgf.hash.algorithmOid).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.NULL,false,"")])])]));}if(E.saltLength!==undefined){D.push(u.create(u.Class.CONTEXT_SPECIFIC,2,true,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,false,u.integerToDer(E.saltLength).getBytes())]));}return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,D);default:return u.create(u.Class.UNIVERSAL,u.Type.NULL,false,"");}}function B(F){var E=u.create(u.Class.CONTEXT_SPECIFIC,0,true,[]);if(F.attributes.length===0){return E;}var J=F.attributes;for(var D=0;D<J.length;++D){var G=J[D];var H=G.value;var I=u.Type.UTF8;if("valueTagClass" in G){I=G.valueTagClass;}if(I===u.Type.UTF8){H=s.util.encodeUtf8(H);}var C=false;if("valueConstructed" in G){C=G.valueConstructed;}var K=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[u.create(u.Class.UNIVERSAL,u.Type.OID,false,u.oidToDer(G.type).getBytes()),u.create(u.Class.UNIVERSAL,u.Type.SET,true,[u.create(u.Class.UNIVERSAL,I,C,H)])]);E.value.push(K);}return E;}m.getTBSCertificate=function(D){var C=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[u.create(u.Class.CONTEXT_SPECIFIC,0,true,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,false,u.integerToDer(D.version).getBytes())]),u.create(u.Class.UNIVERSAL,u.Type.INTEGER,false,s.util.hexToBytes(D.serialNumber)),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[u.create(u.Class.UNIVERSAL,u.Type.OID,false,u.oidToDer(D.siginfo.algorithmOid).getBytes()),A(D.siginfo.algorithmOid,D.siginfo.parameters)]),r(D.issuer),u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[u.create(u.Class.UNIVERSAL,u.Type.UTCTIME,false,u.dateToUtcTime(D.validity.notBefore)),u.create(u.Class.UNIVERSAL,u.Type.UTCTIME,false,u.dateToUtcTime(D.validity.notAfter))]),r(D.subject),sofo.pki.publicKeyToAsn1(D.publicKey)]);if(D.issuer.uniqueId){C.value.push(u.create(u.Class.CONTEXT_SPECIFIC,1,true,[u.create(u.Class.UNIVERSAL,u.Type.BITSTRING,false,String.fromCharCode(0)+D.issuer.uniqueId)]));}if(D.subject.uniqueId){C.value.push(u.create(u.Class.CONTEXT_SPECIFIC,2,true,[u.create(u.Class.UNIVERSAL,u.Type.BITSTRING,false,String.fromCharCode(0)+D.subject.uniqueId)]));}if(D.extensions.length>0){C.value.push(m.certificateExtensionsToAsn1(D.extensions));}return C;};m.getCertificationRequestInfo=function(D){var C=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[u.create(u.Class.UNIVERSAL,u.Type.INTEGER,false,u.integerToDer(D.version).getBytes()),r(D.subject),sofo.pki.publicKeyToAsn1(D.publicKey),B(D)]);return C;};m.distinguishedNameToAsn1=function(C){return r(C);};m.certificateToAsn1=function(D){var C=D.tbsCertificate||m.getTBSCertificate(D);return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[C,u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[u.create(u.Class.UNIVERSAL,u.Type.OID,false,u.oidToDer(D.signatureOid).getBytes()),A(D.signatureOid,D.signatureParameters)]),u.create(u.Class.UNIVERSAL,u.Type.BITSTRING,false,String.fromCharCode(0)+D.signature)]);};m.certificateExtensionsToAsn1=function(E){var F=u.create(u.Class.CONTEXT_SPECIFIC,3,true,[]);var C=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[]);F.value.push(C);for(var D=0;D<E.length;++D){C.value.push(m.certificateExtensionToAsn1(E[D]));}return F;};m.certificateExtensionToAsn1=function(D){var C=u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[]);C.value.push(u.create(u.Class.UNIVERSAL,u.Type.OID,false,u.oidToDer(D.id).getBytes()));if(D.critical){C.value.push(u.create(u.Class.UNIVERSAL,u.Type.BOOLEAN,false,String.fromCharCode(255)));}var E=D.value;if(typeof D.value!=="string"){E=u.toDer(E).getBytes();}C.value.push(u.create(u.Class.UNIVERSAL,u.Type.OCTETSTRING,false,E));return C;};m.certificationRequestToAsn1=function(D){var C=D.certificationRequestInfo||m.getCertificationRequestInfo(D);return u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[C,u.create(u.Class.UNIVERSAL,u.Type.SEQUENCE,true,[u.create(u.Class.UNIVERSAL,u.Type.OID,false,u.oidToDer(D.signatureOid).getBytes()),A(D.signatureOid,D.signatureParameters)]),u.create(u.Class.UNIVERSAL,u.Type.BITSTRING,false,String.fromCharCode(0)+D.signature)]);};m.createCaStore=function(G){var F={certs:{}};F.getIssuer=function(H){var I=E(H.issuer);return I;};F.addCertificate=function(I){if(typeof I==="string"){I=s.pki.certificateFromPem(I);}if(!I.subject.hash){var J=s.md.sha1.create();I.subject.attributes=m.RDNAttributesAsArray(r(I.subject),J);I.subject.hash=J.digest().toHex();}if(I.subject.hash in F.certs){var H=F.certs[I.subject.hash];if(!s.util.isArray(H)){H=[H];}H.push(I);}else{F.certs[I.subject.hash]=I;}};F.hasCertificate=function(L){var J=E(L.subject);if(!J){return false;}if(!s.util.isArray(J)){J=[J];}var I=u.toDer(m.certificateToAsn1(L)).getBytes();for(var K=0;K<J.length;++K){var H=u.toDer(m.certificateToAsn1(J[K])).getBytes();if(I===H){return true;}}return false;};function E(H){if(!H.hash){var I=s.md.sha1.create();H.attributes=m.RDNAttributesAsArray(r(H),I);H.hash=I.digest().toHex();}return F.certs[H.hash]||null;}if(G){for(var D=0;D<G.length;++D){var C=G[D];F.addCertificate(C);}}return F;};m.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};m.verifyCertificateChain=function(I,K,C){K=K.slice(0);var E=K.slice(0);var D=new Date;var G=true;var M=null;var W=0;do{var U=K.shift();var H=null;var P=false;if(D<U.validity.notBefore||D>U.validity.notAfter){M={message:"Certificate is not valid yet or has expired.",error:m.certificateError.certificate_expired,notBefore:U.validity.notBefore,notAfter:U.validity.notAfter,now:D};}if(M===null){H=K[0]||I.getIssuer(U);if(H===null){if(U.isIssuer(U)){P=true;H=U;}}if(H){var T=H;if(!s.util.isArray(T)){T=[T];}var L=false;while(!L&&T.length>0){H=T.shift();try{L=H.verify(U);}catch(R){console.log("Exception : sf_x509 - verifyCertificateChain");}}if(!L){M={message:"Certificate signature is invalid.",error:m.certificateError.bad_certificate};}}if(M===null&&(!H||P)&&!I.hasCertificate(U)){M={message:"Certificate is not trusted.",error:m.certificateError.unknown_ca};}}if(M===null&&H&&!U.isIssuer(H)){M={message:"Certificate issuer is invalid.",error:m.certificateError.bad_certificate};}if(M===null){var X={keyUsage:true,basicConstraints:true};for(var Q=0;M===null&&Q<U.extensions.length;++Q){var F=U.extensions[Q];if(F.critical&&!(F.name in X)){M={message:"Certificate has an unsupported critical extension.",error:m.certificateError.unsupported_certificate};}}}if(M===null&&(!G||K.length===0&&(!H||P))){var O=U.getExtension("basicConstraints");var J=U.getExtension("keyUsage");if(J!==null){if(!J.keyCertSign||O===null){M={message:"Certificate keyUsage or basicConstraints conflict "+"or indicate that the certificate is not a CA. "+"If the certificate is the only one in the chain or "+"isn't the first then the certificate must be a "+"valid CA.",error:m.certificateError.bad_certificate};}}if(M===null&&O!==null&&!O.cA){M={message:"Certificate basicConstraints indicates the certificate "+"is not a CA.",error:m.certificateError.bad_certificate};}if(M===null&&J!==null&&"pathLenConstraint" in O){var N=W-1;if(N>O.pathLenConstraint){M={message:"Certificate basicConstraints pathLenConstraint violated.",error:m.certificateError.bad_certificate};}}}var S=M===null?true:M.error;var V=C?C(S,W,E):S;if(V===true){M=null;}else{if(S===true){M={message:"The application rejected the certificate.",error:m.certificateError.bad_certificate};}if(V||V===0){if(typeof V==="object"&&!s.util.isArray(V)){if(V.message){M.message=V.message;}if(V.error){M.error=V.error;}}else{if(typeof V==="string"){M.error=V;}}}throw M;}G=false;++W;}while(K.length>0);return true;};}var b="x509";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m.pki;};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./aes","./asn1","./des","./md","./mgf","./oids","./pem","./pss","./rsa","./kcdsa","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(r){var o=r.asn1;var q=r.pkcs7=r.pkcs7||{};q.messageFromPem=function(A){var C=r.pem.decode(A)[0];if(C.type!=="PKCS7"){var z=new Error("Could not convert PKCS#7 message from PEM; PEM "+'header type is not "PKCS#7".');z.headerType=C.type;throw z;}if(C.procType&&C.procType.type==="ENCRYPTED"){throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");}var B=o.fromDer(C.body);return q.messageFromAsn1(B);};q.messageToPem=function(A,B){var z={type:"PKCS7",body:o.toDer(A.toAsn1()).getBytes()};return r.pem.encode(z,{maxline:B});};q.messageFromAsn1=function(B){var z={};var E=[];if(!o.validate(B,q.asn1.contentInfoValidator,z,E)){var A=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not an PKCS#7 ContentInfo.");A.errors=E;throw A;}var D=o.derToOid(z.contentType);var C;switch(D){case r.pki.oids.envelopedData:C=q.createEnvelopedData();break;case r.pki.oids.encryptedData:C=q.createEncryptedData();break;case r.pki.oids.signedData:C=q.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+D+" is not (yet) supported.");}C.fromAsn1(z.content.value[0]);return C;};q.createSignedData=function(){var B=null;B={type:r.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(E){u(B,E,q.asn1.signedDataValidator);B.certificates=[];B.crls=[];B.digestAlgorithmIdentifiers=[];B.contentInfo=null;B.signerInfos=[];var D=B.rawCapture.certificates.value;for(var C=0;C<D.length;++C){B.certificates.push(r.pki.certificateFromAsn1(D[C]));}},toAsn1:function(){if(!B.contentInfo){B.sign();}var D=[];for(var C=0;C<B.certificates.length;++C){D.push(r.pki.certificateToAsn1(B.certificates[C]));}var F=[];var E=o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,o.integerToDer(B.version).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,true,B.digestAlgorithmIdentifiers),B.contentInfo])]);if(D.length>0){E.value[0].value.push(o.create(o.Class.CONTEXT_SPECIFIC,0,true,D));}if(F.length>0){E.value[0].value.push(o.create(o.Class.CONTEXT_SPECIFIC,1,true,F));}E.value[0].value.push(o.create(o.Class.UNIVERSAL,o.Type.SET,true,B.signerInfos));return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(B.type).getBytes()),E]);},addSigner:function(C){var G=C.issuer;var E=C.serialNumber;if(C.certificate){var F=C.certificate;if(typeof F==="string"){F=r.pki.certificateFromPem(F);}G=F.issuer.attributes;E=F.serialNumber;}var L=C.key;if(!L){throw new Error("Could not add PKCS#7 signer; no private key specified.");}if(typeof L==="string"){L=r.pki.privateKeyFromPem(L);}var I=C.digestAlgorithm||r.pki.oids.sha1;switch(I){case r.pki.oids.sha1:case r.pki.oids.sha256:case r.pki.oids.sha384:case r.pki.oids.sha512:case r.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+I);}var J=C.authenticatedAttributes||[];if(J.length>0){var K=false;var M=false;for(var D=0;D<J.length;++D){var H=J[D];if(!K&&H.type===r.pki.oids.contentType){K=true;if(M){break;}continue;}if(!M&&H.type===r.pki.oids.messageDigest){M=true;if(K){break;}continue;}}if(!K||!M){throw new Error("Invalid signer.authenticatedAttributes. If "+"signer.authenticatedAttributes is specified, then it must "+"contain at least two attributes, PKCS #9 content-type and "+"PKCS #9 message-digest.");}}B.signers.push({key:L,version:1,issuer:G,serialNumber:E,digestAlgorithm:I,signatureAlgorithm:r.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:J,unauthenticatedAttributes:[]});},sign:function(){if(typeof B.content!=="object"||B.contentInfo===null){B.contentInfo=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(r.pki.oids.data).getBytes())]);if("content" in B){var D;if(B.content instanceof r.util.ByteBuffer){D=B.content.bytes();}else{if(typeof B.content==="string"){D=r.util.encodeUtf8(B.content);}}B.contentInfo.value.push(o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,D)]));}}if(B.signers.length===0){return;}var C=A();z(C);},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.");},addCertificate:function(C){if(typeof C==="string"){C=r.pki.certificateFromPem(C);}B.certificates.push(C);},addCertificateRevokationList:function(C){throw new Error("PKCS#7 CRL support not yet implemented.");}};return B;function A(){var C={};for(var D=0;D<B.signers.length;++D){var F=B.signers[D];var E=F.digestAlgorithm;if(!(E in C)){C[E]=r.md[r.pki.oids[E]].create();}if(F.authenticatedAttributes.length===0){F.md=C[E];}else{F.md=r.md[r.pki.oids[E]].create();}}B.digestAlgorithmIdentifiers=[];for(var E in C){B.digestAlgorithmIdentifiers.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(E).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,false,"")]));}return C;}function z(L){if(B.contentInfo.value.length<2){throw new Error("Could not sign PKCS#7 message; there is no content to sign.");}var K=o.derToOid(B.contentInfo.value[0].value);var H=B.contentInfo.value[1];H=H.value[0];var M=o.toDer(H);M.getByte();o.getBerValueLength(M);M=M.getBytes();for(var E in L){L[E].start().update(M);}var D=new Date;for(var F=0;F<B.signers.length;++F){var C=B.signers[F];if(C.authenticatedAttributes.length===0){if(K!==r.pki.oids.data){throw new Error("Invalid signer; authenticatedAttributes must be present "+"when the ContentInfo content type is not PKCS#7 Data.");}}else{C.authenticatedAttributesAsn1=o.create(o.Class.CONTEXT_SPECIFIC,0,true,[]);var J=o.create(o.Class.UNIVERSAL,o.Type.SET,true,[]);for(var I=0;I<C.authenticatedAttributes.length;++I){var G=C.authenticatedAttributes[I];if(G.type===r.pki.oids.messageDigest){G.value=L[C.digestAlgorithm].digest();}else{if(G.type===r.pki.oids.signingTime){if(!G.value){G.value=D;}}}J.value.push(g(G));C.authenticatedAttributesAsn1.value.push(g(G));}M=o.toDer(J).getBytes();C.md.start().update(M);}C.signature=C.key.sign(C.md,"RSASSA-PKCS1-V1_5");}B.signerInfos=h(B.signers);}};q.createEncryptedData=function(){var z=null;z={type:r.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:r.pki.oids["aes256-CBC"]},fromAsn1:function(A){u(z,A,q.asn1.encryptedDataValidator);},decrypt:function(A){if(A!==undefined){z.encryptedContent.key=A;}w(z);}};return z;};q.createEnvelopedData=function(){var z=null;z={type:r.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:r.pki.oids["aes256-CBC"]},fromAsn1:function(B){var A=u(z,B,q.asn1.envelopedDataValidator);z.recipients=p(A.recipientInfos.value);},toAsn1:function(){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(z.type).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,o.integerToDer(z.version).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,true,m(z.recipients)),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,l(z.encryptedContent))])])]);},findRecipient:function(D){var E=D.issuer.attributes;for(var C=0;C<z.recipients.length;++C){var F=z.recipients[C];var G=F.issuer;if(F.serialNumber!==D.serialNumber){continue;}if(G.length!==E.length){continue;}var B=true;for(var A=0;A<E.length;++A){if(G[A].type!==E[A].type||G[A].value!==E[A].value){B=false;break;}}if(B){return F;}}return null;},decrypt:function(C,B){if(z.encryptedContent.key===undefined&&C!==undefined&&B!==undefined){switch(C.encryptedContent.algorithm){case r.pki.oids.rsaEncryption:case r.pki.oids.desCBC:var A=B.decrypt(C.encryptedContent.content);z.encryptedContent.key=r.util.createBuffer(A);break;default:throw new Error("Unsupported asymmetric cipher, "+"OID "+C.encryptedContent.algorithm);}}w(z);},addRecipient:function(A){z.recipients.push({version:0,issuer:A.issuer.attributes,serialNumber:A.serialNumber,encryptedContent:{algorithm:r.pki.oids.rsaEncryption,key:A.publicKey}});},encrypt:function(D,A){if(z.encryptedContent.content===undefined){A=A||z.encryptedContent.algorithm;D=D||z.encryptedContent.key;var B,H,G;switch(A){case r.pki.oids["aes128-CBC"]:B=16;H=16;G=r.aes.createEncryptionCipher;break;case r.pki.oids["aes192-CBC"]:B=24;H=16;G=r.aes.createEncryptionCipher;break;case r.pki.oids["aes256-CBC"]:B=32;H=16;G=r.aes.createEncryptionCipher;break;case r.pki.oids["des-EDE3-CBC"]:B=24;H=8;G=r.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+A);}if(D===undefined){D=r.util.createBuffer(r.random.getBytes(B));}else{if(D.length()!=B){throw new Error("Symmetric key has wrong length; "+"got "+D.length()+" bytes, expected "+B+".");}}z.encryptedContent.algorithm=A;z.encryptedContent.key=D;z.encryptedContent.parameter=r.util.createBuffer(r.random.getBytes(H));var F=G(D);F.start(z.encryptedContent.parameter.copy());F.update(z.content);if(!F.finish()){throw new Error("Symmetric encryption failed.");}z.encryptedContent.content=F.output;}for(var C=0;C<z.recipients.length;++C){var E=z.recipients[C];if(E.encryptedContent.content!==undefined){continue;}switch(E.encryptedContent.algorithm){case r.pki.oids.rsaEncryption:E.encryptedContent.content=E.encryptedContent.key.encrypt(z.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+E.encryptedContent.algorithm);}}}};return z;};function t(B){var z={};var C=[];if(!o.validate(B,q.asn1.recipientInfoValidator,z,C)){var A=new Error("Cannot read PKCS#7 RecipientInfo. "+"ASN.1 object is not an PKCS#7 RecipientInfo.");A.errors=C;throw A;}return{version:z.version.charCodeAt(0),issuer:r.pki.RDNAttributesAsArray(z.issuer),serialNumber:r.util.createBuffer(z.serial).toHex(),encryptedContent:{algorithm:o.derToOid(z.encAlgorithm),parameter:z.encParameter.value,content:z.encKey}};}function n(z){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,o.integerToDer(z.version).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[r.pki.distinguishedNameToAsn1({attributes:z.issuer}),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,r.util.hexToBytes(z.serialNumber))]),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(z.encryptedContent.algorithm).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,false,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,z.encryptedContent.content)]);}function p(B){var z=[];for(var A=0;A<B.length;++A){z.push(t(B[A]));}return z;}function m(z){var A=[];for(var B=0;B<z.length;++B){A.push(n(z[B]));}return A;}function y(D){var z={};var F=[];if(!o.validate(D,q.asn1.signerInfoValidator,z,F)){var A=new Error("Cannot read PKCS#7 SignerInfo. "+"ASN.1 object is not an PKCS#7 SignerInfo.");A.errors=F;throw A;}var C={version:z.version.charCodeAt(0),issuer:r.pki.RDNAttributesAsArray(z.issuer),serialNumber:r.util.createBuffer(z.serial).toHex(),digestAlgorithm:o.derToOid(z.digestAlgorithm),signatureAlgorithm:o.derToOid(z.signatureAlgorithm),signature:z.signature,authenticatedAttributes:[],unauthenticatedAttributes:[]};var E=z.authenticatedAttributes||[];var B=z.unauthenticatedAttributes||[];return C;}function s(D){var C=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,o.integerToDer(D.version).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[r.pki.distinguishedNameToAsn1({attributes:D.issuer}),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,r.util.hexToBytes(D.serialNumber))]),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(D.digestAlgorithm).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,false,"")])]);if(D.authenticatedAttributesAsn1){C.value.push(D.authenticatedAttributesAsn1);}C.value.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(D.signatureAlgorithm).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,false,"")]));C.value.push(o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,D.signature));if(D.unauthenticatedAttributes.length>0){var B=o.create(o.Class.CONTEXT_SPECIFIC,1,true,[]);for(var A=0;A<D.unauthenticatedAttributes.length;++A){var z=D.unauthenticatedAttributes[A];B.values.push(g(z));}C.value.push(B);}return C;}function v(B){var z=[];for(var A=0;A<B.length;++A){z.push(y(B[A]));}return z;}function h(B){var z=[];for(var A=0;A<B.length;++A){z.push(s(B[A]));}return z;}function g(z){var C;if(z.type===r.pki.oids.contentType){C=o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(z.value).getBytes());}else{if(z.type===r.pki.oids.messageDigest){C=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,z.value.bytes());}else{if(z.type===r.pki.oids.signingTime){var E=new Date("Jan 1, 1950 00:00:00Z");var D=new Date("Jan 1, 2050 00:00:00Z");var A=z.value;if(typeof A==="string"){var B=Date.parse(A);if(!isNaN(B)){A=new Date(B);}else{if(A.length===13){A=o.utcTimeToDate(A);}else{A=o.generalizedTimeToDate(A);}}}if(A>=E&&A<D){C=o.create(o.Class.UNIVERSAL,o.Type.UTCTIME,false,o.dateToUtcTime(A));}else{C=o.create(o.Class.UNIVERSAL,o.Type.GENERALIZEDTIME,false,o.dateToGeneralizedTime(A));}}}}return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(z.type).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,true,[C])]);}function l(z){return[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(r.pki.oids.data).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(z.algorithm).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,z.parameter.getBytes())]),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,z.content.getBytes())])];}function u(A,C,z){var H={};var F=[];if(!o.validate(C,z,H,F)){var E=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not a supported PKCS#7 message.");E.errors=E;throw E;}var G=o.derToOid(H.contentType);if(G!==r.pki.oids.data){throw new Error("Unsupported PKCS#7 message. "+"Only wrapped ContentType Data supported.");}if(H.encryptedContent){var D="";if(r.util.isArray(H.encryptedContent)){for(var B=0;B<H.encryptedContent.length;++B){if(H.encryptedContent[B].type!==o.Type.OCTETSTRING){throw new Error("Malformed PKCS#7 message, expecting encrypted "+"content constructed of only OCTET STRING objects.");}D+=H.encryptedContent[B].value;}}else{D=H.encryptedContent;}A.encryptedContent={algorithm:o.derToOid(H.encAlgorithm),parameter:r.util.createBuffer(H.encParameter.value),content:r.util.createBuffer(D)};}if(H.content){var D="";if(r.util.isArray(H.content)){for(var B=0;B<H.content.length;++B){if(H.content[B].type!==o.Type.OCTETSTRING){throw new Error("Malformed PKCS#7 message, expecting "+"content constructed of only OCTET STRING objects.");}D+=H.content[B].value;}}else{D=H.content;}A.content=r.util.createBuffer(D);}A.version=H.version.charCodeAt(0);A.rawCapture=H;return H;}function w(A){if(A.encryptedContent.key===undefined){throw new Error("Symmetric key not available.");}if(A.content===undefined){var z;switch(A.encryptedContent.algorithm){case r.pki.oids["aes128-CBC"]:case r.pki.oids["aes192-CBC"]:case r.pki.oids["aes256-CBC"]:z=r.aes.createDecryptionCipher(A.encryptedContent.key);break;case r.pki.oids["desCBC"]:case r.pki.oids["des-EDE3-CBC"]:z=r.des.createDecryptionCipher(A.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+A.encryptedContent.algorithm);}z.start(A.encryptedContent.parameter);z.update(A.encryptedContent.content);if(!z.finish()){throw new Error("Symmetric decryption failed.");}A.content=z.output;}}}var b="pkcs7";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./aes","./asn1","./des","./oids","./pem","./pkcs7asn1","./random","./util","./x509"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(h){var g=h.asn1;var m=h.pkcs7asn1=h.pkcs7asn1||{};h.pkcs7=h.pkcs7||{};h.pkcs7.asn1=m;var o={name:"ContentInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"ContentInfo.ContentType",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"contentType"},{name:"ContentInfo.content",tagClass:g.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,captureAsn1:"content"}]};m.contentInfoValidator=o;var p={name:"ucpidRequestInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"ucpidRequestInfo.ContentType",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"contentType"},{name:"ucpidRequestInfo.content",tagClass:g.Class.CONTEXT_SPECIFIC,type:0,constructed:true,capture:"content",value:[{name:"ucpidRequestInfo.rootOctetString",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:true,capture:"rootOctetString",value:[{name:"ucpidRequestInfo.rootSequence",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"ucpidRequestInfo.version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"version"},{name:"ucpidRequestInfo.ucpidNonce",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:false,capture:"ucpidNonce"},{name:"ucpidRequestInfo.firstSequence",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"ucpidRequestInfo.firstSequence.userAgreement",tagClass:g.Class.UNIVERSAL,type:g.Type.UTF8,constructed:false,capture:"userAgreement"},{name:"ucpidRequestInfo.firstSequence.userAgreeInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.BITSTRING,constructed:false,capture:"userAgreeInfo"}]},{name:"ucpidRequestInfo.secondSequence",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"ucpidRequestInfo.secondSequence.moduleName",tagClass:g.Class.UNIVERSAL,type:g.Type.UTF8,constructed:false,capture:"moduleName"},{name:"ucpidRequestInfo.secondSequence.moduleVendorName",tagClass:g.Class.UNIVERSAL,type:g.Type.UTF8,constructed:false,capture:"moduleVendorName"},{name:"ucpidRequestInfo.secondSequence.moduleVersion",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,capture:"moduleVersion",value:[{name:"ucpidRequestInfo.secondSequence.moduleVersion.major",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"major"},{name:"ucpidRequestInfo.secondSequence.moduleVersion.minor",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"minor"},{name:"ucpidRequestInfo.secondSequence.moduleVersion.context0",tagClass:g.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,capture:"context0",value:[{name:"ucpidRequestInfo.secondSequence.moduleVersion.build",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"build"}]},{name:"ucpidRequestInfo.secondSequence.moduleVersion.context1",tagClass:g.Class.CONTEXT_SPECIFIC,type:1,constructed:true,optional:true,capture:"context1",value:[{name:"ucpidRequestInfo.secondSequence.moduleVersion.revision",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"revision"}]}]}]},{name:"ucpidRequestInfo.ispUrlInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.UTF8,constructed:false,capture:"ispUrlInfo"}]}]}]}]};m.ucpidRequestInfoValidator=p;var l={name:"EncryptedContentInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedContentInfo.contentType",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:g.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:g.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};m.envelopedDataValidator={name:"EnvelopedData",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"EnvelopedData.Version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:g.Class.UNIVERSAL,type:g.Type.SET,constructed:true,captureAsn1:"recipientInfos"}].concat(l)};m.encryptedDataValidator={name:"EncryptedData",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"EncryptedData.Version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"version"}].concat(l)};var n={name:"SignerInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false},{name:"SignerInfo.issuerAndSerialNumber",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:g.Class.UNIVERSAL,constructed:false,captureAsn1:"digestParameter",optional:true}]},{name:"SignerInfo.authenticatedAttributes",tagClass:g.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:false,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:g.Class.CONTEXT_SPECIFIC,type:1,constructed:true,optional:true,capture:"unauthenticatedAttributes"}]};m.signedDataValidator={name:"SignedData",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"SignedData.Version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:g.Class.UNIVERSAL,type:g.Type.SET,constructed:true,captureAsn1:"digestAlgorithms"},o,{name:"SignedData.Certificates",tagClass:g.Class.CONTEXT_SPECIFIC,type:0,optional:true,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:g.Class.CONTEXT_SPECIFIC,type:1,optional:true,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:g.Class.UNIVERSAL,type:g.Type.SET,capture:"signerInfos",optional:true,value:[n]}]};m.signedUcpidValidator={name:"SignedData",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"SignedData.Version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:g.Class.UNIVERSAL,type:g.Type.SET,constructed:true,captureAsn1:"digestAlgorithms"},p,{name:"SignedData.Certificates",tagClass:g.Class.CONTEXT_SPECIFIC,type:0,optional:true,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:g.Class.CONTEXT_SPECIFIC,type:1,optional:true,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:g.Class.UNIVERSAL,type:g.Type.SET,capture:"signerInfos",optional:true,value:[n]}]};m.recipientInfoValidator={name:"RecipientInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:g.Class.UNIVERSAL,constructed:false,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:false,capture:"encKey"}]};}var b="pkcs7asn1";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./asn1","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(s){var o=s.asn1;var q=s.pki;var g=s.pkcs12=s.pkcs12||{};var p={name:"ContentInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:true,value:[{name:"ContentInfo.contentType",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:false,capture:"contentType"},{name:"ContentInfo.content",tagClass:o.Class.CONTEXT_SPECIFIC,constructed:true,captureAsn1:"content"}]};var v={name:"PFX",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:true,value:[{name:"PFX.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:false,capture:"version"},p,{name:"PFX.macData",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:true,optional:true,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:true,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:true,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:false,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:o.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:false,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:false,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:false,optional:true,capture:"macIterations"}]}]};var n={name:"SafeBag",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:true,value:[{name:"SafeBag.bagId",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:false,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:o.Class.CONTEXT_SPECIFIC,constructed:true,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:o.Class.UNIVERSAL,type:o.Type.SET,constructed:true,optional:true,capture:"bagAttributes"}]};var m={name:"Attribute",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:true,value:[{name:"Attribute.attrId",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:false,capture:"oid"},{name:"Attribute.attrValues",tagClass:o.Class.UNIVERSAL,type:o.Type.SET,constructed:true,capture:"values"}]};var z={name:"CertBag",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:true,value:[{name:"CertBag.certId",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:false,capture:"certId"},{name:"CertBag.certValue",tagClass:o.Class.CONTEXT_SPECIFIC,constructed:true,value:[{name:"CertBag.certValue[0]",tagClass:o.Class.UNIVERSAL,type:o.Class.OCTETSTRING,constructed:false,capture:"cert"}]}]};function u(E,D,G,H){var A=[];for(var C=0;C<E.length;C++){for(var B=0;B<E[C].safeBags.length;B++){var F=E[C].safeBags[B];if(H!==undefined&&F.type!==H){continue;}if(D===null){A.push(F);continue;}if(F.attributes[D]!==undefined&&F.attributes[D].indexOf(G)>=0){A.push(F);}}}return A;}g.pkcs12FromAsn1=function(F,M,O){var H=false;if(M==="CertRelay"){M=true;H=true;}else{if(typeof M==="string"){O=M;M=true;}else{if(M===undefined){M=true;}}}var Q={};var N=[];if(!o.validate(F,v,Q,N)){var K=new Error("Cannot read PKCS#12 PFX. "+"ASN.1 object is not an PKCS#12 PFX.");K.errors=K;throw K;}var J={version:Q.version.charCodeAt(0),safeContents:[],getBags:function(S){var T={};var R;if("localKeyId" in S){R=S.localKeyId;}else{if("localKeyIdHex" in S){R=s.util.hexToBytes(S.localKeyIdHex);}}if(R===undefined&&!("friendlyName" in S)&&"bagType" in S){T[S.bagType]=u(J.safeContents,null,null,S.bagType);}if(R!==undefined){T.localKeyId=u(J.safeContents,"localKeyId",R,S.bagType);}if("friendlyName" in S){T.friendlyName=u(J.safeContents,"friendlyName",S.friendlyName,S.bagType);}return T;},getBagsByFriendlyName:function(R,S){return u(J.safeContents,"friendlyName",R,S);},getBagsByLocalKeyId:function(R,S){return u(J.safeContents,"localKeyId",R,S);}};if(Q.version.charCodeAt(0)!==3){var K=new Error("PKCS#12 PFX of version other than 3 not supported.");K.version=Q.version.charCodeAt(0);throw K;}if(o.derToOid(Q.contentType)!==q.oids.data){var K=new Error("Only PKCS#12 PFX in password integrity mode supported.");K.oid=o.derToOid(Q.contentType);throw K;}var E=Q.content.value[0];if(E.tagClass!==o.Class.UNIVERSAL||E.type!==o.Type.OCTETSTRING){throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");}E=w(E);if(Q.mac){var L=null;var D=0;var G=o.derToOid(Q.macAlgorithm);switch(G){case q.oids.sha1:L=s.md.sha1.create();D=20;break;case q.oids.sha256:L=s.md.sha256.create();D=32;break;case q.oids.sha384:L=s.md.sha384.create();D=48;break;case q.oids.sha512:L=s.md.sha512.create();D=64;break;case q.oids.md5:L=s.md.md5.create();D=16;break;default:}if(L===null){throw new Error("PKCS#12 uses unsupported MAC algorithm: "+G);}var B=new s.util.ByteBuffer(Q.macSalt);var C="macIterations" in Q?parseInt(s.util.bytesToHex(Q.macIterations),16):1;var A=g.generateKey(O,B,3,C,D,L);var I=s.hmac.create();I.start(L,A);I.update(E.value);var P=I.getMac();if(P.getBytes()!==Q.macDigest){throw new Error("PKCS#12 MAC could not be verified. Invalid password?");}}if(H){y(J,E.value,M,O,H);}else{y(J,E.value,M,O);}return J;};function w(C){if(C.composed||C.constructed){var B=s.util.createBuffer();for(var A=0;A<C.value.length;++A){B.putBytes(C.value[A].value);}C.composed=C.constructed=false;C.value=B.getBytes();}return C;}function y(H,A,J,L,G){A=o.fromDer(A,J);if(A.tagClass!==o.Class.UNIVERSAL||A.type!==o.Type.SEQUENCE||A.constructed!==true){throw new Error("PKCS#12 AuthenticatedSafe expected to be a "+"SEQUENCE OF ContentInfo");}for(var F=0;F<A.value.length;F++){var C=A.value[F];var M={};var K=[];if(!o.validate(C,p,M,K)){var I=new Error("Cannot read ContentInfo.");I.errors=K;throw I;}var E={encrypted:false};var B=null;var D=M.content.value[0];switch(o.derToOid(M.contentType)){case q.oids.data:if(D.tagClass!==o.Class.UNIVERSAL||D.type!==o.Type.OCTETSTRING){throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");}B=w(D).value;break;case q.oids.encryptedData:B=r(D,L);E.encrypted=true;break;default:var I=new Error("Unsupported PKCS#12 contentType.");I.contentType=o.derToOid(M.contentType);throw I;}if(G){E.safeBags=l(B,J,null);}else{E.safeBags=l(B,J,L);}H.safeContents.push(E);}}function t(M,B,D){D=D||{};D.saltSize=D.saltSize||8;D.count=D.count||2048;D.algorithm=D.algorithm||"aes128";var C=s.random.getBytesSync(D.saltSize);var J=D.count;var I=o.integerToDer(J);var O;var G;var R;if(D.algorithm.indexOf("aes")===0||D.algorithm==="des"){var L,H,N;switch(D.algorithm){case "aes128":O=16;L=16;H=q.oids["aes128-CBC"];N=s.aes.createEncryptionCipher;break;case "aes192":O=24;L=16;H=q.oids["aes192-CBC"];N=s.aes.createEncryptionCipher;break;case "aes256":O=32;L=16;H=q.oids["aes256-CBC"];N=s.aes.createEncryptionCipher;break;case "des":O=8;L=8;H=q.oids["desCBC"];N=s.des.createEncryptionCipher;break;default:var P=new Error("Cannot encrypt private key. Unknown encryption algorithm.");P.algorithm=D.algorithm;throw P;}var Q=s.pkcs5.pbkdf2(B,C,J,O);var E=s.random.getBytesSync(L);var A=N(Q);A.start(E);A.update(o.toDer(M));A.finish();R=A.output.getBytes();G=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids["pkcs5PBES2"]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids["pkcs5PBKDF2"]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,C),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,I.getBytes())])]),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(H).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,E)])])]);}else{if(D.algorithm==="3des"){O=24;var K=new s.util.ByteBuffer(C);var Q=q.pbe.generatePkcs12Key(B,K,1,J,O);var E=q.pbe.generatePkcs12Key(B,K,2,J,O);var A=s.des.createEncryptionCipher(Q);A.start(E);A.update(o.toDer(M));A.finish();R=A.output.getBytes();G=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,C),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,I.getBytes())])]);}else{var P=new Error("Cannot encrypt private key. Unknown encryption algorithm.");P.algorithm=D.algorithm;throw P;}}var F=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.data).getBytes()),G,o.create(o.Class.CONTEXT_SPECIFIC,0,false,R)])]);var S=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids["encryptedData"]).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[F])])]);return S;}function r(B,H){var I={};var F=[];if(!o.validate(B,s.pkcs7.asn1.encryptedDataValidator,I,F)){var E=new Error("Cannot read EncryptedContentInfo.");E.errors=F;throw E;}var A=o.derToOid(I.contentType);if(A!==q.oids.data){var E=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");E.oid=A;throw E;}A=o.derToOid(I.encAlgorithm);var D=q.pbe.getCipher(A,I.encParameter,H);var G=w(I.encryptedContentAsn1);var C=s.util.createBuffer(G.value);D.update(C);if(!D.finish()){throw new Error("Failed to decrypt PKCS#12 SafeContents.");}return D.output.getBytes();}function l(C,K,N){if(!K&&C.length===0){return[];}C=o.fromDer(C,K);if(C.tagClass!==o.Class.UNIVERSAL||C.type!==o.Type.SEQUENCE||C.constructed!==true){throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");}var I=[];for(var E=0;E<C.value.length;E++){var P=C.value[E];var O={};var L=[];if(!o.validate(P,n,O,L)){var J=new Error("Cannot read SafeBag.");J.errors=L;throw J;}var B={type:o.derToOid(O.bagId),attributes:h(O.bagAttributes)};I.push(B);var A,D;var G=O.bagValue.value[0];switch(B.type){case q.oids.pkcs8ShroudedKeyBag:try{var F=q.decryptPrivateKeyInfo(G,N);if(F===null){throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");}else{G=F;}}catch(H){B.key=G;B.asn1=G;}case q.oids.keyBag:try{var M=sofo.pki.privateKeyFromAsn1(G);B.key=M.key;B.randomNum=M.randomNum;}catch(H){B.randomNum=null;B.key=G;B.asn1=G;}continue;case q.oids.certBag:A=z;D=function(){if(o.derToOid(O.certId)!==q.oids.x509Certificate){var Q=new Error("Unsupported certificate type, only X.509 supported.");Q.oid=o.derToOid(O.certId);throw Q;}var R=o.fromDer(O.cert,K);try{B.cert=q.certificateFromAsn1(R,true);}catch(S){B.cert=null;B.asn1=R;}};break;default:var J=new Error("Unsupported PKCS#12 SafeBag type.");J.oid=B.type;throw J;}if(A!==undefined&&!o.validate(G,A,O,L)){var J=new Error("Cannot read PKCS#12 "+A.name);J.errors=L;throw J;}D();}return I;}function h(B){var H={};if(B!==undefined){for(var E=0;E<B.length;++E){var A={};var G=[];if(!o.validate(B[E],m,A,G)){var D=new Error("Cannot read PKCS#12 BagAttribute.");D.errors=G;throw D;}var F=o.derToOid(A.oid);if(q.oids[F]===undefined){continue;}H[q.oids[F]]=[];for(var C=0;C<A.values.length;++C){H[q.oids[F]].push(A.values[C].value);}}}return H;}g.toPkcs12Asn1=function(H,E,O,N,A,D){var af=E;var ae=H;var X=0;D=D||{};D.saltSize=D.saltSize||8;D.count=D.count||2048;D.algorithm=D.algorithm||D.encAlgorithm||"aes128";D.format=D.format||"default";if(!("useMac" in D)){D.useMac=true;}if(!("localKeyId" in D)){D.localKeyId=null;}if(!("generateLocalKeyId" in D)){D.generateLocalKeyId=true;}var ab=[];while(true){if(X>1){break;}if(X>0){if(O&&N){af=N;ae=O;}else{break;}}var L=D.localKeyId;var C;if(L!==null){L=s.util.hexToBytes(L);}else{if(D.generateLocalKeyId){if(ae){var ad=s.util.isArray(ae)?ae[0]:ae;if(typeof ad==="string"){ad=q.certificateFromPem(ad);}var R=s.md.sha1.create();R.update(o.toDer(q.certificateToAsn1(ad)).getBytes());L=R.digest().getBytes();}else{L=s.random.getBytes(20);}}}var U=[];if(L!==null){U.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.localKeyId).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,L)])]));}if("friendlyName" in D){U.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.friendlyName).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,true,[o.create(o.Class.UNIVERSAL,o.Type.BMPSTRING,false,D.friendlyName)])]));}if(U.length>0){C=o.create(o.Class.UNIVERSAL,o.Type.SET,true,U);}var S=[];if(ae!==null){if(s.util.isArray(ae)){S=ae;}else{S=[ae];}}var ag=[];for(var Z=0;Z<S.length;++Z){ae=S[Z];if(typeof ae==="string"){ae=q.certificateFromPem(ae);}var Q=Z===0?C:undefined;var W=q.certificateToAsn1(ae);var M=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.certBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.x509Certificate).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,o.toDer(W).getBytes())])])]),Q]);ag.push(M);}if(ag.length>0){if(D.format=="encryptedData"){ab=ab.concat(ag);}else{var T=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,ag);var ac=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,o.toDer(T).getBytes())])]);ab.push(ac);}}var aa=null;if(af!==null){var K=sofo.pki.wrapPrivateKey(af.key,af.randomNum);if(A===null||D.format=="encryptedData"){aa=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.keyBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[K]),C]);}else{aa=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.pkcs8ShroudedKeyBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[q.encryptPrivateKeyInfo(K,A,D)]),C]);}if(D.format=="encryptedData"){ab.push(aa);}else{var B=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[aa]);var G=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,o.toDer(B).getBytes())])]);ab.push(G);}}X++;}var J=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,ab);if(D.format=="encryptedData"){J=t(J,A,D);}var P;if(D.useMac){var R=s.md.sha1.create();var V=new s.util.ByteBuffer(s.random.getBytes(D.saltSize));var I=D.count;var af=g.generateKey(A,V,3,I,20);var F=s.hmac.create();F.start(R,af);F.update(o.toDer(J).getBytes());var Y=F.getMac();P=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.sha1).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,false,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,Y.getBytes())]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,V.getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,o.integerToDer(I).getBytes())]);}return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,o.integerToDer(3).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,o.toDer(J).getBytes())])]),P]);};g.toPkcs12Asn1ForCertRelay=function(H,E,O,N,A,D){var af=E;var ae=H;var X=0;D=D||{};D.saltSize=D.saltSize||8;D.count=D.count||2048;D.algorithm=D.algorithm||D.encAlgorithm||"aes128";D.format=D.format||"default";if(!("useMac" in D)){D.useMac=true;}if(!("localKeyId" in D)){D.localKeyId=null;}if(!("generateLocalKeyId" in D)){D.generateLocalKeyId=true;}var ab=[];while(true){if(X>1){break;}if(X>0){if(O&&N){af=N;ae=O;}else{break;}}var L=D.localKeyId;var C;if(L!==null){L=s.util.hexToBytes(L);}else{if(D.generateLocalKeyId){if(ae){var ad=s.util.isArray(ae)?ae[0]:ae;if(typeof ad==="string"){ad=q.certificateFromPem(ad);}var R=s.md.sha1.create();R.update(o.toDer(q.certificateToAsn1(ad)).getBytes());L=R.digest().getBytes();}else{L=s.random.getBytes(20);}}}var U=[];if(L!==null){U.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.localKeyId).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,L)])]));}if("friendlyName" in D){U.push(o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.friendlyName).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SET,true,[o.create(o.Class.UNIVERSAL,o.Type.BMPSTRING,false,D.friendlyName)])]));}if(U.length>0){C=o.create(o.Class.UNIVERSAL,o.Type.SET,true,U);}var S=[];if(ae!==null){if(s.util.isArray(ae)){S=ae;}else{S=[ae];}}var ag=[];for(var Z=0;Z<S.length;++Z){ae=S[Z];if(typeof ae==="string"){ae=q.certificateFromPem(ae);}var Q=Z===0?C:undefined;var W=q.certificateToAsn1(ae);var M=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.certBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.x509Certificate).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,o.toDer(W).getBytes())])])]),Q]);ag.push(M);}if(ag.length>0){if(D.format=="encryptedData"){ab=ab.concat(ag);}else{var T=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,ag);var ac=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,o.toDer(T).getBytes())])]);ab.push(ac);}}var aa=null;if(af!==null){var K;K=af;aa=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.pkcs8ShroudedKeyBag).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[K]),C]);if(D.format=="encryptedData"){ab.push(aa);}else{var B=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[aa]);var G=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,o.toDer(B).getBytes())])]);ab.push(G);}}X++;}var J=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,ab);if(D.format=="encryptedData"){J=t(J,A,D);}var P;if(D.useMac){var R=s.md.sha1.create();var V=new s.util.ByteBuffer(s.random.getBytes(D.saltSize));var I=D.count;var af=g.generateKey(A,V,3,I,20);var F=s.hmac.create();F.start(R,af);F.update(o.toDer(J).getBytes());var Y=F.getMac();P=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.sha1).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,false,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,Y.getBytes())]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,V.getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,o.integerToDer(I).getBytes())]);}return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,false,o.integerToDer(3).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,true,[o.create(o.Class.UNIVERSAL,o.Type.OID,false,o.oidToDer(q.oids.data).getBytes()),o.create(o.Class.CONTEXT_SPECIFIC,0,true,[o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,false,o.toDer(J).getBytes())])]),P]);};g.generateKey=s.pbe.generatePkcs12Key;}var b="pkcs12";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./asn1","./hmac","./oids","./pkcs7asn1","./pbe","./random","./rsa","./sha1","./util","./x509"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(g){var m=g.pkcs5=g.pkcs5||{};var l=typeof process!=="undefined"&&process.versions&&process.versions.node;var h;if(l&&!g.disableNativeCode){h=require("crypto");}g.pbkdf2=m.pbkdf2=function(y,t,G,A,J,o){if(typeof J==="function"){o=J;J=null;}if(l&&!g.disableNativeCode&&h.pbkdf2&&(J===null||typeof J!=="object")&&(h.pbkdf2Sync.length>4||(!J||J==="sha1"))){if(typeof J!=="string"){J="sha1";}t=new Buffer(t,"binary");if(!o){if(h.pbkdf2Sync.length===4){return h.pbkdf2Sync(y,t,G,A).toString("binary");}return h.pbkdf2Sync(y,t,G,A,J).toString("binary");}if(h.pbkdf2Sync.length===4){return h.pbkdf2(y,t,G,A,function(r,p){if(r){return o(r);}o(null,p.toString("binary"));});}return h.pbkdf2(y,t,G,A,J,function(r,p){if(r){return o(r);}o(null,p.toString("binary"));});}if(typeof J==="undefined"||J===null){J=g.md.sha1.create();}if(typeof J==="string"){if(!(J in g.md.algorithms)){throw new Error("Unknown hash algorithm: "+J);}J=g.md[J].create();}var u=J.digestLength;if(A>4294967295*u){var q=new Error("Derived key is too long.");if(o){return o(q);}throw q;}var F=Math.ceil(A/u);var v=A-(F-1)*u;var w=g.hmac.create();w.start(J,y);var D="";var B,H,z;if(!o){for(var E=1;E<=F;++E){w.start(null,null);w.update(t);w.update(g.util.int32ToBytes(E));B=z=w.digest().getBytes();for(var C=2;C<=G;++C){w.start(null,null);w.update(z);H=w.digest().getBytes();B=g.util.xorBytes(B,H,u);z=H;}D+=E<F?B:B.substr(0,v);}return D;}var E=1,C;function n(){if(E>F){return o(null,D);}w.start(null,null);w.update(t);w.update(g.util.int32ToBytes(E));B=z=w.digest().getBytes();C=2;I();}function I(){if(C<=G){w.start(null,null);w.update(z);H=w.digest().getBytes();B=g.util.xorBytes(B,H,u);z=H;++C;return g.util.setImmediate(I);}D+=E<F?B:B.substr(0,v);++E;n();}n();};}var b="pbkdf2";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./hmac","./md","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(g){g.cipher=g.cipher||{};g.cipher.algorithms=g.cipher.algorithms||{};g.cipher.createCipher=function(l,m){var n=l;if(typeof n==="string"){n=g.cipher.getAlgorithm(n);if(n){n=n();}}if(!n){throw new Error("Unsupported algorithm: "+l);}return new g.cipher.BlockCipher({algorithm:n,key:m,decrypt:false});};g.cipher.createDecipher=function(l,m){var n=l;if(typeof n==="string"){n=g.cipher.getAlgorithm(n);if(n){n=n();}}if(!n){throw new Error("Unsupported algorithm: "+l);}return new g.cipher.BlockCipher({algorithm:n,key:m,decrypt:true});};g.cipher.registerAlgorithm=function(m,l){m=m.toUpperCase();g.cipher.algorithms[m]=l;};g.cipher.getAlgorithm=function(l){l=l.toUpperCase();if(l in g.cipher.algorithms){return g.cipher.algorithms[l];}return null;};var h=g.cipher.BlockCipher=function(l){this.algorithm=l.algorithm;this.mode=this.algorithm.mode;this.blockSize=this.mode.blockSize;this._finish=false;this._input=null;this.output=null;this._op=l.decrypt?this.mode.decrypt:this.mode.encrypt;this._decrypt=l.decrypt;this.algorithm.initialize(l);};h.prototype.start=function(l){l=l||{};var n={};for(var m in l){n[m]=l[m];}n.decrypt=this._decrypt;this._finish=false;this._input=g.util.createBuffer();this.output=l.output||g.util.createBuffer();this.mode.start(n);};h.prototype.update=function(l){if(l){this._input.putBuffer(l);}while(!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish){}this._input.compact();};h.prototype.finish=function(m){if(m&&(this.mode.name==="ECB"||this.mode.name==="CBC")){this.mode.pad=function(n){return m(this.blockSize,n,false);};this.mode.unpad=function(n){return m(this.blockSize,n,true);};}var l={};l.decrypt=this._decrypt;l.overflow=this._input.length()%this.blockSize;if(!this._decrypt&&this.mode.pad){if(!this.mode.pad(this._input,l)){return false;}}this._finish=true;this.update();if(this._decrypt&&this.mode.unpad){if(!this.mode.unpad(this.output,l)){return false;}}if(this.mode.afterFinish){if(!this.mode.afterFinish(this.output,l)){return false;}}return true;};}var b="cipher";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(g){g.cipher=g.cipher||{};var m=g.cipher.modes=g.cipher.modes||{};m.ecb=function(o){o=o||{};this.name="ECB";this.cipher=o.cipher;this.blockSize=o.blockSize||16;this._ints=this.blockSize/4;this._inBlock=new Array(this._ints);this._outBlock=new Array(this._ints);};m.ecb.prototype.start=function(o){};m.ecb.prototype.encrypt=function(p,o,r){if(p.length()<this.blockSize&&!(r&&p.length()>0)){return true;}for(var q=0;q<this._ints;++q){this._inBlock[q]=p.getInt32();}this.cipher.encrypt(this._inBlock,this._outBlock);for(var q=0;q<this._ints;++q){o.putInt32(this._outBlock[q]);}};m.ecb.prototype.decrypt=function(p,o,r){if(p.length()<this.blockSize&&!(r&&p.length()>0)){return true;}for(var q=0;q<this._ints;++q){this._inBlock[q]=p.getInt32();}this.cipher.decrypt(this._inBlock,this._outBlock);for(var q=0;q<this._ints;++q){o.putInt32(this._outBlock[q]);}};m.ecb.prototype.pad=function(o,p){var q=o.length()===this.blockSize?this.blockSize:this.blockSize-o.length();o.fillWithByte(q,q);return true;};m.ecb.prototype.unpad=function(p,q){if(q.overflow>0){return false;}var o=p.length();var r=p.at(o-1);if(r>this.blockSize<<2){return false;}p.truncate(r);return true;};m.cbc=function(o){o=o||{};this.name="CBC";this.cipher=o.cipher;this.blockSize=o.blockSize||16;this._ints=this.blockSize/4;this._inBlock=new Array(this._ints);this._outBlock=new Array(this._ints);};m.cbc.prototype.start=function(o){if(o.iv===null){if(!this._prev){throw new Error("Invalid IV parameter.");}this._iv=this._prev.slice(0);}else{if(!("iv" in o)){throw new Error("Invalid IV parameter.");}else{this._iv=h(o.iv);this._prev=this._iv.slice(0);}}};m.cbc.prototype.encrypt=function(p,o,r){if(p.length()<this.blockSize&&!(r&&p.length()>0)){return true;}for(var q=0;q<this._ints;++q){this._inBlock[q]=this._prev[q]^p.getInt32();}this.cipher.encrypt(this._inBlock,this._outBlock);for(var q=0;q<this._ints;++q){o.putInt32(this._outBlock[q]);}this._prev=this._outBlock;};m.cbc.prototype.decrypt=function(p,o,r){if(p.length()<this.blockSize&&!(r&&p.length()>0)){return true;}for(var q=0;q<this._ints;++q){this._inBlock[q]=p.getInt32();}this.cipher.decrypt(this._inBlock,this._outBlock);for(var q=0;q<this._ints;++q){o.putInt32(this._prev[q]^this._outBlock[q]);}this._prev=this._inBlock.slice(0);};m.cbc.prototype.pad=function(o,p){var q=o.length()===this.blockSize?this.blockSize:this.blockSize-o.length();o.fillWithByte(q,q);return true;};m.cbc.prototype.unpad=function(p,q){if(q.overflow>0){return false;}var o=p.length();var r=p.at(o-1);if(r>this.blockSize<<2){return false;}p.truncate(r);return true;};m.cfb=function(o){o=o||{};this.name="CFB";this.cipher=o.cipher;this.blockSize=o.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._ints);this._partialBlock=new Array(this._ints);this._partialOutput=g.util.createBuffer();this._partialBytes=0;};m.cfb.prototype.start=function(o){if(!("iv" in o)){throw new Error("Invalid IV parameter.");}this._iv=h(o.iv);this._inBlock=this._iv.slice(0);this._partialBytes=0;};m.cfb.prototype.encrypt=function(q,p,s){var o=q.length();if(o===0){return true;}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&o>=this.blockSize){for(var r=0;r<this._ints;++r){this._inBlock[r]=q.getInt32()^this._outBlock[r];p.putInt32(this._inBlock[r]);}return;}var t=(this.blockSize-o)%this.blockSize;if(t>0){t=this.blockSize-t;}this._partialOutput.clear();for(var r=0;r<this._ints;++r){this._partialBlock[r]=q.getInt32()^this._outBlock[r];this._partialOutput.putInt32(this._partialBlock[r]);}if(t>0){q.read-=this.blockSize;}else{for(var r=0;r<this._ints;++r){this._inBlock[r]=this._partialBlock[r];}}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes);}if(t>0&&!s){p.putBytes(this._partialOutput.getBytes(t-this._partialBytes));this._partialBytes=t;return true;}p.putBytes(this._partialOutput.getBytes(o-this._partialBytes));this._partialBytes=0;};m.cfb.prototype.decrypt=function(q,p,s){var o=q.length();if(o===0){return true;}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&o>=this.blockSize){for(var r=0;r<this._ints;++r){this._inBlock[r]=q.getInt32();p.putInt32(this._inBlock[r]^this._outBlock[r]);}return;}var t=(this.blockSize-o)%this.blockSize;if(t>0){t=this.blockSize-t;}this._partialOutput.clear();for(var r=0;r<this._ints;++r){this._partialBlock[r]=q.getInt32();this._partialOutput.putInt32(this._partialBlock[r]^this._outBlock[r]);}if(t>0){q.read-=this.blockSize;}else{for(var r=0;r<this._ints;++r){this._inBlock[r]=this._partialBlock[r];}}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes);}if(t>0&&!s){p.putBytes(this._partialOutput.getBytes(t-this._partialBytes));this._partialBytes=t;return true;}p.putBytes(this._partialOutput.getBytes(o-this._partialBytes));this._partialBytes=0;};m.ofb=function(o){o=o||{};this.name="OFB";this.cipher=o.cipher;this.blockSize=o.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._ints);this._partialOutput=g.util.createBuffer();this._partialBytes=0;};m.ofb.prototype.start=function(o){if(!("iv" in o)){throw new Error("Invalid IV parameter.");}this._iv=h(o.iv);this._inBlock=this._iv.slice(0);this._partialBytes=0;};m.ofb.prototype.encrypt=function(q,p,s){var o=q.length();if(q.length()===0){return true;}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&o>=this.blockSize){for(var r=0;r<this._ints;++r){p.putInt32(q.getInt32()^this._outBlock[r]);this._inBlock[r]=this._outBlock[r];}return;}var t=(this.blockSize-o)%this.blockSize;if(t>0){t=this.blockSize-t;}this._partialOutput.clear();for(var r=0;r<this._ints;++r){this._partialOutput.putInt32(q.getInt32()^this._outBlock[r]);}if(t>0){q.read-=this.blockSize;}else{for(var r=0;r<this._ints;++r){this._inBlock[r]=this._outBlock[r];}}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes);}if(t>0&&!s){p.putBytes(this._partialOutput.getBytes(t-this._partialBytes));this._partialBytes=t;return true;}p.putBytes(this._partialOutput.getBytes(o-this._partialBytes));this._partialBytes=0;};m.ofb.prototype.decrypt=m.ofb.prototype.encrypt;m.ctr=function(o){o=o||{};this.name="CTR";this.cipher=o.cipher;this.blockSize=o.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=new Array(this._ints);this._partialOutput=g.util.createBuffer();this._partialBytes=0;};m.ctr.prototype.start=function(o){if(!("iv" in o)){throw new Error("Invalid IV parameter.");}this._iv=h(o.iv);this._inBlock=this._iv.slice(0);this._partialBytes=0;};m.ctr.prototype.encrypt=function(q,p,s){var o=q.length();if(o===0){return true;}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&o>=this.blockSize){for(var r=0;r<this._ints;++r){p.putInt32(q.getInt32()^this._outBlock[r]);}}else{var t=(this.blockSize-o)%this.blockSize;if(t>0){t=this.blockSize-t;}this._partialOutput.clear();for(var r=0;r<this._ints;++r){this._partialOutput.putInt32(q.getInt32()^this._outBlock[r]);}if(t>0){q.read-=this.blockSize;}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes);}if(t>0&&!s){p.putBytes(this._partialOutput.getBytes(t-this._partialBytes));this._partialBytes=t;return true;}p.putBytes(this._partialOutput.getBytes(o-this._partialBytes));this._partialBytes=0;}n(this._inBlock);};m.ctr.prototype.decrypt=m.ctr.prototype.encrypt;m.gcm=function(o){o=o||{};this.name="GCM";this.cipher=o.cipher;this.blockSize=o.blockSize||16;this._ints=this.blockSize/4;this._inBlock=new Array(this._ints);this._outBlock=new Array(this._ints);this._partialOutput=g.util.createBuffer();this._partialBytes=0;this._R=3774873600;};m.gcm.prototype.start=function(q){if(!("iv" in q)){throw new Error("Invalid IV parameter.");}var p=g.util.createBuffer(q.iv);this._cipherLength=0;var r;if("additionalData" in q){r=g.util.createBuffer(q.additionalData);}else{r=g.util.createBuffer();}if("tagLength" in q){this._tagLength=q.tagLength;}else{this._tagLength=128;}this._tag=null;if(q.decrypt){this._tag=g.util.createBuffer(q.tag).getBytes();if(this._tag.length!==this._tagLength/8){throw new Error("Authentication tag does not match tag length.");}}this._hashBlock=new Array(this._ints);this.tag=null;this._hashSubkey=new Array(this._ints);this.cipher.encrypt([0,0,0,0],this._hashSubkey);this.componentBits=4;this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var o=p.length();if(o===12){this._j0=[p.getInt32(),p.getInt32(),p.getInt32(),1];}else{this._j0=[0,0,0,0];while(p.length()>0){this._j0=this.ghash(this._hashSubkey,this._j0,[p.getInt32(),p.getInt32(),p.getInt32(),p.getInt32()]);}this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(l(o*8)));}this._inBlock=this._j0.slice(0);n(this._inBlock);this._partialBytes=0;r=g.util.createBuffer(r);this._aDataLength=l(r.length()*8);var s=r.length()%this.blockSize;if(s){r.fillWithByte(0,this.blockSize-s);}this._s=[0,0,0,0];while(r.length()>0){this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);}};m.gcm.prototype.encrypt=function(q,p,s){var o=q.length();if(o===0){return true;}this.cipher.encrypt(this._inBlock,this._outBlock);if(this._partialBytes===0&&o>=this.blockSize){for(var r=0;r<this._ints;++r){p.putInt32(this._outBlock[r]^=q.getInt32());}this._cipherLength+=this.blockSize;}else{var u=(this.blockSize-o)%this.blockSize;if(u>0){u=this.blockSize-u;}this._partialOutput.clear();for(var r=0;r<this._ints;++r){this._partialOutput.putInt32(q.getInt32()^this._outBlock[r]);}if(u===0||s){if(s){var t=o%this.blockSize;this._cipherLength+=t;this._partialOutput.truncate(this.blockSize-t);}else{this._cipherLength+=this.blockSize;}for(var r=0;r<this._ints;++r){this._outBlock[r]=this._partialOutput.getInt32();}this._partialOutput.read-=this.blockSize;}if(this._partialBytes>0){this._partialOutput.getBytes(this._partialBytes);}if(u>0&&!s){q.read-=this.blockSize;p.putBytes(this._partialOutput.getBytes(u-this._partialBytes));this._partialBytes=u;return true;}p.putBytes(this._partialOutput.getBytes(o-this._partialBytes));this._partialBytes=0;}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock);n(this._inBlock);};m.gcm.prototype.decrypt=function(q,p,s){var o=q.length();if(o<this.blockSize&&!(s&&o>0)){return true;}this.cipher.encrypt(this._inBlock,this._outBlock);n(this._inBlock);this._hashBlock[0]=q.getInt32();this._hashBlock[1]=q.getInt32();this._hashBlock[2]=q.getInt32();this._hashBlock[3]=q.getInt32();this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var r=0;r<this._ints;++r){p.putInt32(this._outBlock[r]^this._hashBlock[r]);}if(o<this.blockSize){this._cipherLength+=o%this.blockSize;}else{this._cipherLength+=this.blockSize;}};m.gcm.prototype.afterFinish=function(p,q){var s=true;if(q.decrypt&&q.overflow){p.truncate(this.blockSize-q.overflow);}this.tag=g.util.createBuffer();var t=this._aDataLength.concat(l(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,t);var o=[];this.cipher.encrypt(this._j0,o);for(var r=0;r<this._ints;++r){this.tag.putInt32(this._s[r]^o[r]);}this.tag.truncate(this.tag.length()%(this._tagLength/8));if(q.decrypt&&this.tag.bytes()!==this._tag){s=false;}return s;};m.gcm.prototype.multiply=function(p,t){var q=[0,0,0,0];var s=t.slice(0);for(var r=0;r<128;++r){var o=p[r/32|0]&1<<31-r%32;if(o){q[0]^=s[0];q[1]^=s[1];q[2]^=s[2];q[3]^=s[3];}this.pow(s,s);}return q;};m.gcm.prototype.pow=function(o,p){var r=o[3]&1;for(var q=3;q>0;--q){p[q]=o[q]>>>1|(o[q-1]&1)<<31;}p[0]=o[0]>>>1;if(r){p[0]^=this._R;}};m.gcm.prototype.tableMultiply=function(q){var t=[0,0,0,0];for(var s=0;s<32;++s){var p=s/8|0;var o=q[p]>>>(7-s%8)*4&15;var r=this._m[s][o];t[0]^=r[0];t[1]^=r[1];t[2]^=r[2];t[3]^=r[3];}return t;};m.gcm.prototype.ghash=function(p,q,o){q[0]^=o[0];q[1]^=o[1];q[2]^=o[2];q[3]^=o[3];return this.tableMultiply(q);};m.gcm.prototype.generateHashTable=function(t,v){var w=8/v;var q=4*w;var y=16*w;var p=new Array(y);for(var r=0;r<y;++r){var s=[0,0,0,0];var u=r/q|0;var o=(q-1-r%q)*v;s[u]=1<<v-1<<o;p[r]=this.generateSubHashTable(this.multiply(s,t),v);}return p;};m.gcm.prototype.generateSubHashTable=function(u,v){var y=1<<v;var w=y>>>1;var q=new Array(y);q[w]=u.slice(0);var s=w>>>1;while(s>0){this.pow(q[2*s],q[s]=[]);s>>=1;}s=2;while(s<w){for(var r=1;r<s;++r){var p=q[s];var o=q[r];q[s+r]=[p[0]^o[0],p[1]^o[1],p[2]^o[2],p[3]^o[3]];}s*=2;}q[0]=[0,0,0,0];for(s=w+1;s<y;++s){var t=q[s^w];q[s]=[u[0]^t[0],u[1]^t[1],u[2]^t[2],u[3]^t[3]];}return q;};function h(o){if(typeof o==="string"){o=g.util.createBuffer(o);}if(g.util.isArray(o)&&o.length>4){var q=o;o=g.util.createBuffer();for(var p=0;p<q.length;++p){o.putByte(q[p]);}}if(!g.util.isArray(o)){o=[o.getInt32(),o.getInt32(),o.getInt32(),o.getInt32()];}return o;}function n(o){o[o.length-1]=o[o.length-1]+1&4294967295;}function l(o){return[o/4294967296|0,o&4294967295];}}var b="cipherModes";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(q){q.aes=q.aes||{};q.aes.startEncrypting=function(A,z,y,B){var w=s({key:A,output:y,decrypt:false,mode:B});w.start(z);return w;};q.aes.createEncryptionCipher=function(w,y){return s({key:w,output:null,decrypt:false,mode:y});};q.aes.startDecrypting=function(A,z,y,B){var w=s({key:A,output:y,decrypt:true,mode:B});w.start(z);return w;};q.aes.createDecryptionCipher=function(w,y){return s({key:w,output:null,decrypt:true,mode:y});};q.aes.Algorithm=function(y,z){if(!t){m();}var w=this;w.name=y;w.mode=new z({blockSize:16,cipher:{encrypt:function(B,A){return h(w._w,B,A,false);},decrypt:function(B,A){return h(w._w,B,A,true);}}});w._init=false;};q.aes.Algorithm.prototype.initialize=function(y){if(this._init){return;}var B=y.key;var A;if(typeof B==="string"&&(B.length===16||B.length===24||B.length===32)){B=q.util.createBuffer(B);}else{if(q.util.isArray(B)&&(B.length===16||B.length===24||B.length===32)){A=B;B=q.util.createBuffer();for(var z=0;z<A.length;++z){B.putByte(A[z]);}}}if(!q.util.isArray(B)){A=B;B=[];var w=A.length();if(w===16||w===24||w===32){w=w>>>2;for(var z=0;z<w;++z){B.push(A.getInt32());}}}if(!q.util.isArray(B)||!(B.length===4||B.length===6||B.length===8)){throw new Error("Invalid key parameter.");}var D=this.mode.name;var C=["CFB","OFB","CTR","GCM"].indexOf(D)!==-1;this._w=v(B,y.decrypt&&!C);this._init=true;};q.aes._expandKey=function(y,w){if(!t){m();}return v(y,w);};q.aes._updateBlock=h;r("AES-ECB",q.cipher.modes.ecb);r("AES-CBC",q.cipher.modes.cbc);r("AES-CFB",q.cipher.modes.cfb);r("AES-OFB",q.cipher.modes.ofb);r("AES-CTR",q.cipher.modes.ctr);r("AES-GCM",q.cipher.modes.gcm);function r(y,z){var w=function(){return new q.aes.Algorithm(y,z);};q.cipher.registerAlgorithm(y,w);}var t=false;var p=4;var n;var g;var l;var u;var o;function m(){t=true;l=[0,1,2,4,8,16,32,64,128,27,54];var I=new Array(256);for(var A=0;A<128;++A){I[A]=A<<1;I[A+128]=A+128<<1^283;}n=new Array(256);g=new Array(256);u=new Array(4);o=new Array(4);for(var A=0;A<4;++A){u[A]=new Array(256);o[A]=new Array(256);}var D=0,z=0,G,E,B,H,w,F,C;for(var A=0;A<256;++A){H=z^z<<1^z<<2^z<<3^z<<4;H=H>>8^H&255^99;n[D]=H;g[H]=D;w=I[H];G=I[D];E=I[G];B=I[E];F=w<<24^H<<16^H<<8^(H^w);C=(G^E^B)<<24^(D^B)<<16^(D^E^B)<<8^(D^G^B);for(var y=0;y<4;++y){u[y][D]=F;o[y][H]=C;F=F<<24|F>>>8;C=C<<24|C>>>8;}if(D===0){D=z=1;}else{D=G^I[I[I[G^B]]];z^=I[I[z]];}}}function v(K,A){var I=K.slice(0);var M,z=1;var D=I.length;var B=D+6+1;var E=p*B;for(var G=D;G<E;++G){M=I[G-1];if(G%D===0){M=n[M>>>16&255]<<24^n[M>>>8&255]<<16^n[M&255]<<8^n[M>>>24]^l[z]<<24;z++;}else{if(D>6&&G%D===4){M=n[M>>>24]<<24^n[M>>>16&255]<<16^n[M>>>8&255]<<8^n[M&255];}}I[G]=I[G-D]^M;}if(A){var F;var O=o[0];var N=o[1];var L=o[2];var J=o[3];var H=I.slice(0);E=I.length;for(var G=0,y=E-p;G<E;G+=p,y-=p){if(G===0||G===E-p){H[G]=I[y];H[G+1]=I[y+3];H[G+2]=I[y+2];H[G+3]=I[y+1];}else{for(var C=0;C<p;++C){F=I[y+C];H[G+(3&-C)]=O[n[F>>>24]]^N[n[F>>>16&255]]^L[n[F>>>8&255]]^J[n[F&255]];}}}I=H;}return I;}function h(H,I,G,B){var D=H.length/4-1;var C,A,z,y,F;if(B){C=o[0];A=o[1];z=o[2];y=o[3];F=g;}else{C=u[0];A=u[1];z=u[2];y=u[3];F=n;}var P,O,M,L,Q,E,J;P=I[0]^H[0];O=I[B?3:1]^H[1];M=I[2]^H[2];L=I[B?1:3]^H[3];var K=3;for(var N=1;N<D;++N){Q=C[P>>>24]^A[O>>>16&255]^z[M>>>8&255]^y[L&255]^H[++K];E=C[O>>>24]^A[M>>>16&255]^z[L>>>8&255]^y[P&255]^H[++K];J=C[M>>>24]^A[L>>>16&255]^z[P>>>8&255]^y[O&255]^H[++K];L=C[L>>>24]^A[P>>>16&255]^z[O>>>8&255]^y[M&255]^H[++K];P=Q;O=E;M=J;}G[0]=F[P>>>24]<<24^F[O>>>16&255]<<16^F[M>>>8&255]<<8^F[L&255]^H[++K];G[B?3:1]=F[O>>>24]<<24^F[M>>>16&255]<<16^F[L>>>8&255]<<8^F[P&255]^H[++K];G[2]=F[M>>>24]<<24^F[L>>>16&255]<<16^F[P>>>8&255]<<8^F[O&255]^H[++K];G[B?1:3]=F[L>>>24]<<24^F[P>>>16&255]<<16^F[O>>>8&255]<<8^F[M&255]^H[++K];}function s(z){z=z||{};var A=(z.mode||"CBC").toUpperCase();var y="AES-"+A;var w;if(z.decrypt){w=q.cipher.createDecipher(y,z.key);}else{w=q.cipher.createCipher(y,z.key);}var B=w.start;w.start=function(E,D){var C=null;if(D instanceof q.util.ByteBuffer){C=D;D={};}D=D||{};D.output=C;D.iv=E;B.call(w,D);};return w;}}var b="aes";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./cipher","./cipherModes","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(t){t.aria=t.aria||{};t.pki.oids["1.2.410.100001.1.20"]="aria-CBC";t.pki.oids["aria-CBC"]="1.2.410.100001.1.20";t.aria.startEncrypting=function(Q,P,O,R){var N=m({key:Q,output:O,decrypt:false,mode:R});N.start(P);return N;};t.aria.createEncryptionCipher=function(N,O){return m({key:N,output:null,decrypt:false,mode:O});};t.aria.startDecrypting=function(Q,P,O,R){var N=m({key:Q,output:O,decrypt:true,mode:R});N.start(P);return N;};t.aria.createDecryptionCipher=function(N,O){return m({key:N,output:null,decrypt:true,mode:O});};t.aria.Algorithm=function(O,P){if(!D){h();}var N=this;N.name=O;N.mode=new P({blockSize:16,cipher:{encrypt:function(R,Q){return n(N._w,R,Q,false);},decrypt:function(R,Q){return n(N._w,R,Q,true);}}});N._init=false;};t.aria.Algorithm.prototype.initialize=function(O){if(this._init){return;}var R=O.key;var Q;if(typeof R==="string"&&(R.length===16||R.length===24||R.length===32)){R=t.util.createBuffer(R);}else{if(t.util.isArray(R)&&(R.length===16||R.length===24||R.length===32)){Q=R;R=t.util.createBuffer();for(var P=0;P<Q.length;++P){R.putByte(Q[P]);}}}if(!t.util.isArray(R)){Q=R;R=[];var N=Q.length();if(N===16||N===24||N===32){N=N>>>2;for(var P=0;P<N;++P){R.push(Q.getInt32());}}}if(!t.util.isArray(R)||!(R.length===4||R.length===6||R.length===8)){throw new Error("Invalid key parameter.");}var T=this.mode.name;var S=["CFB","OFB","CTR","GCM"].indexOf(T)!==-1;this._w=w(R,O.decrypt&&!S);this._init=true;};t.aria._expandKey=function(O,N){if(!D){h();}return w(O,N);};t.aria._updateBlock=n;B("ARIA-ECB",t.cipher.modes.ecb);B("ARIA-CBC",t.cipher.modes.cbc);B("ARIA-CFB",t.cipher.modes.cfb);B("ARIA-OFB",t.cipher.modes.ofb);B("ARIA-CTR",t.cipher.modes.ctr);B("ARIA-GCM",t.cipher.modes.gcm);function B(O,P){var N=function(){return new t.aria.Algorithm(O,P);};t.cipher.registerAlgorithm(O,N);}var D=false;var z,o,l,G,F;var r=[];var q=[];var L=[];var K=[];function h(){D=true;z=[[1367130551,656542356,4262702056,4204424928],[1840335564,2653014048,4280857045,4015907504],[3683792669,556198256,52729717,82364686]];o=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];l=[226,78,84,252,148,194,74,204,98,13,106,70,60,77,139,209,94,250,100,203,180,151,190,43,188,119,46,3,211,25,89,193,29,6,65,107,85,240,153,105,234,156,24,174,99,223,231,187,0,115,102,251,150,76,133,228,58,9,69,170,15,238,16,235,45,127,244,41,172,207,173,145,141,120,200,149,249,47,206,205,8,122,136,56,92,131,42,40,71,219,184,199,147,164,18,83,255,135,14,49,54,33,88,72,1,142,55,116,50,202,233,177,183,171,12,215,196,86,66,38,7,152,96,217,182,185,17,64,236,32,140,189,160,201,132,4,73,35,241,79,80,31,19,220,216,192,158,87,227,195,123,101,59,2,143,62,232,37,146,229,21,221,253,23,169,191,212,154,126,197,57,103,254,118,157,67,167,225,208,245,104,242,27,52,112,5,163,138,213,121,134,168,48,198,81,75,30,166,39,246,53,210,110,36,22,130,95,218,230,117,162,239,44,178,28,159,93,111,128,10,114,68,155,108,144,11,91,51,125,90,82,243,97,161,247,176,214,63,124,109,237,20,224,165,61,34,179,248,137,222,113,26,175,186,181,129];G=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125];F=[48,104,153,27,135,185,33,120,80,57,219,225,114,9,98,60,62,126,94,142,241,160,204,163,42,29,251,182,214,32,196,141,129,101,245,137,203,157,119,198,87,67,86,23,212,64,26,77,192,99,108,227,183,200,100,106,83,170,56,152,12,244,155,237,127,34,118,175,221,58,11,88,103,136,6,195,53,13,1,139,140,194,230,95,2,36,117,147,102,30,229,226,84,216,16,206,122,232,8,44,18,151,50,171,180,39,10,35,223,239,202,217,184,250,220,49,107,209,173,25,73,189,81,150,238,228,168,65,218,255,205,85,134,54,190,97,82,248,187,14,130,72,105,154,224,71,158,92,4,75,52,21,121,38,167,222,41,174,146,215,132,233,210,186,93,243,197,176,191,164,59,113,68,70,43,252,235,111,213,246,20,254,124,112,90,125,253,47,24,131,22,165,145,31,5,149,116,169,193,91,74,133,109,19,7,79,78,69,178,15,201,28,166,188,236,115,144,123,207,89,143,161,249,45,242,177,0,148,55,159,208,46,156,110,40,63,128,240,61,211,37,138,181,231,66,179,199,234,247,76,17,51,3,162,172,96];for(var N=0;N<256;N++){r[N]=65793*(o[N]&255);q[N]=16777473*(l[N]&255);L[N]=16842753*(G[N]&255);K[N]=16843008*(F[N]&255);}}function w(Q,P){var O={};var R,N;if(Q.length===4){R=128;N=12;}else{if(Q.length===6){R=192;N=14;}else{R=256;N=16;}}O.encRoundKeys=y(Q,R,N);if(P){O.decRoundKeys=H(O.encRoundKeys,R);}O.keyBits=R;O.rounds=N;return O;}function I(O,X,W,P){var V,T,S,R,Q=0;var U=[];V=W[0];T=W[1];S=W[2];R=W[3];for(var N=1;N<X/2;N++){V^=O[Q++];T^=O[Q++];S^=O[Q++];R^=O[Q++];V=r[u(V,3)]^q[u(V,2)]^L[u(V,1)]^K[u(V,0)];T=r[u(T,3)]^q[u(T,2)]^L[u(T,1)]^K[u(T,0)];S=r[u(S,3)]^q[u(S,2)]^L[u(S,1)]^K[u(S,0)];R=r[u(R,3)]^q[u(R,2)]^L[u(R,1)]^K[u(R,0)];T^=S;S^=R;V^=T;R^=T;S^=V;T^=S;T=p(T);S=M(S);R=J(R);T^=S;S^=R;V^=T;R^=T;S^=V;T^=S;V^=O[Q++];T^=O[Q++];S^=O[Q++];R^=O[Q++];V=L[u(V,3)]^K[u(V,2)]^r[u(V,1)]^q[u(V,0)];T=L[u(T,3)]^K[u(T,2)]^r[u(T,1)]^q[u(T,0)];S=L[u(S,3)]^K[u(S,2)]^r[u(S,1)]^q[u(S,0)];R=L[u(R,3)]^K[u(R,2)]^r[u(R,1)]^q[u(R,0)];T^=S;S^=R;V^=T;R^=T;S^=V;T^=S;R=p(R);V=M(V);T=J(T);T^=S;S^=R;V^=T;R^=T;S^=V;T^=S;}V^=O[Q++];T^=O[Q++];S^=O[Q++];R^=O[Q++];V=r[u(V,3)]^q[u(V,2)]^L[u(V,1)]^K[u(V,0)];T=r[u(T,3)]^q[u(T,2)]^L[u(T,1)]^K[u(T,0)];S=r[u(S,3)]^q[u(S,2)]^L[u(S,1)]^K[u(S,0)];R=r[u(R,3)]^q[u(R,2)]^L[u(R,1)]^K[u(R,0)];T^=S;S^=R;V^=T;R^=T;S^=V;T^=S;T=p(T);S=M(S);R=J(R);T^=S;S^=R;V^=T;R^=T;S^=V;T^=S;V^=O[Q++];T^=O[Q++];S^=O[Q++];R^=O[Q++];U[0]=(G[255&V>>>24]^O[Q]>>>24)&255;U[1]=(F[255&V>>>16]^O[Q]>>>16)&255;U[2]=(o[255&V>>>8]^O[Q]>>>8)&255;U[3]=(l[255&V]^O[Q])&255;U[4]=(G[255&T>>>24]^O[Q+1]>>>24)&255;U[5]=(F[255&T>>>16]^O[Q+1]>>>16)&255;U[6]=(o[255&T>>>8]^O[Q+1]>>>8)&255;U[7]=(l[255&T]^O[Q+1])&255;U[8]=(G[255&S>>>24]^O[Q+2]>>>24)&255;U[9]=(F[255&S>>>16]^O[Q+2]>>>16)&255;U[10]=(o[255&S>>>8]^O[Q+2]>>>8)&255;U[11]=(l[255&S]^O[Q+2])&255;U[12]=(G[255&R>>>24]^O[Q+3]>>>24)&255;U[13]=(F[255&R>>>16]^O[Q+3]>>>16)&255;U[14]=(o[255&R>>>8]^O[Q+3]>>>8)&255;U[15]=(l[255&R]^O[Q+3])&255;P[0]=g(U,0);P[1]=g(U,4);P[2]=g(U,8);P[3]=g(U,12);}function y(Z,Y,aa){var U=new Array(4*(aa+1));var X,S,Q,P,N,O=0;var W=new Array(4);var V=new Array(4);var T=new Array(4);var R=new Array(4);W[0]=Z[0];W[1]=Z[1];W[2]=Z[2];W[3]=Z[3];N=(Y-128)/64;X=W[0]^z[N][0];S=W[1]^z[N][1];Q=W[2]^z[N][2];P=W[3]^z[N][3];X=r[u(X,3)]^q[u(X,2)]^L[u(X,1)]^K[u(X,0)];S=r[u(S,3)]^q[u(S,2)]^L[u(S,1)]^K[u(S,0)];Q=r[u(Q,3)]^q[u(Q,2)]^L[u(Q,1)]^K[u(Q,0)];P=r[u(P,3)]^q[u(P,2)]^L[u(P,1)]^K[u(P,0)];S^=Q;Q^=P;X^=S;P^=S;Q^=X;S^=Q;S=p(S);Q=M(Q);P=J(P);S^=Q;Q^=P;X^=S;P^=S;Q^=X;S^=Q;if(Y>128){V[0]=Z[4];V[1]=Z[5];if(Y>192){V[2]=Z[6];V[3]=Z[7];}else{V[2]=V[3]=0;}}else{V[0]=V[1]=V[2]=V[3]=0;}V[0]^=X;V[1]^=S;V[2]^=Q;V[3]^=P;X=V[0];S=V[1];Q=V[2];P=V[3];N=N==2?0:N+1;X^=z[N][0];S^=z[N][1];Q^=z[N][2];P^=z[N][3];X=L[u(X,3)]^K[u(X,2)]^r[u(X,1)]^q[u(X,0)];S=L[u(S,3)]^K[u(S,2)]^r[u(S,1)]^q[u(S,0)];Q=L[u(Q,3)]^K[u(Q,2)]^r[u(Q,1)]^q[u(Q,0)];P=L[u(P,3)]^K[u(P,2)]^r[u(P,1)]^q[u(P,0)];S^=Q;Q^=P;X^=S;P^=S;Q^=X;S^=Q;P=p(P);X=M(X);S=J(S);S^=Q;Q^=P;X^=S;P^=S;Q^=X;S^=Q;X^=W[0];S^=W[1];Q^=W[2];P^=W[3];T[0]=X;T[1]=S;T[2]=Q;T[3]=P;N=N==2?0:N+1;X^=z[N][0];S^=z[N][1];Q^=z[N][2];P^=z[N][3];X=r[u(X,3)]^q[u(X,2)]^L[u(X,1)]^K[u(X,0)];S=r[u(S,3)]^q[u(S,2)]^L[u(S,1)]^K[u(S,0)];Q=r[u(Q,3)]^q[u(Q,2)]^L[u(Q,1)]^K[u(Q,0)];P=r[u(P,3)]^q[u(P,2)]^L[u(P,1)]^K[u(P,0)];S^=Q;Q^=P;X^=S;P^=S;Q^=X;S^=Q;S=p(S);Q=M(Q);P=J(P);S^=Q;Q^=P;X^=S;P^=S;Q^=X;S^=Q;R[0]=X^V[0];R[1]=S^V[1];R[2]=Q^V[2];R[3]=P^V[3];v(W,V,19,U,O);O+=4;v(V,T,19,U,O);O+=4;v(T,R,19,U,O);O+=4;v(R,W,19,U,O);O+=4;v(W,V,31,U,O);O+=4;v(V,T,31,U,O);O+=4;v(T,R,31,U,O);O+=4;v(R,W,31,U,O);O+=4;v(W,V,67,U,O);O+=4;v(V,T,67,U,O);O+=4;v(T,R,67,U,O);O+=4;v(R,W,67,U,O);O+=4;v(W,V,97,U,O);O+=4;if(Y>128){v(V,T,97,U,O);O+=4;v(T,R,97,U,O);O+=4;}if(Y>192){v(R,W,97,U,O);O+=4;v(W,V,109,U,O);}return U;}function H(Q,S){var P=Q.slice(0);var N=0,R;var O=new Array(4);R=32+S/8;s(P,0,R);N+=4;R-=4;for(;N<R;N+=4,R-=4){E(P,N,R,O);}C(P,N,O,0);P[N]=O[0];P[N+1]=O[1];P[N+2]=O[2];P[N+3]=O[3];return P;}function A(N){return 65793*(N>>>24&255)^16777473*(N>>>16&255)^16842753*(N>>>8&255)^16843008*(N&255);}function p(N){return N<<8&4278255360|N>>>8&16711935;}function M(N){return N<<16&4294901760|N>>>16&65535;}function J(N){return(N&255)<<24|(N&65280)<<8|(N&16711680)>>>8|(N&4278190080)>>>24;}function v(O,U,P,N,T){var S=4-Math.floor(P/32),R=P%32,Q=32-R;N[T]=O[0]^U[S%4]>>>R^U[(S+3)%4]<<Q;N[T+1]=O[1]^U[(S+1)%4]>>>R^U[S%4]<<Q;N[T+2]=O[2]^U[(S+2)%4]>>>R^U[(S+1)%4]<<Q;N[T+3]=O[3]^U[(S+3)%4]>>>R^U[(S+2)%4]<<Q;}function C(Q,O,T,N){var U,S,R,P;U=A(Q[O]);S=A(Q[O+1]);R=A(Q[O+2]);P=A(Q[O+3]);S^=R;R^=P;U^=S;P^=S;R^=U;S^=R;S=p(S);R=M(R);P=J(P);S^=R;R^=P;U^=S;P^=S;R^=U;S^=R;T[N]=U;T[N+1]=S;T[N+2]=R;T[N+3]=P;}function s(O,N,R){var Q;for(var P=0;P<4;P++){Q=O[N+P];O[N+P]=O[R+P];O[R+P]=Q;}}function E(O,N,Q,P){C(O,N,P,0);C(O,Q,O,N);O[Q]=P[0];O[Q+1]=P[1];O[Q+2]=P[2];O[Q+3]=P[3];}function g(N,O){return(255&N[O])<<24|(255&N[O+1])<<16|(255&N[O+2])<<8|255&N[O+3];}function u(N,O){return N>>>8*O&255;}function n(N,P,O,Q){if(Q){I(N.decRoundKeys,N.rounds,P,O);}else{I(N.encRoundKeys,N.rounds,P,O);}}function m(P){P=P||{};var Q=(P.mode||"CBC").toUpperCase();var O="ARIA-"+Q;var N;if(P.decrypt){N=t.cipher.createDecipher(O,P.key);}else{N=t.cipher.createCipher(O,P.key);}var R=N.start;N.start=function(U,T){var S=null;if(T instanceof t.util.ByteBuffer){S=T;T={};}T=T||{};T.output=S;T.iv=U;R.call(N,T);};return N;}}var b="aria";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./cipher","./cipherModes","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function b(f){f.seed=f.seed||{};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(q,r){for(var p=r||0,o=this.length;p<o;p++){if(this[p]===q){return p;}}return-1;};}var e=[[696885672,92635524,382128852,331600848,340021332,487395612,747413676,621093156,491606364,54739776,403181592,504238620,289493328,1020063996,181060296,591618912,671621160,71581764,536879136,495817116,549511392,583197408,147374280,386339604,629514660,261063564,50529024,994800504,999011256,318968592,314757840,785310444,809529456,210534540,1057960764,680042664,839004720,500027868,919007988,876900468,751624428,361075092,185271048,390550356,474763356,457921368,1032696252,16843008,604250148,470552604,860058480,411603096,268439568,214745292,851636976,432656856,738992172,667411428,843215472,58950528,462132120,297914832,109478532,164217288,541089888,272650320,595829664,734782440,218956044,914797236,512660124,256852812,931640244,441078360,113689284,944271480,646357668,302125584,797942700,365285844,557932896,63161280,881111220,21053760,306336336,1028485500,227377548,134742024,521081628,428446104,0,420024600,67371012,323179344,935850996,566354400,1036907004,910586484,789521196,654779172,813740208,193692552,235799052,730571688,578986656,776888940,327390096,223166796,692674920,1011642492,151585032,168428040,1066382268,802153452,868479984,96846276,126321540,335810580,1053750012,608460900,516870876,772678188,189481800,436867608,101057028,553722144,726360936,642146916,33686016,902164980,310547088,176849544,202113036,864269232,1045328508,281071824,977957496,122110788,377918100,633725412,637936164,8421504,764256684,533713884,562143648,805318704,923218740,781099692,906375732,352653588,570565152,940060728,885321972,663200676,88424772,206323788,25264512,701096424,75792516,394761108,889532724,197903304,248431308,1007431740,826372464,285282576,130532292,160006536,893743476,1003222008,449499864,952692984,344232084,424235352,42107520,80003268,1070593020,155795784,956903736,658989924,12632256,265274316,398971860,948482232,252642060,244220556,37896768,587408160,293704080,743202924,466342872,612671652,872689716,834793968,138952776,46318272,793731948,1024274748,755835180,4210752,1049539260,1041117756,1015853244,29475264,713728680,982168248,240009804,356864340,990589752,483184860,675831912,1062171516,478974108,415813848,172638792,373707348,927429492,545300640,768467436,105267780,897954228,722150184,625303908,986379000,600040416,965325240,830583216,529503132,508449372,969535992,650568420,847426224,822161712,717939432,760045932,525292380,616882404,817950960,231588300,143163528,369496596,973746744,407392344,348442836,574775904,688464168,117900036,855847728,684253416,453710616,84214020,961114488,276861072,709517928,705307176,445289112],[943196208,3894986976,741149985,2753988258,3423588291,3693006546,2956166067,3090712752,2888798115,1612726368,1410680145,3288844227,1141130304,1815039843,1747667811,1478183763,3221472195,1612857954,808649523,3023406513,673777953,2686484640,3760374498,2754054051,3490956243,2417066385,269549841,67503618,471600144,3158084784,875955762,1208699715,3962556387,2282260608,1814842464,2821228704,337053459,3288646848,336987666,4097098992,3221406402,1141196097,3760308705,3558262482,1010765619,1010634033,2349764226,2551744656,673712160,1276005954,4097230578,1010699826,2753922465,4164536817,202181889,3693072339,3625502928,673909539,1680229986,2017086066,606537507,741281571,4029792753,1882342002,1073889858,3558130896,1073824065,3221274816,1882407795,1680295779,2888600736,2282457987,4097296371,2888666529,2147516544,471797523,3356150466,741084192,2821360290,875824176,3490890450,134941443,3962490594,3895052769,1545424209,2484372624,404228112,4164471024,1410811731,2888732322,134744064,3288712641,269681427,3423456705,2215020162,3090778545,4232040435,2084392305,3221340609,808517937,4097164785,2282392194,1747602018,2956034481,3490824657,538968096,3558328275,131586,539099682,67372032,1747470432,1882276209,67569411,3625700307,2619182481,2551810449,1612792161,3158216370,3827746530,1478052177,3692940753,1343308113,2417000592,3692874960,2551876242,2686682019,2821426083,3490758864,2147582337,202313475,1141327683,404359698,3760440291,3962359008,2349698433,3158282163,2484504210,2017151859,1545358416,2686616226,2686550433,1612923747,539165475,1275940161,3356018880,2619248274,2619116688,943327794,202116096,741215778,3090844338,1814974050,2619314067,1478117970,4029858546,2417132178,4029924339,1208568129,2016954480,3423390912,336921873,4164668403,1882210416,1949648241,2084523891,875889969,269484048,197379,1680098400,1814908257,3288778434,1949582448,3558196689,3023340720,3895118562,134809857,1949714034,404293905,4231974642,1073758272,269615634,3760242912,3158150577,67437825,4164602610,65793,4029726960,673843746,1545490002,2821294497,1410745938,1073955651,2214954369,336856080,2282326401,2551942035,2955968688,3827680737,1208502336,2017020273,2484570003,4231843056,471731730,2147648130,539033889,2349632640,404425491,1545555795,1949779827,1410614352,2956100274,471665937,606405921,1276071747,0,1141261890,3962424801,1477986384,1343373906,3895184355,2084458098,3625634514,3356084673,4231908849,808452144,2484438417,1680164193,1010568240,3023472306,3827614944,3090910131,2084326512,202247682,1343242320,943262001,606471714,808583730,2214888576,1747536225,2417197971,876021555,3827812323,606340128,2753856672,3356216259,1343439699,134875650,2215085955,3625568721,1275874368,2147713923,2349830019,3423522498,943393587,1208633922,3023538099],[2712152457,2172913029,3537114822,3553629123,1347687492,287055117,2695638156,556016901,1364991309,1128268611,270014472,303832590,1364201793,4043062476,3267889866,1667244867,539502600,1078199364,538976256,2442927501,3772784832,3806339778,3234334920,320083719,2711889285,2206994319,50332419,1937259339,3015195531,319820547,3536851650,3807129294,1886400576,2156661900,859586319,2695374984,842019330,3520863693,4076091078,1886663748,3773574348,2442401157,50858763,1398019911,1348213836,1398283083,2981903757,16777473,539239428,270277644,1936732995,2425886856,269488128,3234598092,4075827906,3520600521,539765772,3823380423,1919955522,2206204803,2476219275,3520074177,2189690502,3251112393,1616912448,1347424320,2745181059,3823643595,17566989,2998154886,2459704974,1129058127,3014932359,1381505610,3267626694,1886926920,2728666758,303043074,2745970575,3520337349,1633689921,3284140995,2964599940,1094713665,1380979266,1903967565,2173439373,526344,320610063,2442664329,0,286791945,263172,1397756739,4092868551,3789562305,4059839949,1920218694,590098191,589571847,2964336768,2206731147,34344462,2745707403,2728403586,1651256910,2475692931,1095503181,1634216265,1887190092,17303817,34081290,3015458703,3823906767,4092605379,3250849221,2206467975,269751300,4076617422,1617175620,3537641166,573320718,1128794955,303569418,33818118,555753729,1667771211,1650730566,33554946,4059313605,2458915458,2189953674,789516,3014669187,1920745038,3503296704,1920481866,1128531783,2459178630,3789825477,572794374,2155872384,2712415629,3554418639,2711626113,808464384,859059975,2729193102,842282502,286528773,572531202,808990728,4042536132,2745444231,1094976837,1078725708,2172649857,3790088649,2156135556,2475956103,825505029,3284667339,3268153038,809253900,1903178049,286265601,3284404167,2173176201,1903441221,4093131723,3537377994,4042799304,2425623684,1364728137,2189427330,3234071748,4093394895,1095240009,825768201,1667508039,3233808576,3284930511,3553892295,2964863112,51121935,2190216846,1111491138,589308675,2442137985,1617701964,3554155467,2695111812,808727556,4059050433,1078462536,3267363522,1668034383,826031373,556543245,1077936192,2998681230,842808846,2965126284,3250586049,2728929930,2998418058,1112280654,1364464965,859323147,3504086220,1617438792,1937522511,2426150028,3503823048,1112017482,1381242438,1936996167,2694848640,3790351821,1111754310,2981377413,589835019,1633953093,4076354250,3823117251,2981640585,2981114241,2476482447,1381768782,4059576777,3806602950,2997891714,825241857,3806866122,1634479437,1398546255,3773048004,4042272960,3251375565,2156398728,303306246,842545674,1347950664,3503559876,1650467394,556280073,50595591,858796803,3773311176,320346891,17040645,1903704393,2425360512,1650993738,573057546,2459441802],[137377848,3370182696,220277805,2258805798,3485715471,3469925406,2209591347,2293282872,2409868335,1080057888,1162957845,3351495687,1145062404,1331915823,1264805931,1263753243,3284385795,1113743394,53686323,2243015733,153167913,2158010400,3269648418,2275648551,3285438483,2173800465,17895441,100795398,202382364,2360392764,103953462,1262700555,3487820847,2290124808,1281387564,2292230184,118690839,3300967428,101848086,3304125492,3267543042,1161905157,3252805665,3335705622,255015999,221330493,2390920206,2291177496,136325160,1312967694,3337810998,238173246,2241963045,3388078137,218172429,3486768159,3369130008,186853419,1180853286,1249015866,119743527,253963311,3253858353,1114796082,1111638018,3302020116,1094795265,3233857536,1131638835,1197696039,2359340076,2340653067,3354653751,2376182829,2155905024,252910623,3401762826,203435052,2325915690,70267956,3268595730,184748043,3470978094,3387025449,1297177629,2224067604,135272472,3371235384,1196643351,2393025582,134219784,3317810181,51580947,3452029965,2256700422,2310125625,3488873535,1299283005,3250700289,20000817,3320968245,2323810314,1247963178,2175905841,3251752977,2105376,3352548375,33685506,35790882,67109892,1214277672,1097953329,117638151,3419658267,2375130141,2308020249,1096900641,2394078270,3336758310,1230067737,3453082653,1095847953,2156957712,3436239900,2324863002,2208538659,2342758443,3234910224,2172747777,251857935,1195590663,168957978,3286491171,3437292588,2374077453,2410921023,2257753110,1265858619,1280334876,2191695906,2174853153,1130586147,52633635,1296124941,3368077320,2391972894,2358287388,171063354,201329676,237120558,2326968378,1315073070,2408815647,1246910490,3270701106,2190643218,3287543859,1229015049,1215330360,3435187212,85005333,3421763643,1081110576,1165063221,1332968511,87110709,1052688,50528259,1147167780,1298230317,3334652934,1148220468,3318862869,2226172980,3403868202,151062537,1181905974,152115225,3472030782,1077952512,34738194,3235962912,2377235517,83952645,3404920890,16842753,3237015600,170010666,1314020382,2309072937,1179800598,1128480771,2239857669,68162580,2306967561,2341705755,2159063088,3319915557,1212172296,1232173113,2274595863,3438345276,236067870,2189590530,18948129,2357234700,185800731,1330863135,1198748727,1146115092,2192748594,219225117,86058021,1329810447,0,1178747910,3454135341,1213224984,1112690706,3420710955,1316125758,3402815514,3384920073,3455188029,3158064,2240910357,1164010533,204487740,2259858486,3303072804,2343811131,1282440252,235015182,1079005200,154220601,102900774,36843570,2223014916,1231120425,2207485971,120796215,3353601063,69215268,2225120292,3418605579,1129533459,167905290,2273543175,3385972761,1279282188,2206433283,2407762959,3468872718,187906107,1245857802,2276701239]];function g(o){return e[3][o>>>24&255]^e[2][o>>>16&255]^e[1][o>>>8&255]^e[0][o&255];}function l(r,p){var o=r[0];var s=r[1];var q=[];q[0]=s[0]^p[0];q[1]=s[1]^p[1];q[1]^=q[0];q[1]=g(q[1]);q[0]+=q[1];q[0]=g(q[0]);q[1]+=q[0];q[1]=g(q[1]);q[0]+=q[1];o[0]^=q[0];o[1]^=q[1];return[s,o];}var d=[2654435769,1013904243,2027808486,4055616972,3816266649,3337566003,2380164711,465362127,930724254,1861448508,3722897016,3150826737,2006686179,4013372358,3731777421,3168587547];var h=function(v,u,s){var t=0;var o=v.slice(t,t+2);var r=v.slice(t+2,t+4);var p=[o,r];for(var q=0;q<16;q++){p=l(p,u[q]);}p.reverse();s.splice(t,4,p[0][0],p[0][1],p[1][0],p[1][1]);};var n=function(o,q,p,r){h(q,o,p);};var m=function(C,u,s,p,w){var r=w==="CBC";var y=null;var F;var D;var B;var A;var v;var t;var q;var z=4<<2;var o;y={_key:C,output:null};var B;q=E;y.update=function(G){if(!t){D.putBuffer(G);}while(D.length()>=z||D.length()>0&&t){q();}};y.finish=function(K){var J=true;var L=D.length()%z;if(!p){if(K){J=K(z,D,p);}else{if(r){var I=D.length()===z?z:z-D.length();D.fillWithByte(I,I);}}}if(J){t=true;y.update();}if(p){if(r){J=L===0;}if(J){if(K){J=K(z,B,p);}else{if(r){var G=B.length();var H=B.at(G-1);if(H>4<<2){J=false;}else{B.truncate(H);}}}}}if(!r&&!K&&L>0){B.truncate(z-L);}return J;};y.start=function(N,L){F=N;if(typeof N==="string"&&N.length===16){N=f.util.createBuffer(N);}else{if(f.util.isArray(N)&&N.length===16){var O=N;var N=f.util.createBuffer();for(var P=0;P<16;++P){N.putByte(O[P]);}}}D=f.util.createBuffer();B=L||f.util.createBuffer();o=[];o.splice(0,4,N.getInt32(),N.getInt32(),N.getInt32(),N.getInt32());A=new Array(4);v=new Array(4);t=false;y.output=B;if(["CFB","OFB","CTR"].indexOf(w)!==-1){for(var P=0;P<4;++P){A[P]=o[P];}o=null;}var S=f.util.createBuffer(this._key);var J=S.getInt32();var I=S.getInt32();var H=S.getInt32();var G=S.getInt32();var R=[];for(var P=0;P<16;P++){R[P]=[];R[P][0]=g(J+H-d[P]);R[P][1]=g(I-G+d[P]);if(P%2==0){var M=J;J=J>>>8|I<<24;I=I>>>8|M<<24;}else{var Q=H;H=H<<8|G>>>24;G=G<<8|Q>>>24;}}this._roundKeys=R;this._invRoundKeys=R.slice().reverse();};if(u!==null){y.start(u,s);}return y;function E(){var H;H=y._roundKeys;if(p){H=y._invRoundKeys;for(var G=0;G<4;++G){A[G]=D.getInt32();}}else{for(var G=0;G<4;++G){A[G]=o[G]^D.getInt32();}}n(H,A,v,p);if(p){for(var G=0;G<4;++G){B.putInt32(o[G]^v[G]);}o=A.slice(0);}else{for(var G=0;G<4;++G){B.putInt32(v[G]);}o=v;}}};f.seed.createEncryptionCipher=function(o,p){return m(o,null,null,false,p);};f.seed.createDecryptionCipher=function(o,p){return m(o,null,null,true,p);};}var a="seed";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var c=true;define=function(e,d){d(require,module);};}else{if(typeof forge==="undefined"){forge={};}return b(forge);}}})();(function(){function c(g){var l=typeof process!=="undefined"&&process.versions&&process.versions.node;var m=null;if(!g.disableNativeCode&&l&&!process.versions["node-webkit"]){m=require("crypto");}var h=g.prng=g.prng||{};h.create=function(s){var v={plugin:s,key:null,seed:null,time:null,reseeds:0,generated:0};var t=s.md;var u=new Array(32);for(var r=0;r<32;++r){u[r]=t.create();}v.pools=u;v.pool=0;v.generate=function(C,E){if(!E){return v.generateSync(C);}var z=v.plugin.cipher;var y=v.plugin.increment;var D=v.plugin.formatKey;var B=v.plugin.formatSeed;var w=g.util.createBuffer();v.key=null;A();function A(G){if(G){return E(G);}if(w.length()>=C){return E(null,w.getBytes(C));}if(v.generated>1048575){v.key=null;}if(v.key===null){return g.util.nextTick(function(){n(A);});}var F=z(v.key,v.seed);v.generated+=F.length;w.putBytes(F);v.key=D(z(v.key,y(v.seed)));v.seed=B(z(v.key,v.seed));g.util.setImmediate(A);}};v.generateSync=function(C){var z=v.plugin.cipher;var y=v.plugin.increment;var D=v.plugin.formatKey;var B=v.plugin.formatSeed;v.key=null;var w=g.util.createBuffer();while(w.length()<C){if(v.generated>1048575){v.key=null;}if(v.key===null){o();}var A=z(v.key,v.seed);v.generated+=A.length;w.putBytes(A);v.key=D(z(v.key,y(v.seed)));v.seed=B(z(v.key,v.seed));}return w.getBytes(C);};function n(y){if(v.pools[0].messageLength>=32){p();return y();}var w=32-v.pools[0].messageLength<<5;v.seedFile(w,function(A,z){if(A){return y(A);}v.collect(z);p();y();});}function o(){if(v.pools[0].messageLength>=32){return p();}var w=32-v.pools[0].messageLength<<5;v.collect(v.seedFileSync(w));p();}function p(){var B=v.plugin.md.create();B.update(v.pools[0].digest().getBytes());v.pools[0].start();var z=1;for(var A=1;A<32;++A){z=z===31?2147483648:z<<2;if(z%v.reseeds===0){B.update(v.pools[A].digest().getBytes());v.pools[A].start();}}var y=B.digest().getBytes();B.start();B.update(y);var w=B.digest().getBytes();v.key=v.plugin.formatKey(y);v.seed=v.plugin.formatSeed(w);v.reseeds=v.reseeds===4294967295?0:v.reseeds+1;v.generated=0;}function q(H){var I=null;if(typeof window!=="undefined"){var B=window.crypto||window.msCrypto;if(B&&B.getRandomValues){I=function(J){return B.getRandomValues(J);};}}var G=g.util.createBuffer();if(I){while(G.length()<H){var C=Math.max(1,Math.min(H-G.length(),65536)/4);var F=new Uint32Array(Math.floor(C));try{I(F);for(var y=0;y<F.length;++y){G.putInt32(F[y]);}}catch(E){if(!(typeof QuotaExceededError!=="undefined"&&E instanceof QuotaExceededError)){throw E;}}}}if(G.length()<H){var w,D,A;var z=parseInt((window.crypto||window.msCrypto).getRandomValues(new Uint16Array(1))[0]);while(G.length()<H){D=16807*(z&65535);w=16807*(z>>16);D+=(w&32767)<<16;D+=w>>15;D=(D&2147483647)+(D>>31);z=D&4294967295;for(var y=0;y<3;++y){A=z>>>(y<<3);A^=parseInt((window.crypto||window.msCrypto).getRandomValues(new Uint8Array(1))[0]);G.putByte(A&255);}}}return G.getBytes(H);}if(m){v.seedFile=function(w,y){m.randomBytes(w,function(A,z){if(A){return y(A);}y(null,z.toString());});};v.seedFileSync=function(w){return m.randomBytes(w).toString();};}else{v.seedFile=function(w,z){try{z(null,q(w));}catch(y){z(y);}};v.seedFileSync=q;}v.collect=function(w){var z=w.length;for(var y=0;y<z;++y){v.pools[v.pool].update(w.substr(y,1));v.pool=v.pool===31?0:v.pool+1;}};v.collectInt=function(z,A){var y="";for(var w=0;w<A;w+=8){y+=String.fromCharCode(z>>w&255);}v.collect(y);};v.registerWorker=function(y){if(y===self){v.seedFile=function(z,B){function A(D){var C=D.data;if(C.forge&&C.forge.prng){self.removeEventListener("message",A);B(C.forge.prng.err,C.forge.prng.bytes);}}self.addEventListener("message",A);self.postMessage({forge:{prng:{needed:z}}});};}else{var w=function(A){var z=A.data;if(z.forge&&z.forge.prng){v.seedFile(z.forge.prng.needed,function(C,B){y.postMessage({forge:{prng:{err:C,bytes:B}}});});}};y.addEventListener("message",w);}};return v;};}var b="prng";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./md","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(h){var m=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173];var l=[1,2,3,5];var o=function(q,p){return q<<p&65535|(q&65535)>>16-p;};var g=function(q,p){return(q&65535)>>p|q<<16-p&65535;};h.rc2=h.rc2||{};h.rc2.expandKey=function(v,u){if(typeof v==="string"){v=h.util.createBuffer(v);}u=u||128;var p=v;var s=v.length();var w=u;var q=Math.ceil(w/8);var r=255>>(w&7);var t;for(t=s;t<128;t++){p.putByte(m[p.at(t-1)+p.at(t-s)&255]);}p.setAt(128-q,m[p.at(128-q)&r]);for(t=127-q;t>=0;t--){p.setAt(t,m[p.at(t+1)^p.at(t+q)]);}return p;};var n=function(z,A,u){var q=false,B=null,w=null,D=null;var C,v;var s,r,y=[];z=h.rc2.expandKey(z,A);for(s=0;s<64;s++){y.push(z.getInt16Le());}if(u){C=function(E){for(s=0;s<4;s++){E[s]+=y[r]+(E[(s+3)%4]&E[(s+2)%4])+(~E[(s+3)%4]&E[(s+1)%4]);E[s]=o(E[s],l[s]);r++;}};v=function(E){for(s=0;s<4;s++){E[s]+=y[E[(s+3)%4]&63];}};}else{C=function(E){for(s=3;s>=0;s--){E[s]=g(E[s],l[s]);E[s]-=y[r]+(E[(s+3)%4]&E[(s+2)%4])+(~E[(s+3)%4]&E[(s+1)%4]);r--;}};v=function(E){for(s=3;s>=0;s--){E[s]-=y[E[(s+3)%4]&63];}};}var p=function(G){var E=[];for(s=0;s<4;s++){var H=B.getInt16Le();if(D!==null){if(u){H^=D.getInt16Le();}else{D.putInt16Le(H);}}E.push(H&65535);}r=u?0:63;for(var I=0;I<G.length;I++){for(var F=0;F<G[I][0];F++){G[I][1](E);}}for(s=0;s<4;s++){if(D!==null){if(u){D.putInt16Le(E[s]);}else{E[s]^=D.getInt16Le();}}w.putInt16Le(E[s]);}};var t=null;t={start:function(F,E){if(F){if(typeof F==="string"){F=h.util.createBuffer(F);}}q=false;B=h.util.createBuffer();w=E||new h.util.createBuffer;D=F;t.output=w;},update:function(E){if(!q){B.putBuffer(E);}while(B.length()>=8){p([[5,C],[1,v],[6,C],[1,v],[5,C]]);}},finish:function(I){var H=true;if(u){if(I){H=I(8,B,!u);}else{var G=B.length()===8?8:8-B.length();B.fillWithByte(G,G);}}if(H){q=true;t.update();}if(!u){H=B.length()===0;if(H){if(I){H=I(8,w,!u);}else{var E=w.length();var F=w.at(E-1);if(F>E){H=false;}else{w.truncate(F);}}}}return H;}};return t;};h.rc2.startEncrypting=function(s,r,q){var p=h.rc2.createEncryptionCipher(s,128);p.start(r,q);return p;};h.rc2.createEncryptionCipher=function(p,q){return n(p,q,true);};h.rc2.startDecrypting=function(s,r,q){var p=h.rc2.createDecryptionCipher(s,128);p.start(r,q);return p;};h.rc2.createDecryptionCipher=function(p,q){return n(p,q,false);};}var b="rc2";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(s){s.des=s.des||{};s.des.startEncrypting=function(A,z,y,B){var w=v({key:A,output:y,decrypt:false,mode:B||(z===null?"ECB":"CBC")});w.start(z);return w;};s.des.createEncryptionCipher=function(w,y){return v({key:w,output:null,decrypt:false,mode:y});};s.des.startDecrypting=function(A,z,y,B){var w=v({key:A,output:y,decrypt:true,mode:B||(z===null?"ECB":"CBC")});w.start(z);return w;};s.des.createDecryptionCipher=function(w,y){return v({key:w,output:null,decrypt:true,mode:y});};s.des.Algorithm=function(y,z){var w=this;w.name=y;w.mode=new z({blockSize:8,cipher:{encrypt:function(B,A){return r(w._keys,B,A,false);},decrypt:function(B,A){return r(w._keys,B,A,true);}}});w._init=false;};s.des.Algorithm.prototype.initialize=function(w){if(this._init){return;}var y=s.util.createBuffer(w.key);if(this.name.indexOf("3DES")===0){if(y.length()!==24){throw new Error("Invalid Triple-DES key size: "+y.length()*8);}}this._keys=u(y);this._init=true;};t("DES-ECB",s.cipher.modes.ecb);t("DES-CBC",s.cipher.modes.cbc);t("DES-CFB",s.cipher.modes.cfb);t("DES-OFB",s.cipher.modes.ofb);t("DES-CTR",s.cipher.modes.ctr);t("3DES-ECB",s.cipher.modes.ecb);t("3DES-CBC",s.cipher.modes.cbc);t("3DES-CFB",s.cipher.modes.cfb);t("3DES-OFB",s.cipher.modes.ofb);t("3DES-CTR",s.cipher.modes.ctr);function t(y,z){var w=function(){return new s.des.Algorithm(y,z);};s.cipher.registerAlgorithm(y,w);}var q=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756];var p=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344];var o=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584];var n=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928];var m=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080];var l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312];var h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154];var g=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function u(W){var V=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],T=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],S=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],R=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],O=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],N=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],M=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],L=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],K=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],I=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],C=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],B=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],A=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],z=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261];var J=W.length()>8?3:1;var E=[];var D=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];var F=0,Q;for(var G=0;G<J;G++){var y=W.getInt32();var P=W.getInt32();Q=(y>>>4^P)&252645135;P^=Q;y^=Q<<4;Q=(P>>>-16^y)&65535;y^=Q;P^=Q<<-16;Q=(y>>>2^P)&858993459;P^=Q;y^=Q<<2;Q=(P>>>-16^y)&65535;y^=Q;P^=Q<<-16;Q=(y>>>1^P)&1431655765;P^=Q;y^=Q<<1;Q=(P>>>8^y)&16711935;y^=Q;P^=Q<<8;Q=(y>>>1^P)&1431655765;P^=Q;y^=Q<<1;Q=y<<8|P>>>20&240;y=P<<24|P<<8&16711680|P>>>8&65280|P>>>24&240;P=Q;for(var H=0;H<D.length;++H){if(D[H]){y=y<<2|y>>>26;P=P<<2|P>>>26;}else{y=y<<1|y>>>27;P=P<<1|P>>>27;}y&=-15;P&=-15;var U=V[y>>>28]|T[y>>>24&15]|S[y>>>20&15]|R[y>>>16&15]|O[y>>>12&15]|N[y>>>8&15]|M[y>>>4&15];var w=L[P>>>28]|K[P>>>24&15]|I[P>>>20&15]|C[P>>>16&15]|B[P>>>12&15]|A[P>>>8&15]|z[P>>>4&15];Q=(w>>>16^U)&65535;E[F++]=U^Q;E[F++]=w^Q<<16;}}return E;}function r(K,I,B,A){var D=K.length===32?3:9;var L;if(D===3){L=A?[30,-2,-2]:[0,32,2];}else{L=A?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];}var H;var C=I[0];var J=I[1];H=(C>>>4^J)&252645135;J^=H;C^=H<<4;H=(C>>>16^J)&65535;J^=H;C^=H<<16;H=(J>>>2^C)&858993459;C^=H;J^=H<<2;H=(J>>>8^C)&16711935;C^=H;J^=H<<8;H=(C>>>1^J)&1431655765;J^=H;C^=H<<1;C=C<<1|C>>>31;J=J<<1|J>>>31;for(var F=0;F<D;F+=3){var E=L[F+1];var z=L[F+2];for(var G=L[F];G!=E;G+=z){var y=J^K[G];var w=(J>>>4|J<<28)^K[G+1];H=C;C=J;J=H^(p[y>>>24&63]|n[y>>>16&63]|l[y>>>8&63]|g[y&63]|q[w>>>24&63]|o[w>>>16&63]|m[w>>>8&63]|h[w&63]);}H=C;C=J;J=H;}C=C>>>1|C<<31;J=J>>>1|J<<31;H=(C>>>1^J)&1431655765;J^=H;C^=H<<1;H=(J>>>8^C)&16711935;C^=H;J^=H<<8;H=(J>>>2^C)&858993459;C^=H;J^=H<<2;H=(C>>>16^J)&65535;J^=H;C^=H<<16;H=(C>>>4^J)&252645135;J^=H;C^=H<<4;B[0]=C;B[1]=J;}function v(z){z=z||{};var A=(z.mode||"CBC").toUpperCase();var y="DES-"+A;var w;if(z.decrypt){w=s.cipher.createDecipher(y,z.key);}else{w=s.cipher.createCipher(y,z.key);}var B=w.start;w.start=function(E,D){var C=null;if(D instanceof s.util.ByteBuffer){C=D;D={};}D=D||{};D.output=C;D.iv=E;B.call(w,D);};return w;}}var b="des";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./cipher","./cipherModes","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(g){if(g.random&&g.random.getBytes){return;}(function(v){var s={};var o=new Array(4);var n=g.util.createBuffer();s.formatKey=function(y){var w=g.util.createBuffer(y);y=new Array(4);y[0]=w.getInt32();y[1]=w.getInt32();y[2]=w.getInt32();y[3]=w.getInt32();return g.aes._expandKey(y,false);};s.formatSeed=function(w){var y=g.util.createBuffer(w);w=new Array(4);w[0]=y.getInt32();w[1]=y.getInt32();w[2]=y.getInt32();w[3]=y.getInt32();return w;};s.cipher=function(y,w){g.aes._updateBlock(y,w,o,false);n.putInt32(o[0]);n.putInt32(o[1]);n.putInt32(o[2]);n.putInt32(o[3]);return n.getBytes();};s.increment=function(w){++w[3];return w;};s.md=g.md.sha256;function m(){var w=g.prng.create(s);w.getBytes=function(y,z){return w.generate(y,z);};w.getBytesSync=function(y){return w.generate(y);};w.nextBytes=function(z){var y=w.getBytesSync(z.length);for(var A=0;A<z.length;++A){z[A]=y.charCodeAt(A);}};return w;}var l=m();var q=typeof process!=="undefined"&&process.versions&&process.versions.node;var u=null;if(typeof window!=="undefined"){var p=window.crypto||window.msCrypto;if(p&&p.getRandomValues){u=function(w){return p.getRandomValues(w);};}}if(g.disableNativeCode||!q&&!u){if(typeof window==="undefined"||window.document===undefined){}l.collectInt(+new Date,32);if(typeof navigator!=="undefined"){var h="";for(var t in navigator){try{if(t!="cookieEnabled"){if(typeof navigator[t]=="string"){h+=navigator[t];}}else{h+=false;}}catch(r){console.log("try catch - sf random");}}l.collect(h);h=null;}if(v){v().mousemove(function(w){l.collectInt(w.clientX,16);l.collectInt(w.clientY,16);});v().keypress(function(w){l.collectInt(w.charCode,8);});}}if(!g.random){g.random=l;}else{for(var t in l){g.random[t]=l[t];}}g.random.createInstance=m;})(typeof jQuery!=="undefined"?jQuery:null);}var b="random";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./aes","./md","./prng","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){sofo.crypto.SHA1=function(b){var c=forge.md.sha1.create();c.update(b);return c.digest();};sofo.crypto.SHA256=function(b){var c=forge.md.sha256.create();c.update(b);return c.digest();};sofo.crypto.SHA512=function(b){var c=forge.md.sha512.create();c.update(b);return c.digest();};sofo.crypto.MD5=function(c,b){var d=forge.md.md5.create();var e=c;if(b!==undefined||b!==null){e=c.toString().slice(0,b);}d.update(e);return d.digest();};sofo.crypto.HMAC=function(b,c){var d=forge.hmac.create();d.start("sha1",c);d.update(b);return d.digest();};sofo.crypto.hashUpdate=function(b,f,g){var e,d,c;switch(g){case "sha1":d=sofo.crypto.SHA1;break;case "sha256":d=sofo.crypto.SHA256;break;case "sha512":d=sofo.crypto.SHA512;break;default:throw new Error("Unsupported hash algorithm "+g);}c=b.concat(f.toString());e=d(c);return e;};sofo.crypto.encrypt=function(m,n,d,h){var c=null;if(m!==undefined){var b,l,g;var e=forge.util.createBuffer(m,"utf8");switch(h){case "seedCBC":b=16;l=16;g=forge.seed.createEncryptionCipher;break;case "aesCBC":b=16;l=16;g=forge.aes.createEncryptionCipher;break;default:throw new Error('Unsupperted symmetric cipher "'+h+'"');}var f=g(n,"CBC");f.start(forge.util.createBuffer(d));f.update(e);if(!f.finish()){throw new Error("Symmetric encryption failed.");}c=f.output;}return c.data;};sofo.crypto.decrypt=function(l,m,c,g){if(l!==undefined){var b,h,f;var d=forge.util.createBuffer(l);switch(g){case "seedCBC":b=16;h=16;f=forge.seed.createDecryptionCipher;break;case "aesCBC":b=16;h=16;f=forge.aes.createDecryptionCipher;break;default:throw new Error('Unsupperted symmetric cipher "'+g+'"');}var e=f(m,"CBC");e.start(forge.util.createBuffer(c));e.update(d);if(!e.finish()){throw new Error("Symmetric decryption failed.");}output=e.output;}return output.data;};var a={};a.create=function(){var b={};var c=null;var d=null;b.start=function(e,f){if(f.length>8){f=f.substring(0,8);}c=e.startEncrypting(forge.util.createBuffer(f),forge.util.hexToBytes("0000000000000000"));};b.update=function(e){if(typeof e=="string"){e=forge.util.createBuffer(e);}var f=8;var g;g=forge.util.createBuffer(e.getBytes(f));c.update(g);c.update(e);};b.getMac=function(){var e;var f;c.finish(function(l,h,g){var m;m=l-h.length()%l;if(m!=l){h.fillWithByte(0,m);}f=l;return true;});c.output.read=c.output.length()-f;e=c.output.getBytes(f);return forge.util.createBuffer(e);};return b;};sofo.crypto.cmac=a;})();(function(){if(typeof f==="undefined"){var f=forge.jsbn.BigInteger;}var g=forge.asn1;var a=sofo.pki=sofo.pki||{};a.pbe=sofo.pbe=sofo.pbe||{};var G=sofo.error||{};forge.pki.oids["1.2.410.200004.1.4"]="seedCBC";forge.pki.oids["seedCBC"]="1.2.410.200004.1.4";forge.pki.oids["1.2.410.200004.1.4.2"]="gpki-seedCBC";forge.pki.oids["gpki-seedCBC"]="1.2.410.200004.1.4.2";forge.pki.oids["1.2.410.200004.1.15"]="seedCBCWithSHA1";forge.pki.oids["seedCBCWithSHA1"]="1.2.410.200004.1.15";forge.pki.oids["1.2.410.200004.10.1.1.1"]="VID";forge.pki.oids["VID"]="1.2.410.200004.10.1.1.1";forge.pki.oids["1.2.410.200004.10.1.1.2"]="EncryptedVID";forge.pki.oids["EncryptedVID"]="1.2.410.200004.10.1.1.2";forge.pki.oids["1.2.410.200004.10.1.1.3"]="randomNum";forge.pki.oids["randomNum"]="1.2.410.200004.10.1.1.3";var u={yessign:["1.2.410.200005.1.1.1","1.2.410.200005.1.1.1.1","1.2.410.200005.1.1.1.2","1.2.410.200005.1.1.1.3","1.2.410.200005.1.1.1.4","1.2.410.200005.1.1.1.5","1.2.410.200005.1.1.1.6","1.2.410.200005.1.1.4","1.2.410.200005.1.1.4.1","1.2.410.200005.1.1.4.2","1.2.410.200005.1.1.4.3","1.2.410.200005.1.1.4.4","1.2.410.200005.1.1.4.5","1.2.410.200005.1.1.4.6"],SignKorea:["1.2.410.200004.5.1.1.5","1.2.410.200004.5.1.1.9"],KICA:["1.2.410.200004.5.2.1.2","1.2.410.200004.5.2.1.7.1","1.2.410.200004.2.201"],CrossCert:["1.2.410.200004.5.4.1.1"]};var X=0;var F=1;var H=11;var O=13;var o=14;var N=19;var T=null;var ai=16;function P(aj){var ak=[];aj.attributes.forEach(function(al){ak.push(al.shortName.toLowerCase()+"="+al.value);});return forge.util.decodeUtf8(ak.reverse().join(","));}var ab=2592000;function ag(am,al){var aj=0;var ak=(al.getTime()-am.getTime())/1000;if(ak<0){aj=2;}else{if(ak>ab){aj=0;}else{aj=1;}}return aj;}function c(ao){var ak={policy:[],unotice:[],cps:[]};var al=false;var ap=false;if(!ao){return ak;}function an(at){if(at.composed&&at.value instanceof Array){for(var ar=0;ar<at.value.length;ar++){an(at.value[ar]);}}else{if(at.tagClass==forge.asn1.Class.UNIVERSAL&&at.type==forge.asn1.Type.OID){var aq=forge.asn1.derToOid(at.value);if(aq=="1.3.6.1.5.5.7.2.2"){al=true;}else{if(aq=="1.3.6.1.5.5.7.2.1"){ap=true;}else{al=false;ap=false;}}}else{if(al){ak.unotice.push(at.value);}else{if(ap){ak.cps.push(at.value);}}al=false;ap=false;}}}function aj(at){if(!at){return;}if(at.composed&&at.value instanceof Array){for(var ar=0;ar<at.value.length;ar++){if(at.value[ar].composed&&at.value[ar].value instanceof Array){for(var aq=0;aq<at.value[ar].value.length;aq++){if(at.value[ar].value[aq].tagClass==forge.asn1.Class.UNIVERSAL&&at.value[ar].value[aq].type==forge.asn1.Type.OID){ak.policy.push(forge.asn1.derToOid(at.value[ar].value[aq].value));}else{an(at.value[ar].value[aq]);}}}}}}try{aj(forge.asn1.fromDer(ao.value));return ak;}catch(am){return ak;}}function S(al,an){var ap;var ak=c(al.getExtension("certificatePolicies"));var aj=ak.policy[0];var am=an.split(",");for(var ao=0;ao<am.length;ao++){if(am[ao].indexOf("o=")==0){ap=am[ao].substring(2);break;}}if(u[ap].indexOf(aj)==-1){ap=null;}return ap;}function W(ao){if(!ao){return null;}if(!T){return ao;}var ap=-1;var al="";if(typeof ao==="string"){var ak=ao.indexOf("$");if(ak==-1){return null;}ap=parseInt(ao.substring(0,ak));if(ao.length>ak+1){al=ao.substring(ak+1);}}else{if(typeof ao==="object"){if(typeof ao.type!=="number"){return null;}ap=ao.type;if(ap==O){if(!ao.keypad||ao.keypad==null||ao.keypad=="undefined"){return null;}}else{return null;}}else{return null;}}var ar=T.split("$");var aj=0;var aq="";var an=false;for(var am=0;am<ar.length;am++){var ak=ar[am].indexOf("|");if(ak==-1){aj=parseInt(ar[am]);}else{aj=parseInt(ar[am].substring(0,ak));if(ar[am].length>ak+1){aq=ar[am].substring(ak+1);}}if(aj==ap){an=true;break;}}if(!an){return null;}if(ap==X){return al;}else{if(ap==O){return ao.keypad.get_input();}else{if(ap==F){return Y(al,aq);}else{if(ap==N){return q(al);}else{if(ap==H){return ac(al,aq);}else{if(ap==o){return e(al);}else{return null;}}}}}}}function e(an){var ap=[212,33,154,107,230,184,57,227,78,115,229,44,155,34,19,195,210,84,254,208,38,55,171,206,96,90,136,126,28,57,61,222];var am;var ao;var al;var aq="CBC";am=forge.util.hexToBytes(an.substr(0,32));ao=forge.util.hexToBytes(an.substr(32));al=forge.aria.createDecryptionCipher;var ak=al(ap,aq);ak.start(forge.util.createBuffer(am));ak.update(forge.util.createBuffer(ao));ak.finish();var aj=ak.output.getBytes().split("<::>");return aj[0];}function Y(al,ar){var av;var am;var au;var ao="CBC";var aj="softforum";var at;var aq;if(window.location.port){aq=window.location.host;}else{aq=window.location.hostname+":80";}at=forge.md.sha1.create().update(ar+aj).digest().getBytes().substr(0,20);av=forge.md.sha1.create().update(aq+at).digest().getBytes().substr(0,20);am="sosiconnwithsofo";au=forge.seed.createDecryptionCipher;var an=forge.util.hexToBytes(al);var ap=au(av,ao);ap.start(am);ap.update(forge.util.createBuffer(an));ap.finish();var ak=ap.output.getBytes();return ak;}function ac(ao,aw){var aA;var ap;var ay;var au="CBC";var ak="softforum";var am="wXksGwIDAQABo1AwTjAdBgNVHQ4EFgQUnEyOz2mKK/";var ax;var at;var az;ax=forge.md.sha1.create().update(aw+ak).digest().getBytes().substr(0,20);aA=forge.md.sha1.create().update(am+ax).digest().getBytes().substr(0,20);az="0x"+aw[aw.length-1];at=parseInt(az);at=at-1;if(at==-1){at=0;}var aj;while(at){aj=forge.md.sha1.create().update(aA).digest().getBytes().substr(0,20);aA=aj;at--;}ap="sosiconnwithsofo";ay=forge.seed.createDecryptionCipher;var ar=forge.util.hexToBytes(ao);var av=ay(aA,au);av.start(ap);av.update(forge.util.createBuffer(ar));av.finish();var an=av.output.getBytes();for(var aq=0;aq<an.length;aq++){var al=Number(an.charCodeAt(aq)).toString(16);if(al==0){an=an.substr(0,aq);break;}}return an;}function q(ak){var aj;var an="0099BE1D911228E862159E88BBFF9A18B9CF5EB49240E9663EA5821D69024D6259AF19C288916C611821E8B94D8B6F048F942DD12B7B5B7CD209162196FF5ED98BF71A16AB02FDA5B284C52F40819D5451A374137B04B6A74C8E96C1B6F7D0C6C63249CEA787349AEC76CCD4864737A53D62F971ABC187EF67B8168F29968607191075E9996C7E6F22D0408A574FE1036259D90312A9D812AA0B30A1A380698E027D5E35B8F5B28F4E64DF32A86ED0D539C9980ED6FCE8C3BEE48C0D42DE572A107A8F298C758FA27887561B6FD4CF29D2D7D31D34A323DDD30CBA098D0512BD876D7D8BA5EBEC54D7AF97D3A831855FD0A5F7DA6BDD8CA4B47F6257B15D681AC1";var ao="00C169A28F2F88B2BB0CDF813A8B16D1599967ED9127B08160EDECBDC230655F09FCD7A88A5C756176BE8B2249782ACFC56364FF0C527E2A5B70EC0202B014CD0CB9CD673EE759655096AF3A209AB97A392B651F3C06D43868F46C8642FC97E0C7D507F86B503BAFF1DB19FA3F01DF349ECE19F59E13E68CB05FD60CB05D90040321F8E444D389F05B390586B8CF918522336B09A56AEF24EE853A889D2E408CABC8D5BBE6B186CC7A2C0ADA3B5DC5EBB522F4D940C9D087B41C9B65ABDC7E76E125252CE10C157DE92CE7CA35F901CB03F8591B8FD76D4296C9599904AEEDB7F65E66E5CEB6F655963537AE68EF11BE3E14E376930A2996AF2233B851C452DB15";var al;try{al=mtk.rsaes_oaep_decrypt_key(ak,an,ao);aj=forge.util.decode64(al);}catch(am){console.log("[transkey mobile] rsaes_oaep_decrypt_key error : "+am);aj=null;}return aj;}a._setSecureInput=function(aj){T=aj;};a._getSecureInput=function(){return T;};a.checkKeyword=function(ap,al,ak){var ao=W(ap);if(!ao){G.setError(G.ERROR_INCORRECT_PARAM);return-1;}var an;if(ak){an=W(al);if(!an){G.setError(G.ERROR_INCORRECT_PARAM);return-1;}}if(ao.length<8||ao.length>56){G.setError(G.ERROR_INPUT_LENGTH);return-3;}var aj=false;var aq=false;for(var am=0;am<ao.length;am++){var ar=ao.charCodeAt(am);if(ar>47&&ar<58){aj=true;}else{aq=true;}}if(!aj||!aq){G.setError(G.ERROR_PASSWORD_IS_WRONG);return-4;}if(ak){if(ao!=an){G.setError(G.ERROR_CONFIRMED_PASSWORD_DOES_NOT_MATCH);return-5;}}return 0;};a.checkKeyword2=function(aq,al,ak){var ap=W(aq);if(!ap){G.setError(G.ERROR_INCORRECT_PARAM);return-1;}var ao;if(ak){ao=W(al);if(!ao){G.setError(G.ERROR_INCORRECT_PARAM);return-1;}}if(ap.length<10||ap.length>56){G.setError(G.ERROR_INPUT_LENGTH_10);return-1;}var aj=false;var ar=false;var an=false;for(var am=0;am<ap.length;am++){var at=ap.charCodeAt(am);if(at==34||at==39||at==92||at==124){G.setError(G.ERROR_PASSWORD_NOT_ALLOW_CHARACTER);return-2;}if(at>47&&at<58){aj=true;}else{if(at>64&&at<91||at>96&&at<123){ar=true;}else{an=true;}}}if(!aj||!ar||!an){G.setError(G.ERROR_PASSWORD_MIX_DISIT_ALPHA_PUNCT);return-3;}if(ak){if(ap!=ao){G.setError(G.ERROR_CONFIRMED_PASSWORD_DOES_NOT_MATCH);return-4;}}return 0;};a.pbe.getCipherForSEED_PKCS12PBE=function(ak,aq,at){var am;var aj;var ap;var av;var al;var aw=16;var ar=16;var au;var an="CBC";am=forge.util.createBuffer(ak.value[0].value);aj=forge.util.createBuffer(ak.value[1].value);aj=aj.getInt(aj.length()<<3);av=forge.pki.pbe.generatePkcs12Key(aq,am,1,aj,aw);al=forge.pki.pbe.generatePkcs12Key(aq,am,2,aj,ar);if(at){au=forge.seed.createEncryptionCipher;}else{au=forge.seed.createDecryptionCipher;}var ao=au(av,an);ao.start(al);return ao;};a.pbe.getCipherForSEED=function(ak,aq,at){var am;var aj;var ap;var av;var al;var aw=16;var ar=16;var au;var an="CBC";am=ak.value[0].value;aj=g.derToInteger(ak.value[1].value);ap=a.pbe.seedkdf(aq,am,aj);av=ap.substr(0,aw);al=forge.md.sha1.create().update(ap.substr(aw)).digest().getBytes().substr(0,ar);if(at){au=forge.seed.createEncryptionCipher;}else{au=forge.seed.createDecryptionCipher;}var ao=au(av,an);ao.start(al);return ao;};a.pbe.seedkdf=function(ak,al,am){var an;var ao;an=forge.md.sha1.create();an.update(ak);an.update(al);ao=an.digest().getBytes();for(var aj=1;aj<am;++aj){an.start();an.update(ao);ao=an.digest().getBytes();}return ao;};var v={name:"PrivateKeyInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"PrivateKeyInfo.version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"privateKeyOid"},{name:"AlgorithmIdentifier.parameters",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,captureAsn1:"parameters",optional:true}]},{name:"PrivateKeyInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:false,capture:"privateKey"},{name:"PrivateKeyInfo.attributes",tagClass:g.Class.CONTEXT_SPECIFIC,type:0,constructed:true,captureAsn1:"attributes",optional:true}]};var ad={name:"EncryptedPrivateKeyInfo",tagClass:0,type:16,constructed:true,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:0,type:16,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:0,type:6,constructed:false,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:0,type:16,constructed:true,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:0,type:4,constructed:false,capture:"encryptedData"}]};a.privateKeyFromAsn1=function(al){var at={};var ao=[];var ak;if(g.validate(al,v,at,ao)){if(at.parameters){ak=at.parameters;}al=g.fromDer(forge.util.createBuffer(at.privateKey));}var an;if(at.attributes){var aj;var ar;var ap;at.attributes.value.forEach(function(au){aj=g.derToOid(au.value[0].value);ar=au.value[1].value;if(aj==forge.pki.oids.randomNum){ap=forge.util.createBuffer(ar[0].value);++ap.read;ap=ap.getBytes();an=ap;}});}var aq;var am=g.derToOid(at.privateKeyOid);if(am==forge.pki.oids.rsaEncryption){return forge.pki.rsa.privateKeyFromAsn1(al,an);}else{if(am==forge.pki.oids.kcdsa1){return forge.pki.kcdsa.privateKeyFromAsn1(al,ak,an);}}};a.encryptPrivateKeyInfo=function(an,ar,au){if(au.algorithm==="seed"){var ap=forge.random.getBytes(8);var ak=2048;var al=forge.pki.oids["seedCBCWithSHA1"];var am=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,ap),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,g.integerToDer(ak).getBytes())]);var at=an;var aq=a.pbe.getCipherForSEED(am,ar,true);var aj=g.toDer(at).getBytes();aq.update(forge.util.createBuffer(aj));aq.finish();var ao=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[]);ao.value.push(g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(al).getBytes()),am]));ao.value.push(g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,aq.output.getBytes()));return ao;}else{return forge.pki.encryptPrivateKeyInfo(an,ar,au);}};a.decryptPrivateKeyInfo=function(al,ao){var am=null;var ar={};var aq=[];if(!g.validate(al,ad,ar,aq)){var ak=new Error("Cannot read encrypted private key. "+"ASN.1 object is not a supported EncryptedPrivateKeyInfo.");ak.errors=aq;throw ak;}var ap;var aj=g.derToOid(ar.encryptionOid);if(aj==forge.pki.oids["seedCBCWithSHA1"]){ap=a.pbe.getCipherForSEED(ar.encryptionParams,ao,false);}else{if(aj==forge.pki.oids["gpki-seedCBC"]){ap=a.pbe.getCipherForSEED_PKCS12PBE(ar.encryptionParams,ao,false);}else{ap=forge.pki.pbe.getCipher(aj,ar.encryptionParams,ao);}}var an=forge.util.createBuffer(ar.encryptedData);ap.update(an);if(ap.finish()){am=g.fromDer(ap.output);}return am;};var z={name:"SubjectPublicKeyInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"publicKeyOid"},{name:"AlgorithmIdentifier.parameters",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,captureAsn1:"parameters",optional:true}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:g.Class.UNIVERSAL,type:g.Type.BITSTRING,constructed:false,capture:"publicKey"}]};a.publicKeyFromAsn1=function(am){var aj={};var ao=[];var an;var al;if(g.validate(am,z,aj,ao)){al=g.derToOid(aj.publicKeyOid);if(al!==forge.pki.oids.rsaEncryption&&al!==forge.pki.oids.kcdsa1){var ak=new Error("Cannot read public key. Unknown OID.");ak.oid=al;throw ak;}if(aj.parameters){an=aj.parameters;}am=aj.publicKey[0];}if(al===forge.pki.oids.rsaEncryption){return forge.rsa.publicKeyFromAsn1(am);}else{if(al===forge.pki.oids.kcdsa1){return forge.kcdsa.publicKeyFromAsn1(am,an);}else{var ak=new Error("Cannot read public key.");ak.oid=al;throw ak;}}};a.publicKeyToAsn1=a.publicKeyToSubjectPublicKeyInfo=function(aj){if(aj.kcdsa){return forge.pki.kcdsa.publicKeyToAsn1(aj);}else{return forge.pki.rsa.publicKeyToAsn1(aj);}};a.wrapPrivateKey=function(aj,ak){if(aj.kcdsa){return forge.pki.wrapKcdsaPrivateKey(forge.pki.privateKeyToKCDSAPrivateKey(aj),forge.pki.parametersToAsn1(aj),ak);}else{return forge.pki.wrapRsaPrivateKey(forge.pki.privateKeyToAsn1(aj),ak);}};function l(ak,am,aj){var ar={};var ap=[];if(!g.validate(am,aj,ar,ap)){var ao=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not a supported PKCS#7 message.");ao.errors=ao;throw ao;}var aq=g.derToOid(ar.contentType);if(aq!==forge.pki.oids.data){throw new Error("Unsupported PKCS#7 message. "+"Only wrapped ContentType Data supported.");}if(ar.encryptedContent){var an="";if(forge.util.isArray(ar.encryptedContent)){for(var al=0;al<ar.encryptedContent.length;++al){if(ar.encryptedContent[al].type!==g.Type.OCTETSTRING){throw new Error("Malformed PKCS#7 message, expecting encrypted "+"content constructed of only OCTET STRING objects.");}an+=ar.encryptedContent[al].value;}}else{an=ar.encryptedContent;}ak.encryptedContent={algorithm:g.derToOid(ar.encAlgorithm),parameter:forge.util.createBuffer(ar.encParameter.value),content:forge.util.createBuffer(an)};}if(ar.content){var an="";if(forge.util.isArray(ar.content)){for(var al=0;al<ar.content.length;++al){if(ar.content[al].type!==g.Type.OCTETSTRING){throw new Error("Malformed PKCS#7 message, expecting "+"content constructed of only OCTET STRING objects.");}an+=ar.content[al].value;}}else{an=ar.content;}ak.content=forge.util.createBuffer(an);}ak.version=ar.version.charCodeAt(0);ak.rawCapture=ar;return ar;}function C(al){var aj=[];for(var ak=0;ak<al.length;++ak){aj.push(U(al[ak]));}return aj;}function U(an){var am=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,g.integerToDer(an.version).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[forge.pki.distinguishedNameToAsn1({attributes:an.issuer}),g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,forge.util.hexToBytes(an.serialNumber))]),g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(an.digestAlgorithm).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.NULL,false,"")])]);if(an.authenticatedAttributesAsn1){am.value.push(an.authenticatedAttributesAsn1);}am.value.push(g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(an.signatureAlgorithm).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.NULL,false,"")]));am.value.push(g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,an.signature));if(an.unauthenticatedAttributes.length>0){var al=g.create(g.Class.CONTEXT_SPECIFIC,1,true,[]);for(var ak=0;ak<an.unauthenticatedAttributes.length;++ak){var aj=an.unauthenticatedAttributes[ak];al.values.push(p(aj));}am.value.push(al);}return am;}function p(aj){var am;if(aj.type===forge.pki.oids.contentType){am=g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(aj.value).getBytes());}else{if(aj.type===forge.pki.oids.messageDigest){am=g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,aj.value.bytes());}else{if(aj.type===forge.pki.oids.signingTime){var ao=new Date("Jan 1, 1950 00:00:00Z");var an=new Date("Jan 1, 2050 00:00:00Z");var ak=aj.value;if(typeof ak==="string"){var al=Date.parse(ak);if(!isNaN(al)){ak=new Date(al);}else{if(ak.length===13){ak=g.utcTimeToDate(ak);}else{ak=g.generalizedTimeToDate(ak);}}}if(ak>=ao&&ak<an){am=g.create(g.Class.UNIVERSAL,g.Type.UTCTIME,false,g.dateToUtcTime(ak));}else{am=g.create(g.Class.UNIVERSAL,g.Type.GENERALIZEDTIME,false,g.dateToGeneralizedTime(ak));}}}}return g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(aj.type).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SET,true,[am])]);}a.createSignedData=function(){var al=null;al={base:forge.pkcs7.createSignedData(),fromAsn1:function(ao){l(al.base,ao,forge.pkcs7.asn1.signedDataValidator);al.base.certificates=[];al.base.crls=[];al.base.digestAlgorithmIdentifiers=[];al.base.contentInfo=null;al.base.signerInfos=[];var an=al.base.rawCapture.certificates.value;for(var am=0;am<an.length;++am){al.base.certificates.push(forge.pki.certificateFromAsn1(an[am]));}al.base.signerInfos=al.base.rawCapture.signerInfos;al.base.digestAlgorithmIdentifiers=al.base.rawCapture.digestAlgorithms.value;if(al.base.rawCapture.content){al.base.content=forge.util.createBuffer(al.base.rawCapture.content.value[0].value);}else{al.base.content=null;}},toAsn1:function(ar){if(!al.base.contentInfo){al.base.sign();}if(ar&A){if(!al.base.signerInfos){return null;}var av={};var at=[];if(!g.validate(al.base.signerInfos[0],E,av,at)){var an=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not an PKCS#7 SignerInfo.");an.errors=at;throw an;}var am=av.signature;if(typeof am=="object"){return g.toDer(am[0]).getBytes();}else{return am;}}var aq=[];for(var ap=0;ap<al.base.certificates.length;++ap){aq.push(forge.pki.certificateToAsn1(al.base.certificates[ap]));}var ao=[];if(ar&ah||ar&I){al.base.contentInfo.value.splice(1,1);}var au=g.create(g.Class.CONTEXT_SPECIFIC,0,true,[g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,g.integerToDer(al.base.version).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SET,true,al.base.digestAlgorithmIdentifiers),al.base.contentInfo])]);if(aq.length>0){au.value[0].value.push(g.create(g.Class.CONTEXT_SPECIFIC,0,true,aq));}if(ao.length>0){au.value[0].value.push(g.create(g.Class.CONTEXT_SPECIFIC,1,true,ao));}au.value[0].value.push(g.create(g.Class.UNIVERSAL,g.Type.SET,true,al.base.signerInfos));if(ar&s){return au.value[0];}else{return g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(al.base.type).getBytes()),au]);}},addSigner:function(am){var ar=am.issuer;var ap=am.serialNumber;if(am.certificate){var aq=am.certificate;if(typeof aq==="string"){aq=forge.pki.certificateFromPem(aq);}ar=aq.issuer.attributes;ap=aq.serialNumber;}var ay=am.key;if(!ay){throw new Error("Could not add PKCS#7 signer; no private key specified.");}if(typeof ay==="string"){ay=forge.pki.privateKeyFromPem(ay);}var au=am.digestAlgorithm||forge.pki.oids.sha1;switch(au){case forge.pki.oids.sha1:case forge.pki.oids.sha256:case forge.pki.oids.sha384:case forge.pki.oids.sha512:case forge.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+au);}var aw=am.authenticatedAttributes||[];if(aw.length>0){var ax=false;var az=false;for(var ao=0;ao<aw.length;++ao){var at=aw[ao];if(!ax&&at.type===forge.pki.oids.contentType){ax=true;if(az){break;}continue;}if(!az&&at.type===forge.pki.oids.messageDigest){az=true;if(ax){break;}continue;}}if(!ax||!az){throw new Error("Invalid signer.authenticatedAttributes. If "+"signer.authenticatedAttributes is specified, then it must "+"contain at least two attributes, PKCS #9 content-type and "+"PKCS #9 message-digest.");}}var an;var av;if(am.certificate.publicKeyOid==forge.pki.oids.kcdsa1){switch(au){case forge.pki.oids.has160:an=forge.pki.oids.kcdsa1WithHAS160;break;case forge.pki.oids.sha1:an=forge.pki.oids.kcdsa1WithSHA1;break;case forge.pki.oids.sha256:an=forge.pki.oids.kcdsa1WithSHA256;break;default:throw new Error("Could not add PKCS#7 signer; unknown message signature algorithm: kcdsa,"+au);}av=am.certificate.publicKey.y;}else{an=forge.pki.oids.rsaEncryption;}al.base.signers.push({key:ay,version:1,issuer:ar,serialNumber:ap,digestAlgorithm:au,signatureAlgorithm:an,publicKeyOid:am.certificate.publicKeyOid,publicKey:av,signature:null,authenticatedAttributes:aw,unauthenticatedAttributes:[]});},addCertificate:function(am){al.base.addCertificate(am);},getCertificate:function(){return al.base.certificates;},sign:function(){if(typeof al.base.content!=="object"||al.base.contentInfo===null){al.base.contentInfo=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(forge.pki.oids.data).getBytes())]);if("content" in al.base){var an;if(al.base.content instanceof forge.util.ByteBuffer){an=al.base.content.bytes();}else{if(typeof al.base.content==="string"){an=forge.util.encodeUtf8(al.base.content);}}al.base.contentInfo.value.push(g.create(g.Class.CONTEXT_SPECIFIC,0,true,[g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,an)]));}}if(al.base.signers.length===0){return;}var am=ak();aj(am);},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.");},setContent:function(am){al.base.content=am;},setContentDigest:function(am){al.base.digest=am;}};return al;function ak(){var am={};if(al.base.digestAlgorithmIdentifiers.length>0){var ao=g.derToOid(al.base.digestAlgorithmIdentifiers[0].value[0].value);am[ao]=forge.md[forge.pki.oids[ao]].create();for(var an=0;an<al.base.signers.length;++an){var ap=al.base.signers[an];if(ap.authenticatedAttributes.length===0){ap.md=am[ao];}else{ap.md=forge.md[forge.pki.oids[ao]].create();}}}else{for(var an=0;an<al.base.signers.length;++an){var ap=al.base.signers[an];var ao=ap.digestAlgorithm;if(!(ao in am)){am[ao]=forge.md[forge.pki.oids[ao]].create();}if(ap.authenticatedAttributes.length===0){ap.md=am[ao];}else{ap.md=forge.md[forge.pki.oids[ao]].create();}}al.base.digestAlgorithmIdentifiers=[];for(var ao in am){al.base.digestAlgorithmIdentifiers.push(g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(ao).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.NULL,false,"")]));}}return am;}function aj(ay){if(al.base.contentInfo.value.length<2){throw new Error("Could not sign PKCS#7 message; there is no content to sign.");}var ax=g.derToOid(al.base.contentInfo.value[0].value);if(typeof al.base.digest==="undefined"||al.base.digest==null){var au=al.base.contentInfo.value[1];au=au.value[0];var az=g.toDer(au);az.getByte();g.getBerValueLength(az);az=az.getBytes();for(var aq in ay){ay[aq].start().update(az);}}var an=new Date;for(var ar=0;ar<al.base.signers.length;++ar){var am=al.base.signers[ar];if(am.authenticatedAttributes.length===0){if(ax!==forge.pki.oids.data){throw new Error("Invalid signer; authenticatedAttributes must be present "+"when the ContentInfo content type is not PKCS#7 Data.");}}else{am.authenticatedAttributesAsn1=g.create(g.Class.CONTEXT_SPECIFIC,0,true,[]);var aw=g.create(g.Class.UNIVERSAL,g.Type.SET,true,[]);for(var av=0;av<am.authenticatedAttributes.length;++av){var at=am.authenticatedAttributes[av];if(at.type===forge.pki.oids.messageDigest){if(typeof al.base.digest==="undefined"||al.base.digest==null){at.value=ay[am.digestAlgorithm].digest();}else{at.value=al.base.digest;}}else{if(at.type===forge.pki.oids.signingTime){if(!at.value){at.value=an;}}}aw.value.push(p(at));am.authenticatedAttributesAsn1.value.push(p(at));}az=g.toDer(aw).getBytes();am.md.start().update(az);}if(am.publicKeyOid==forge.pki.oids.kcdsa1){var ao=am.key.sign(am.md.algorithm,az,am.publicKey);am.signature=g.toDer(ao).getBytes();}else{am.signature=am.key.sign(am.md,"RSASSA-PKCS1-V1_5");}}var ap=C(al.base.signers);al.base.signerInfos=al.base.signerInfos.concat(ap);}};a.createUCPIDSignedData=function(){var al=null;al={base:forge.pkcs7.createSignedData(),fromAsn1:function(ao){l(al.base,ao,forge.pkcs7.asn1.signedUcpidValidator);al.base.certificates=[];al.base.crls=[];al.base.digestAlgorithmIdentifiers=[];al.base.contentInfo=null;al.base.signerInfos=[];var an=al.base.rawCapture.certificates.value;for(var am=0;am<an.length;++am){al.base.certificates.push(forge.pki.certificateFromAsn1(an[am]));}al.base.signerInfos=al.base.rawCapture.signerInfos;al.base.digestAlgorithmIdentifiers=al.base.rawCapture.digestAlgorithms.value;if(al.base.rawCapture.content){al.base.content=forge.util.createBuffer(al.base.rawCapture.content.value[0].value);}else{al.base.content=null;}},toAsn1:function(ar){if(!al.base.contentInfo){al.base.sign();}if(ar&A){if(!al.base.signerInfos){return null;}var av={};var at=[];if(!g.validate(al.base.signerInfos[0],E,av,at)){var an=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not an PKCS#7 SignerInfo.");an.errors=at;throw an;}var am=av.signature;if(typeof am=="object"){return g.toDer(am[0]).getBytes();}else{return am;}}var aq=[];for(var ap=0;ap<al.base.certificates.length;++ap){aq.push(forge.pki.certificateToAsn1(al.base.certificates[ap]));}var ao=[];if(ar&ah){al.base.contentInfo.value.splice(1,1);}var au=g.create(g.Class.CONTEXT_SPECIFIC,0,true,[g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,g.integerToDer(al.base.version).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SET,true,al.base.digestAlgorithmIdentifiers),al.base.contentInfo])]);if(aq.length>0){au.value[0].value.push(g.create(g.Class.CONTEXT_SPECIFIC,0,true,aq));}if(ao.length>0){au.value[0].value.push(g.create(g.Class.CONTEXT_SPECIFIC,1,true,ao));}au.value[0].value.push(g.create(g.Class.UNIVERSAL,g.Type.SET,true,al.base.signerInfos));if(ar&s){return au.value[0];}else{return g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(al.base.type).getBytes()),au]);}},addSigner:function(am){var ar=am.issuer;var ap=am.serialNumber;if(am.certificate){var aq=am.certificate;if(typeof aq==="string"){aq=forge.pki.certificateFromPem(aq);}ar=aq.issuer.attributes;ap=aq.serialNumber;}var ay=am.key;if(!ay){throw new Error("Could not add PKCS#7 signer; no private key specified.");}if(typeof ay==="string"){ay=forge.pki.privateKeyFromPem(ay);}var au=am.digestAlgorithm||forge.pki.oids.sha1;switch(au){case forge.pki.oids.sha1:case forge.pki.oids.sha256:case forge.pki.oids.sha384:case forge.pki.oids.sha512:case forge.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+au);}var aw=am.authenticatedAttributes||[];if(aw.length>0){var ax=false;var az=false;for(var ao=0;ao<aw.length;++ao){var at=aw[ao];if(!ax&&at.type===forge.pki.oids.contentType){ax=true;if(az){break;}continue;}if(!az&&at.type===forge.pki.oids.messageDigest){az=true;if(ax){break;}continue;}}if(!ax||!az){throw new Error("Invalid signer.authenticatedAttributes. If "+"signer.authenticatedAttributes is specified, then it must "+"contain at least two attributes, PKCS #9 content-type and "+"PKCS #9 message-digest.");}}var an;var av;if(am.certificate.publicKeyOid==forge.pki.oids.kcdsa1){switch(au){case forge.pki.oids.has160:an=forge.pki.oids.kcdsa1WithHAS160;break;case forge.pki.oids.sha1:an=forge.pki.oids.kcdsa1WithSHA1;break;case forge.pki.oids.sha256:an=forge.pki.oids.kcdsa1WithSHA256;break;default:throw new Error("Could not add PKCS#7 signer; unknown message signature algorithm: kcdsa,"+au);}av=am.certificate.publicKey.y;}else{an=forge.pki.oids.rsaEncryption;}al.base.signers.push({key:ay,version:1,issuer:ar,serialNumber:ap,digestAlgorithm:au,signatureAlgorithm:an,publicKeyOid:am.certificate.publicKeyOid,publicKey:av,signature:null,authenticatedAttributes:aw,unauthenticatedAttributes:[]});},addCertificate:function(am){al.base.addCertificate(am);},getCertificate:function(){return al.base.certificates;},sign:function(){var ar=al.base.content;var aE;var aC=g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,g.integerToDer(ar.version).getBytes());aE=forge.util.decode64url(ar.ucpidNonce.getBytes());var au=g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,aE);var ay=g.create(g.Class.UNIVERSAL,g.Type.UTF8,false,ar.userAgreement.bytes());var az=g.create(g.Class.UNIVERSAL,g.Type.BITSTRING,false,String.fromCharCode(ar.unUsed)+String.fromCharCode(ar.userAgreeInfo));var aq=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[ay,az]);aE=forge.util.encodeUtf8(ar.moduleName);aE=forge.util.decodeUtf8(ar.moduleName);var aA=g.create(g.Class.UNIVERSAL,g.Type.UTF8,false,aE);aE=forge.util.encodeUtf8(ar.moduleVendorName);aE=forge.util.decodeUtf8(ar.moduleVendorName);var aD=g.create(g.Class.UNIVERSAL,g.Type.UTF8,false,aE);var aB=g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,g.integerToDer(ar.major).getBytes());var an=g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,g.integerToDer(ar.minor).getBytes());var ax=g.create(g.Class.CONTEXT_SPECIFIC,0,true,[g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,g.integerToDer(ar.build).getBytes())]);var at=g.create(g.Class.CONTEXT_SPECIFIC,1,true,[g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,g.integerToDer(ar.revision).getBytes())]);var ao=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[aB,an,ax,at]);var aw=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[aA,aD,ao]);aE=forge.util.encodeUtf8(ar.ispUrlInfo);aE=forge.util.decodeUtf8(ar.ispUrlInfo);var aG=g.create(g.Class.UNIVERSAL,g.Type.UTF8,false,aE);var av=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[aC,au,aq,aw,aG]);var am=g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,true,[av]);var ap=g.create(g.Class.CONTEXT_SPECIFIC,0,true,[am]);al.base.contentInfo=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(forge.pki.oids.data).getBytes()),ap]);if(al.base.signers.length===0){return;}var aF=ak();aj(aF);},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.");},setContent:function(am){al.base.content=am;},setNameContent:function(am,an){al.base.content[am]=an;},setContentDigest:function(am){al.base.digest=am;}};return al;function ak(){var am={};if(al.base.digestAlgorithmIdentifiers.length>0){var ao=g.derToOid(al.base.digestAlgorithmIdentifiers[0].value[0].value);am[ao]=forge.md[forge.pki.oids[ao]].create();for(var an=0;an<al.base.signers.length;++an){var ap=al.base.signers[an];if(ap.authenticatedAttributes.length===0){ap.md=am[ao];}else{ap.md=forge.md[forge.pki.oids[ao]].create();}}}else{for(var an=0;an<al.base.signers.length;++an){var ap=al.base.signers[an];var ao=ap.digestAlgorithm;if(!(ao in am)){am[ao]=forge.md[forge.pki.oids[ao]].create();}if(ap.authenticatedAttributes.length===0){ap.md=am[ao];}else{ap.md=forge.md[forge.pki.oids[ao]].create();}}al.base.digestAlgorithmIdentifiers=[];for(var ao in am){al.base.digestAlgorithmIdentifiers.push(g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(ao).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.NULL,false,"")]));}}return am;}function aj(ay){if(al.base.contentInfo.value.length<2){throw new Error("Could not sign PKCS#7 message; there is no content to sign.");}var ax=g.derToOid(al.base.contentInfo.value[0].value);if(typeof al.base.digest==="undefined"||al.base.digest==null){var au=al.base.contentInfo.value[1];au=au.value[0];var az=g.toDer(au);az.getByte();g.getBerValueLength(az);az=az.getBytes();for(var aq in ay){ay[aq].start().update(az);}}var an=new Date;for(var ar=0;ar<al.base.signers.length;++ar){var am=al.base.signers[ar];if(am.authenticatedAttributes.length===0){if(ax!==forge.pki.oids.data){throw new Error("Invalid signer; authenticatedAttributes must be present "+"when the ContentInfo content type is not PKCS#7 Data.");}}else{am.authenticatedAttributesAsn1=g.create(g.Class.CONTEXT_SPECIFIC,0,true,[]);var aw=g.create(g.Class.UNIVERSAL,g.Type.SET,true,[]);for(var av=0;av<am.authenticatedAttributes.length;++av){var at=am.authenticatedAttributes[av];if(at.type===forge.pki.oids.messageDigest){if(typeof al.base.digest==="undefined"||al.base.digest==null){at.value=ay[am.digestAlgorithm].digest();}else{at.value=al.base.digest;}}else{if(at.type===forge.pki.oids.signingTime){if(!at.value){at.value=an;}}}aw.value.push(p(at));am.authenticatedAttributesAsn1.value.push(p(at));}az=g.toDer(aw).getBytes();am.md.start().update(az);}if(am.publicKeyOid==forge.pki.oids.kcdsa1){var ao=am.key.sign(am.md.algorithm,az,am.publicKey);am.signature=g.toDer(ao).getBytes();}else{am.signature=am.key.sign(am.md,"RSASSA-PKCS1-V1_5");}}var ap=C(al.base.signers);al.base.signerInfos=al.base.signerInfos.concat(ap);}};a.createEnvelopedData=function(){var aj=null;aj={base:forge.pkcs7.createEnvelopedData(),fromAsn1:function(al){var ak=l(aj.base,al,forge.pkcs7.asn1.envelopedDataValidator);if(ak.version.charCodeAt(0)==0){aj.base.recipients=Q(ak.recipientInfos.value);}else{aj.base.recipients.push(d(ak.recipientInfos.value[0]));}},toAsn1:function(){if(aj.base.version==0){return aj.base.toAsn1();}else{return g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(aj.base.type).getBytes()),g.create(g.Class.CONTEXT_SPECIFIC,0,true,[g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,g.integerToDer(aj.base.version).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SET,true,[g.create(g.Class.CONTEXT_SPECIFIC,2,true,[g.create(g.Class.UNIVERSAL,g.Type.INTEGER,false,g.integerToDer(4).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,"")]),g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(aj.base.recipients[0].encryptedContent.algorithm).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.NULL,false,"")]),g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,aj.base.recipients[0].encryptedContent.content)])]),g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(forge.pki.oids.data).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(aj.base.encryptedContent.algorithm).getBytes()),g.create(g.Class.UNIVERSAL,g.Type.OCTETSTRING,false,aj.base.encryptedContent.parameter.getBytes())]),g.create(g.Class.CONTEXT_SPECIFIC,0,false,aj.base.encryptedContent.content.getBytes())])])])]);}},findRecipient:function(ak){if(typeof ak==="number"){return aj.base.recipients[ak];}else{return aj.base.findRecipient(ak);}},decrypt:function(aq,ar){if(aj.base.version==0){if(aj.base.encryptedContent.key===undefined&&aq!==undefined&&ar!==undefined){switch(aq.encryptedContent.algorithm){case forge.pki.oids.rsaEncryption:case forge.pki.oids.desCBC:var av=ar.decrypt(aq.encryptedContent.content);aj.base.encryptedContent.key=forge.util.createBuffer(av);break;default:throw new Error("Unsupported asymmetric cipher, "+"OID "+aq.encryptedContent.algorithm);}}}else{switch(aq.encryptedContent.algorithm){case forge.pki.oids.seedCBC:var au=forge.md.md5.create();au.update(ar);var an=forge.util.createBuffer(au.digest().getBytes());var al=forge.util.createBuffer();var at=16;for(var am=0;am<at;am++){al.putByte(0);}var ak=al.getBytes();var ap=forge.seed.createDecryptionCipher;var ao=ap(an,"CBC");ao.start(ak);ao.update(forge.util.createBuffer(aq.encryptedContent.content));if(!ao.finish()){throw new Error("Symmetric encryption failed.");}aj.base.encryptedContent.key=forge.util.createBuffer(ao.output);break;default:throw new Error("Unsupported asymmetric cipher, "+"OID "+aq.encryptedContent.algorithm);}}b(aj.base);},addRecipient:function(ak){aj.base.addRecipient(ak);},encrypt:function(al){var av=forge.pki.oids["seedCBC"];var ar="CBC";var ak=16;var ax=16;var at=forge.seed.createEncryptionCipher;var az=forge.util.createBuffer(forge.random.getBytes(ak));aj.base.encryptedContent.algorithm=av;aj.base.encryptedContent.key=az;aj.base.encryptedContent.parameter=forge.util.createBuffer(forge.random.getBytes(ax));var au=at(az,ar);au.start(aj.base.encryptedContent.parameter.copy());au.update(aj.base.content);if(!au.finish()){throw new Error("Symmetric encryption failed.");}aj.base.encryptedContent.content=au.output;if(al){var ay=forge.md.md5.create();ay.update(al);var aq=forge.util.createBuffer(ay.digest().getBytes());var ao=forge.util.createBuffer();for(var an=0;an<ax;an++){ao.putByte(0);}var am=ao.getBytes();var ap=at(aq,ar);ap.start(am);ap.update(aj.base.encryptedContent.key);if(!ap.finish()){throw new Error("Symmetric encryption failed.");}aj.base.version=2;aj.base.recipients.push({encryptedContent:{algorithm:av,content:ap.output.getBytes()}});}else{for(var an=0;an<aj.base.recipients.length;++an){var aw=aj.base.recipients[an];if(aw.encryptedContent.content!==undefined){continue;}switch(aw.encryptedContent.algorithm){case forge.pki.oids.rsaEncryption:aw.encryptedContent.content=aw.encryptedContent.key.encrypt(aj.base.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+aw.encryptedContent.algorithm);}}}},setContent:function(ak){aj.base.content=ak;},getContent:function(){return aj.base.content;}};return aj;};var L={name:"RecipientInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:g.Class.UNIVERSAL,constructed:false,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:false,capture:"encKey"}]};var af={name:"RecipientInfo",tagClass:g.Class.CONTEXT_SPECIFIC,type:2,constructed:true,value:[{name:"RecipientInfo.version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"version"},{name:"RecipientInfo.identifier",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.identifier.keyIdentifier",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:false,capture:"keyIdentifier"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:g.Class.UNIVERSAL,constructed:false,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:false,capture:"encKey"}]};function r(al){var aj={};var am=[];if(!g.validate(al,L,aj,am)){var ak=new Error("Cannot read PKCS#7 RecipientInfo. "+"ASN.1 object is not an PKCS#7 RecipientInfo.");ak.errors=am;throw ak;}return{version:aj.version.charCodeAt(0),issuer:forge.pki.RDNAttributesAsArray(aj.issuer),serialNumber:forge.util.createBuffer(aj.serial).toHex(),encryptedContent:{algorithm:g.derToOid(aj.encAlgorithm),parameter:aj.encParameter.value,content:aj.encKey}};}function d(al){var aj={};var am=[];if(!g.validate(al,af,aj,am)){var ak=new Error("Cannot read PKCS#7 RecipientInfo. "+"ASN.1 object is not an PKCS#7 RecipientInfo.");ak.errors=am;throw ak;}return{version:aj.version.charCodeAt(0),encryptedContent:{algorithm:g.derToOid(aj.encAlgorithm),parameter:aj.encParameter.value,content:aj.encKey}};}function Q(al){var aj=[];for(var ak=0;ak<al.length;++ak){aj.push(r(al[ak]));}return aj;}function b(al){if(al.encryptedContent.key===undefined){throw new Error("Symmetric key not available.");}if(al.content===undefined){var aj;switch(al.encryptedContent.algorithm){case forge.pki.oids["aes128-CBC"]:case forge.pki.oids["aes192-CBC"]:case forge.pki.oids["aes256-CBC"]:aj=forge.aes.createDecryptionCipher(al.encryptedContent.key);break;case forge.pki.oids["desCBC"]:case forge.pki.oids["des-EDE3-CBC"]:aj=forge.des.createDecryptionCipher(al.encryptedContent.key);break;case forge.pki.oids["seedCBC"]:var ak=forge.seed.createDecryptionCipher;aj=ak(al.encryptedContent.key,"CBC");break;default:throw new Error("Unsupported symmetric cipher, OID "+al.encryptedContent.algorithm);}aj.start(al.encryptedContent.parameter);aj.update(al.encryptedContent.content);if(!aj.finish()){throw new Error("Symmetric decryption failed.");}al.content=aj.output;}}a.checkPrivateKey=function(am,aj,al){var ak;if(al&ai){ak=aj;}else{ak=W(aj);}if(!ak){G.setError(G.ERROR_INCORRECT_PARAM);return-1;}try{if(!a.decryptPrivateKeyInfo(am,ak)){G.setError(G.ERROR_VERIFYPASSWORD);return-2;}}catch(an){G.setError(G.ERROR_VERIFYPASSWORD,an);return-3;}return 0;};a.changeEncryptPrivateKey=function(aq,am,an,aj){var ar=null;var ak=null;var ap;if(aj&ai){ap=am;}else{ap=W(am);}if(!ap){G.setError(G.ERROR_INCORRECT_PARAM);return null;}var ao;if(aj&ai){ao=an;}else{ao=W(an);}if(!ao){G.setError(G.ERROR_INCORRECT_PARAM);return null;}try{ar=a.decryptPrivateKeyInfo(aq,ap);if(!ar){G.setError(G.ERROR_DECRYPT_PRIKEY);return null;}}catch(al){G.setError(G.ERROR_DECRYPT_PRIKEY,al);return null;}try{var aj={};aj.algorithm="seed";ak=a.encryptPrivateKeyInfo(ar,ao,aj);if(!ak){G.setError(G.ERROR_ENCRYPT_PRIKEY);return null;}}catch(al){G.setError(G.ERROR_ENCRYPT_PRIKEY,al);return null;}return ak;};var y=256;var n=512;var M=1024;var B=2048;var ah=4096;var I=8192;var s=65536;var A=8388608;a.signDataCMS=function(ar,aq,aE,an,ay,aj,ax){aj=aj||"utf8";if(aj=="utf-8"){aj="utf8";}var ap;if(ax&ai){ap=aE;}else{ap=W(aE);}if(!ap){G.setError(G.ERROR_INCORRECT_PARAM);return null;}var aH;try{var aB=a.decryptPrivateKeyInfo(aq,ap);if(!aB){G.setError(G.ERROR_INCORRECT_PASSWORD);return null;}aH=a.privateKeyFromAsn1(aB);}catch(aC){G.setError(G.ERROR_INCORRECT_PASSWORD,aC);return null;}try{var aF=sofo.pki.createSignedData();var am;if(ar.md.algorithm=="sha256"){am=forge.pki.oids.sha256;}else{am=forge.pki.oids.sha1;}if(ay&B){var aA=an.split("|");var aG=aA[0];var aD=aA[1];var at=aA[2];var aw=function(aJ){var aI=g.Type.UTF8;if(aI===g.Type.UTF8){aJ=forge.util.encodeUtf8(aJ);}return g.create(g.Class.UNIVERSAL,aI,false,aJ);};var ak=function(aJ){var aI;if(aJ.lastIndexOf("Z")===aJ.length-1){aI=aJ;}else{aI=aJ+"Z";}return g.create(g.Class.UNIVERSAL,g.Type.UTCTIME,false,g.dateToUtcTime(aI));};var az=g.toDer(aw(aG)).getBytes()+g.toDer(ak(aD)).getBytes();var av=forge.util.hexToBytes(at);an=av;aF.setContentDigest(forge.util.createBuffer(av));}if(ay&I){var al=forge.util.hexToBytes(an);var ao=an.length;if(am==forge.pki.oids.sha256&&ao!=64||am==forge.pki.oids.sha1&&ao!=40){G.setError(G.ERROR_INCORRECT_PARAM);return null;}aF.setContentDigest(forge.util.createBuffer(al));}if(aj=="euc-kr"){aF.setContent(sofo.utils.ucs2_to_ksc5601(an));}else{aF.setContent(forge.util.createBuffer(an,aj));}aF.addCertificate(ar);if(ay&n&&!(ay&A)){aF.addSigner({key:aH.key,certificate:ar,digestAlgorithm:am,authenticatedAttributes:[{type:forge.pki.oids.contentType,value:forge.pki.oids.data},{type:forge.pki.oids.signingTime,value:new Date},{type:forge.pki.oids.messageDigest}]});}else{if(ay&I&&!(ay&A)){aF.addSigner({key:aH.key,certificate:ar,digestAlgorithm:am,authenticatedAttributes:[{type:forge.pki.oids.contentType,value:forge.pki.oids.data},{type:forge.pki.oids.messageDigest}]});}else{aF.addSigner({key:aH.key,certificate:ar,digestAlgorithm:am});}}aF.sign();var au=aF.toAsn1(ay);if(ay&A){if(ay&y){return forge.util.encode64(au);}else{return forge.util.bytesToHex(au);}}else{if(ay&y){if(ay&B){return forge.util.encode64(g.toDer(au).getBytes()+az);}else{return forge.util.encode64(g.toDer(au).getBytes());}}else{if(ay&B){return forge.util.bytesToHex(g.toDer(au).getBytes()+az);}else{return forge.util.bytesToHex(g.toDer(au).getBytes());}}}}catch(aC){G.setError(G.ERROR_CREATE_SIGNDATA,aC);return null;}};a.signDataUCPID=function(at,ar,aM,aI,aD,aC,ay,an,ax){an=an||"utf8";if(an=="utf-8"){an="utf8";}var aq;if(ax&ai){aq=aM;}else{aq=W(aM);}if(!aq){G.setError(G.ERROR_INCORRECT_PARAM);return null;}var aP;try{var aG=a.decryptPrivateKeyInfo(ar,aq);if(!aG){G.setError(G.ERROR_INCORRECT_PASSWORD);return null;}aP=a.privateKeyFromAsn1(aG);}catch(aK){G.setError(G.ERROR_INCORRECT_PASSWORD,aK);return null;}var aL=null;try{aL=S(at,aI);if(aL==null){G.setError(G.ERROR_USE_CERT_FAIL,aK);return null;}}catch(aK){console.log("check ucpid oid : "+aK);G.setError(G.ERROR_USE_CERT_FAIL,aK);return null;}var aJ;var av,aQ;var aO;var aF;var am,aA,au,ap,aw;var aN;var ao;var aj;var az;var aB;var al=new Array;var aE=new Array;var ak=new Array;try{aJ=JSON.parse(aD);for(var aH=0;aH<aJ.length;aH++){try{aN=0;al[aH]=aJ[aH].orgCode;av=aJ[aH].consentInfo;aQ=JSON.stringify(av);aO=aJ[aH].ucpidRequestInfo;aF=aO.userAgreeInfo;am=aF.realName;aA=aF.gender;au=aF.nationalInfo;ap=aF.birthDate;aw=aF.ci;if(am){aN|=128;}if(aA){aN|=64;}if(au){aN|=32;}if(ap){aN|=16;}if(aw){aN|=8;}ao=aO.userAgreement;aj=aO.ispUrlInfo;az=aO.ucpidNonce;}catch(aK){console.log("jsonArray parsing error : "+aK);G.setError(G.ERROR_INCORRECT_PARAM,aK);return null;}try{aE[aH]=a.genSignedConsent(at,aP,an,aQ,ay);}catch(aK){console.log("genSignedConsent error : "+aK);G.setError(G.ERROR_CREATE_UCPID_SIGNDATA,aK);return null;}try{ak[aH]=a.ucpidSignDataCMS(at,aP,an,aC,ao,aN,aj,az,ay);}catch(aK){console.log("ucpidSignDataCMS error : "+aK);G.setError(G.ERROR_CREATE_UCPID_SIGNDATA,aK);return null;}}try{aB=a.makeJsonStringResultSignData(al,aE,ak,aL);}catch(aK){console.log("makeJsonStringResultSignData error : "+aK);G.setError(G.ERROR_CREATE_UCPID_SIGNDATA,aK);return null;}}catch(aK){console.log("makeUCPIDSignedData error : "+aK);G.setError(G.ERROR_CREATE_UCPID_SIGNDATA,aK);return null;}return aB;};a.genSignedConsent=function(ap,at,ak,ao,am){var ar;try{var aq=sofo.pki.createSignedData();var aj;if(ap.md.algorithm=="sha256"){aj=forge.pki.oids.sha256;}else{aj=forge.pki.oids.sha1;}if(ak=="euc-kr"){aq.setContent(sofo.utils.ucs2_to_ksc5601(ao));}else{aq.setContent(forge.util.createBuffer(ao,ak));}aq.addCertificate(ap);if(am&n&&!(am&A)){aq.addSigner({key:at.key,certificate:ap,digestAlgorithm:aj,authenticatedAttributes:[{type:forge.pki.oids.contentType,value:forge.pki.oids.data},{type:forge.pki.oids.signingTime,value:new Date},{type:forge.pki.oids.messageDigest}]});}else{aq.addSigner({key:at.key,certificate:ap,digestAlgorithm:aj});}aq.sign();var al=aq.toAsn1(am);if(am&y){ar=forge.util.encode64(g.toDer(al).getBytes());}else{if(am&M){ar=forge.util.encode64url(g.toDer(al).getBytes());}else{ar=forge.util.bytesToHex(g.toDer(al).getBytes());}}}catch(an){console.log("pki.genSignedConsent : "+an);}return ar;};a.ucpidSignDataCMS=function(aq,aD,an,av,ao,aC,ak,at,ar){var am;try{var aB=av.mUcpidModuleVersion.split(".");var aw=parseInt(aB[0]);var al=parseInt(aB[1]);var au=parseInt(aB[2]);var ap=parseInt(aB[3]);var aj=sofo.pki.createUCPIDSignedData();if(aq.md.algorithm=="sha256"){alg=forge.pki.oids.sha256;}else{alg=forge.pki.oids.sha1;}aj.base.content={};if(an=="euc-kr"){aj.setNameContent("moduleName",sofo.utils.ucs2_to_ksc5601(av.mUcpidModuleName));aj.setNameContent("moduleVendorName",sofo.utils.ucs2_to_ksc5601(av.mUcpidModuleVendorName));aj.setNameContent("userAgreement",sofo.utils.ucs2_to_ksc5601(ao));aj.setNameContent("ucpidNonce",sofo.utils.ucs2_to_ksc5601(at));aj.setNameContent("ispUrlInfo",sofo.utils.ucs2_to_ksc5601(ak));}else{aj.setNameContent("moduleName",forge.util.createBuffer(av.mUcpidModuleName,an));aj.setNameContent("moduleVendorName",forge.util.createBuffer(av.mUcpidModuleVendorName,an));aj.setNameContent("userAgreement",forge.util.createBuffer(ao,an));aj.setNameContent("ucpidNonce",forge.util.createBuffer(at,an));aj.setNameContent("ispUrlInfo",forge.util.createBuffer(ak,an));}aj.setNameContent("version",av.mUcpidVersion);aj.setNameContent("major",aw);aj.setNameContent("minor",al);aj.setNameContent("build",au);aj.setNameContent("revision",ap);var az=0;for(var ax=0;ax<8;ax++){if(!(aC>>ax&1)){az++;}else{break;}}aj.setNameContent("unUsed",az);aj.setNameContent("userAgreeInfo",aC);aj.addCertificate(aq);if(ar&n&&!(ar&A)){aj.addSigner({key:aD.key,certificate:aq,digestAlgorithm:alg,authenticatedAttributes:[{type:forge.pki.oids.contentType,value:forge.pki.oids.data},{type:forge.pki.oids.signingTime,value:new Date},{type:forge.pki.oids.messageDigest}]});}else{aj.addSigner({key:aD.key,certificate:aq,digestAlgorithm:alg});}aj.sign();var ay=aj.toAsn1(ar);if(ar&y){am=forge.util.encode64(g.toDer(ay).getBytes());}else{if(ar&M){am=forge.util.encode64url(g.toDer(ay).getBytes());}else{am=forge.util.bytesToHex(g.toDer(ay).getBytes());}}}catch(aA){console.log("pki.ucpidSignDataCMS : "+aA);}return am;};a.makeJsonStringResultSignData=function(an,al,aj,ak){var ar=new Object;var am=new Array;try{for(var ao=0;ao<an.length;ao++){var ap=new Object;ap.orgCode=an[ao];ap.signedPersonInfoReq=aj[ao];ap.signedConsent=al[ao];am.push(ap);}ar.signedDataList=am;ar.caOrg=ak;}catch(aq){console.log("pki.makeJsonStringResultSignData : "+aq);}return JSON.stringify(ar);};var t=134217728;a.signDataAddition=function(az,ax,aN,aw,aD,aj){aj=aj||"utf8";if(aj=="utf-8"){aj="utf8";}var av=W(aN);if(!av){G.setError(G.ERROR_INCORRECT_PARAM);return null;}var aQ;try{var aG=a.decryptPrivateKeyInfo(ax,av);if(!aG){G.setError(G.ERROR_INCORRECT_PASSWORD);return null;}aQ=a.privateKeyFromAsn1(aG);}catch(aL){G.setError(G.ERROR_INCORRECT_PASSWORD,aL);return null;}try{if(typeof aw!=="string"){G.setError(G.ERROR_CREATE_SIGNDATA);return null;}var aA;if(aw.charAt(0)=="3"){var at=forge.util.hexToBytes(aw);if(aD&B){var au=at.charCodeAt(1)-128;var aC=0;if(au>0){for(var aI=0;aI<au;aI++){var aM=at.charCodeAt(au+1-aI);aC+=aM<<aI*8;}}else{au=0;aC=at.charCodeAt(1);}var ar=2+au+aC;var am=at.slice(0,ar);if(aC<0||ar>at.length){G.setError(G.ERROR_CREATE_SIGNDATA);return null;}if(at.charCodeAt(ar)!=12){G.setError(G.ERROR_CREATE_SIGNDATA);return null;}au=at.charCodeAt(ar+1)-128;if(au>0){aC=0;for(aI=0;aI<au;aI++){aM=at.charCodeAt(ar+au+1-aI);aC+=aM<<aI*8;}}else{au=0;aC=at.charCodeAt(ar+1);}ar=ar+2+au+aC;if(aC<0||ar>at.length){G.setError(G.ERROR_CREATE_SIGNDATA);return null;}var aP=at.slice(ar-aC,ar);if(at.charCodeAt(ar)!=23){G.setError(G.ERROR_CREATE_SIGNDATA);return null;}au=at.charCodeAt(ar+1)-128;if(au>0){aC=0;for(aI=0;aI<au;aI++){aM=at.charCodeAt(ar+au+1-aI);aC+=aM<<aI*8;}}else{au=0;aC=at.charCodeAt(ar+1);}ar=ar+2+au+aC;if(aC<0||ar>at.length){G.setError(G.ERROR_CREATE_SIGNDATA);return null;}var aK=at.slice(ar-aC,ar);aA=g.fromDer(am);}else{aA=g.fromDer(at);}}else{if(aw.charAt(0)=="M"){var at=forge.util.decode64(aw);aA=g.fromDer(at);}else{G.setError(G.ERROR_CREATE_SIGNDATA);return null;}}var aF={};var ay=[];if(!g.validate(aA,ae,aF,ay)){var aq=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not an PKCS#7 ContentInfo.");aq.errors=ay;throw aq;}var aJ=g.derToOid(aF.contentType);var aO;switch(aJ){case forge.pki.oids.signedData:aO=sofo.pki.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+aJ+" is not (yet) supported(signedData).");}aO.fromAsn1(aF.content.value[0]);if(!(aD&t)){var ap=aO.getCertificate();for(var aI=0;aI<ap.length;aI++){if(P(ap[aI].issuer)==P(az.issuer)&&ap[aI].serialNumber==az.serialNumber){G.setError(G.ERROR_SIGN_DUPLICATE_CERT);return null;}}}aO.addCertificate(az);var ao;ao=g.derToOid(aO.base.digestAlgorithmIdentifiers[0].value[0].value);if(aD&n&&!(aD&A)){aO.addSigner({key:aQ.key,certificate:az,digestAlgorithm:ao,authenticatedAttributes:[{type:forge.pki.oids.contentType,value:forge.pki.oids.data},{type:forge.pki.oids.signingTime,value:new Date},{type:forge.pki.oids.messageDigest}]});}else{aO.addSigner({key:aQ.key,certificate:az,digestAlgorithm:ao});}if(aD&B){var aB=function(aS){var aR=g.Type.UTF8;if(aR===g.Type.UTF8){aS=forge.util.encodeUtf8(aS);aS=forge.util.decodeUtf8(aS);}return g.create(g.Class.UNIVERSAL,aR,false,aS);};var al=function(aS){var aR;if(aS.lastIndexOf("Z")===aS.length-1){aR=aS;}else{aR=aS+"Z";}return g.create(g.Class.UNIVERSAL,g.Type.UTCTIME,false,g.dateToUtcTime(aR));};var aE=g.toDer(aB(aP)).getBytes()+g.toDer(al(aK)).getBytes();for(var aI=0;aI<aO.base.signerInfos.length;aI++){caputre={};ay=[];if(!g.validate(aO.base.signerInfos[aI],E,caputre,ay)){var aq=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not an PKCS#7 SignerInfo.");aq.errors=ay;throw aq;}if(caputre.authenticatedAttributes){for(var aH=0;aH<caputre.authenticatedAttributes.value.length;aH++){var ak=g.derToOid(caputre.authenticatedAttributes.value[aH].value[0].value);if(ak===forge.pki.oids.messageDigest){var an=caputre.authenticatedAttributes.value[aH].value[1].value[0].value;}}}else{G.setError(G.ERROR_GETPLAINDATAOFSIGNDATA);return null;}}if(an==undefined||an==null){G.setError(G.ERROR_GETPLAINDATAOFSIGNDATA);return null;}else{aO.setContentDigest(forge.util.createBuffer(an));}}aO.sign();var aA=aO.toAsn1(aD);if(aD&A){if(aD&y){return forge.util.encode64(aA);}else{return forge.util.bytesToHex(aA);}}else{if(aD&y){if(aD&B){return forge.util.encode64(g.toDer(aA).getBytes()+aE);}else{return forge.util.encode64(g.toDer(aA).getBytes());}}else{if(aD&B){return forge.util.bytesToHex(g.toDer(aA).getBytes()+aE);}else{return forge.util.bytesToHex(g.toDer(aA).getBytes());}}}}catch(aL){G.setError(G.ERROR_CREATE_SIGNDATA,aL);return null;}};var ae={name:"ContentInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"ContentInfo.ContentType",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"contentType"},{name:"ContentInfo.content",tagClass:g.Class.CONTEXT_SPECIFIC,type:0,constructed:true,optional:true,captureAsn1:"content"}]};a.PrivateKeySignData=function(ap,aj,av,aq,am){var al;if(!av||av==""){al=W(aj);if(!al){G.setError(G.ERROR_INCORRECT_PARAM);return null;}}else{al=av;}var ar;try{var au=a.decryptPrivateKeyInfo(ap,al);if(!au){G.setError(G.ERROR_INCORRECT_PASSWORD);return null;}ar=a.privateKeyFromAsn1(au);}catch(ak){G.setError(G.ERROR_INCORRECT_PASSWORD,ak);return null;}try{var at;if(ar.key.kcdsa){var ao=ar.key.sign("has160",aq,am.y);at=g.toDer(ao).getBytes();}else{var an=forge.sha256.create();an.update(aq);at=ar.key.sign(an);}return at;}catch(ak){G.setError(G.ERROR_CREATE_SIGNDATA,ak);return null;}};var E={name:"SignerInfo",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.version",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"version"},{name:"SignerInfo.issuerAndSerialNumber",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.issuerAndSerial.issuer",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerial.serial",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"digestOid"}]},{name:"SignerInfo.AuthenticatedAttributes",tagClass:g.Class.CONTEXT_SPECIFIC,type:0,constructed:true,captureAsn1:"authenticatedAttributes",optional:true},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"SignerInfo.digestEncryptionAlgorithm.signatureAlgorithm",tagClass:g.Class.UNIVERSAL,type:g.Type.OID,constructed:false,capture:"signatureOid"}]},{name:"SignerInfo.encryptedDigest",tagClass:g.Class.UNIVERSAL,type:g.Type.OCTETSTRING,constructed:false,capture:"signature"}]};var h={name:"KCDSASignature",tagClass:g.Class.UNIVERSAL,type:g.Type.SEQUENCE,constructed:true,value:[{name:"KCDSASignature.r",tagClass:g.Class.UNIVERSAL,type:g.Type.BITSTRING,constructed:false,capture:"r"},{name:"KCDSASignature.s",tagClass:g.Class.UNIVERSAL,type:g.Type.INTEGER,constructed:false,capture:"s"}]};a.verifySignedData=function(au,aq,aA,al){al=al||"utf8";if(al=="utf-8"){al="utf8";}var at=[];var aj=[];try{if(typeof au!=="string"){G.setError(G.ERROR_GETPLAINDATAOFSIGNDATA);return null;}var ax;if(au.charAt(0)=="3"){var ar=forge.util.hexToBytes(au);ax=g.fromDer(ar);}else{if(au.charAt(0)=="M"){var ar=forge.util.decode64(au);ax=g.fromDer(ar);}else{G.setError(G.ERROR_GETPLAINDATAOFSIGNDATA);return null;}}var aO;var aE={};var av=[];if(!g.validate(ax,ae,aE,av)){aO=sofo.pki.createSignedData();aO.fromAsn1(ax);}else{var aI=g.derToOid(aE.contentType);switch(aI){case forge.pki.oids.signedData:aO=sofo.pki.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+aI+" is not (yet) supported(signedData).");}aO.fromAsn1(aE.content.value[0]);}var az;if(aq){if(al=="euc-kr"){az=sofo.utils.ucs2_to_ksc5601(aq).getBytes();}else{az=forge.util.createBuffer(aq,al).getBytes();}}else{if(aO.base.content){az=aO.base.content.getBytes();}else{az="";}}var ay=forge.pki.oids[g.derToOid(aO.base.digestAlgorithmIdentifiers[0].value[0].value)];var aQ=forge.md[ay].create();aQ.start().update(az);var ak=aQ.digest().getBytes();var ao=aO.getCertificate();for(var aH=0;aH<aO.base.signerInfos.length;aH++){aE={};av=[];if(!g.validate(aO.base.signerInfos[aH],E,aE,av)){var ap=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not an PKCS#7 SignerInfo.");ap.errors=av;throw ap;}var aM;var aC;var aL;if(aE.authenticatedAttributes){for(var aG=0;aG<aE.authenticatedAttributes.value.length;aG++){var am=g.derToOid(aE.authenticatedAttributes.value[aG].value[0].value);if(am===forge.pki.oids.contentType){if(forge.pki.oids.data!==g.derToOid(aE.authenticatedAttributes.value[aG].value[1].value[0].value)){G.setError(G.ERROR_GETPLAINDATAOFSIGNDATA);return null;}}else{if(am===forge.pki.oids.messageDigest){if(ak!==aE.authenticatedAttributes.value[aG].value[1].value[0].value){G.setError(G.ERROR_GETPLAINDATAOFSIGNDATA);return null;}}}}var aF=g.create(g.Class.UNIVERSAL,g.Type.SET,true,aE.authenticatedAttributes.value);aC=g.toDer(aF).getBytes();aM=forge.pki.oids[g.derToOid(aE.digestOid)];var aK=forge.md[aM].create();aK.start().update(aC);aL=aK.digest().getBytes();}else{aM=ay;aC=az;aL=ak;}var aN;var aD={};aD.attributes=forge.pki.RDNAttributesAsArray(aE.issuer);aD=P(aD);var an=forge.util.bytesToHex(aE.serial);for(var aG=0;aG<ao.length;aG++){if(aD==P(ao[aG].issuer)&&an==ao[aG].serialNumber){aN=ao[aG];break;}}if(!aN){G.setError(G.ERROR_GETPLAINDATAOFSIGNDATA);return null;}var aP;var aw=g.derToOid(aE.signatureOid);if(forge.pki.oids[aw].indexOf("kcdsa")==0){if(aw!=forge.pki.oids.kcdsa1&&aw!=forge.pki.oids.kcdsa1WithSHA1&&aw!=forge.pki.oids.kcdsa1WithSHA256){G.setError(G.ERROR_GETPLAINDATAOFSIGNDATA);return null;}var aB=ax=g.fromDer(aE.signature);aE={};av=[];if(!g.validate(aB,h,aE,av)){var ap=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not an PKCS#7 Signature(KCDSA).");ap.errors=av;throw ap;}aP=aN.publicKey.verify(aM,aC,aE.r,aE.s);}else{aP=aN.publicKey.verify(aL,aE.signature,"RSASSA-PKCS1-V1_5");}if(!aP){G.setError(G.ERROR_GETPLAINDATAOFSIGNDATA);return null;}aP=a.verifyCertificate(aN,0);at.push(aP);aj.push(aN);}var aq;if(al=="euc-kr"){aq=sofo.utils.ksc5601_to_ucs2(az);}else{aq=forge.util.decodeUtf8(az);}}catch(aJ){G.setError(G.ERROR_GETPLAINDATAOFSIGNDATA,aJ);return null;}return{plain:aq,cert:aj,result:at};};a.convertSignedData=function(aq,au,am,ak){ak=ak||"utf8";if(ak=="utf-8"){ak="utf8";}try{if(typeof aq!=="string"){G.setError(G.ERROR_CREATE_SIGNDATA);return null;}var al;if(aq.charAt(0)=="3"){var ap=forge.util.hexToBytes(aq);al=g.fromDer(ap);}else{if(aq.charAt(0)=="M"){var ap=forge.util.decode64(aq);al=g.fromDer(ap);}else{G.setError(G.ERROR_CREATE_SIGNDATA);return null;}}var ao;var av={};var ar=[];if(!g.validate(al,ae,av,ar)){ao=sofo.pki.createSignedData();ao.fromAsn1(al);}else{var at=g.derToOid(av.contentType);switch(at){case forge.pki.oids.signedData:ao=sofo.pki.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+at+" is not (yet) supported(signedData).");}ao.fromAsn1(av.content.value[0]);}if(au){if(ak=="euc-kr"){ao.setContent(sofo.utils.ucs2_to_ksc5601(au));}else{ao.setContent(forge.util.createBuffer(au,ak));}}else{if(!ao.base.content){ao.setContent("");}}ao.sign();var aj=ao.toAsn1(am);if(am&A){if(am&y){return forge.util.encode64(aj);}else{return forge.util.bytesToHex(aj);}}else{if(am&y){return forge.util.encode64(g.toDer(aj).getBytes());}else{return forge.util.bytesToHex(g.toDer(aj).getBytes());}}}catch(an){G.setError(G.ERROR_CREATE_SIGNDATA,an);return null;}};a.verifyCertificate=function(ak,al){try{var aj=ag(new Date,new Date(ak.validity.notAfter));if(aj==0||aj==1){return aj;}G.setError(G.ERROR_CERT_EXPIRED);return 43034;}catch(am){G.setError(G.ERROR_VERIFYCERT,am);return-1;}};a.envelopeIdNum=function(au,at,aC,az,ap){var aq=W(aC);if(!aq){G.setError(G.ERROR_INCORRECT_PARAM);return null;}var aj=W(az);if(aj==null){aj=az;}var aD;try{aD=forge.pki.certificateFromPem(ap);}catch(aA){G.setError(G.ERROR_INCORRECT_PARAM,aA);return null;}var ao;try{var aw=a.decryptPrivateKeyInfo(at,aq);if(!aw){G.setError(G.ERROR_INCORRECT_PASSWORD);return null;}ao=a.privateKeyFromAsn1(aw);}catch(aA){G.setError(G.ERROR_INCORRECT_PASSWORD,aA);return null;}if(!ao.randomNum){G.setError(G.ERROR_ENVELOPIDNUM);return null;}try{var aE=forge.util.createBuffer(forge.random.getBytes(16));var aB=forge.util.createBuffer();for(var ay=0;ay<16;ay++){aB.putByte(0);}var ak=aB.getBytes();var av=forge.seed.createEncryptionCipher;var ax=av(aE,"CBC");ax.start(ak);var an=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.PRINTABLESTRING,false,aj),g.create(g.Class.UNIVERSAL,g.Type.BITSTRING,false,String.fromCharCode(0)+ao.randomNum)]);ax.update(g.toDer(an));ax.finish();var am=ax.output.getBytes();var al=aD.publicKey.encrypt(aE.getBytes(),"RSAES-PKCS1-V1_5");var ar=forge.util.createBuffer();ar.putBytes(al);ar.putBytes(am);return forge.util.bytesToHex(ar.getBytes());}catch(aA){G.setError(G.ERROR_ENVELOPIDNUM,aA);return null;}return null;};a.envelopeIdNumFincert=function(al,ak,ax){var aq;try{aq=forge.pki.certificateFromPem(ax);}catch(aw){G.setError(G.ERROR_INCORRECT_PARAM,aw);return null;}var av=forge.util.decode64(ak);var am=al=="dummy"?"":al;try{var aA=forge.util.createBuffer(forge.random.getBytes(16));var ap=forge.util.createBuffer();for(var ao=0;ao<16;ao++){ap.putByte(0);}var an=ap.getBytes();var au=forge.seed.createEncryptionCipher;var at=au(aA,"CBC");at.start(an);var az=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.PRINTABLESTRING,false,am),g.create(g.Class.UNIVERSAL,g.Type.BITSTRING,false,String.fromCharCode(0)+av)]);at.update(g.toDer(az));at.finish();var ay=at.output.getBytes();var ar=aq.publicKey.encrypt(aA.getBytes(),"RSAES-PKCS1-V1_5");var aj=forge.util.createBuffer();aj.putBytes(ar);aj.putBytes(ay);return forge.util.bytesToHex(aj.getBytes());}catch(aw){G.setError(G.ERROR_ENVELOPIDNUM,aw);return null;}};var J=1024;a.envelopeData=function(aq,ak,au,an,aj){aj=aj||"utf8";if(aj=="utf-8"){aj="utf8";}var at;if(aq){at=0;}else{if(ak){at=1;}else{G.setError(G.ERROR_INCORRECT_PARAM);return null;}}var ap;if(at==1){ap=W(ak);if(!ap){G.setError(G.ERROR_INCORRECT_PARAM);return null;}}try{var ar=sofo.pki.createEnvelopedData();if(at==0){if(forge.util.isArray(aq)){for(var am=0;am<aq.length;am++){ar.addRecipient(aq[am]);}}else{ar.addRecipient(aq);}}if(aj=="euc-kr"){ar.setContent(sofo.utils.ucs2_to_ksc5601(au));}else{ar.setContent(forge.util.createBuffer(au,aj));}if(at==0){ar.encrypt();}else{ar.encrypt(ap);}var al=ar.toAsn1();if(an&J){return forge.util.encode64(g.toDer(al).getBytes());}else{return forge.util.bytesToHex(g.toDer(al).getBytes());}}catch(ao){G.setError(G.ERROR_ENVELOP_FAIL,ao);return null;}};a.deenvelopeData=function(au,ar,aC,az,aj,aw,ak){ak=ak||"utf8";if(ak=="utf-8"){ak="utf8";}var al;if(au&&ar&&aC){al=0;}else{if(az){al=1;}else{G.setError(G.ERROR_INCORRECT_PARAM);return null;}}var aq;if(al==0){aq=W(aC);}else{aq=W(az);}if(!aq){G.setError(G.ERROR_INCORRECT_PARAM);return null;}var aD;if(al==0){try{var ay=a.decryptPrivateKeyInfo(ar,aq);if(!ay){G.setError(G.ERROR_INCORRECT_PASSWORD);return null;}aD=a.privateKeyFromAsn1(ay);}catch(aB){G.setError(G.ERROR_INCORRECT_PASSWORD,aB);return null;}}try{if(typeof aj!=="string"){G.setError(G.ERROR_DEENVELOP_FAIL);return null;}var av;if(aj.charAt(0)=="3"){var ao=forge.util.hexToBytes(aj);av=g.fromDer(ao);}else{if(aj.charAt(0)=="M"){var ao=forge.util.decode64(aj);av=g.fromDer(ao);}else{G.setError(G.ERROR_DEENVELOP_FAIL);return null;}}var ax={};var at=[];if(!g.validate(av,ae,ax,at)){var an=new Error("Cannot read PKCS#7 message. "+"ASN.1 object is not an PKCS#7 ContentInfo.");an.errors=at;throw an;}var aA=g.derToOid(ax.contentType);var am;switch(aA){case forge.pki.oids.envelopedData:am=sofo.pki.createEnvelopedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+aA+" is not (yet) supported(envelopedData).");}am.fromAsn1(ax.content.value[0]);if(al==0){var ap=am.findRecipient(au);if(!ap){G.setError(G.ERROR_GETCERT);return null;}am.decrypt(ap,aD.key);}else{var ap=am.findRecipient(0);am.decrypt(ap,aq);}if(ak=="euc-kr"){return sofo.utils.ksc5601_to_ucs2(am.getContent().getBytes());}else{return am.getContent().toString();}}catch(aB){G.setError(G.ERROR_DEENVELOP_FAIL,aB);return null;}};a.certificateFromPFX=function(an,ar,ak){var al={signCert:null,signKey:null,kmCert:null,kmKey:null};var ax;var au;var az=W(ar);if(!az){G.setError(G.ERROR_INCORRECT_PARAM);return null;}var ay;if(ak){ay=W(ak);if(!ay){G.setError(G.ERROR_INCORRECT_PARAM);return null;}}else{ay=az;}try{var aw;if(typeof an==="string"){if(an.charAt(0)=="3"){aw=forge.util.hexToBytes(an);}else{if(an.charAt(0)=="M"){aw=forge.util.decode64(an);}else{aw=forge.util.createBuffer(an);}}}else{aw=forge.util.createBuffer(an);}var aj=g.fromDer(aw);var av=forge.pkcs12.pkcs12FromAsn1(aj,az);ax=av.getBags({bagType:forge.pki.oids.certBag})[forge.pki.oids.certBag];au=av.getBags({bagType:forge.pki.oids.keyBag})[forge.pki.oids.keyBag];var aA=av.getBags({bagType:forge.pki.oids.pkcs8ShroudedKeyBag})[forge.pki.oids.pkcs8ShroudedKeyBag];for(var am=0;am<aA.length;am++){au.push(aA[am]);}}catch(at){if(at.message.indexOf("Invalid password")>0){G.setError(G.ERROR_VERIFYPASSWORD,at);return null;}else{G.setError(G.ERROR_IMPORTCERT_FAIL,at);return null;}}try{for(var am=0;am<ax.length;am++){var aq=a.wrapPrivateKey(au[am].key,au[am].randomNum);var ap={};ap.algorithm="seed";var ao=a.encryptPrivateKeyInfo(aq,ay,ap);if(am==0){al.signCert=ax[am].cert;al.signKey=ao;}else{al.kmCert=ax[am].cert;al.kmKey=ao;}if(am==1){break;}}return al;}catch(at){G.setError(G.ERROR_ENCRYPT_PRIKEY,at);return null;}G.setError(G.ERROR_IMPORTCERT_FAIL);return null;};a.certificateFromPFXForCertRelay=function(am,ao){var ak={signCert:null,signKey:null,kmCert:null,kmKey:null};var au;var aq;var av=ao;if(!av){G.setError(G.ERROR_INCORRECT_PARAM);return null;}try{var at;if(typeof am==="string"){if(am.charAt(0)=="3"){at=forge.util.hexToBytes(am);}else{if(am.charAt(0)=="M"){at=forge.util.decode64(am);}else{at=forge.util.createBuffer(am);}}}else{at=forge.util.createBuffer(am);}var aj=g.fromDer(at);var ar=forge.pkcs12.pkcs12FromAsn1(aj,"CertRelay",av);au=ar.getBags({bagType:forge.pki.oids.certBag})[forge.pki.oids.certBag];aq=ar.getBags({bagType:forge.pki.oids.keyBag})[forge.pki.oids.keyBag];var aw=ar.getBags({bagType:forge.pki.oids.pkcs8ShroudedKeyBag})[forge.pki.oids.pkcs8ShroudedKeyBag];for(var al=0;al<aw.length;al++){aq.push(aw[al]);}}catch(ap){if(ap.message.indexOf("Invalid password")>0){G.setError(G.ERROR_VERIFYPASSWORD,ap);return null;}else{G.setError(G.ERROR_IMPORTCERT_FAIL,ap);return null;}}try{for(var al=0;al<au.length;al++){var an;an=aq[al].key;if(al==0){ak.signCert=au[al].cert;ak.signKey=an;}else{ak.kmCert=au[al].cert;ak.kmKey=an;}if(al==1){break;}}return ak;}catch(ap){G.setError(G.ERROR_ENCRYPT_PRIKEY,ap);return null;}G.setError(G.ERROR_IMPORTCERT_FAIL);return null;};a.certificateFromDer=function(ao,ak,au,at,az,ax){var av={signCert:null,signKey:null,kmCert:null,kmKey:null};var aB=W(az);if(!aB){G.setError(G.ERROR_INCORRECT_PARAM);return null;}var aA;if(ax){aA=W(ax);if(!aA){G.setError(G.ERROR_INCORRECT_PARAM);return null;}}else{aA=aB;}var an,ap,am;var aq;try{if(typeof ao==="string"){if(ao.charAt(0)=="3"){an=forge.util.hexToBytes(ao);}else{if(ao.charAt(0)=="M"){an=forge.util.decode64(ao);}else{an=forge.util.createBuffer(ao);}}}else{an=forge.util.createBuffer(ao);}ap=g.fromDer(an);aq=forge.pki.certificateFromAsn1(ap,true);}catch(ay){G.setError(G.ERROR_IMPORTCERT_FAIL,ay);return null;}try{if(typeof ak==="string"){if(ak.charAt(0)=="3"){an=forge.util.hexToBytes(ak);}else{if(ak.charAt(0)=="M"){an=forge.util.decode64(ak);}else{an=forge.util.createBuffer(ak);}}}else{an=forge.util.createBuffer(ak);}ap=g.fromDer(an);}catch(ay){G.setError(G.ERROR_IMPORTCERT_FAIL,ay);return null;}try{am=a.decryptPrivateKeyInfo(ap,aB);if(!am){G.setError(G.ERROR_VERIFYPASSWORD);return null;}}catch(ay){G.setError(G.ERROR_DECRYPT_PRIKEY,ay);return null;}var aj;try{var ar={};ar.algorithm="seed";aj=a.encryptPrivateKeyInfo(am,aA,ar);if(!aj){G.setError(G.ERROR_ENCRYPT_PRIKEY);return null;}}catch(ay){G.setError(G.ERROR_ENCRYPT_PRIKEY,ay);return null;}av.signCert=aq;av.signKey=aj;if(au&&at){var al;try{if(typeof au==="string"){if(au.charAt(0)=="3"){an=forge.util.hexToBytes(au);}else{if(au.charAt(0)=="M"){an=forge.util.decode64(au);}else{an=forge.util.createBuffer(au);}}}else{an=forge.util.createBuffer(au);}ap=g.fromDer(an);al=forge.pki.certificateFromAsn1(ap,true);}catch(ay){G.setError(G.ERROR_IMPORTCERT_FAIL,ay);return null;}try{if(typeof at==="string"){if(at.charAt(0)=="3"){an=forge.util.hexToBytes(at);}else{if(at.charAt(0)=="M"){an=forge.util.decode64(at);}else{an=forge.util.createBuffer(at);}}}else{an=forge.util.createBuffer(at);}ap=g.fromDer(an);}catch(ay){G.setError(G.ERROR_IMPORTCERT_FAIL,ay);return null;}try{am=a.decryptPrivateKeyInfo(ap,aB);if(!am){G.setError(G.ERROR_VERIFYPASSWORD);return null;}}catch(ay){G.setError(G.ERROR_DECRYPT_PRIKEY,ay);return null;}var aw;try{aw=a.encryptPrivateKeyInfo(am,aA,ar);if(!aw){G.setError(G.ERROR_ENCRYPT_PRIKEY);return null;}}catch(ay){G.setError(G.ERROR_ENCRYPT_PRIKEY,ay);return null;}av.kmCert=al;av.kmKey=aw;}return av;};a.certificateFromCMP=function(am,ax,aj,ak,at,al,ar){var an={signCert:null,signKey:null,kmCert:null,kmKey:null};var aw=[];var av=[];var ay;if(ar&ai){ay=at;}else{ay=W(at);}if(!ay){G.setError(G.ERROR_INCORRECT_PARAM);return null;}if(am!==null&&ax!==null){aw.push({cert:am});av.push({key:ax,randomNum:al});}if(aj!==null&&ak!==null){aw.push({cert:aj});av.push({key:ak,randomNum:null});}try{for(var ao=0;ao<aw.length;ao++){var aq=a.wrapPrivateKey(av[ao].key,av[ao].randomNum);var ar={};ar.algorithm="seed";var ap=a.encryptPrivateKeyInfo(aq,ay,ar);if(ao==0){if(am==null||ax==null){throw G.ERROR_IMPORTCERT_FAIL;}an.signCert=aw[ao].cert;an.signKey=ap;}else{an.kmCert=aw[ao].cert;an.kmKey=ap;}if(ao==1){break;}}return an;}catch(au){G.setError(G.ERROR_ENCRYPT_PRIKEY,au);return null;}G.setError(G.ERROR_IMPORTCERT_FAIL);return null;};var w=1;a.certificateToPKCS12=function(an,au,al,am,ax,aj,aq){var aA=null;var ak=null;var aw=W(ax);if(!aw){G.setError(G.ERROR_INCORRECT_PARAM);return null;}var av=W(aj);if(!av){G.setError(G.ERROR_INCORRECT_PARAM);return "";}try{var az=a.decryptPrivateKeyInfo(au,aw);if(!az){G.setError(G.ERROR_DECRYPT_PRIKEY);return null;}aA=a.privateKeyFromAsn1(az);}catch(ar){G.setError(G.ERROR_DECRYPT_PRIKEY,ar);return null;}if(al&&am){try{var az=a.decryptPrivateKeyInfo(am,aw);if(!az){G.setError(G.ERROR_DECRYPT_PRIKEY);return null;}ak=a.privateKeyFromAsn1(az);}catch(ar){G.setError(G.ERROR_DECRYPT_PRIKEY,ar);return null;}}try{var ay;if(al&&ak){ay=forge.pkcs12.toPkcs12Asn1(an,aA,al,ak,av,{algorithm:"3des",format:"encryptedData"});}else{ay=forge.pkcs12.toPkcs12Asn1(an,aA,null,null,av,{algorithm:"3des",format:"encryptedData"});}if(!ay){G.setError(G.ERROR_EXPORTCERT);return null;}if(aq&w){var at=forge.asn1.toDer(ay).getBytes();var ao=forge.util.encode64(at);return ao;}else{var at=forge.asn1.toDer(ay).getBytes();var ap=forge.util.bytesToHex(at);return ap;}}catch(ar){G.setError(G.ERROR_EXPORTCERT,ar);return null;}};a.certificateToPKCS12ForCertRelay=function(an,au,al,am,aj,aq){var aw=null;var ak=null;try{aw=au;}catch(ar){G.setError(G.ERROR_DECRYPT_PRIKEY,ar);return null;}if(al&&am){try{ak=am;}catch(ar){G.setError(G.ERROR_DECRYPT_PRIKEY,ar);return null;}}try{var av;if(al&&ak){av=forge.pkcs12.toPkcs12Asn1ForCertRelay(an,aw,al,ak,aj,{algorithm:"3des",format:"encryptedData"});}else{av=forge.pkcs12.toPkcs12Asn1ForCertRelay(an,aw,null,null,aj,{algorithm:"3des",format:"encryptedData"});}if(!av){G.setError(G.ERROR_EXPORTCERT);return null;}if(aq&w){var at=forge.asn1.toDer(av).getBytes();var ao=forge.util.encode64(at);return ao;}else{var at=forge.asn1.toDer(av).getBytes();var ap=forge.util.bytesToHex(at);return ap;}}catch(ar){G.setError(G.ERROR_EXPORTCERT,ar);return null;}};a.identifyVID=function(at,av,ao,an){var ar=W(ao);if(!ar){G.setError(G.ERROR_INCORRECT_PARAM);return-1;}var am=W(an);if(!am){G.setError(G.ERROR_INCORRECT_PARAM);return-1;}var az;try{var ay=a.decryptPrivateKeyInfo(av,ar);if(!ay){G.setError(G.ERROR_INCORRECT_PASSWORD);return-1;}az=a.privateKeyFromAsn1(ay);}catch(aq){G.setError(G.ERROR_INCORRECT_PASSWORD,aq);return-1;}if(!az.randomNum){G.setError(G.ERROR_PKCS8_NO_RANDOM);return-1;}var ak=at.getExtension("subjectAltName");if(!ak){G.setError(G.ERROR_PKCS8_NO_VID);return-1;}var aj;var al;try{function ax(aD){if(!aD){return null;}if(aD.composed&&aD.value instanceof Array){for(var aC=0;aC<aD.value.length;aC++){if(aD.value[aC].tagClass==g.Class.CONTEXT_SPECIFIC&&aD.value[aC].type==0){if(aD.value[aC].composed&&aD.value[aC].value instanceof Array){var aG=false;for(var aB=0;aB<aD.value[aC].value.length;aB++){if(aD.value[aC].value[aB].tagClass==g.Class.UNIVERSAL&&aD.value[aC].value[aB].type==g.Type.OID){var aF=g.derToOid(aD.value[aC].value[aB].value);var aA=forge.pki.oids[aF]?forge.pki.oids[aF]:aF;if(aA.toLowerCase()=="kisa-identifyData".toLowerCase()){aG=true;}}else{if(aG){var aE=aD.value[aC].value[aB].value[0];aj=g.derToOid(aE.value[1].value[0].value[1].value[0].value[0].value);al=aE.value[1].value[0].value[1].value[1].value[0].value;return 0;}}}}}}}return-1;}if(ax(g.fromDer(ak.value))!=0){G.setError(G.ERROR_PKCS8_NO_VID);return-1;}}catch(aq){G.setError(G.ERROR_PKCS8_NO_VID,aq);return-1;}try{var au;var ap;switch(aj){case forge.pki.oids.sha1:au=forge.md.sha1.create();break;case forge.pki.oids.sha256:au=forge.md.sha256.create();break;case forge.pki.oids.sha512:au=forge.md.sha512.create();break;case forge.pki.oids.md5:au=forge.md.md5.create();break;default:G.setError(G.ERROR_VERIFYCERTOWNER);return-1;}var aw=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.PRINTABLESTRING,false,am),g.create(g.Class.UNIVERSAL,g.Type.BITSTRING,false,String.fromCharCode(0)+az.randomNum)]);au.update(g.toDer(aw).getBytes());ap=au.digest().getBytes();au.start();au.update(ap);ap=au.digest().getBytes();if(al!=ap){G.setError(G.ERROR_VERIFYCERTOWNER);return-1;}}catch(aq){G.setError(G.ERROR_VERIFYCERTOWNER,aq);return-1;}return 0;};var m=0;var K=1;var aa=2;var V=3;var Z=4;var R=1;a.hashData=function(aj,ak,al,am){am=am||"utf8";if(am=="utf-8"){am="utf8";}var an;try{switch(aj){case m:an=forge.md.md5.create();break;case K:an=forge.md.sha1.create();break;case aa:an=forge.md.sha256.create();break;case V:an=forge.md.sha384.create();break;case Z:an=forge.md.sha512.create();break;default:G.setError(G.ERROR_INCORRECT_PARAM);return null;}an.start();if(am=="euc-kr"){an.update(sofo.utils.ucs2_to_ksc5601(ak).getBytes());}else{an.update(forge.util.createBuffer(ak,am).getBytes());}if(al&R){return forge.util.encode64(an.digest().getBytes());}else{return forge.util.bytesToHex(an.digest().getBytes());}}catch(ao){G.setError(G.ERROR_HASHDATA,ao);return null;}};a.distinguishedNameToAsn1=function(aj){return D(aj);};a.generateRandom=function(aj){return forge.util.bytesToHex(forge.random.getBytes(aj));};function D(ap){var ao=g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[]);var aj,aq;var ak=ap.attributes;for(var al=0;al<ak.length;++al){aj=ak[al];var an=aj.value;var am=g.Type.PRINTABLESTRING;if("valueTagClass" in aj){am=aj.valueTagClass;if(am===g.Type.UTF8){an=forge.util.encodeUtf8(an);an=forge.util.decodeUtf8(an);}}aq=g.create(g.Class.UNIVERSAL,g.Type.SET,true,[g.create(g.Class.UNIVERSAL,g.Type.SEQUENCE,true,[g.create(g.Class.UNIVERSAL,g.Type.OID,false,g.oidToDer(aj.type).getBytes()),g.create(g.Class.UNIVERSAL,am,false,an)])]);ao.value.push(aq);}return ao;}})();(function(){sofo.utils.bytesToHex=function(d){return forge.util.bytesToHex(d);};sofo.utils.hexToBytes=function(d){return forge.util.hexToBytes(d);};sofo.utils.stringToBytes=function(e){var d=[];for(var f=0;f<e.length;++f){d.push(e.charCodeAt(f));}return d;};sofo.utils.sidToPortNumber=function(d){var e=forge.md.sha1.create();e.update(d,"utf8");return e.digest2();};sofo.utils.base64Decode=function(d){return forge.util.decode64(d);};sofo.utils.base64Encode=function(d){return forge.util.encode64(d);};sofo.utils.getBytes=function(d){return forge.random.getBytes(d);};sofo.utils.createBuffer=function(d,e){return forge.util.createBuffer(d,e);};function c(h){var d=[];if(window.crypto&&window.crypto.getRandomValues){var e=new Uint8Array(h);window.crypto.getRandomValues(e);for(var f=0;f<h;f++){d.push(e[f]);}}else{for(var d=[];h>0;h--){d.push(parseInt(window.msCrypto.getRandomValues(new Uint8Array(1))[0]));}}var g="";for(var f=0;f<d.length;f++){g+=String.fromCharCode(d[f]);}return g;}sofo.utils.generatorRandom=function(e){var f=forge.util.bytesToHex(c(e-4));var d=new Date;var g=forge.util.bytesToHex(d.getTime().toString()).slice(-8);return forge.util.hexToBytes(g+=f);};sofo.utils.decodeUTF8=function(d){return forge.util.decodeUtf8(d);};sofo.utils.encodeUTF8=function(d){return forge.util.encodeUtf8(d);};sofo.utils.memcpy=function(l,d,n,f,g){var e,h=f;var m=sofo.utils.stringToBytes(l);for(e=0;e<g;e++){n.setAt(h++,m[e]);}return n;};sofo.utils.calcuratorBlock=function(r,h,o,g){var n=sofo.utils.memcpy;var e=forge.util.createBuffer(1024);var p=forge.util.createBuffer(1024);var d;var f;var q,m,l;for(m=0;m<g;m++){q=0;for(l=0;l<=m;l++){e.setAt(q++,"A".charCodeAt(0)+m);}n(r,q,e,q,48);q+=48;n(h,q,e,q,32);q+=32;n(o,q,e,q,32);q+=32;d=sofo.crypto.SHA1(e.data);q=0;n(r,q,e,q,48);q+=48;n(d.data,q,e,q,20);q+=20;mdValue=sofo.crypto.MD5(e.data,q);n(mdValue.data,q,p,m*16,16);}return p;};sofo.utils.createKeyBlock=function(f,e,h){if(e===undefined||e.length<=0){return new Error("The key block enter does not correctly.");}var d=sofo.utils.bytesToHex(e.data);if(f=="secure"){var g=0;h.macKey.value=sofo.utils.hexToBytes(d.slice(g,20*2));g+=20*2;h.server.macKey.value=sofo.utils.hexToBytes(d.slice(g,g+20*2));g+=20*2;h.encKey.value=sofo.utils.hexToBytes(d.slice(g,g+16*2));g+=16*2;h.server.encKey.value=sofo.utils.hexToBytes(d.slice(g,g+16*2));g+=16*2;h.iv.value=sofo.utils.hexToBytes(d.slice(g,g+16*2));g+=16*2;h.server.iv.value=sofo.utils.hexToBytes(d.slice(g,g+16*2));}else{h.macKey.value=sofo.utils.hexToBytes(d.slice(g,20*2));g+=20*2;h.encKey.value=sofo.utils.hexToBytes(d.slice(g,g+16*2));g+=16*2;h.iv.value=sofo.utils.hexToBytes(d.slice(g,g+16*2));g+=16*2;}};sofo.utils.isValiedPemFormat=function(d){try{forge.pem.decode(d);return true;}catch(f){return false;}};var b=[12288,12289,12290,183,8229,8230,168,12291,173,8213,8741,65340,8764,8216,8217,8220,8221,12308,12309,12296,12297,12298,12299,12300,12301,12302,12303,12304,12305,177,215,247,8800,8804,8805,8734,8756,176,8242,8243,8451,8491,65504,65505,65509,9794,9792,8736,8869,8978,8706,8711,8801,8786,167,8251,9734,9733,9675,9679,9678,9671,9670,9633,9632,9651,9650,9661,9660,8594,8592,8593,8595,8596,12307,8810,8811,8730,8765,8733,8757,8747,8748,8712,8715,8838,8839,8834,8835,8746,8745,8743,8744,65506,8658,8660,8704,8707,180,65374,711,728,733,730,729,184,731,161,191,720,8750,8721,8719,164,8457,8240,9665,9664,9655,9654,9828,9824,9825,9829,9831,9827,8857,9672,9635,9680,9681,9618,9636,9637,9640,9639,9638,9641,9832,9743,9742,9756,9758,182,8224,8225,8597,8599,8601,8598,8600,9837,9833,9834,9836,12927,12828,8470,13255,8482,13250,13272,8481,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,65281,65282,65283,65284,65285,65286,65287,65288,65289,65290,65291,65292,65293,65294,65295,65296,65297,65298,65299,65300,65301,65302,65303,65304,65305,65306,65307,65308,65309,65310,65311,65312,65313,65314,65315,65316,65317,65318,65319,65320,65321,65322,65323,65324,65325,65326,65327,65328,65329,65330,65331,65332,65333,65334,65335,65336,65337,65338,65339,65510,65341,65342,65343,65344,65345,65346,65347,65348,65349,65350,65351,65352,65353,65354,65355,65356,65357,65358,65359,65360,65361,65362,65363,65364,65365,65366,65367,65368,65369,65370,65371,65372,65373,65507,12593,12594,12595,12596,12597,12598,12599,12600,12601,12602,12603,12604,12605,12606,12607,12608,12609,12610,12611,12612,12613,12614,12615,12616,12617,12618,12619,12620,12621,12622,12623,12624,12625,12626,12627,12628,12629,12630,12631,12632,12633,12634,12635,12636,12637,12638,12639,12640,12641,12642,12643,12644,12645,12646,12647,12648,12649,12650,12651,12652,12653,12654,12655,12656,12657,12658,12659,12660,12661,12662,12663,12664,12665,12666,12667,12668,12669,12670,12671,12672,12673,12674,12675,12676,12677,12678,12679,12680,12681,12682,12683,12684,12685,12686,8560,8561,8562,8563,8564,8565,8566,8567,8568,8569,-1,-1,-1,-1,-1,8544,8545,8546,8547,8548,8549,8550,8551,8552,8553,-1,-1,-1,-1,-1,-1,-1,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,-1,-1,-1,-1,-1,-1,-1,-1,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,963,964,965,966,967,968,969,-1,-1,-1,-1,-1,-1,9472,9474,9484,9488,9496,9492,9500,9516,9508,9524,9532,9473,9475,9487,9491,9499,9495,9507,9523,9515,9531,9547,9504,9519,9512,9527,9535,9501,9520,9509,9528,9538,9490,9489,9498,9497,9494,9493,9486,9485,9502,9503,9505,9506,9510,9511,9513,9514,9517,9518,9521,9522,9525,9526,9529,9530,9533,9534,9536,9537,9539,9540,9541,9542,9543,9544,9545,9546,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13205,13206,13207,8467,13208,13252,13219,13220,13221,13222,13209,13210,13211,13212,13213,13214,13215,13216,13217,13218,13258,13197,13198,13199,13263,13192,13193,13256,13223,13224,13232,13233,13234,13235,13236,13237,13238,13239,13240,13241,13184,13185,13186,13187,13188,13242,13243,13244,13245,13246,13247,13200,13201,13202,13203,13204,8486,13248,13249,13194,13195,13196,13270,13253,13229,13230,13231,13275,13225,13226,13227,13228,13277,13264,13267,13251,13257,13276,13254,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,198,208,170,294,-1,306,-1,319,321,216,338,186,222,358,330,-1,12896,12897,12898,12899,12900,12901,12902,12903,12904,12905,12906,12907,12908,12909,12910,12911,12912,12913,12914,12915,12916,12917,12918,12919,12920,12921,12922,12923,9424,9425,9426,9427,9428,9429,9430,9431,9432,9433,9434,9435,9436,9437,9438,9439,9440,9441,9442,9443,9444,9445,9446,9447,9448,9449,9312,9313,9314,9315,9316,9317,9318,9319,9320,9321,9322,9323,9324,9325,9326,189,8531,8532,188,190,8539,8540,8541,8542,230,273,240,295,305,307,312,320,322,248,339,223,254,359,331,329,12800,12801,12802,12803,12804,12805,12806,12807,12808,12809,12810,12811,12812,12813,12814,12815,12816,12817,12818,12819,12820,12821,12822,12823,12824,12825,12826,12827,9372,9373,9374,9375,9376,9377,9378,9379,9380,9381,9382,9383,9384,9385,9386,9387,9388,9389,9390,9391,9392,9393,9394,9395,9396,9397,9332,9333,9334,9335,9336,9337,9338,9339,9340,9341,9342,9343,9344,9345,9346,185,178,179,8308,8319,8321,8322,8323,8324,12353,12354,12355,12356,12357,12358,12359,12360,12361,12362,12363,12364,12365,12366,12367,12368,12369,12370,12371,12372,12373,12374,12375,12376,12377,12378,12379,12380,12381,12382,12383,12384,12385,12386,12387,12388,12389,12390,12391,12392,12393,12394,12395,12396,12397,12398,12399,12400,12401,12402,12403,12404,12405,12406,12407,12408,12409,12410,12411,12412,12413,12414,12415,12416,12417,12418,12419,12420,12421,12422,12423,12424,12425,12426,12427,12428,12429,12430,12431,12432,12433,12434,12435,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,12449,12450,12451,12452,12453,12454,12455,12456,12457,12458,12459,12460,12461,12462,12463,12464,12465,12466,12467,12468,12469,12470,12471,12472,12473,12474,12475,12476,12477,12478,12479,12480,12481,12482,12483,12484,12485,12486,12487,12488,12489,12490,12491,12492,12493,12494,12495,12496,12497,12498,12499,12500,12501,12502,12503,12504,12505,12506,12507,12508,12509,12510,12511,12512,12513,12514,12515,12516,12517,12518,12519,12520,12521,12522,12523,12524,12525,12526,12527,12528,12529,12530,12531,12532,12533,12534,-1,-1,-1,-1,-1,-1,-1,-1,1040,1041,1042,1043,1044,1045,1025,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1072,1073,1074,1075,1076,1077,1105,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44032,44033,44036,44039,44040,44041,44042,44048,44049,44050,44051,44052,44053,44054,44055,44057,44058,44059,44060,44061,44064,44068,44076,44077,44079,44080,44081,44088,44089,44092,44096,44107,44109,44116,44120,44124,44144,44145,44148,44151,44152,44154,44160,44161,44163,44164,44165,44166,44169,44170,44171,44172,44176,44180,44188,44189,44191,44192,44193,44200,44201,44202,44204,44207,44208,44216,44217,44219,44220,44221,44225,44228,44232,44236,44245,44247,44256,44257,44260,44263,44264,44266,44268,44271,44272,44273,44275,44277,44278,44284,44285,44288,44292,44294,44300,44301,44303,44305,44312,44316,44320,44329,44332,44333,44340,44341,44344,44348,44356,44357,44359,44361,44368,44372,44376,44385,44387,44396,44397,44400,44403,44404,44405,44406,44411,44412,44413,44415,44417,44418,44424,44425,44428,44432,44444,44445,44452,44471,44480,44481,44484,44488,44496,44497,44499,44508,44512,44516,44536,44537,44540,44543,44544,44545,44552,44553,44555,44557,44564,44592,44593,44596,44599,44600,44602,44608,44609,44611,44613,44614,44618,44620,44621,44622,44624,44628,44630,44636,44637,44639,44640,44641,44645,44648,44649,44652,44656,44664,44665,44667,44668,44669,44676,44677,44684,44732,44733,44734,44736,44740,44748,44749,44751,44752,44753,44760,44761,44764,44776,44779,44781,44788,44792,44796,44807,44808,44813,44816,44844,44845,44848,44850,44852,44860,44861,44863,44865,44866,44867,44872,44873,44880,44892,44893,44900,44901,44921,44928,44932,44936,44944,44945,44949,44956,44984,44985,44988,44992,44999,45000,45001,45003,45005,45006,45012,45020,45032,45033,45040,45041,45044,45048,45056,45057,45060,45068,45072,45076,45084,45085,45096,45124,45125,45128,45130,45132,45134,45139,45140,45141,45143,45145,45149,45180,45181,45184,45188,45196,45197,45199,45201,45208,45209,45210,45212,45215,45216,45217,45218,45224,45225,45227,45228,45229,45230,45231,45233,45235,45236,45237,45240,45244,45252,45253,45255,45256,45257,45264,45265,45268,45272,45280,45285,45320,45321,45323,45324,45328,45330,45331,45336,45337,45339,45340,45341,45347,45348,45349,45352,45356,45364,45365,45367,45368,45369,45376,45377,45380,45384,45392,45393,45396,45397,45400,45404,45408,45432,45433,45436,45440,45442,45448,45449,45451,45453,45458,45459,45460,45464,45468,45480,45516,45520,45524,45532,45533,45535,45544,45545,45548,45552,45561,45563,45565,45572,45573,45576,45579,45580,45588,45589,45591,45593,45600,45620,45628,45656,45660,45664,45672,45673,45684,45685,45692,45700,45701,45705,45712,45713,45716,45720,45721,45722,45728,45729,45731,45733,45734,45738,45740,45744,45748,45768,45769,45772,45776,45778,45784,45785,45787,45789,45794,45796,45797,45798,45800,45803,45804,45805,45806,45807,45811,45812,45813,45815,45816,45817,45818,45819,45823,45824,45825,45828,45832,45840,45841,45843,45844,45845,45852,45908,45909,45910,45912,45915,45916,45918,45919,45924,45925,45927,45929,45931,45934,45936,45937,45940,45944,45952,45953,45955,45956,45957,45964,45968,45972,45984,45985,45992,45996,46020,46021,46024,46027,46028,46030,46032,46036,46037,46039,46041,46043,46045,46048,46052,46056,46076,46096,46104,46108,46112,46120,46121,46123,46132,46160,46161,46164,46168,46176,46177,46179,46181,46188,46208,46216,46237,46244,46248,46252,46261,46263,46265,46272,46276,46280,46288,46293,46300,46301,46304,46307,46308,46310,46316,46317,46319,46321,46328,46356,46357,46360,46363,46364,46372,46373,46375,46376,46377,46378,46384,46385,46388,46392,46400,46401,46403,46404,46405,46411,46412,46413,46416,46420,46428,46429,46431,46432,46433,46496,46497,46500,46504,46506,46507,46512,46513,46515,46516,46517,46523,46524,46525,46528,46532,46540,46541,46543,46544,46545,46552,46572,46608,46609,46612,46616,46629,46636,46644,46664,46692,46696,46748,46749,46752,46756,46763,46764,46769,46804,46832,46836,46840,46848,46849,46853,46888,46889,46892,46895,46896,46904,46905,46907,46916,46920,46924,46932,46933,46944,46948,46952,46960,46961,46963,46965,46972,46973,46976,46980,46988,46989,46991,46992,46993,46994,46998,46999,47000,47001,47004,47008,47016,47017,47019,47020,47021,47028,47029,47032,47047,47049,47084,47085,47088,47092,47100,47101,47103,47104,47105,47111,47112,47113,47116,47120,47128,47129,47131,47133,47140,47141,47144,47148,47156,47157,47159,47160,47161,47168,47172,47185,47187,47196,47197,47200,47204,47212,47213,47215,47217,47224,47228,47245,47272,47280,47284,47288,47296,47297,47299,47301,47308,47312,47316,47325,47327,47329,47336,47337,47340,47344,47352,47353,47355,47357,47364,47384,47392,47420,47421,47424,47428,47436,47439,47441,47448,47449,47452,47456,47464,47465,47467,47469,47476,47477,47480,47484,47492,47493,47495,47497,47498,47501,47502,47532,47533,47536,47540,47548,47549,47551,47553,47560,47561,47564,47566,47567,47568,47569,47570,47576,47577,47579,47581,47582,47585,47587,47588,47589,47592,47596,47604,47605,47607,47608,47609,47610,47616,47617,47624,47637,47672,47673,47676,47680,47682,47688,47689,47691,47693,47694,47699,47700,47701,47704,47708,47716,47717,47719,47720,47721,47728,47729,47732,47736,47747,47748,47749,47751,47756,47784,47785,47787,47788,47792,47794,47800,47801,47803,47805,47812,47816,47832,47833,47868,47872,47876,47885,47887,47889,47896,47900,47904,47913,47915,47924,47925,47926,47928,47931,47932,47933,47934,47940,47941,47943,47945,47949,47951,47952,47956,47960,47969,47971,47980,48008,48012,48016,48036,48040,48044,48052,48055,48064,48068,48072,48080,48083,48120,48121,48124,48127,48128,48130,48136,48137,48139,48140,48141,48143,48145,48148,48149,48150,48151,48152,48155,48156,48157,48158,48159,48164,48165,48167,48169,48173,48176,48177,48180,48184,48192,48193,48195,48196,48197,48201,48204,48205,48208,48221,48260,48261,48264,48267,48268,48270,48276,48277,48279,48281,48282,48288,48289,48292,48295,48296,48304,48305,48307,48308,48309,48316,48317,48320,48324,48333,48335,48336,48337,48341,48344,48348,48372,48373,48374,48376,48380,48388,48389,48391,48393,48400,48404,48420,48428,48448,48456,48457,48460,48464,48472,48473,48484,48488,48512,48513,48516,48519,48520,48521,48522,48528,48529,48531,48533,48537,48538,48540,48548,48560,48568,48596,48597,48600,48604,48617,48624,48628,48632,48640,48643,48645,48652,48653,48656,48660,48668,48669,48671,48708,48709,48712,48716,48718,48724,48725,48727,48729,48730,48731,48736,48737,48740,48744,48746,48752,48753,48755,48756,48757,48763,48764,48765,48768,48772,48780,48781,48783,48784,48785,48792,48793,48808,48848,48849,48852,48855,48856,48864,48867,48868,48869,48876,48897,48904,48905,48920,48921,48923,48924,48925,48960,48961,48964,48968,48976,48977,48981,49044,49072,49093,49100,49101,49104,49108,49116,49119,49121,49212,49233,49240,49244,49248,49256,49257,49296,49297,49300,49304,49312,49313,49315,49317,49324,49325,49327,49328,49331,49332,49333,49334,49340,49341,49343,49344,49345,49349,49352,49353,49356,49360,49368,49369,49371,49372,49373,49380,49381,49384,49388,49396,49397,49399,49401,49408,49412,49416,49424,49429,49436,49437,49438,49439,49440,49443,49444,49446,49447,49452,49453,49455,49456,49457,49462,49464,49465,49468,49472,49480,49481,49483,49484,49485,49492,49493,49496,49500,49508,49509,49511,49512,49513,49520,49524,49528,49541,49548,49549,49550,49552,49556,49558,49564,49565,49567,49569,49573,49576,49577,49580,49584,49597,49604,49608,49612,49620,49623,49624,49632,49636,49640,49648,49649,49651,49660,49661,49664,49668,49676,49677,49679,49681,49688,49689,49692,49695,49696,49704,49705,49707,49709,49711,49713,49714,49716,49736,49744,49745,49748,49752,49760,49765,49772,49773,49776,49780,49788,49789,49791,49793,49800,49801,49808,49816,49819,49821,49828,49829,49832,49836,49837,49844,49845,49847,49849,49884,49885,49888,49891,49892,49899,49900,49901,49903,49905,49910,49912,49913,49915,49916,49920,49928,49929,49932,49933,49939,49940,49941,49944,49948,49956,49957,49960,49961,49989,50024,50025,50028,50032,50034,50040,50041,50044,50045,50052,50056,50060,50112,50136,50137,50140,50143,50144,50146,50152,50153,50157,50164,50165,50168,50184,50192,50212,50220,50224,50228,50236,50237,50248,50276,50277,50280,50284,50292,50293,50297,50304,50324,50332,50360,50364,50409,50416,50417,50420,50424,50426,50431,50432,50433,50444,50448,50452,50460,50472,50473,50476,50480,50488,50489,50491,50493,50500,50501,50504,50505,50506,50508,50509,50510,50515,50516,50517,50519,50520,50521,50525,50526,50528,50529,50532,50536,50544,50545,50547,50548,50549,50556,50557,50560,50564,50567,50572,50573,50575,50577,50581,50583,50584,50588,50592,50601,50612,50613,50616,50617,50619,50620,50621,50622,50628,50629,50630,50631,50632,50633,50634,50636,50638,50640,50641,50644,50648,50656,50657,50659,50661,50668,50669,50670,50672,50676,50678,50679,50684,50685,50686,50687,50688,50689,50693,50694,50695,50696,50700,50704,50712,50713,50715,50716,50724,50725,50728,50732,50733,50734,50736,50739,50740,50741,50743,50745,50747,50752,50753,50756,50760,50768,50769,50771,50772,50773,50780,50781,50784,50796,50799,50801,50808,50809,50812,50816,50824,50825,50827,50829,50836,50837,50840,50844,50852,50853,50855,50857,50864,50865,50868,50872,50873,50874,50880,50881,50883,50885,50892,50893,50896,50900,50908,50909,50912,50913,50920,50921,50924,50928,50936,50937,50941,50948,50949,50952,50956,50964,50965,50967,50969,50976,50977,50980,50984,50992,50993,50995,50997,50999,51004,51005,51008,51012,51018,51020,51021,51023,51025,51026,51027,51028,51029,51030,51031,51032,51036,51040,51048,51051,51060,51061,51064,51068,51069,51070,51075,51076,51077,51079,51080,51081,51082,51086,51088,51089,51092,51094,51095,51096,51098,51104,51105,51107,51108,51109,51110,51116,51117,51120,51124,51132,51133,51135,51136,51137,51144,51145,51148,51150,51152,51160,51165,51172,51176,51180,51200,51201,51204,51208,51210,51216,51217,51219,51221,51222,51228,51229,51232,51236,51244,51245,51247,51249,51256,51260,51264,51272,51273,51276,51277,51284,51312,51313,51316,51320,51322,51328,51329,51331,51333,51334,51335,51339,51340,51341,51348,51357,51359,51361,51368,51388,51389,51396,51400,51404,51412,51413,51415,51417,51424,51425,51428,51445,51452,51453,51456,51460,51461,51462,51468,51469,51471,51473,51480,51500,51508,51536,51537,51540,51544,51552,51553,51555,51564,51568,51572,51580,51592,51593,51596,51600,51608,51609,51611,51613,51648,51649,51652,51655,51656,51658,51664,51665,51667,51669,51670,51673,51674,51676,51677,51680,51682,51684,51687,51692,51693,51695,51696,51697,51704,51705,51708,51712,51720,51721,51723,51724,51725,51732,51736,51753,51788,51789,51792,51796,51804,51805,51807,51808,51809,51816,51837,51844,51864,51900,51901,51904,51908,51916,51917,51919,51921,51923,51928,51929,51936,51948,51956,51976,51984,51988,51992,52000,52001,52033,52040,52041,52044,52048,52056,52057,52061,52068,52088,52089,52124,52152,52180,52196,52199,52201,52236,52237,52240,52244,52252,52253,52257,52258,52263,52264,52265,52268,52270,52272,52280,52281,52283,52284,52285,52286,52292,52293,52296,52300,52308,52309,52311,52312,52313,52320,52324,52326,52328,52336,52341,52376,52377,52380,52384,52392,52393,52395,52396,52397,52404,52405,52408,52412,52420,52421,52423,52425,52432,52436,52452,52460,52464,52481,52488,52489,52492,52496,52504,52505,52507,52509,52516,52520,52524,52537,52572,52576,52580,52588,52589,52591,52593,52600,52616,52628,52629,52632,52636,52644,52645,52647,52649,52656,52676,52684,52688,52712,52716,52720,52728,52729,52731,52733,52740,52744,52748,52756,52761,52768,52769,52772,52776,52784,52785,52787,52789,52824,52825,52828,52831,52832,52833,52840,52841,52843,52845,52852,52853,52856,52860,52868,52869,52871,52873,52880,52881,52884,52888,52896,52897,52899,52900,52901,52908,52909,52929,52964,52965,52968,52971,52972,52980,52981,52983,52984,52985,52992,52993,52996,53000,53008,53009,53011,53013,53020,53024,53028,53036,53037,53039,53040,53041,53048,53076,53077,53080,53084,53092,53093,53095,53097,53104,53105,53108,53112,53120,53125,53132,53153,53160,53168,53188,53216,53217,53220,53224,53232,53233,53235,53237,53244,53248,53252,53265,53272,53293,53300,53301,53304,53308,53316,53317,53319,53321,53328,53332,53336,53344,53356,53357,53360,53364,53372,53373,53377,53412,53413,53416,53420,53428,53429,53431,53433,53440,53441,53444,53448,53449,53456,53457,53459,53460,53461,53468,53469,53472,53476,53484,53485,53487,53488,53489,53496,53517,53552,53553,53556,53560,53562,53568,53569,53571,53572,53573,53580,53581,53584,53588,53596,53597,53599,53601,53608,53612,53628,53636,53640,53664,53665,53668,53672,53680,53681,53683,53685,53690,53692,53696,53720,53748,53752,53767,53769,53776,53804,53805,53808,53812,53820,53821,53823,53825,53832,53852,53860,53888,53889,53892,53896,53904,53905,53909,53916,53920,53924,53932,53937,53944,53945,53948,53951,53952,53954,53960,53961,53963,53972,53976,53980,53988,53989,54000,54001,54004,54008,54016,54017,54019,54021,54028,54029,54030,54032,54036,54038,54044,54045,54047,54048,54049,54053,54056,54057,54060,54064,54072,54073,54075,54076,54077,54084,54085,54140,54141,54144,54148,54156,54157,54159,54160,54161,54168,54169,54172,54176,54184,54185,54187,54189,54196,54200,54204,54212,54213,54216,54217,54224,54232,54241,54243,54252,54253,54256,54260,54268,54269,54271,54273,54280,54301,54336,54340,54364,54368,54372,54381,54383,54392,54393,54396,54399,54400,54402,54408,54409,54411,54413,54420,54441,54476,54480,54484,54492,54495,54504,54508,54512,54520,54523,54525,54532,54536,54540,54548,54549,54551,54588,54589,54592,54596,54604,54605,54607,54609,54616,54617,54620,54624,54629,54632,54633,54635,54637,54644,54645,54648,54652,54660,54661,54663,54664,54665,54672,54693,54728,54729,54732,54736,54738,54744,54745,54747,54749,54756,54757,54760,54764,54772,54773,54775,54777,54784,54785,54788,54792,54800,54801,54803,54804,54805,54812,54816,54820,54829,54840,54841,54844,54848,54853,54856,54857,54859,54861,54865,54868,54869,54872,54876,54887,54889,54896,54897,54900,54915,54917,54924,54925,54928,54932,54941,54943,54945,54952,54956,54960,54969,54971,54980,54981,54984,54988,54993,54996,54999,55001,55008,55012,55016,55024,55029,55036,55037,55040,55044,55057,55064,55065,55068,55072,55080,55081,55083,55085,55092,55093,55096,55100,55108,55111,55113,55120,55121,55124,55126,55127,55128,55129,55136,55137,55139,55141,55145,55148,55152,55156,55164,55165,55169,55176,55177,55180,55184,55192,55193,55195,55197,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,20285,20339,20551,20729,21152,21487,21621,21733,22025,23233,23478,26247,26550,26551,26607,27468,29634,30146,31292,33499,33540,34903,34952,35382,36040,36303,36603,36838,39381,21051,21364,21508,24682,24932,27580,29647,33050,35258,35282,38307,20355,21002,22718,22904,23014,24178,24185,25031,25536,26438,26604,26751,28567,30286,30475,30965,31240,31487,31777,32925,33390,33393,35563,38291,20075,21917,26359,28212,30883,31469,33883,35088,34638,38824,21208,22350,22570,23884,24863,25022,25121,25954,26577,27204,28187,29976,30131,30435,30640,32058,37039,37969,37970,40853,21283,23724,30002,32987,37440,38296,21083,22536,23004,23713,23831,24247,24378,24394,24951,27743,30074,30086,31968,32115,32177,32652,33108,33313,34193,35137,35611,37628,38477,40007,20171,20215,20491,20977,22607,24887,24894,24936,25913,27114,28433,30117,30342,30422,31623,33445,33995,63744,37799,38283,21888,23458,22353,63745,31923,32697,37301,20520,21435,23621,24040,25298,25454,25818,25831,28192,28844,31067,36317,36382,63746,36989,37445,37624,20094,20214,20581,24062,24314,24838,26967,33137,34388,36423,37749,39467,20062,20625,26480,26688,20745,21133,21138,27298,30652,37392,40660,21163,24623,36850,20552,25001,25581,25802,26684,27268,28608,33160,35233,38548,22533,29309,29356,29956,32121,32365,32937,35211,35700,36963,40273,25225,27770,28500,32080,32570,35363,20860,24906,31645,35609,37463,37772,20140,20435,20510,20670,20742,21185,21197,21375,22384,22659,24218,24465,24950,25004,25806,25964,26223,26299,26356,26775,28039,28805,28913,29855,29861,29898,30169,30828,30956,31455,31478,32069,32147,32789,32831,33051,33686,35686,36629,36885,37857,38915,38968,39514,39912,20418,21843,22586,22865,23395,23622,24760,25106,26690,26800,26856,28330,30028,30328,30926,31293,31995,32363,32380,35336,35489,35903,38542,40388,21476,21481,21578,21617,22266,22993,23396,23611,24235,25335,25911,25925,25970,26272,26543,27073,27837,30204,30352,30590,31295,32660,32771,32929,33167,33510,33533,33776,34241,34865,34996,35493,63747,36764,37678,38599,39015,39640,40723,21741,26011,26354,26767,31296,35895,40288,22256,22372,23825,26118,26801,26829,28414,29736,34974,39908,27752,63748,39592,20379,20844,20849,21151,23380,24037,24656,24685,25329,25511,25915,29657,31354,34467,36002,38799,20018,23521,25096,26524,29916,31185,33747,35463,35506,36328,36942,37707,38982,24275,27112,34303,37101,63749,20896,23448,23532,24931,26874,27454,28748,29743,29912,31649,32592,33733,35264,36011,38364,39208,21038,24669,25324,36866,20362,20809,21281,22745,24291,26336,27960,28826,29378,29654,31568,33009,37979,21350,25499,32619,20054,20608,22602,22750,24618,24871,25296,27088,39745,23439,32024,32945,36703,20132,20689,21676,21932,23308,23968,24039,25898,25934,26657,27211,29409,30350,30703,32094,32761,33184,34126,34527,36611,36686,37066,39171,39509,39851,19992,20037,20061,20167,20465,20855,21246,21312,21475,21477,21646,22036,22389,22434,23495,23943,24272,25084,25304,25937,26552,26601,27083,27472,27590,27628,27714,28317,28792,29399,29590,29699,30655,30697,31350,32127,32777,33276,33285,33290,33503,34914,35635,36092,36544,36881,37041,37476,37558,39378,39493,40169,40407,40860,22283,23616,33738,38816,38827,40628,21531,31384,32676,35033,36557,37089,22528,23624,25496,31391,23470,24339,31353,31406,33422,36524,20518,21048,21240,21367,22280,25331,25458,27402,28099,30519,21413,29527,34152,36470,38357,26426,27331,28528,35437,36556,39243,63750,26231,27512,36020,39740,63751,21483,22317,22862,25542,27131,29674,30789,31418,31429,31998,33909,35215,36211,36917,38312,21243,22343,30023,31584,33740,37406,63752,27224,20811,21067,21127,25119,26840,26997,38553,20677,21156,21220,25027,26020,26681,27135,29822,31563,33465,33771,35250,35641,36817,39241,63753,20170,22935,25810,26129,27278,29748,31105,31165,33449,34942,34943,35167,63754,37670,20235,21450,24613,25201,27762,32026,32102,20120,20834,30684,32943,20225,20238,20854,20864,21980,22120,22331,22522,22524,22804,22855,22931,23492,23696,23822,24049,24190,24524,25216,26071,26083,26398,26399,26462,26827,26820,27231,27450,27683,27773,27778,28103,29592,29734,29738,29826,29859,30072,30079,30849,30959,31041,31047,31048,31098,31637,32000,32186,32648,32774,32813,32908,35352,35663,35912,36215,37665,37668,39138,39249,39438,39439,39525,40594,32202,20342,21513,25326,26708,37329,21931,20794,63755,63756,23068,25062,63757,25295,25343,63758,63759,63760,63761,63762,63763,37027,63764,63765,63766,63767,63768,35582,63769,63770,63771,63772,26262,63773,29014,63774,63775,38627,63776,25423,25466,21335,63777,26511,26976,28275,63778,30007,63779,63780,63781,32013,63782,63783,34930,22218,23064,63784,63785,63786,63787,63788,20035,63789,20839,22856,26608,32784,63790,22899,24180,25754,31178,24565,24684,25288,25467,23527,23511,21162,63791,22900,24361,24594,63792,63793,63794,29785,63795,63796,63797,63798,63799,63800,39377,63801,63802,63803,63804,63805,63806,63807,63808,63809,63810,63811,28611,63812,63813,33215,36786,24817,63814,63815,33126,63816,63817,23615,63818,63819,63820,63821,63822,63823,63824,63825,23273,35365,26491,32016,63826,63827,63828,63829,63830,63831,33021,63832,63833,23612,27877,21311,28346,22810,33590,20025,20150,20294,21934,22296,22727,24406,26039,26086,27264,27573,28237,30701,31471,31774,32222,34507,34962,37170,37723,25787,28606,29562,30136,36948,21846,22349,25018,25812,26311,28129,28251,28525,28601,30192,32835,33213,34113,35203,35527,35674,37663,27795,30035,31572,36367,36957,21776,22530,22616,24162,25095,25758,26848,30070,31958,34739,40680,20195,22408,22382,22823,23565,23729,24118,24453,25140,25825,29619,33274,34955,36024,38538,40667,23429,24503,24755,20498,20992,21040,22294,22581,22615,23566,23648,23798,23947,24230,24466,24764,25361,25481,25623,26691,26873,27330,28120,28193,28372,28644,29182,30428,30585,31153,31291,33796,35241,36077,36339,36424,36867,36884,36947,37117,37709,38518,38876,27602,28678,29272,29346,29544,30563,31167,31716,32411,35712,22697,24775,25958,26109,26302,27788,28958,29129,35930,38931,20077,31361,20189,20908,20941,21205,21516,24999,26481,26704,26847,27934,28540,30140,30643,31461,33012,33891,37509,20828,26007,26460,26515,30168,31431,33651,63834,35910,36887,38957,23663,33216,33434,36929,36975,37389,24471,23965,27225,29128,30331,31561,34276,35588,37159,39472,21895,25078,63835,30313,32645,34367,34746,35064,37007,63836,27931,28889,29662,32097,33853,63837,37226,39409,63838,20098,21365,27396,27410,28734,29211,34349,40478,21068,36771,23888,25829,25900,27414,28651,31811,32412,34253,35172,35261,25289,33240,34847,24266,26391,28010,29436,29701,29807,34690,37086,20358,23821,24480,33802,20919,25504,30053,20142,20486,20841,20937,26753,27153,31918,31921,31975,33391,35538,36635,37327,20406,20791,21237,21570,24300,24942,25150,26053,27354,28670,31018,34268,34851,38317,39522,39530,40599,40654,21147,26310,27511,28701,31019,36706,38722,24976,25088,25891,28451,29001,29833,32244,32879,34030,36646,36899,37706,20925,21015,21155,27916,28872,35010,24265,25986,27566,28610,31806,29557,20196,20278,22265,63839,23738,23994,24604,29618,31533,32666,32718,32838,36894,37428,38646,38728,38936,40801,20363,28583,31150,37300,38583,21214,63840,25736,25796,27347,28510,28696,29200,30439,32769,34310,34396,36335,36613,38706,39791,40442,40565,30860,31103,32160,33737,37636,40575,40595,35542,22751,24324,26407,28711,29903,31840,32894,20769,28712,29282,30922,36034,36058,36084,38647,20102,20698,23534,24278,26009,29134,30274,30637,32842,34044,36988,39719,40845,22744,23105,23650,27155,28122,28431,30267,32047,32311,34078,35128,37860,38475,21129,26066,26611,27060,27969,28316,28687,29705,29792,30041,30244,30827,35628,39006,20845,25134,38520,20374,20523,23833,28138,32184,36650,24459,24900,26647,63841,38534,21202,32907,20956,20940,26974,31260,32190,33777,38517,20442,21033,21400,21519,21774,23653,24743,26446,26792,28012,29313,29432,29702,29827,63842,30178,31852,32633,32696,33673,35023,35041,37324,37328,38626,39881,21533,28542,29136,29848,34298,36522,38563,40023,40607,26519,28107,29747,33256,38678,30764,31435,31520,31890,25705,29802,30194,30908,30952,39340,39764,40635,23518,24149,28448,33180,33707,37000,19975,21325,23081,24018,24398,24930,25405,26217,26364,28415,28459,28771,30622,33836,34067,34875,36627,39237,39995,21788,25273,26411,27819,33545,35178,38778,20129,22916,24536,24537,26395,32178,32596,33426,33579,33725,36638,37017,22475,22969,23186,23504,26151,26522,26757,27599,29028,32629,36023,36067,36993,39749,33032,35978,38476,39488,40613,23391,27667,29467,30450,30431,33804,20906,35219,20813,20885,21193,26825,27796,30468,30496,32191,32236,38754,40629,28357,34065,20901,21517,21629,26126,26269,26919,28319,30399,30609,33559,33986,34719,37225,37528,40180,34946,20398,20882,21215,22982,24125,24917,25720,25721,26286,26576,27169,27597,27611,29279,29281,29761,30520,30683,32791,33468,33541,35584,35624,35980,26408,27792,29287,30446,30566,31302,40361,27519,27794,22818,26406,33945,21359,22675,22937,24287,25551,26164,26483,28218,29483,31447,33495,37672,21209,24043,25006,25035,25098,25287,25771,26080,26969,27494,27595,28961,29687,30045,32326,33310,33538,34154,35491,36031,38695,40289,22696,40664,20497,21006,21563,21839,25991,27766,32010,32011,32862,34442,38272,38639,21247,27797,29289,21619,23194,23614,23883,24396,24494,26410,26806,26979,28220,28228,30473,31859,32654,34183,35598,36855,38753,40692,23735,24758,24845,25003,25935,26107,26108,27665,27887,29599,29641,32225,38292,23494,34588,35600,21085,21338,25293,25615,25778,26420,27192,27850,29632,29854,31636,31893,32283,33162,33334,34180,36843,38649,39361,20276,21322,21453,21467,25292,25644,25856,26001,27075,27886,28504,29677,30036,30242,30436,30460,30928,30971,31020,32070,33324,34784,36820,38930,39151,21187,25300,25765,28196,28497,30332,36299,37297,37474,39662,39747,20515,20621,22346,22952,23592,24135,24439,25151,25918,26041,26049,26121,26507,27036,28354,30917,32033,32938,33152,33323,33459,33953,34444,35370,35607,37030,38450,40848,20493,20467,63843,22521,24472,25308,25490,26479,28227,28953,30403,32972,32986,35060,35061,35097,36064,36649,37197,38506,20271,20336,24091,26575,26658,30333,30334,39748,24161,27146,29033,29140,30058,63844,32321,34115,34281,39132,20240,31567,32624,38309,20961,24070,26805,27710,27726,27867,29359,31684,33539,27861,29754,20731,21128,22721,25816,27287,29863,30294,30887,34327,38370,38713,63845,21342,24321,35722,36776,36783,37002,21029,30629,40009,40712,19993,20482,20853,23643,24183,26142,26170,26564,26821,28851,29953,30149,31177,31453,36647,39200,39432,20445,22561,22577,23542,26222,27493,27921,28282,28541,29668,29995,33769,35036,35091,35676,36628,20239,20693,21264,21340,23443,24489,26381,31119,33145,33583,34068,35079,35206,36665,36667,39333,39954,26412,20086,20472,22857,23553,23791,23792,25447,26834,28925,29090,29739,32299,34028,34562,36898,37586,40179,19981,20184,20463,20613,21078,21103,21542,21648,22496,22827,23142,23386,23413,23500,24220,63846,25206,25975,26023,28014,28325,29238,31526,31807,32566,33104,33105,33178,33344,33433,33705,35331,36000,36070,36091,36212,36282,37096,37340,38428,38468,39385,40167,21271,20998,21545,22132,22707,22868,22894,24575,24996,25198,26128,27774,28954,30406,31881,31966,32027,33452,36033,38640,63847,20315,24343,24447,25282,23849,26379,26842,30844,32323,40300,19989,20633,21269,21290,21329,22915,23138,24199,24754,24970,25161,25209,26000,26503,27047,27604,27606,27607,27608,27832,63848,29749,30202,30738,30865,31189,31192,31875,32203,32737,32933,33086,33218,33778,34586,35048,35513,35692,36027,37145,38750,39131,40763,22188,23338,24428,25996,27315,27567,27996,28657,28693,29277,29613,36007,36051,38971,24977,27703,32856,39425,20045,20107,20123,20181,20282,20284,20351,20447,20735,21490,21496,21766,21987,22235,22763,22882,23057,23531,23546,23556,24051,24107,24473,24605,25448,26012,26031,26614,26619,26797,27515,27801,27863,28195,28681,29509,30722,31038,31040,31072,31169,31721,32023,32114,32902,33293,33678,34001,34503,35039,35408,35422,35613,36060,36198,36781,37034,39164,39391,40605,21066,63849,26388,63850,20632,21034,23665,25955,27733,29642,29987,30109,31639,33948,37240,38704,20087,25746,27578,29022,34217,19977,63851,26441,26862,28183,33439,34072,34923,25591,28545,37394,39087,19978,20663,20687,20767,21830,21930,22039,23360,23577,23776,24120,24202,24224,24258,24819,26705,27233,28248,29245,29248,29376,30456,31077,31665,32724,35059,35316,35443,35937,36062,38684,22622,29885,36093,21959,63852,31329,32034,33394,29298,29983,29989,63853,31513,22661,22779,23996,24207,24246,24464,24661,25234,25471,25933,26257,26329,26360,26646,26866,29312,29790,31598,32110,32214,32626,32997,33298,34223,35199,35475,36893,37604,40653,40736,22805,22893,24109,24796,26132,26227,26512,27728,28101,28511,30707,30889,33990,37323,37675,20185,20682,20808,21892,23307,23459,25159,25982,26059,28210,29053,29697,29764,29831,29887,30316,31146,32218,32341,32680,33146,33203,33337,34330,34796,35445,36323,36984,37521,37925,39245,39854,21352,23633,26964,27844,27945,28203,33292,34203,35131,35373,35498,38634,40807,21089,26297,27570,32406,34814,36109,38275,38493,25885,28041,29166,63854,22478,22995,23468,24615,24826,25104,26143,26207,29481,29689,30427,30465,31596,32854,32882,33125,35488,37266,19990,21218,27506,27927,31237,31545,32048,63855,36016,21484,22063,22609,23477,23567,23569,24034,25152,25475,25620,26157,26803,27836,28040,28335,28703,28836,29138,29990,30095,30094,30233,31505,31712,31787,32032,32057,34092,34157,34311,35380,36877,36961,37045,37559,38902,39479,20439,23660,26463,28049,31903,32396,35606,36118,36895,23403,24061,25613,33984,36956,39137,29575,23435,24730,26494,28126,35359,35494,36865,38924,21047,63856,28753,30862,37782,34928,37335,20462,21463,22013,22234,22402,22781,23234,23432,23723,23744,24101,24833,25101,25163,25480,25628,25910,25976,27193,27530,27700,27929,28465,29159,29417,29560,29703,29874,30246,30561,31168,31319,31466,31929,32143,32172,32353,32670,33065,33585,33936,34010,34282,34966,35504,35728,36664,36930,36995,37228,37526,37561,38539,38567,38568,38614,38656,38920,39318,39635,39706,21460,22654,22809,23408,23487,28113,28506,29087,29729,29881,32901,33789,24033,24455,24490,24642,26092,26642,26991,27219,27529,27957,28147,29667,30462,30636,31565,32020,33059,33308,33600,34036,34147,35426,35524,37255,37662,38918,39348,25100,34899,36848,37477,23815,23847,23913,29791,33181,34664,28629,25342,32722,35126,35186,19998,20056,20711,21213,21319,25215,26119,32361,34821,38494,20365,21273,22070,22987,23204,23608,23630,23629,24066,24337,24643,26045,26159,26178,26558,26612,29468,30690,31034,32709,33940,33997,35222,35430,35433,35553,35925,35962,22516,23508,24335,24687,25325,26893,27542,28252,29060,31698,34645,35672,36606,39135,39166,20280,20353,20449,21627,23072,23480,24892,26032,26216,29180,30003,31070,32051,33102,33251,33688,34218,34254,34563,35338,36523,36763,63857,36805,22833,23460,23526,24713,23529,23563,24515,27777,63858,28145,28683,29978,33455,35574,20160,21313,63859,38617,27663,20126,20420,20818,21854,23077,23784,25105,29273,33469,33706,34558,34905,35357,38463,38597,39187,40201,40285,22538,23731,23997,24132,24801,24853,25569,27138,28197,37122,37716,38990,39952,40823,23433,23736,25353,26191,26696,30524,38593,38797,38996,39839,26017,35585,36555,38332,21813,23721,24022,24245,26263,30284,33780,38343,22739,25276,29390,40232,20208,22830,24591,26171,27523,31207,40230,21395,21696,22467,23830,24859,26326,28079,30861,33406,38552,38724,21380,25212,25494,28082,32266,33099,38989,27387,32588,40367,40474,20063,20539,20918,22812,24825,25590,26928,29242,32822,63860,37326,24369,63861,63862,32004,33509,33903,33979,34277,36493,63863,20335,63864,63865,22756,23363,24665,25562,25880,25965,26264,63866,26954,27171,27915,28673,29036,30162,30221,31155,31344,63867,32650,63868,35140,63869,35731,37312,38525,63870,39178,22276,24481,26044,28417,30208,31142,35486,39341,39770,40812,20740,25014,25233,27277,33222,20547,22576,24422,28937,35328,35578,23420,34326,20474,20796,22196,22852,25513,28153,23978,26989,20870,20104,20313,63871,63872,63873,22914,63874,63875,27487,27741,63876,29877,30998,63877,33287,33349,33593,36671,36701,63878,39192,63879,63880,63881,20134,63882,22495,24441,26131,63883,63884,30123,32377,35695,63885,36870,39515,22181,22567,23032,23071,23476,63886,24310,63887,63888,25424,25403,63889,26941,27783,27839,28046,28051,28149,28436,63890,28895,28982,29017,63891,29123,29141,63892,30799,30831,63893,31605,32227,63894,32303,63895,34893,36575,63896,63897,63898,37467,63899,40182,63900,63901,63902,24709,28037,63903,29105,63904,63905,38321,21421,63906,63907,63908,26579,63909,28814,28976,29744,33398,33490,63910,38331,39653,40573,26308,63911,29121,33865,63912,63913,22603,63914,63915,23992,24433,63916,26144,26254,27001,27054,27704,27891,28214,28481,28634,28699,28719,29008,29151,29552,63917,29787,63918,29908,30408,31310,32403,63919,63920,33521,35424,36814,63921,37704,63922,38681,63923,63924,20034,20522,63925,21000,21473,26355,27757,28618,29450,30591,31330,33454,34269,34306,63926,35028,35427,35709,35947,63927,37555,63928,38675,38928,20116,20237,20425,20658,21320,21566,21555,21978,22626,22714,22887,23067,23524,24735,63929,25034,25942,26111,26212,26791,27738,28595,28879,29100,29522,31613,34568,35492,39986,40711,23627,27779,29508,29577,37434,28331,29797,30239,31337,32277,34314,20800,22725,25793,29934,29973,30320,32705,37013,38605,39252,28198,29926,31401,31402,33253,34521,34680,35355,23113,23436,23451,26785,26880,28003,29609,29715,29740,30871,32233,32747,33048,33109,33694,35916,38446,38929,26352,24448,26106,26505,27754,29579,20525,23043,27498,30702,22806,23916,24013,29477,30031,63930,63931,20709,20985,22575,22829,22934,23002,23525,63932,63933,23970,25303,25622,25747,25854,63934,26332,63935,27208,63936,29183,29796,63937,31368,31407,32327,32350,32768,33136,63938,34799,35201,35616,36953,63939,36992,39250,24958,27442,28020,32287,35109,36785,20433,20653,20887,21191,22471,22665,23481,24248,24898,27029,28044,28263,28342,29076,29794,29992,29996,32883,33592,33993,36362,37780,37854,63940,20110,20305,20598,20778,21448,21451,21491,23431,23507,23588,24858,24962,26100,29275,29591,29760,30402,31056,31121,31161,32006,32701,33419,34261,34398,36802,36935,37109,37354,38533,38632,38633,21206,24423,26093,26161,26671,29020,31286,37057,38922,20113,63941,27218,27550,28560,29065,32792,33464,34131,36939,38549,38642,38907,34074,39729,20112,29066,38596,20803,21407,21729,22291,22290,22435,23195,23236,23491,24616,24895,25588,27781,27961,28274,28304,29232,29503,29783,33489,34945,36677,36960,63942,38498,39000,40219,26376,36234,37470,20301,20553,20702,21361,22285,22996,23041,23561,24944,26256,28205,29234,29771,32239,32963,33806,33894,34111,34655,34907,35096,35586,36949,38859,39759,20083,20369,20754,20842,63943,21807,21929,23418,23461,24188,24189,24254,24736,24799,24840,24841,25540,25912,26377,63944,26580,26586,63945,26977,26978,27833,27943,63946,28216,63947,28641,29494,29495,63948,29788,30001,63949,30290,63950,63951,32173,33278,33848,35029,35480,35547,35565,36400,36418,36938,36926,36986,37193,37321,37742,63952,63953,22537,63954,27603,32905,32946,63955,63956,20801,22891,23609,63957,63958,28516,29607,32996,36103,63959,37399,38287,63960,63961,63962,63963,32895,25102,28700,32104,34701,63964,22432,24681,24903,27575,35518,37504,38577,20057,21535,28139,34093,38512,38899,39150,25558,27875,37009,20957,25033,33210,40441,20381,20506,20736,23452,24847,25087,25836,26885,27589,30097,30691,32681,33380,34191,34811,34915,35516,35696,37291,20108,20197,20234,63965,63966,22839,23016,63967,24050,24347,24411,24609,63968,63969,63970,63971,29246,29669,63972,30064,30157,63973,31227,63974,32780,32819,32900,33505,33617,63975,63976,36029,36019,36999,63977,63978,39156,39180,63979,63980,28727,30410,32714,32716,32764,35610,20154,20161,20995,21360,63981,21693,22240,23035,23493,24341,24525,28270,63982,63983,32106,33589,63984,34451,35469,63985,38765,38775,63986,63987,19968,20314,20350,22777,26085,28322,36920,37808,39353,20219,22764,22922,23001,24641,63988,63989,31252,63990,33615,36035,20837,21316,63991,63992,63993,20173,21097,23381,33471,20180,21050,21672,22985,23039,23376,23383,23388,24675,24904,28363,28825,29038,29574,29943,30133,30913,32043,32773,33258,33576,34071,34249,35566,36039,38604,20316,21242,22204,26027,26152,28796,28856,29237,32189,33421,37196,38592,40306,23409,26855,27544,28538,30430,23697,26283,28507,31668,31786,34870,38620,19976,20183,21280,22580,22715,22767,22892,23559,24115,24196,24373,25484,26290,26454,27167,27299,27404,28479,29254,63994,29520,29835,31456,31911,33144,33247,33255,33674,33900,34083,34196,34255,35037,36115,37292,38263,38556,20877,21705,22312,23472,25165,26448,26685,26771,28221,28371,28797,32289,35009,36001,36617,40779,40782,29229,31631,35533,37658,20295,20302,20786,21632,22992,24213,25269,26485,26990,27159,27822,28186,29401,29482,30141,31672,32053,33511,33785,33879,34295,35419,36015,36487,36889,37048,38606,40799,21219,21514,23265,23490,25688,25973,28404,29380,63995,30340,31309,31515,31821,32318,32735,33659,35627,36042,36196,36321,36447,36842,36857,36969,37841,20291,20346,20659,20840,20856,21069,21098,22625,22652,22880,23560,23637,24283,24731,25136,26643,27583,27656,28593,29006,29728,30000,30008,30033,30322,31564,31627,31661,31686,32399,35438,36670,36681,37439,37523,37666,37931,38651,39002,39019,39198,20999,25130,25240,27993,30308,31434,31680,32118,21344,23742,24215,28472,28857,31896,38673,39822,40670,25509,25722,34678,19969,20117,20141,20572,20597,21576,22979,23450,24128,24237,24311,24449,24773,25402,25919,25972,26060,26230,26232,26622,26984,27273,27491,27712,28096,28136,28191,28254,28702,28833,29582,29693,30010,30555,30855,31118,31243,31357,31934,32142,33351,35330,35562,35998,37165,37194,37336,37478,37580,37664,38662,38742,38748,38914,40718,21046,21137,21884,22564,24093,24351,24716,25552,26799,28639,31085,31532,33229,34234,35069,35576,36420,37261,38500,38555,38717,38988,40778,20430,20806,20939,21161,22066,24340,24427,25514,25805,26089,26177,26362,26361,26397,26781,26839,27133,28437,28526,29031,29157,29226,29866,30522,31062,31066,31199,31264,31381,31895,31967,32068,32368,32903,34299,34468,35412,35519,36249,36481,36896,36973,37347,38459,38613,40165,26063,31751,36275,37827,23384,23562,21330,25305,29469,20519,23447,24478,24752,24939,26837,28121,29742,31278,32066,32156,32305,33131,36394,36405,37758,37912,20304,22352,24038,24231,25387,32618,20027,20303,20367,20570,23005,32964,21610,21608,22014,22863,23449,24030,24282,26205,26417,26609,26666,27880,27954,28234,28557,28855,29664,30087,31820,32002,32044,32162,33311,34523,35387,35461,36208,36490,36659,36913,37198,37202,37956,39376,31481,31909,20426,20737,20934,22472,23535,23803,26201,27197,27994,28310,28652,28940,30063,31459,34850,36897,36981,38603,39423,33537,20013,20210,34886,37325,21373,27355,26987,27713,33914,22686,24974,26366,25327,28893,29969,30151,32338,33976,35657,36104,20043,21482,21675,22320,22336,24535,25345,25351,25711,25903,26088,26234,26525,26547,27490,27744,27802,28460,30693,30757,31049,31063,32025,32930,33026,33267,33437,33463,34584,35468,63996,36100,36286,36978,30452,31257,31287,32340,32887,21767,21972,22645,25391,25634,26185,26187,26733,27035,27524,27941,28337,29645,29800,29857,30043,30137,30433,30494,30603,31206,32265,32285,33275,34095,34967,35386,36049,36587,36784,36914,37805,38499,38515,38663,20356,21489,23018,23241,24089,26702,29894,30142,31209,31378,33187,34541,36074,36300,36845,26015,26389,63997,22519,28503,32221,36655,37878,38598,24501,25074,28548,19988,20376,20511,21449,21983,23919,24046,27425,27492,30923,31642,63998,36425,36554,36974,25417,25662,30528,31364,37679,38015,40810,25776,28591,29158,29864,29914,31428,31762,32386,31922,32408,35738,36106,38013,39184,39244,21049,23519,25830,26413,32046,20717,21443,22649,24920,24921,25082,26028,31449,35730,35734,20489,20513,21109,21809,23100,24288,24432,24884,25950,26124,26166,26274,27085,28356,28466,29462,30241,31379,33081,33369,33750,33980,20661,22512,23488,23528,24425,25505,30758,32181,33756,34081,37319,37365,20874,26613,31574,36012,20932,22971,24765,34389,20508,63999,21076,23610,24957,25114,25299,25842,26021,28364,30240,33034,36448,38495,38587,20191,21315,21912,22825,24029,25797,27849,28154,29588,31359,33307,34214,36068,36368,36983,37351,38369,38433,38854,20984,21746,21894,24505,25764,28552,32180,36639,36685,37941,20681,23574,27838,28155,29979,30651,31805,31844,35449,35522,22558,22974,24086,25463,29266,30090,30571,35548,36028,36626,24307,26228,28152,32893,33729,35531,38737,39894,64000,21059,26367,28053,28399,32224,35558,36910,36958,39636,21021,21119,21736,24980,25220,25307,26786,26898,26970,27189,28818,28966,30813,30977,30990,31186,31245,32918,33400,33493,33609,34121,35970,36229,37218,37259,37294,20419,22225,29165,30679,34560,35320,23544,24534,26449,37032,21474,22618,23541,24740,24961,25696,32317,32880,34085,37507,25774,20652,23828,26368,22684,25277,25512,26894,27000,27166,28267,30394,31179,33467,33833,35535,36264,36861,37138,37195,37276,37648,37656,37786,38619,39478,39949,19985,30044,31069,31482,31569,31689,32302,33988,36441,36468,36600,36880,26149,26943,29763,20986,26414,40668,20805,24544,27798,34802,34909,34935,24756,33205,33795,36101,21462,21561,22068,23094,23601,28810,32736,32858,33030,33261,36259,37257,39519,40434,20596,20164,21408,24827,28204,23652,20360,20516,21988,23769,24159,24677,26772,27835,28100,29118,30164,30196,30305,31258,31305,32199,32251,32622,33268,34473,36636,38601,39347,40786,21063,21189,39149,35242,19971,26578,28422,20405,23522,26517,27784,28024,29723,30759,37341,37756,34756,31204,31281,24555,20182,21668,21822,22702,22949,24816,25171,25302,26422,26965,33333,38464,39345,39389,20524,21331,21828,22396,64001,25176,64002,25826,26219,26589,28609,28655,29730,29752,35351,37944,21585,22022,22374,24392,24986,27470,28760,28845,32187,35477,22890,33067,25506,30472,32829,36010,22612,25645,27067,23445,24081,28271,64003,34153,20812,21488,22826,24608,24907,27526,27760,27888,31518,32974,33492,36294,37040,39089,64004,25799,28580,25745,25860,20814,21520,22303,35342,24927,26742,64005,30171,31570,32113,36890,22534,27084,33151,35114,36864,38969,20600,22871,22956,25237,36879,39722,24925,29305,38358,22369,23110,24052,25226,25773,25850,26487,27874,27966,29228,29750,30772,32631,33453,36315,38935,21028,22338,26495,29256,29923,36009,36774,37393,38442,20843,21485,25420,20329,21764,24726,25943,27803,28031,29260,29437,31255,35207,35997,24429,28558,28921,33192,24846,20415,20559,25153,29255,31687,32232,32745,36941,38829,39449,36022,22378,24179,26544,33805,35413,21536,23318,24163,24290,24330,25987,32954,34109,38281,38491,20296,21253,21261,21263,21638,21754,22275,24067,24598,25243,25265,25429,64006,27873,28006,30129,30770,32990,33071,33502,33889,33970,34957,35090,36875,37610,39165,39825,24133,26292,26333,28689,29190,64007,20469,21117,24426,24915,26451,27161,28418,29922,31080,34920,35961,39111,39108,39491,21697,31263,26963,35575,35914,39080,39342,24444,25259,30130,30382,34987,36991,38466,21305,24380,24517,27852,29644,30050,30091,31558,33534,39325,20047,36924,19979,20309,21414,22799,24264,26160,27827,29781,33655,34662,36032,36944,38686,39957,22737,23416,34384,35604,40372,23506,24680,24717,26097,27735,28450,28579,28698,32597,32752,38289,38290,38480,38867,21106,36676,20989,21547,21688,21859,21898,27323,28085,32216,33382,37532,38519,40569,21512,21704,30418,34532,38308,38356,38492,20130,20233,23022,23270,24055,24658,25239,26477,26689,27782,28207,32568,32923,33322,64008,64009,38917,20133,20565,21683,22419,22874,23401,23475,25032,26999,28023,28707,34809,35299,35442,35559,36994,39405,39608,21182,26680,20502,24184,26447,33607,34892,20139,21521,22190,29670,37141,38911,39177,39255,39321,22099,22687,34395,35377,25010,27382,29563,36562,27463,38570,39511,22869,29184,36203,38761,20436,23796,24358,25080,26203,27883,28843,29572,29625,29694,30505,30541,32067,32098,32291,33335,34898,64010,36066,37449,39023,23377,31348,34880,38913,23244,20448,21332,22846,23805,25406,28025,29433,33029,33031,33698,37583,38960,20136,20804,21009,22411,24418,27842,28366,28677,28752,28847,29074,29673,29801,33610,34722,34913,36872,37026,37795,39336,20846,24407,24800,24935,26291,34137,36426,37295,38795,20046,20114,21628,22741,22778,22909,23733,24359,25142,25160,26122,26215,27627,28009,28111,28246,28408,28564,28640,28649,28765,29392,29733,29786,29920,30355,31068,31946,32286,32993,33446,33899,33983,34382,34399,34676,35703,35946,37804,38912,39013,24785,25110,37239,23130,26127,28151,28222,29759,39746,24573,24794,31503,21700,24344,27742,27859,27946,28888,32005,34425,35340,40251,21270,21644,23301,27194,28779,30069,31117,31166,33457,33775,35441,35649,36008,38772,64011,25844,25899,30906,30907,31339,20024,21914,22864,23462,24187,24739,25563,27489,26213,26707,28185,29029,29872,32008,36996,39529,39973,27963,28369,29502,35905,38346,20976,24140,24488,24653,24822,24880,24908,26179,26180,27045,27841,28255,28361,28514,29004,29852,30343,31681,31783,33618,34647,36945,38541,40643,21295,22238,24315,24458,24674,24724,25079,26214,26371,27292,28142,28590,28784,29546,32362,33214,33588,34516,35496,36036,21123,29554,23446,27243,37892,21742,22150,23389,25928,25989,26313,26783,28045,28102,29243,32948,37237,39501,20399,20505,21402,21518,21564,21897,21957,24127,24460,26429,29030,29661,36869,21211,21235,22628,22734,28932,29071,29179,34224,35347,26248,34216,21927,26244,29002,33841,21321,21913,27585,24409,24509,25582,26249,28999,35569,36637,40638,20241,25658,28875,30054,34407,24676,35662,40440,20807,20982,21256,27958,33016,40657,26133,27427,28824,30165,21507,23673,32007,35350,27424,27453,27462,21560,24688,27965,32725,33288,20694,20958,21916,22123,22221,23020,23305,24076,24985,24984,25137,26206,26342,29081,29113,29114,29351,31143,31232,32690,35440,0];var a=b.length-1;sofo.utils.convert_ksc5601_to_ucs2=function(e,d){var f=(e-161)*94+d-161;var g;if(f>=0&&f<a){g=b[f];if(g!=-1){return g;}}return 0;};sofo.utils.ksc5601_to_ucs2=function(g){var f;var h=[];for(f=0;f<g.length;++f){var e=g.charCodeAt(f);var d;if(0<=e&&e<128){h.push(String.fromCharCode(e));}else{if(f+1==g.length){if(0<=e&&e<128){h.push(String.fromCharCode(e));}else{if(e<256){h.push("?");}else{h.push("??");}}}else{d=g.charCodeAt(f+1);var l=sofo.utils.convert_ksc5601_to_ucs2(e,d);if(l!=0){h.push(String.fromCharCode(l));f++;}else{if(e<256){h.push("?");}else{h.push("??");}}}}}return h.join("");};sofo.utils.ucs2_to_ksc5601=function(m){var g;var h=forge.util.createBuffer();for(g=0;g<m.length;++g){var f;var e;var n=m.charCodeAt(g);if(0<=n&&n<128){h.putByte(n);}else{var d=b.indexOf(n);if(d!=-1){var l=Math.floor(d/94);f=l+161;e=d-l*94+161;h.putByte(f);h.putByte(e);}else{h.putByte("?".charCodeAt(0));if(n>=256){h.putByte("?".charCodeAt(0));}}}}return h;};})();(function(){"";var E=sofo.storage;var A=sofo.error;var J=sofo.open||{};var c=forge.asn1;var o=forge.pkcs12;var C=forge.crypto;var a=forge.pki;var y=forge.random;var e=forge.util;var P=forge.md.sha1;var L=forge.md.sha256;var M=0;var z=1;var B=11;var G=13;var g=14;var H=null;var h=["local"];var l="AnySignWebCertStorage";var F="CertandKey";var Q=null;var S="";var s=null;var d;var p;var w;var u=false;var n=true;E.setCrossStorage=function(W,T,U){try{if(W!==null&&typeof W!=="undefined"&&W!==""){Q=new CrossStorageClient(W,T);if(Q!==null&&typeof Q!=="undefined"){Q.onConnect().then(function(){S=W;h=[];h.push("crossweb");if(U){U(0);}return 0;})["catch"](function(X){A.setError(A.ERROR_SETCROSSSTORAGE_FAIL,X);if(typeof Q.close==="function"){Q.close();}if(U){U(-1);}return-1;});}}else{if(U){U(0);}return 0;}}catch(V){A.setError(A.ERROR_SETCROSSSTORAGE_FAIL,V);if(U){U(-1);}return-1;}};E.setOpenStorage=function(X,W,U,T,V){if(typeof T!=="undefined"){s=T;}d=X;p=W;w=U;if(V){V(0);}return 0;};E.setItem=function(Y,U,W,T,V){try{if(T==="session"){e.setItem(Q,Y,U,W,["session"],V);}else{e.setItem(Q,Y,U,W,h,V);}}catch(X){throw X;}};E.getItem=function(X,U,T,V){try{if(T==="session"){return e.getItem(Q,X,U,["session"],V);}else{return e.getItem(Q,X,U,h,V);}}catch(W){throw W;}};E.removeItem=function(X,U,T,V){try{if(T==="session"){e.removeItem(Q,X,U,["session"],V);}else{e.removeItem(Q,X,U,h,V);}}catch(W){A.setError(A.ERROR_LOCALSTORAGE_FAIL,W);if(V){V(-1);}return-1;}};E.clearItems=function(W,T,U){try{if(T==="session"){e.clearItems(Q,W,["session"],U);}else{e.clearItems(Q,W,h,U);}}catch(V){A.setError(A.ERROR_LOCALSTORAGE_FAIL,V);if(U){U(-1);}return-1;}};E.chunkToData=function(V){var U=V;var T=c.fromDer(e.createBuffer(U));return T;};E.dataToChunk=function(V){var U=V;var T=c.toDer(U);return T;};E.saveCertKey=function(X,ab,V,W,ac,Y,aa){try{var U=this;var T=function(ae){var ah=[];var ag=false;if(ae===null){ah=[];}else{ah=ae;}var ai=E.getCertFingerPrint(X);for(var af=0;af<ah.length;af++){if(ah[af].id===ai){ag=true;break;}}if(ag!==true){var ad=_encryptCertKey(X,ab,V,W,ac);if(!ad){A.setError(A.ERROR_SAVECERT);aa(-1);return-1;}ah.push({id:ai,cert:ad});}else{if(Y==1){var ad=_encryptCertKey(X,ab,V,W,ac);if(!ad){A.setError(A.ERROR_SAVECERT);aa(-1);return-1;}ah.splice(af,1,{id:ai,cert:ad});}else{A.setError(A.ERROR_SAVE_CERT_ALREADY_EXIST);aa(1);return 1;}}U.setItem(l,F,ah,ac,aa);};this.getItem(l,F,ac,T);}catch(Z){A.setError(A.ERROR_SAVECERT,Z);aa(-1);}};E.saveOpenCertKey=function(Y,W,ad,ac,X,ag,ab,ai,aj){var U=Y;var T=W;var af=ad;var aa=ac;var ae=E.getCertFingerPrint(Y);var V=(new Date).getTime();try{var Z=this;var ah=function(an){var ar=[];var ap=false;if(an===null){ar=[];}else{ar=an;}for(var ao=0;ao<ar.length;ao++){if(ar[ao].id===ae){ap=true;break;}}if(ap!==true){var am=_encryptCertKey(Y,W,ad,ac,ag);if(!am){A.setError(A.ERROR_SAVECERT);aj(-1);return-1;}ar.push({id:ae,cert:am,timestamp:V});}else{if(ab==1){var am=_encryptCertKey(Y,W,ad,ac,ag);if(!am){A.setError(A.ERROR_SAVECERT);aj(-1);return-1;}ar.splice(ao,1,{id:ae,cert:am,timestamp:V});}else{A.setError(A.ERROR_SAVE_CERT_ALREADY_EXIST);aj(1);return 1;}}var al=function(at){if(at!==0){if(aj){aj(-1);}else{return-1;}}else{Z.setItem(l,F,ar,ag,aj);}};var aq=function(at){if(at!==0){if(aj){aj(-5000);}else{return-5000;}}else{u=true;J.setCertOpenStorage(U,T,af,aa,ae,X,V,ai,al);}};if(u==false){J.init(d,p,w,aq);}else{aq(0);}return;};this.getItem(l,F,ag,ah);}catch(ak){A.setError(A.ERROR_SAVECERT,ak);aj(-1);}};E.saveCertKeyFromOpenCert=function(Y,af,W,X,ab,ag,aa,Z,ae){var V=E.getCertFingerPrint(Y);var ad=Z;try{var U=this;var T=function(ai){var al=[];var ak=false;if(ai===null){al=[];}else{al=ai;}for(var aj=0;aj<al.length;aj++){if(al[aj].id===V){ak=true;break;}}if(ak!==true){var ah=_encryptCertKey(Y,af,W,X,ag);if(!ah){A.setError(A.ERROR_SAVECERT);ae(-1);return-1;}al.push({id:V,cert:ah,timestamp:ad});}else{if(aa==1){var ah=_encryptCertKey(Y,af,W,X,ag);if(!ah){A.setError(A.ERROR_SAVECERT);ae(-1);return-1;}al.splice(aj,1,{id:V,cert:ah,timestamp:ad});}else{A.setError(A.ERROR_SAVE_CERT_ALREADY_EXIST);ae(1);return 1;}}U.setItem(l,F,al,ag,ae);};this.getItem(l,F,ag,T);}catch(ac){A.setError(A.ERROR_SAVECERT,ac);ae(-1);}};E.changeCertPriKey=function(Y,ac,V,W,ad,ab){var Z=[];var X=false;try{var U=this;var T=function(ae){if(ae===null){Z=[];}else{Z=ae;}var ag=E.getCertFingerPrint(Y);var af;for(af=0;af<Z.length;af++){if(Z[af].id===ag){X=true;break;}}if(X===true){Z.splice(af,1,{id:ag,cert:_encryptCertKey(Y,ac,V?V:null,W?W:null,ad)});}else{A.setError(A.ERROR_GETCERTIFICATE);ab(-1);return-1;}U.setItem(l,F,Z,ad,ab);};this.getItem(l,F,ad,T);}catch(aa){A.setError(A.ERROR_CHANGECERTPASSWORD,aa);ab(-1);}};E.changeOpenCertPriKey=function(Y,X,ad,ac,al,W,ah,ai){var U=Y;var T=X;var ae=ad;var aa=ac;var ab=[];var af=false;var V=(new Date).getTime();try{var Z=this;var ak=null;var ag=function(an){if(an===null){ab=[];}else{ab=an;}var aq=E.getCertFingerPrint(Y);var ao;for(ao=0;ao<ab.length;ao++){if(ab[ao].id===aq){af=true;break;}}if(af===true){if(s){ak=s({type:"",args:"",onconfirm:"",oncancel:function(){ak.dispose();}});ak.show();}ab.splice(ao,1,{id:aq,cert:_encryptCertKey(Y,X,ad?ad:null,ac?ac:null,ah),timestamp:V});var am=function(ar){if(ak){ak.dispose();ak=null;}if(ar!==0){if(ai){ai(-1);}return-1;}else{Z.setItem(l,F,ab,ah,ai);return 0;}};var ap=function(ar){if(ar!==0){if(ak){ak.dispose();ak=null;}if(ai){ai(-5000);}else{return-5000;}}else{u=true;J.setCertOpenStorage(U,T,ae,aa,aq,W,V,0,am);}};if(u==false){J.init(d,p,w,ap);}else{ap(0);}return;}else{if(s){ak=s({type:"",args:"",onconfirm:"",oncancel:function(){ak.dispose();}});ak.show();}var am=function(av,ar,ax){if(av.error){if(ak){ak.dispose();ak=null;}ai(-1);return-1;}var at=av;var au=function(ay){if(ak){ak.dispose();ak=null;}if(ay!==0){if(ai){ai(-1);}else{return-1;}}else{ai(0);return 0;}};var aw=function(ay){if(ay!==0){if(ak){ak.dispose();ak=null;}if(ai){ai(-1);}return-1;}J.setCertOpenStorage(U,T,ae,aa,aq,W,ax,0,au);return 0;};if(ar==true){E.saveCertKeyFromOpenCert(U,T,ae,aa,W,null,1,ax,aw);}else{J.setCertOpenStorage(U,T,ae,aa,aq,W,ax,0,au);}return;};var ap=function(ar){if(ar!==0){if(ak){ak.dispose();ak=null;}if(ai){ai(-5000);}else{return-5000;}}else{u=true;J.getCertOpenStorage(aq,al,am);}};if(u==false){J.init(d,p,w,ap);}else{ap(0);}return;}};this.getItem(l,F,ah,ag);}catch(aj){A.setError(A.ERROR_CHANGECERTPASSWORD,aj);ai(-1);}};E.deleteCert=function(U,T,W){var Y=[];try{var Z=this;var V=function(aa){Y=aa;for(var ab=0;ab<Y.length;ab++){if(ab==U){Y.splice(ab,1);}}Z.setItem(l,F,Y,T,W);};this.getItem(l,F,T,V);}catch(X){A.setError(A.ERROR_DELETECERT,X);W(-1);}};E.deleteOpenCert=function(T,U,W){var Y=[];try{var Z=this;var V=function(ab){Y=ab;var ae=E.getCertFingerPrint(T.signCert);if(Y){for(var ac=0;ac<Y.length;ac++){if(Y[ac].id==ae){Y.splice(ac,1);}}}var aa=function(af){if(af.error){var ag=function(ah){if(W){W(-1);}return-1;};Z.setItem(l,F,Y,U,ag);}else{Z.setItem(l,F,Y,U,W);return 0;}};var ad=function(af){if(af!==0){if(W){W(-5000);}return-5000;}else{u=true;J.removeCert(ae,aa);}};if(u==false){J.init(d,p,w,ad);}else{ad(0);}return;};this.getItem(l,F,U,V);}catch(X){A.setError(A.ERROR_DELETECERT,X);W(-1);}};E.deleteOpenCertFromID=function(Z,U,W){var Y=[];try{var aa=this;var T=Z;var V=function(ad){Y=ad;if(Y){for(var ae=0;ae<Y.length;ae++){var af=_decryptCertKey(Y[ae].cert,U);if(!af){break;}var ab;for(var ah in af){if(ah==="signCert"){ab=af[ah];}}if(Y[ae].id==Z||ab.serialNumber.toLowerCase()==Z.toLowerCase()){T=Y[ae].id;Y.splice(ae,1);break;}}}var ac=function(ai){if(ai.error){var aj=function(ak){if(W){W(-1);}return-1;};aa.setItem(l,F,Y,U,aj);}else{aa.setItem(l,F,Y,U,W);return 0;}};var ag=function(ai){if(ai!==0){if(W){W(-5000);}return-5000;}else{u=true;J.removeCert(T,ac);}};if(u==false){J.init(d,p,w,ag);}else{ag(0);}return;};this.getItem(l,F,U,V);}catch(X){A.setError(A.ERROR_DELETECERT,X);W(-1);}};E.deleteOpenCertFromIndex=function(T,U,W){var Y=[];try{var Z=this;var aa;var V=function(ad){Y=ad;if(Y){for(var ae=0;ae<Y.length;ae++){if(ae==T){var af=_decryptCertKey(Y[ae].cert,U);if(!af){Y.splice(ae,1);break;}var ab;for(var ah in af){if(ah==="signCert"){ab=af[ah];}}aa=E.getCertFingerPrint(ab);Y.splice(ae,1);}}}var ac=function(ai){if(ai.error){var aj=function(ak){if(W){W(-1);}return-1;};Z.setItem(l,F,Y,U,aj);}else{Z.setItem(l,F,Y,U,W);return 0;}};var ag=function(ai){if(ai!==0){if(W){W(-5000);}return-5000;}else{u=true;J.removeCert(aa,ac);}};if(u==false){J.init(d,p,w,ag);}else{ag(0);}return;};this.getItem(l,F,U,V);}catch(X){A.setError(A.ERROR_DELETECERT,X);W(-1);}};E.getCertKey=function(Y,V){var U;var X=[];try{var T=function(Z){X=Z;if(typeof X!=="undefined"&&X.length!==0){for(var aa=0;aa<X.length;aa++){if(X[aa].id===Y){U={signCert:a.certificateFromAsn1(E.chunkToData(X[aa].cert),true),signKey:E.chunkToData(X[aa].key)};V(U);break;}}}else{A.setError(A.ERROR_GETCERT);V(-1);}};this.getItem(l,F,null,T);}catch(W){A.setError(A.ERROR_GETCERT,W);V(-1);}};E.getCertKeyList=function(U,W){var Y=[];var T=true;try{while(T){T=false;var V=function(ag){if(!ag){W(Y);return Y;}if(typeof ag!=="undefined"&&ag.length!==0){for(var ab=0;ab<ag.length;ab++){if(!ag[ab].cert){E.deleteCert(ab,U);T=true;break;}var ad=_decryptCertKey(ag[ab].cert,U);if(!ad){E.deleteCert(ab,U);T=true;break;}var aa,ac,Z,ae;for(var af in ad){if(af==="signCert"){aa=ad[af];}if(af==="signKey"){ac=ad[af];}if(af==="kmCert"){Z=ad[af];}if(af==="kmKey"){ae=ad[af];}}if(typeof aa!=="undefined"&&typeof ac!=="undefined"&&typeof Z!=="undefined"&&typeof ae!=="undefined"){Y.push({signCert:aa,signKey:ac,kmCert:Z,kmKey:ae});}else{if(typeof aa!=="undefined"&&typeof ac!=="undefined"){Y.push({signCert:aa,signKey:ac});}}}}if(T){if(Y.length>0){Y.splice(0,Y.length);}}else{if(Y.length==0){A.setError(A.ERROR_GETCERTTREE);}W(Y);}};this.getItem(l,F,U,V);}}catch(X){A.setError(A.ERROR_GETCERTTREE,X);W(Y);}};E.getCertKeyListOpenCert=function(U,W){var Y=[];var T=true;try{while(T){T=false;var V=function(ai){if(!ai){var ah=[];var ag=function(am){if(am.error){W(ah);return 0;}else{ah=[];for(var al=0;al<am.length;al++){if(am[al].status=="SAVE"){ah.push(am[al]);}}W(ah);return 0;}};var ab=function(al){if(al!==0){if(W){W(-5000);}else{return-5000;}}else{u=true;J.mergeCert(Y,ag);}};if(u==false){J.init(d,p,w,ab);}else{ab(0);}return;}if(typeof ai!=="undefined"&&ai.length!==0){for(var ak=0;ak<ai.length;ak++){if(!ai[ak].cert){E.deleteCert(ak,U);T=true;break;}var ac=_decryptCertKey(ai[ak].cert,U);if(!ac){E.deleteCert(ak,U);T=true;break;}var ad,aj,Z,aa;var af=ai[ak].timestamp;for(var ae in ac){if(ae==="signCert"){ad=ac[ae];}if(ae==="signKey"){aj=ac[ae];}if(ae==="kmCert"){Z=ac[ae];}if(ae==="kmKey"){aa=ac[ae];}}if(typeof ad!=="undefined"&&typeof aj!=="undefined"&&typeof Z!=="undefined"&&typeof aa!=="undefined"){Y.push({signCert:ad,signKey:aj,kmCert:Z,kmKey:aa,timestamp:af});}else{if(typeof ad!=="undefined"&&typeof aj!=="undefined"){Y.push({signCert:ad,signKey:aj,timestamp:af});}}}}if(T){if(Y.length>0){Y.splice(0,Y.length);}}else{if(Y.length==0){A.setError(A.ERROR_GETCERTTREE);}var ah=[];var ag=function(am){if(am.error){W(ah);return 0;}else{ah=[];for(var al=0;al<am.length;al++){if(am[al].status=="SAVE"){ah.push(am[al]);}}W(ah);return 0;}};var ab=function(al){if(al!==0){if(W){W(-5000);}else{return-5000;}}else{u=true;J.mergeCert(Y,ag);}};if(u==false){J.init(d,p,w,ab);}else{ab(0);}return;}};this.getItem(l,F,U,V);}}catch(X){A.setError(A.ERROR_GETCERTTREE,X);W(Y);}};E.getCertKeyListOpenCertWithPassword=function(aa,Z,W,ab,Y){var V=[];var T=true;if(W==""){ab=false;}try{while(T){T=false;var U=function(ak){if(!ak){var aj=function(aw){if(aw.error){Y(-1);return-1;}else{for(var at=0;at<aw.length;at++){if(aw[at].fingerprint==Z||aw[at].serial==parseInt(Z,16).toString()){if(aw[at].source=="OPENCERT"){var ar=aw[at].timestamp;if(W==""){var ax=[];ax.push(aw[at]);Y(ax);return 0;}else{var ao=null;var aq=function(aC,ay,aD){if(aC.error){if(ao){ao.dispose();ao=null;}Y(-1);return-1;}var az=aC;var aB=aC;var aA=function(aE){if(ao){ao.dispose();ao=null;}Y(aB);return 0;};if(ay==true){if(s){ao=s({type:"",args:"",onconfirm:"",oncancel:function(){ao.dispose();}});ao.show();}E.saveCertKeyFromOpenCert(az.signCert,az.signKey,az.kmCert,az.kmKey,W,aa,1,ar,aA);}else{Y(aB);}return;};var ap=function(ay){if(ay!==0){if(ao){ao.dispose();ao=null;}if(Y){Y(-5000);}else{return-5000;}}else{u=true;J.getCertOpenStorage(aw[at].fingerprint,W,aq);}};if(u==false){J.init(d,p,w,ap);}else{ap(0);}return;}}else{var au;for(index=0;index<V.length;++index){var an=E.getCertFingerPrint(V[index].signCert);if(an==Z||V[index].signCert.serialNumber.toLowerCase()==Z.toLowerCase()){au=V[index];if(aw[at].source=="LOCAL"&&ab==true){var ao=null;if(s){ao=s({type:"",args:"",onconfirm:"",oncancel:function(){ao.dispose();}});ao.show();}var av=function(ay){if(ao){ao.dispose();ao=null;}Y(au);return 0;};E.saveOpenCertKey(au.signCert,au.signKey,au.kmCert,au.kmKey,W,aa,1,1,av);}else{Y(au);}return 0;}}Y(au);return 0;}}}Y(-1);return 0;}};var ae=function(an){if(an!==0){if(Y){Y(-5000);}else{return-5000;}}else{u=true;J.mergeCert(V,aj);}};if(u==false){J.init(d,p,w,ae);}else{ae(0);}return;}if(typeof ak!=="undefined"&&ak.length!==0){for(var am=0;am<ak.length;am++){if(!ak[am].cert){E.deleteCert(am,aa);T=true;break;}var af=_decryptCertKey(ak[am].cert,aa);if(!af){E.deleteCert(am,aa);T=true;break;}var ag,al,ac,ad;var ai=ak[am].timestamp;for(var ah in af){if(ah==="signCert"){ag=af[ah];}if(ah==="signKey"){al=af[ah];}if(ah==="kmCert"){ac=af[ah];}if(ah==="kmKey"){ad=af[ah];}}if(typeof ag!=="undefined"&&typeof al!=="undefined"&&typeof ac!=="undefined"&&typeof ad!=="undefined"){V.push({signCert:ag,signKey:al,kmCert:ac,kmKey:ad,timestamp:ai});}else{if(typeof ag!=="undefined"&&typeof al!=="undefined"){V.push({signCert:ag,signKey:al,timestamp:ai});}}}}if(T){if(V.length>0){V.splice(0,V.length);}}else{if(V.length==0){A.setError(A.ERROR_GETCERTTREE);}var aj=function(aw){if(aw.error){Y(-1);return-1;}else{for(var at=0;at<aw.length;at++){if(aw[at].fingerprint==Z||aw[at].serial==parseInt(Z,16).toString()){if(aw[at].source=="OPENCERT"){var ar=aw[at].timestamp;if(W==""){var ax=[];ax.push(aw[at]);Y(ax);return 0;}else{var ao=null;var aq=function(aC,ay,aD){if(aC.error){if(ao){ao.dispose();ao=null;}Y(-1);return-1;}var az=aC;var aB=aC;var aA=function(aE){if(ao){ao.dispose();ao=null;}Y(aB);return 0;};if(ay==true){if(s){ao=s({type:"",args:"",onconfirm:"",oncancel:function(){ao.dispose();}});ao.show();}E.saveCertKeyFromOpenCert(az.signCert,az.signKey,az.kmCert,az.kmKey,W,aa,1,ar,aA);}else{Y(aB);}return 0;};var ap=function(ay){if(ay!==0){if(ao){ao.dispose();ao=null;}if(Y){Y(-5000);}else{return-5000;}}else{u=true;J.getCertOpenStorage(aw[at].fingerprint,W,aq);}};if(u==false){J.init(d,p,w,ap);}else{ap(0);}return;}}else{var au;for(index=0;index<V.length;++index){var an=E.getCertFingerPrint(V[index].signCert);if(an==Z||V[index].signCert.serialNumber.toLowerCase()==Z.toLowerCase()){au=V[index];if(aw[at].source=="LOCAL"&&ab==true){var ao=null;if(s){ao=s({type:"",args:"",onconfirm:"",oncancel:function(){ao.dispose();}});ao.show();}var av=function(ay){if(ao){ao.dispose();ao=null;}Y(au);return 0;};E.saveOpenCertKey(au.signCert,au.signKey,au.kmCert,au.kmKey,W,aa,1,1,av);}else{Y(au);}return 0;}}Y(au);return 0;}}}Y(-1);return 0;}};var ae=function(an){if(an!==0){if(Y){Y(-5000);}else{return-5000;}}else{u=true;J.mergeCert(V,aj);}};if(u==false){J.init(d,p,w,ae);}else{ae(0);}return;}};this.getItem(l,F,aa,U);}}catch(X){A.setError(A.ERROR_GETCERTTREE,X);Y(V);}};E.syncOpenCert=function(ae,ad,Z,ac){var Y=[];var X=false;try{var V=null;if(s){V=s({type:"",args:"",onconfirm:"",oncancel:function(){V.dispose();}});V.show();}if(ae=="LOCAL"){var U=this;var T=function(aq){if(typeof aq!=="undefined"&&aq.length!==0){for(var at=0;at<aq.length;at++){if(!aq[at].cert){E.deleteCert(at,null);retry=true;break;}var aj=_decryptCertKey(aq[at].cert,null);if(!aj){E.deleteCert(at,null);retry=true;break;}var ak,ar,ag,ai;var ap=aq[at].timestamp;if(!ap){ap=(new Date).getTime();X=true;}for(var al in aj){if(al==="signCert"){ak=aj[al];}if(al==="signKey"){ar=aj[al];}if(al==="kmCert"){ag=aj[al];}if(al==="kmKey"){ai=aj[al];}}if(typeof ak!=="undefined"&&typeof ar!=="undefined"&&typeof ag!=="undefined"&&typeof ai!=="undefined"){Y.push({signCert:ak,signKey:ar,kmCert:ag,kmKey:ai,timestamp:ap});}else{if(typeof ak!=="undefined"&&typeof ar!=="undefined"){Y.push({signCert:ak,signKey:ar,timestamp:ap});}}}}var an;for(index=0;index<Y.length;++index){var af=E.getCertFingerPrint(Y[index].signCert);if(af==ad){an=Y[index];break;}}var ao=function(au){if(V){V.dispose();V=null;}if(au!==0){if(ac){ac(-1);}else{return-1;}}else{ac(0);return 0;}};var am=function(au){if(X==true){E.saveCertKeyFromOpenCert(an.signCert,an.signKey,an.kmCert,an.kmKey,Z,null,1,an.timestamp,ao);}else{ao(au);}return;};var ah=function(au){if(au!==0){if(V){V.dispose();V=null;}if(ac){ac(-5000);}else{return-5000;}}else{u=true;J.setCertOpenStorage(an.signCert,an.signKey,an.kmCert,an.kmKey,ad,Z,an.timestamp,0,am);}};if(u==false){J.init(d,p,w,ah);}else{ah(0);}};this.getItem(l,F,null,T);return;}else{if(ae=="OPENCERT"){var ab=function(ai,af,ak){if(ai.error){if(V){V.dispose();V=null;}ac(-1);return-1;}var ag=ai;var ah=function(al){if(V){V.dispose();V=null;}if(al!==0){if(ac){ac(-1);}else{return-1;}}else{ac(0);return 0;}};var aj=function(al){if(al!==0){if(V){V.dispose();V=null;}if(ac){ac(-1);}return-1;}J.setCertOpenStorage(ag.signCert,ag.signKey,ag.kmCert,ag.kmKey,ad,Z,ak,0,ah);return 0;};ak=(new Date).getTime();E.saveCertKeyFromOpenCert(ag.signCert,ag.signKey,ag.kmCert,ag.kmKey,Z,null,1,ak,aj);return;};var W=function(af){if(af!==0){if(V){V.dispose();V=null;}if(ac){ac(-5000);}else{return-5000;}}else{u=true;J.getCertOpenStorage(ad,Z,ab);}};if(u==false){J.init(d,p,w,W);}else{W(0);}return;}else{if(V){V.dispose();V=null;}ac(0);return 0;}}return 0;}catch(aa){A.setError(A.ERROR_DELETECERT,aa);ac(-1);}};E.setOpenColudTray=function(T){J.setCloudTray(T);return;};E.getCertFingerPrint=function(U){var V=P.create();var W=c.toDer(a.certificateToAsn1(U)).getBytes();V.start();V.update(W);var T=V.digest();return T.toHex();};E.getCertListInfo=function(Y){var V;var U=Y.validity.notAfter;var X=Y.subject;var W=Y.issuer;var T=this.getCertFingerPrint(Y);V={subject:this.getAttributeValue(X.attributes,"CN"),id:T};return V;};E.getAttributeValue=function(V,U){for(var W=0;W<V.length;W++){var T=V[W];if(T.shortName===U){return I(T.value,T.valueTagClass);}}};function I(T,U){if(U==12||U==19){return e.decodeUtf8(T);}else{throw new Error("tagClass ["+U+"] is not supported");}}E.getCertKeyfromPKCS12=function(ac,ae){var T=[];if(!ac||!ae){throw new Error("invalid arguments for pkcs12.getKeyPair");}var X=ac.tagClass!==undefined?ac:c.fromDer(ac);var Z=o.pkcs12FromAsn1(X,ae);var aa=a.oids.certBag;var ab=Z.getBags({bagType:aa})[aa];var V=[];aa=a.oids.keyBag;V=V.concat(Z.getBags({bagType:aa})[aa]);aa=a.oids.pkcs8ShroudedKeyBag;V=V.concat(Z.getBags({bagType:aa})[aa]);for(var Y=0;Y<ab.length;Y++){var ad=ab[Y];for(var W=0;W<V.length;W++){var U=V[W];if(ad.attributes.localKeyId[0]==U.attributes.localKeyId[0]){T.push({signKey:U.key,signCert:ad.cert});}}}return T;};var R=new Array;E.saveMemCertKey=function(V,W,U,X){var T={signCert:null,signKey:null,kmCert:null,kmKey:null};if(R.length>0){R.splice(0,R.length);}T.signCert=V;T.signKey=W;T.kmCert=U;T.kmKey=X;R.push(T);};E.getMemCertKeyList=function(){return R;};E.clearMemCertKeyList=function(){delete R;R=null;R=new Array;};var v=new Array;E.saveXfsCertKey=function(V,W,U,X){var T={signCert:null,signKey:null,kmCert:null,kmKey:null};T.signCert=V;T.signKey=W;T.kmCert=U;T.kmKey=X;v.push(T);};E.deleteXfsCertKey=function(T){if(v.length>T){v.splice(T,1);return true;}else{return false;}};E.getXfsCertKeyList=function(){return v;};E.clearXfsCertKeyList=function(){delete v;v=null;v=new Array;};var f=["local"];var t="AnySignLocalStorage";E.setLocalStorage=function(T,V,U){try{var X=function(Y){if(Y!=0){A.setError(A.ERROR_API_FAIL);}U(Y);};e.setItem(null,t,T,V,f,X);}catch(W){A.setError(A.ERROR_LOCALSTORAGE_FAIL,W);if(U){U(-1);}return-1;}};E.getLocalStorage=function(T,U){try{e.getItem(null,t,T,f,U);}catch(V){A.setError(A.ERROR_LOCALSTORAGE_FAIL,V);if(U){U(-1);}return-1;}};var f=["local"];var t="apnStorage";E.setAPNStorage=function(T,V,U){try{var X=function(Y){if(Y!=0){A.setError(A.ERROR_API_FAIL);}U(Y);};e.setItem(null,t,T,V,f,X);}catch(W){A.setError(A.ERROR_LOCALSTORAGE_FAIL,W);if(U){U(-1);}return-1;}};E.getAPNStorage=function(T,U){try{e.getItem(null,t,T,f,U);}catch(V){A.setError(A.ERROR_LOCALSTORAGE_FAIL,V);if(U){U(-1);}return-1;}};E.clearAPNStorage=function(T){try{e.clearItems(null,t,f,T);}catch(U){A.setError(A.ERROR_LOCALSTORAGE_FAIL,U);if(T){T(-1);}return-1;}};E.checkAPNIndexedDBEnable=function(V){var T=window.indexedDB;var W=false;if(typeof T==="undefined"){console.log("indexedDB is undefined.");V(false);return false;}try{var U=T.open("APNSubDB",1);}catch(X){console.log("indexedDB open fail. ["+X+"]");if(!W){W=true;V(false);}return false;}U.onupgradeneeded=function(){console.log("indexedDB open occur event. onupgradeneeded!");return true;};U.onsuccess=function(){console.log("indexedDB open occur event. onsuccess!");if(!W){W=true;V(true);}this.result.close();return true;};U.onerror=function(Y){console.log("indexedDB open occur event. onerror!");if(!W){W=true;V(false);}return false;};};E.setAPNIndexedDBEnable=function(T){if(typeof T!=="undefined"){n=T;}return;};E.getAPNIndexedDBEnable=function(){return n;};E.setAPNIndexedDB=function(W,V,T){var U=V;_callIndexedDB(function(X){if(typeof X=="undefined"){A.setError(A.ERROR_INDEXEDDB_FAIL);if(T){T(-1);}return-1;}else{try{var Z=X.put({id:W,publicKey:U.publicKey,privateKey:U.privateKey});}catch(Y){A.setError(A.ERROR_INDEXEDDB_SET_FAIL,Y);if(T){T(-1);}return-1;}Z.onsuccess=function(){if(T){T(0);}return 0;};Z.onerror=function(){A.setError(A.ERROR_INDEXEDDB_SET_FAIL,Y);if(T){T(-1);}return-1;};}});};E.getAPNIndexedDB=function(U,T){_callIndexedDB(function(W){if(typeof W=="undefined"){A.setError(A.ERROR_INDEXEDDB_FAIL);if(T){T(-1);}return-1;}else{try{var V=W.get(U);}catch(X){A.setError(A.ERROR_INDEXEDDB_GET_FAIL,X);if(T){T(-1);}return-1;}V.onsuccess=function(){var Y={};if(typeof V.result!=="object"){A.setError(A.ERROR_INDEXEDDB_GET_FAIL);if(T){T(-1);}return-1;}Y.publicKey=V.result.publicKey;Y.privateKey=V.result.privateKey;(window.crypto||window.msCrypto).subtle.exportKey("spki",Y.publicKey).then(undefined,function(Z){A.setError(A.ERROR_WEBCRYPTO_EXPORTKEY_EXCEPTION,Z);if(T){T(-1);}return-1;}).then(function(aa){if(aa){var Z=forge.pki.rsa.publicKeyFromAsn1forCryptoKey(forge.asn1.fromDer(forge.util.createBuffer(aa)));Y.publicKeyPkcs7=Z;T(Y);}});};V.onerror=function(){A.setError(A.ERROR_INDEXEDDB_GET_FAIL);if(T){T(-1);}return-1;};}});};E.deleteAPNIndexedDB=function(U,T){_callIndexedDB(function(V){if(typeof V=="undefined"){A.setError(A.ERROR_INDEXEDDB_FAIL);if(T){T(-1);}return-1;}else{try{var X=V["delete"](U);}catch(W){A.setError(A.ERROR_INDEXEDDB_DELETE_FAIL,W);if(T){T(-1);}return-1;}X.onsuccess=function(){if(T){T(0);}return 0;};X.onerror=function(){A.setError(A.ERROR_INDEXEDDB_DELETE_FAIL,W);if(T){T(-1);}return-1;};}});};var D=["session"];var q="AnySignSessionStorage";E.setSessionStorage=function(T,W,V,U){var Y=function(Z){if(Z!=0){A.setError(A.ERROR_API_FAIL);}return U(Z);};try{if(V==1){return e.setItem(null,q,T,_encryptData(forge.util.createBuffer(JSON.stringify(W),"utf8")),D,Y);}else{return e.setItem(null,q,T,W,D,Y);}}catch(X){A.setError(A.ERROR_LOCALSTORAGE_FAIL,X);if(U){U(-1);}return-1;}};E.getSessionStorage=function(U,W,V){try{if(W==1){var T=function(Y){if(!Y){A.setError(A.ERROR_API_FAIL);V(null);return null;}else{var Z=_decryptData(Y);}if(!Z){A.setError(A.ERROR_API_FAIL);V(null);return null;}else{return V(JSON.parse(Z.getBytes()));}};return e.getItem(null,q,U,D,T);}else{return e.getItem(null,q,U,D,V);}}catch(X){A.setError(A.ERROR_LOCALSTORAGE_FAIL,X);if(V){V(-1);}return-1;}};E.deleteSessionStorage=function(T,U){try{e.removeItem(null,q,T,D,U);}catch(V){A.setError(A.ERROR_LOCALSTORAGE_FAIL,V);if(U){U(-1);}return-1;}};function K(ac,Y){if(!Y){return null;}if(!ac){return Y;}var Z=-1;var V="";if(typeof Y==="string"){var U=Y.indexOf("$");if(U==-1){return null;}Z=parseInt(Y.substring(0,U));if(Y.length>U+1){V=Y.substring(U+1);}}else{if(typeof Y==="object"){if(typeof Y.type!=="number"){return null;}Z=Y.type;if(Z==G){if(!Y.keypad||Y.keypad==null||Y.keypad=="undefined"){return null;}}else{return null;}}else{return null;}}var ab=ac.split("$");var T=0;var aa="";var X=false;for(var W=0;W<ab.length;W++){var U=ab[W].indexOf("|");if(U==-1){T=parseInt(ab[W]);}else{T=parseInt(ab[W].substring(0,U));if(ab[W].length>U+1){aa=ab[W].substring(U+1);}}if(T==Z){X=true;break;}}if(!X){return null;}if(Z==M){return V;}else{if(Z==G){return Y.keypad.get_input();}else{if(Z==z){return N(V,aa);}else{if(Z==B){return O(V,aa);}else{if(Z==g){return b(V);}else{return null;}}}}}}function b(X){var Z=[212,33,154,107,230,184,57,227,78,115,229,44,155,34,19,195,210,84,254,208,38,55,171,206,96,90,136,126,28,57,61,222];var W;var Y;var V;var aa="CBC";W=forge.util.hexToBytes(X.substr(0,32));Y=forge.util.hexToBytes(X.substr(32));V=forge.aria.createDecryptionCipher;var U=V(Z,aa);U.start(forge.util.createBuffer(W));U.update(forge.util.createBuffer(Y));U.finish();var T=U.output.getBytes().split("<::>");return T[0];}function N(V,ab){var ae;var W;var ad;var Y="CBC";var T="softforum";var ac;var aa;if(window.location.port){aa=window.location.host;}else{aa=window.location.hostname+":80";}ac=forge.md.sha1.create().update(ab+T).digest().getBytes().substr(0,20);ae=forge.md.sha1.create().update(aa+ac).digest().getBytes().substr(0,20);W="sosiconnwithsofo";ad=forge.seed.createDecryptionCipher;var X=forge.util.hexToBytes(V);var Z=ad(ae,Y);Z.start(W);Z.update(forge.util.createBuffer(X));Z.finish();var U=Z.output.getBytes();return U;}function O(Y,af){var aj;var Z;var ah;var ad="CBC";var U="softforum";var W="wXksGwIDAQABo1AwTjAdBgNVHQ4EFgQUnEyOz2mKK/";var ag;var ac;var ai;ag=forge.md.sha1.create().update(af+U).digest().getBytes().substr(0,20);aj=forge.md.sha1.create().update(W+ag).digest().getBytes().substr(0,20);ai="0x"+af[af.length-1];ac=parseInt(ai);ac=ac-1;if(ac==-1){ac=0;}var T;while(ac){T=forge.md.sha1.create().update(aj).digest().getBytes().substr(0,20);aj=T;ac--;}Z="sosiconnwithsofo";ah=forge.seed.createDecryptionCipher;var ab=forge.util.hexToBytes(Y);var ae=ah(aj,ad);ae.start(Z);ae.update(forge.util.createBuffer(ab));ae.finish();var X=ae.output.getBytes();for(var aa=0;aa<X.length;aa++){var V=Number(X.charCodeAt(aa)).toString(16);if(V==0){X=X.substr(0,aa);break;}}return X;}E.setCachedCert=function(Y,U,W,T,aa,Z,X){var V={};V.mediaID=Y;V.issuerRDN=U;V.serialNumber=W;V.cert=T;V.keyword="0$"+K(Z,aa);V.secureInput="0";var ab=function(ac){if(ac!=0){A.setError(A.ERROR_API_FAIL);}X(ac);};E.setSessionStorage("cachedData",V,1,ab);};E.getCachedCert=function(V){var U={};var T=function(W){if(W){U.mediaID=W.mediaID;U.issuerRDN=forge.util.decodeUtf8(W.issuerRDN);U.serialNumber=W.serialNumber;U.cert=W.cert;U.keyword=W.keyword;U.secureInput=W.secureInput;V(U);}else{A.setError(A.ERROR_API_FAIL);V(null);}};E.getSessionStorage("cachedData",1,T);};var m="";var r="anysignstorageiv";E.setSecureID=function(T){m=T;};E._setSecureInput=function(T){H=T;J._setSecureInput(T);};_encryptData=function(Y,ac){try{function T(ad){return forge.md.sha256.create().update(ad).digest().getBytes();}var X=T(l+m);var W=T(T(X.substr(0,16))+T(X.substr(16,16)));var V="";if(h.indexOf("crossweb")<0||ac==="session"){V=T(window.location.protocol+"//"+window.location.host+W);}else{var ab=S;var U=ab.indexOf("//")+2;V=T(ab.substr(0,ab.indexOf("/",U))+W);}var Z=forge.seed.createEncryptionCipher(V.substr(0,16),"CBC");Z.start(r);Z.update(forge.util.createBuffer(Y));Z.finish();return Z.output;}catch(aa){console.log("encryption failed. ["+aa+"]");return null;}};_decryptData=function(Y,ac){try{function T(ad){return forge.md.sha256.create().update(ad).digest().getBytes();}var X=T(l+m);var W=T(T(X.substr(0,16))+T(X.substr(16,16)));var V="";if(h.indexOf("crossweb")<0||ac==="session"){var V=T(window.location.protocol+"//"+window.location.host+W);}else{var ab=S;var U=ab.indexOf("//")+2;var V=T(ab.substr(0,ab.indexOf("/",U))+W);}var Z=forge.seed.createDecryptionCipher(V.substr(0,16),"CBC");Z.start(r);Z.update(forge.util.createBuffer(Y));Z.finish();return Z.output;}catch(aa){console.log("decryption failed. ["+aa+"]");return null;}};_encryptCertKey=function(V,aa,T,U,ab){var Y={type:null,data:null};var W={signCert:null,signKey:null,kmCert:null,kmKey:null};try{W.signCert=E.dataToChunk(a.certificateToAsn1(V));W.signKey=E.dataToChunk(aa);if(T&&U){W.kmCert=E.dataToChunk(a.certificateToAsn1(T));W.kmKey=E.dataToChunk(U);}var X=_encryptData(JSON.stringify(W),ab);if(!X){console.log("CertKey encryption failed.");return null;}Y.type="enc1";Y.data=X;return Y;}catch(Z){console.log("CertKey encryption failed. ["+Z+"]");return null;}};_decryptCertKey=function(U,T){var W={signCert:null,signKey:null,kmCert:null,kmKey:null};try{if(U.type!="enc1"){console.log("CertKey decryption failed. (1)");return null;}var Y=_decryptData(U.data,T);if(!Y){console.log("CertKey decryption failed. (2)");return null;}var X=JSON.parse(Y.getBytes());if(!X||!X.signCert||!X.signKey){console.log("CertKey decryption failed. (3)");return null;}W.signCert=a.certificateFromAsn1(E.chunkToData(X.signCert),true);W.signKey=E.chunkToData(X.signKey);if(X.kmCert&&X.kmKey){W.kmCert=a.certificateFromAsn1(E.chunkToData(X.kmCert),true);W.kmKey=E.chunkToData(X.kmKey);}return W;}catch(V){console.log("CertKey decryption failed. ["+V+"]");return null;}};_callIndexedDB=function(V){var T=window.indexedDB;if(typeof T==="undefined"){V();return;}try{var U=T.open("APNDatabase",1);}catch(W){console.log("indexedDB open fail. ["+W+"]");V();return;}U.onupgradeneeded=function(){var Y=U.result;var X=Y.createObjectStore("apnStorage",{keyPath:"id"});};U.onsuccess=function(){try{var Z=U.result;var X=Z.transaction("apnStorage","readwrite");var Y=X.objectStore("apnStorage");}catch(aa){console.log("indexedDB create transaction fail. ["+aa+"]");V();return;}V(Y);X.oncomplete=function(){Z.close();};};U.onerror=function(){V();return;};};})();(function(){var v=sofo.open||{};var o=sofo.pki||{};var C=sofo.error;var u=forge.asn1;var B=forge.md.sha1;var h=forge.pki;var z="";var g="";var t="";var a="";var s=false;var f="";var b=false;var d={fingerprint:"",timestamp:0,status:"",policyOID:"",source:"",issuer:"",subject:"",notBefore:"",notAfter:"",serial:"",cloud:false};var l=0;var n=1;var c=11;var A=13;var y=14;var e=null;v.init=function(O,N,M,L){z=O;var K=function(Q){if(Q.error){var T="";var S="";var R="[OpenCert Error] code : "+Q.error.code+", message : "+Q.error.message;if(Q.error.code==5000){T="브라우저 인증서비스 초기화에 실패하였습니다.";S="Browser Certificate Service initailization has failed.";C.setError(Q.error.code,T,S,R);}else{console.log(R);C.setError(C.ERROR_OPENCERT_INITIALIZE_FAIL,R);}if(L){L(-1);}return-1;}g=Q.serverNonce;OpenCert.getInstance().setEventListener("changeCertInfos",M);if(L){L(0);}return 0;};var P=function(Q){if(typeof OpenCert=="undefined"){C.setError(C.ERROR_OPENCERT_OPENCERTJS_LOAD_FAIL);if(L){L(-1);}return-1;}OpenCert.getInstance().init(z,K);};m(N,P,L);};v.setCertOpenStorage=function(R,M,Q,T,L,O,N,K,P){if(typeof OpenCert=="undefined"){C.setError(C.ERROR_OPENCERT_OPENCERTJS_LOAD_FAIL);if(P){P(-1);}return-1;}var S=F(O);H(L,S).then(function(V){var ac,aa,ad,Y,ae;var U=D(R.getExtension("certificatePolicies"));var ab=U.policy[0];d["fingerprint"]=L;d["subject"]=w(R.subject);d["issuer"]=w(R.issuer);ac=R.validity.notBefore.getFullYear();aa=R.validity.notBefore.getMonth()+1;ad=R.validity.notBefore.getDate();Y=ac+"-"+(aa<10?"0"+aa:aa)+"-"+(ad<10?"0"+ad:ad)+" 00:00:00";d["notBefore"]=Y;ac=R.validity.notAfter.getFullYear();aa=R.validity.notAfter.getMonth()+1;ad=R.validity.notAfter.getDate();ae=ac+"-"+(aa<10?"0"+aa:aa)+"-"+(ad<10?"0"+ad:ad)+" 23:59:59";d["notAfter"]=ae;d["policyOID"]=ab;d["source"]="LOCAL";d["status"]="SAVE";d["serial"]=parseInt(R.serialNumber,16).toString();d["cloud"]=false;if(N){d["timestamp"]=N;}else{d["timestamp"]=(new Date).getTime();}var X;if(K==1){X={mode:"tray"};}else{X={mode:"window"};}var W=o.certificateToPKCS12(R,M,Q,T,O,O,1);var Z=function(ah){if(ah.error){var ai="";var ag="";var af="[OpenCert Error] code : "+ah.error.code+", message : "+ah.error.message;if(ah.error.code==2211){ai=ah.error.message;ag="Wrong Password count "+ah.error.failCount+". If you input wrong password "+ah.error.maxFailCount+" times, it will be locked.";C.setError(ah.error.code,ai,ag,af);}else{if(ah.error.code==2212){ai=ah.error.message;ag="Lock password for this fingerprint.";C.setError(ah.error.code,ai,ag,af);}else{if(ah.error.code==2422){ai="클라우드에 저장 가능한 인증서 개수("+ah.error.certificateLimit+")를 초과하였습니다. 사용하지 않는 인증서는 클라우드에서 삭제해 주시기 바랍니다. * 삭제방법 : (클라우드표시된) 인증서 선택-> 인증서 삭제버튼 클릭";ag="ertificateLimit is over : "+ah.error.certificateLimit+" @BLE";C.setError(ah.error.code,ai,ag,af);}else{if(ah.error.code==2423){ai="클라우드에 인증서 복사가 실패하였습니다.("+ah.error.message+")";alert(ai);if(P){P(0);}return 0;}else{console.log(af);C.setError(ah.error.code,ah.error.message,ah.error.message,af);}}}}if(P){P(-1);}return-1;}if(P){P(0);}return 0;};OpenCert.getInstance().setPKCS12(W,d,V,Z,X);});};v.getCertOpenStorage=function(O,L,N){if(typeof OpenCert=="undefined"){var K={error:{code:C.ERROR_OPENCERT_OPENCERTJS_LOAD_FAIL}};C.setError(C.ERROR_OPENCERT_OPENCERTJS_LOAD_FAIL);if(N){N(K);}return K;}if(b==true&&t==O){if(N){N(a,s,f);}return;}var M=F(L);H(O,M).then(function(Q){var R=wizvera.util.arrayBufferToBase64Url((window.crypto||window.msCrypto).getRandomValues(new Uint8Array(20)));var P=function(U){if(U.error){var X="";var W="";var V="[OpenCert Error] code : "+U.error.code+", message : "+U.error.message;if(U.error.code==2211){X=U.error.message;W="Wrong Password count "+U.error.failCount+". If you input wrong password "+U.error.maxFailCount+" times, it will be locked.";C.setError(U.error.code,X,W,V);}else{if(U.error.code==2212){X=U.error.message;W="Lock password for this fingerprint.";C.setError(U.error.code,X,W,V);}else{if(U.error.code==2422){X="클라우드에 저장 가능한 인증서 개수("+U.error.certificateLimit+")를 초과하였습니다. 사용하지 않는 인증서는 클라우드에서 삭제해 주시기 바랍니다. * 삭제방법 : (클라우드표시된) 인증서 선택-> 인증서 삭제버튼 클릭";W="ertificateLimit is over : "+U.error.certificateLimit+" @BLE";C.setError(U.error.code,X,W,V);}else{console.log(V);C.setError(U.error.code,U.error.message,U.error.message,V);}}}if(N){N(U);}return;}var T;var S=false;if(U.pkcs12){T=U.pkcs12;S=true;}else{if(U.notSavePKCS12){T=U.notSavePKCS12;S=false;}}E(T,R,g).then(function(Z){var Y=o.certificateFromPFX(Z,L,L);if(N){b=true;t=O;a=Y;s=S;f=U.certInfo.timestamp;N(Y,S,U.certInfo.timestamp);}return;});};OpenCert.getInstance().getPKCS12(O,Q,R,P);});};v.removeCert=function(N,M){if(typeof OpenCert=="undefined"){var K={error:{code:C.ERROR_OPENCERT_OPENCERTJS_LOAD_FAIL}};C.setError(C.ERROR_OPENCERT_OPENCERTJS_LOAD_FAIL);if(M){M(K);}return K;}var L=function(O){if(O.error){var P="[OpenCert Error] code : "+O.error.errorDetail.code+", message : "+O.error.errorDetail.message;if(O.error.errorDetail.code==4307){if(M){M(0);}return 0;}else{console.log(P);C.setError(C.ERROR_OPENCERT_REMOVEPKCS12_FAIL,P);if(M){M(O);}return O;}}if(M){M(O);}return O;};OpenCert.getInstance().removePKCS12(N,L);};v.mergeCert=function(V,T){if(typeof OpenCert=="undefined"){var Y={error:{code:C.ERROR_OPENCERT_OPENCERTJS_LOAD_FAIL}};C.setError(C.ERROR_OPENCERT_OPENCERTJS_LOAD_FAIL);if(T){T(Y);}return Y;}var N=[];var R=function(Z){if(Z.error){var aa="[OpenCert Error] code : "+Z.error.code+", message : "+Z.error.message;console.log(aa);C.setError(C.ERROR_OPENCERT_MERGECERTINFOS_FAIL,aa);if(T){T(Z);}return Z;}var ab=Z.certInfos;OpenCert.getInstance().setTrayView(true);if(T){T(ab);}return 0;};if(V.length>0){for(var O=0;O<V.length;O++){var U,Q,W,P,X;var K=D(V[O].signCert.getExtension("certificatePolicies"));var S=K.policy[0];var L=r(V[O].signCert);var M={};M["fingerprint"]=L;M["subject"]=w(V[O].signCert.subject);M["issuer"]=w(V[O].signCert.issuer);U=V[O].signCert.validity.notBefore.getFullYear();Q=V[O].signCert.validity.notBefore.getMonth()+1;W=V[O].signCert.validity.notBefore.getDate();P=U+"-"+(Q<10?"0"+Q:Q)+"-"+(W<10?"0"+W:W)+" 00:00:00";M["notBefore"]=P;U=V[O].signCert.validity.notAfter.getFullYear();Q=V[O].signCert.validity.notAfter.getMonth()+1;W=V[O].signCert.validity.notAfter.getDate();X=U+"-"+(Q<10?"0"+Q:Q)+"-"+(W<10?"0"+W:W)+" 23:59:59";M["notAfter"]=X;M["policyOID"]=S;M["source"]="LOCAL";M["status"]="SAVE";M["serial"]=parseInt(V[O].signCert.serialNumber,16).toString();M["cloud"]=false;if(V[O].timestamp){M["timestamp"]=V[O].timestamp;}else{M["timestamp"]=(new Date).getTime();}N.push(M);}}OpenCert.getInstance().mergeCertInfos(N,R,{mode:"tray"});};v.setEventListener=function(K){if(typeof OpenCert=="undefined"){return;}OpenCert.getInstance().setEventListener("changeCertInfos",K);};v.close=function(){if(typeof OpenCert=="undefined"){return;}OpenCert.getInstance().close();};v.setCloudTray=function(K){if(typeof OpenCert=="undefined"){return;}OpenCert.getInstance().setTrayView(K);};v.getVersion=function(M){if(typeof OpenCert=="undefined"){var K={error:{code:C.ERROR_OPENCERT_OPENCERTJS_LOAD_FAIL}};C.setError(C.ERROR_OPENCERT_OPENCERTJS_LOAD_FAIL);if(M){M(K);}return K;}var L=function(N){if(M){M(N);}return 0;};OpenCert.getInstance().getVersion(L);};v._setSecureInput=function(K){e=K;};function q(K){return Array.prototype.map.call(new Uint8Array(K),function(L){return("00"+L.toString(16)).slice(-2);}).join("");}function p(L,K){if(typeof L=="string"){try{L=new TextEncoder("utf-8").encode(L);}catch(N){var M=new Uint8Array(L.length);for(var K=0;K<L.length;K++){M[K]=L.charCodeAt(K);}L=M;}}if(K==1||!K){return(window.crypto||window.msCrypto).subtle.digest({name:"SHA-256"},L);}else{return(window.crypto||window.msCrypto).subtle.digest({name:"SHA-256"},L).then(function(O){return p(O,--K);});}}function H(K,L){return p(K+L,2048).then(q);}function E(O,P,Q){var L,K,M;O=wizvera.util.base64UrlToArrayBuffer(O);L=O.slice(0,16);K=O.slice(16,O.byteLength);P=wizvera.util.base64UrlToArrayBuffer(P);Q=wizvera.util.base64UrlToArrayBuffer(Q);var N=new Uint8Array(P.byteLength+Q.byteLength);N.set(new Uint8Array(P),0);N.set(new Uint8Array(Q),P.byteLength);return p(N,2048).then(function(R){return(window.crypto||window.msCrypto).subtle.importKey("raw",R,{name:"AES-CBC"},false,["decrypt"]);}).then(function(R){return(window.crypto||window.msCrypto).subtle.decrypt({name:"AES-CBC",iv:L},R,K);}).then(wizvera.util.textDecode).then(undefined,function(R){console.error(R);});}function w(K){var L=[];K.attributes.forEach(function(M){L.push(M.shortName.toLowerCase()+"="+M.value);});return forge.util.decodeUtf8(L.reverse().join(","));}function r(L){var M=B.create();var N=u.toDer(h.certificateToAsn1(L)).getBytes();M.start();M.update(N);var K=M.digest();return K.toHex();}function D(P){var L={policy:[],unotice:[],cps:[]};var M=false;var Q=false;if(!P){return L;}function O(T){if(T.composed&&T.value instanceof Array){for(var S=0;S<T.value.length;S++){O(T.value[S]);}}else{if(T.tagClass==forge.asn1.Class.UNIVERSAL&&T.type==forge.asn1.Type.OID){var R=forge.asn1.derToOid(T.value);if(R=="1.3.6.1.5.5.7.2.2"){M=true;}else{if(R=="1.3.6.1.5.5.7.2.1"){Q=true;}else{M=false;Q=false;}}}else{if(M){L.unotice.push(T.value);}else{if(Q){L.cps.push(T.value);}}M=false;Q=false;}}}function K(T){if(!T){return;}if(T.composed&&T.value instanceof Array){for(var S=0;S<T.value.length;S++){if(T.value[S].composed&&T.value[S].value instanceof Array){for(var R=0;R<T.value[S].value.length;R++){if(T.value[S].value[R].tagClass==forge.asn1.Class.UNIVERSAL&&T.value[S].value[R].type==forge.asn1.Type.OID){L.policy.push(forge.asn1.derToOid(T.value[S].value[R].value));}else{O(T.value[S].value[R]);}}}}}}try{K(forge.asn1.fromDer(P.value));return L;}catch(N){return L;}}function F(P){if(!P){return null;}if(!e){return P;}var Q=-1;var M="";if(typeof P==="string"){var L=P.indexOf("$");if(L==-1){return null;}Q=parseInt(P.substring(0,L));if(P.length>L+1){M=P.substring(L+1);}}else{if(typeof P==="object"){if(typeof P.type!=="number"){return null;}Q=P.type;if(Q==A){if(!P.keypad||P.keypad==null||P.keypad=="undefined"){return null;}}else{return null;}}else{return null;}}var S=e.split("$");var K=0;var R="";var O=false;for(var N=0;N<S.length;N++){var L=S[N].indexOf("|");if(L==-1){K=parseInt(S[N]);}else{K=parseInt(S[N].substring(0,L));if(S[N].length>L+1){R=S[N].substring(L+1);}}if(K==Q){O=true;break;}}if(!O){return null;}if(Q==l){return M;}else{if(Q==A){return P.keypad.get_input();}else{if(Q==n){return G(M,R);}else{if(Q==c){return I(M,R);}else{if(Q==y){return J(M);}else{return null;}}}}}}function J(O){var Q=[212,33,154,107,230,184,57,227,78,115,229,44,155,34,19,195,210,84,254,208,38,55,171,206,96,90,136,126,28,57,61,222];var N;var P;var M;var R="CBC";N=forge.util.hexToBytes(O.substr(0,32));P=forge.util.hexToBytes(O.substr(32));M=forge.aria.createDecryptionCipher;var L=M(Q,R);L.start(forge.util.createBuffer(N));L.update(forge.util.createBuffer(P));L.finish();var K=L.output.getBytes().split("<::>");return K[0];}function G(M,S){var V;var N;var U;var P="CBC";var K="softforum";var T;var R;if(window.location.port){R=window.location.host;}else{R=window.location.hostname+":80";}T=forge.md.sha1.create().update(S+K).digest().getBytes().substr(0,20);V=forge.md.sha1.create().update(R+T).digest().getBytes().substr(0,20);N="sosiconnwithsofo";U=forge.seed.createDecryptionCipher;var O=forge.util.hexToBytes(M);var Q=U(V,P);Q.start(N);Q.update(forge.util.createBuffer(O));Q.finish();var L=Q.output.getBytes();return L;}function I(P,W){var aa;var Q;var Y;var U="CBC";var L="softforum";var N="wXksGwIDAQABo1AwTjAdBgNVHQ4EFgQUnEyOz2mKK/";var X;var T;var Z;X=forge.md.sha1.create().update(W+L).digest().getBytes().substr(0,20);aa=forge.md.sha1.create().update(N+X).digest().getBytes().substr(0,20);Z="0x"+W[W.length-1];T=parseInt(Z);T=T-1;if(T==-1){T=0;}var K;while(T){K=forge.md.sha1.create().update(aa).digest().getBytes().substr(0,20);aa=K;T--;}Q="sosiconnwithsofo";Y=forge.seed.createDecryptionCipher;var S=forge.util.hexToBytes(P);var V=Y(aa,U);V.start(Q);V.update(forge.util.createBuffer(S));V.finish();var O=V.output.getBytes();for(var R=0;R<O.length;R++){var M=Number(O.charCodeAt(R)).toString(16);if(M==0){O=O.substr(0,R);break;}}return O;}function m(O,P,N){var M=O;var L=function(S,Q){if(S=="OK"){M.shift();if(M.length==0){P();}else{K(M[0]);}}else{if(S=="FAIL"){var R;if(Q==-1){R="[OpenCert Error] code : -1, message : file loading fail ("+M[0]+")";}else{if(Q==-2){R="[OpenCert Error] code : -1, message : file loading exception";}}C.setError(C.ERROR_OPENCERT_INITIALIZE_FAIL,R);if(N){N(-1);}}}};var K=function(Q){try{var R=document.createElement("script");R.setAttribute("type","text/javascript");R.setAttribute("src",Q);R.onerror=function(){L("FAIL",-1);};R.onload=function(){L("OK");};document.getElementsByTagName("head")[0].appendChild(R);}catch(S){L("FAIL",-2);}};K(M[0]);}})();(function(){var q=sofo.xcs||{};var g=sofo.pki||{};var v=sofo.error;var n=forge.asn1;var u=forge.md.sha1;var c=forge.pki;var e="";var h=1;var A=true;var B=1000;var d=0;var f=1;var a=11;var s=13;var p=14;var b=null;q.getServerCert=function(D,H,G){v.resetError();var E=r(h);if(E==true&&typeof G!="function"){v.setError(v.ERROR_INCORRECT_PARAM);return-1;}var F=D+"XCSServerCertificate";var I=function(J){if(!J){v.setError(v.ERROR_SERVER_CONNECT_FAIL);if(G){G(-1);}return-1;}e=J;if(G){G(0);}return 0;};l(F,E,H,I);};q.registerAuthCode=function(E,V,M,T){v.resetError();var L=r(h);if(L==true&&typeof T!="function"){v.setError(v.ERROR_INVALID_PARAM);return-1;}var U=E+"XCSService";var D=forge.pki.certificateFromPem(e);var K=forge.random.getBytesSync(16);var F=XCrypto.hashData(2,V,0,null);var O=D.publicKey.encrypt(K,"RSAES-PKCS1-V1_5");var S=forge.util.encode64(O);var R="";var Q;R+="00013400000040";for(i=0;i<64;i++){Q=o(F.charCodeAt(i).toString(2));R+=parseInt(Q,2).toString(16);}R+="00000000";var P=forge.util.hexToBytes(R);var J=sofo.crypto.encrypt(P,K,K,"seedCBC");var H=forge.util.encode64(J);var I=XCrypto.hashData(2,P,1,null);var N="data="+S+";"+H+";"+I+";";var G=function(ak){if(!ak){v.setError(v.ERROR_SERVER_CONNECT_FAIL);if(T){T(-1);}return-1;}var Y=ak.split(";");var ai=Y[0];var ac=forge.util.decode64(Y[1]);var ae=sofo.crypto.decrypt(ac,K,K,"seedCBC");var W=t(ae,1);if(W!=Y[2]){v.setError(v.ERROR_HASH_CONFIRM);if(T){T(-1);}return-1;}var ab,ad,X;var ag="";var ah="";var aa="";var Z=0;var af="";var aj=0;for(ab=0;ab<ae.length;){ad=forge.util.bytesToHex(ae[ab]);X=forge.util.bytesToHex(ae[ab+1]);if(ad=="00"&&X=="00"){ab+=2;}else{tlen=parseInt(ad,16)*256+parseInt(X,16);ab+=2;af="";while(Z<tlen){af+=ae[ab++];Z++;}if(aj==3){ah=af;}else{if(aj==4){aa=af;}}}aj++;}if(ah!=""){var al="[인증코드 등록 오류] code : "+ah+", message : "+aa;v.setError(v.ERROR_ACR_REG_AUTHCODE,al,al,al);if(T){T(-1);}return-1;}if(T){T(0);}return 0;};m(U,L,N,M,G);};q.generatePKCS12Password=function(J,F){var I=J+"sofoxcs";var D="softforum_xecure_certshare";var E=t(I,0);var H=E.slice(0,16);var G=sofo.crypto.encrypt(J,H,D,"aesCBC");if(G==""){v.setError(v.ERROR_ACR_GEN_PKCS12_PW);if(F){F(-1);}return-1;}else{if(F){F(G);}else{return G;}}return;};q.exportCertRelay=function(E,ab,U,Q,N,Z){v.resetError();var M=r(h);if(M==true&&typeof Z!="function"){v.setError(v.ERROR_INVALID_PARAM);return-1;}var aa=E+"XCSService";var D=forge.pki.certificateFromPem(e);var L=forge.random.getBytesSync(16);var G=XCrypto.hashData(2,ab,0,null);var T=D.publicKey.encrypt(L,"RSAES-PKCS1-V1_5");var Y=forge.util.encode64(T);var X="";var W;var O=U.length;var R=Q.length;X+="00013500000040";for(i=0;i<64;i++){W=o(G.charCodeAt(i).toString(2));X+=parseInt(W,2).toString(16);}var F=O.toString(10);F=new Array(7-F.length).join("0")+F;for(j1=0;j1<6;j1++){W=o(F.charCodeAt(j1).toString(2));X+=parseInt(W,2).toString(16);}for(j=0;j<O;j++){W=o(U.charCodeAt(j).toString(2));X+=parseInt(W,2).toString(16);}var J=R.toString(10);J=new Array(7-J.length).join("0")+J;for(k1=0;k1<6;k1++){W=o(J.charCodeAt(k1).toString(2));X+=parseInt(W,2).toString(16);}for(k=0;k<R;k++){W=o(Q.charCodeAt(k).toString(2));X+=parseInt(W,2).toString(16);}var S=forge.util.hexToBytes(X);var K=sofo.crypto.encrypt(S,L,L,"seedCBC");var H=forge.util.encode64(K);var I=XCrypto.hashData(2,S,1,null);var P="data="+Y+";"+H+";"+I+";";var V=function(aq){if(!aq){v.setError(v.ERROR_SERVER_CONNECT_FAIL);if(Z){Z(-1);}return-1;}var ae=aq.split(";");var ao=ae[0];var ai=forge.util.decode64(ae[1]);var ak=sofo.crypto.decrypt(ai,L,L,"seedCBC");var ac=t(ak,1);if(ac!=ae[2]){v.setError(v.ERROR_HASH_CONFIRM);if(Z){Z(-1);}return-1;}var ah,aj,ad;var am="";var an="";var ag="";var af=0;var al="";var ap=0;for(ah=0;ah<ak.length;){aj=forge.util.bytesToHex(ak[ah]);ad=forge.util.bytesToHex(ak[ah+1]);if(aj=="00"&&ad=="00"){ah+=2;}else{tlen=parseInt(aj,16)*256+parseInt(ad,16);ah+=2;al="";while(af<tlen){al+=ak[ah++];af++;}if(ap==3){an=al;}else{if(ap==4){ag=al;}}}ap++;}if(an!=""){var ar="[인증서 내보내기 오류] code : "+an+", message : "+ag;v.setError(v.ERROR_ACR_EXPORT_CERT,ar,ar,ar);if(Z){Z(-1);}return-1;}if(Z){Z(0);}return 0;};m(aa,M,P,N,V);};q.importCertRelay=function(E,V,L,T){v.resetError();var K=r(h);if(K==true&&typeof T!="function"){v.setError(v.ERROR_INVALID_PARAM);return-1;}var U=E+"XCSService";var D=forge.pki.certificateFromPem(e);var J=forge.random.getBytesSync(16);var F=XCrypto.hashData(2,V,0,null);var O=D.publicKey.encrypt(J,"RSAES-PKCS1-V1_5");var S=forge.util.encode64(O);var R="";var Q;R+="00013600000040";for(i=0;i<64;i++){Q=o(F.charCodeAt(i).toString(2));R+=parseInt(Q,2).toString(16);}R+="00000000";var P=forge.util.hexToBytes(R);var I=sofo.crypto.encrypt(P,J,J,"seedCBC");var G=forge.util.encode64(I);var H=XCrypto.hashData(2,P,1,null);var N="data="+S+";"+G+";"+H+";";var M=function(ak){if(!ak){v.setError(v.ERROR_SERVER_CONNECT_FAIL);if(T){T(-1);}return-1;}var Y=ak.split(";");var ai=Y[0];var ac=forge.util.decode64(Y[1]);var ae=sofo.crypto.decrypt(ac,J,J,"seedCBC");var W=t(ae,1);if(W!=Y[2]){v.setError(v.ERROR_HASH_CONFIRM);if(T){T(-1);}return-1;}var ab,ad,X;var ag="";var ah="";var aa="";var Z=0;var af="";var aj=0;for(ab=0;ab<ae.length;){ad=forge.util.bytesToHex(ae[ab]);X=forge.util.bytesToHex(ae[ab+1]);if(ad=="00"&&X=="00"){ab+=2;}else{tlen=parseInt(ad,16)*256+parseInt(X,16);ab+=2;af="";while(Z<tlen){af+=ae[ab++];Z++;}if(aj==2){ag=af;}else{if(aj==3){ah=af;}else{if(aj==4){aa=af;}}}}aj++;}if(ah!=""||ag==""){if(ah==431020){aa="인증번호가 일치 하지 않습니다. 다시 확인해 주십시요.";}else{if(ag==""){aa="가져올 인증서가 없습니다. 다시 확인해 주십시요.";}}var al="[인증서 가져오기 오류] code : "+ah+", message : "+aa;v.setError(v.ERROR_ACR_IMPORT_CERT,al,al,al);if(T){T(-1);}return-1;}else{if(T){T(ag);}return 0;}};m(U,K,N,L,M);};function r(D){switch(D){case 0:return false;case 1:return true;case 2:return A;default:}return false;}function o(D){D=new Array(9-D.length).join("0")+D;return D;}function t(D,E){var F,G;F=forge.md.sha256.create();F.start();F.update(D);if(E==1){G=forge.util.encode64(F.digest().getBytes());}else{G=F.digest().getBytes();}return G;}function l(L,M,F,K){var J=M;var E,G;var I;if(window.XMLHttpRequest){I=new window.XMLHttpRequest;}else{if(K){K("");return-1;}else{return "";}}try{I.open("GET",L,M);}catch(H){if(!M&&K){J=true;I.open("GET",L,J);}else{if(K){K("");}return null;}}I.withCredentials=F;if(J){var D=null;I.onreadystatechange=function(N){if(I.readyState==4){G=(new Date).getTime();if(G-E<B){A=false;}if(D){D.dispose();D=null;}if(I.status==200){K(I.responseText);}else{K(I.responseText);}}};}E=(new Date).getTime();I.send(null);if(J){return 0;}else{if(K){K(I.responseText);return 0;}else{return I.responseText;}}}function m(M,N,F,G,L){var K=N;var E,H;var J;if(window.XMLHttpRequest){J=new window.XMLHttpRequest;}else{if(L){L("");return-1;}else{return "";}}try{J.open("POST",M,N);}catch(I){if(!N&&L){K=true;J.open("POST",M,K);}else{if(L){L("");}return null;}}J.withCredentials=G;if(K){var D=null;J.onreadystatechange=function(O){if(J.readyState==4){H=(new Date).getTime();if(H-E<B){A=false;}if(D){D.dispose();D=null;}if(J.status==200){L(J.responseText);}else{L(J.responseText);}}};}J.setRequestHeader("Content-type","application/x-www-form-urlencoded");E=(new Date).getTime();J.send(F);if(K){return 0;}else{if(L){L(J.responseText);return 0;}else{return J.responseText;}}}function w(I){if(!I){return null;}if(!b){return I;}var J=-1;var F="";if(typeof I==="string"){var E=I.indexOf("$");if(E==-1){return null;}J=parseInt(I.substring(0,E));if(I.length>E+1){F=I.substring(E+1);}}else{if(typeof I==="object"){if(typeof I.type!=="number"){return null;}J=I.type;if(J==s){if(!I.keypad||I.keypad==null||I.keypad=="undefined"){return null;}}else{return null;}}else{return null;}}var L=b.split("$");var D=0;var K="";var H=false;for(var G=0;G<L.length;G++){var E=L[G].indexOf("|");if(E==-1){D=parseInt(L[G]);}else{D=parseInt(L[G].substring(0,E));if(L[G].length>E+1){K=L[G].substring(E+1);}}if(D==J){H=true;break;}}if(!H){return null;}if(J==d){return F;}else{if(J==s){return I.keypad.get_input();}else{if(J==f){return y(F,K);}else{if(J==a){return z(F,K);}else{if(J==p){return C(F);}else{return null;}}}}}}function C(H){var J=[212,33,154,107,230,184,57,227,78,115,229,44,155,34,19,195,210,84,254,208,38,55,171,206,96,90,136,126,28,57,61,222];var G;var I;var F;var K="CBC";G=forge.util.hexToBytes(H.substr(0,32));I=forge.util.hexToBytes(H.substr(32));F=forge.aria.createDecryptionCipher;var E=F(J,K);E.start(forge.util.createBuffer(G));E.update(forge.util.createBuffer(I));E.finish();var D=E.output.getBytes().split("<::>");return D[0];}function y(F,L){var O;var G;var N;var I="CBC";var D="softforum";var M;var K;if(window.location.port){K=window.location.host;}else{K=window.location.hostname+":80";}M=forge.md.sha1.create().update(L+D).digest().getBytes().substr(0,20);O=forge.md.sha1.create().update(K+M).digest().getBytes().substr(0,20);G="sosiconnwithsofo";N=forge.seed.createDecryptionCipher;var H=forge.util.hexToBytes(F);var J=N(O,I);J.start(G);J.update(forge.util.createBuffer(H));J.finish();var E=J.output.getBytes();return E;}function z(I,P){var T;var J;var R;var N="CBC";var E="softforum";var G="wXksGwIDAQABo1AwTjAdBgNVHQ4EFgQUnEyOz2mKK/";var Q;var M;var S;Q=forge.md.sha1.create().update(P+E).digest().getBytes().substr(0,20);T=forge.md.sha1.create().update(G+Q).digest().getBytes().substr(0,20);S="0x"+P[P.length-1];M=parseInt(S);M=M-1;if(M==-1){M=0;}var D;while(M){D=forge.md.sha1.create().update(T).digest().getBytes().substr(0,20);T=D;M--;}J="sosiconnwithsofo";R=forge.seed.createDecryptionCipher;var L=forge.util.hexToBytes(I);var O=R(T,N);O.start(J);O.update(forge.util.createBuffer(L));O.finish();var H=O.output.getBytes();for(var K=0;K<H.length;K++){var F=Number(H.charCodeAt(K)).toString(16);if(F==0){H=H.substr(0,K);break;}}return H;}})();(function(){"";if(forge.kisa==undefined){forge.kisa={};}var e=forge.asn1;var c=forge.pki;var d=forge.oids;var b=forge.util;var f=forge.kisa;var a={};var g={};a.AttributeTypeAndValue={};a.AttributeTypeAndValue.toAsn1=function(n){var l;var m;l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);l.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,false,e.oidToDer(n.type).getBytes()));switch(n.type){case f.EncryptedVID.oid:m=f.EncryptedVID.toAsn1(n.value);break;case f.OldCertReqMsg.oid:m=f.OldCertReqMsg.toAsn1(n.value);break;case f.PKIArchiveOptions.oid:m=f.PKIArchiveOptions.toAsn1(n.value);break;default:throw "not supported AttributeTypeAndValue oid:"+n.type;}l.value.push(m);return l;};a.CertResponse={};a.CertResponse.toObject=function(l){var m={};m.certReqId=e.derToInteger(l.value[0].value);m.status=cmp.PKIStatusInfo.toObject(l.value[1]);if(l.value.length>2){m.certifiedKeyPair=cmp.CertifiedKeyPair.toObject(l.value[2]);}if(l.value.length>3){m.rspInfo=l.value[3].value;}return m;};a.CertRequest={};a.CertRequest.toAsn1=function(o){var m;m=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);m.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,false,e.integerToDer(o.certReqId).getBytes()));m.value.push(a.CertTemplate.toAsn1(o.certTemplate));if("controls" in o){var l;var n;l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);o.controls.forEach(function(p){n=a.AttributeTypeAndValue.toAsn1(p);l.value.push(n);});m.value.push(l);}return m;};a.CertTemplate={};a.CertTemplate.toAsn1=function(m){var l;l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);if(m.version!=undefined){l.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,true,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,false,e.integerToDer(m.version).getBytes())]));}if(m.serialNumber!=undefined){l.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,true,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,false,e.integerToDer(m.serialNumber).getBytes())]));}if(m.signingAlg!=undefined){l.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,true,[c.AlgorithmIdentifier.toAsn1(m.signingAlg)]));}if(m.issuer!=undefined){l.value.push(e.create(e.Class.CONTEXT_SPECIFIC,3,true,[c.distinguishedNameToAsn1(m.issuer)]));}if(m.validity!=undefined){l.value.push(e.create(e.Class.CONTEXT_SPECIFIC,4,true,[c.Validity.toAsn1(m.validity)]));}if(m.subject!=undefined){l.value.push(e.create(e.Class.CONTEXT_SPECIFIC,5,true,[c.distinguishedNameToAsn1(m.subject)]));}if(m.publicKey!=undefined){l.value.push(e.create(e.Class.CONTEXT_SPECIFIC,6,true,[m.publicKey.value[0],m.publicKey.value[1]]));}if(m.issuerUID!=undefined){l.value.push(e.create(e.Class.CONTEXT_SPECIFIC,7,true,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,false,String.fromCharCode(0)+m.issuerUID)]));}if(m.subjectUID!=undefined){l.value.push(e.create(e.Class.CONTEXT_SPECIFIC,8,true,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,false,String.fromCharCode(0)+m.subjectUID)]));}if(m.extentions!=undefined){throw "not implemented";l.value.push(e.create(e.Class.CONTEXT_SPECIFIC,9,true,[]));}return l;};a.EncryptedValue={};a.EncryptedValue.toAsn1=function(n){var l;var m;l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);if("symmAlg" in n){m=f.SymmAlgorithms.toAsn1(n.symmAlg);l.value.push(m);}if("encSymmKey" in n){m=e.create(e.Class.CONTEXT_SPECIFIC,2,true,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,false,String.fromCharCode(0)+n.encSymmKey)]);l.value.push(m);}if("keyAlg" in n){m=f.EncryptedAlgorithmIdentifier.toAsn1(n.keyAlg);l.value.push(m);}if("encValue" in n){m=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,false,String.fromCharCode(0)+n.encValue);l.value.push(m);}return l;};a.EncryptedValue.toObject=function(l){var n={};var m;l.value.forEach(function(o){if(o.tagClass==e.Class.CONTEXT_SPECIFIC){switch(o.type){case 1:n.symmAlgAndIV=cmp.InfoTypeAndValue.toObject(o);break;case 2:n.encSymmKey=o.value.substring(1,o.value.length);break;case 3:n.keyAlg=cmp.InfoTypeAndValue.toObject(o);break;default:throw "unknown EncryptedValue contextID"+o.type;}}else{n.encValue=o.value.substring(1,o.value.length);}});return n;};a.PBMParameter={};a.PBMParameter.toAsn1=function(l){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[e.create(e.Class.UNIVERSAL,e.Type.OCTET_STRING,l.salt),c.AlgorithmIdentifier.toAsn1(l.owf)]);};a.POPOSigningKeyInput={};a.POPOSigningKeyInput.toAsn1=function(n){var m;var l;m=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);if(!("authInfo" in n)){throw "authInfo does not exist";}if("sender" in n.authInfo){l=e.create(e.Class.CONTEXT_SPECIFIC,0,true,[c.GeneralName.toAsn1(n.authInfo.sender)]);}else{if("publicKeyMAC" in n.authInfo){l=a.PKMACValue.toAsn1(n.authInfo.publicKeyMAC);}else{throw "no choice for authInfo";}}m.value.push(l);m.value.push(n.publicKey);return m;};a.POPOSigningKey={};a.POPOSigningKey.toAsn1=function(m){var l;l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);if("poposkInput" in m){l.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,true,a.POPOSigningKeyInput.toAsn1(m.poposkInput).value));}l.value.push(c.AlgorithmIdentifier.toAsn1(m.algorithmIdentifier));l.value.push(e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,false,String.fromCharCode(0)+m.signature));return l;};a.ProofOfPossession={};a.ProofOfPossession.toAsn1=function(n){var l=0;var m;if("raVerified" in n){l=0;m=[e.create(e.Class.UNIVERSAL,e.Type.NULL,false,"")];}else{if("signature" in n){l=1;m=a.POPOSigningKey.toAsn1(n.signature).value;}else{if("keyEncipherment" in n){l=2;m=n.keyEncipherment;}else{if("keyAgreement" in n){l=3;m=n.keyAgreement;}else{throw "proofOfPossession does not have any choice.";}}}}return e.create(e.Class.CONTEXT_SPECIFIC,l,true,m);};a.CertReqMsg={};a.CertReqMsg.toAsn1=function(m){var l;l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[a.CertRequest.toAsn1(m.certReq)]);if("popo" in m){l.value.push(a.ProofOfPossession.toAsn1(m.popo));}if("regInfo" in m&&m.regInfo!=null){l.value.push(a.RegInfo.toAsn1(m.regInfo));}return l;};a.SubsequentMessage={};a.SubsequentMessage.encrCert=0;a.SubsequentMessage.challengeResp=1;a.PKMACValue={};a.PKMACValue.toAsn1=function(l){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[c.AlgorithmIdentifier.toAsn1(l.algId),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,false,String.fromCharCode(0)+l.value)]);};a.POPOPrivKey={};a.POPOPrivKey.toAsn1=function(n){var m;var l;if("thisMessage" in n){l=0;}else{if("subsequentMessage" in n){l=1;}else{if("dhMAC" in n){l=2;}else{if("agreeMAC" in n){l=3;m=a.PKMACValue.toAsn1(n.agreeMAC);}else{if("encryptedKey" in n){l=4;throw 'not support entry "encryptedKey" in POPOPrivKey';}else{throw "cannot found any supported entry in POPOPrivKey";}}}}}return e.create(e.Class.CONTEXT_SPECIFIC,l,true,[m]);};a.RegInfo={};a.RegInfo.toAsn1=function(m){var l;l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);m.forEach(function(n){l.value.push(a.AttributeTypeAndValue.toAsn1(n));});return l;};a.CertRequestValidator={name:"CertRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,value:[{name:"CertRequest.certReqId",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:false}]};var h={directoryName:{attributes:[{type:d["countryName"],value:"KR"},{type:d["commonName"],value:"haha"}]}};oid={};oid.id_it="1.3.6.1.5.5.7.4";oid.id_it_caProtEncCert=oid.id_it+".1";cmp={};cmp.oids={};cmp.oids.it_ca_ProtEncCert="1.3.6.1.5.5.7.4.1";cmp.oids.it_ca_SignKeyPairTypes="1.3.6.1.5.5.7.4.2";cmp.oids.algorithemKCDSA1="1.2.410.200004.1.21";cmp.oids.passwordBasedMac="1.2.840.113533.7.66.13";cmp.CertifiedKeyPair={};cmp.CertifiedKeyPair.toObject=function(l){var m={};m.certOrEncCert=cmp.CertOrEncCert.toObject(l.value[0]);if(l.value.length>1){throw "this message has not supported entries in CertifiedKeyPair.";}return m;};cmp.CertOrEncCert={};cmp.CertOrEncCert.toObject=function(l){var m={};if(l.type==0){m.certificate=c.certificateFromAsn1(l.value[0],true);}else{m.encryptedCert=a.EncryptedValue.toObject(l.value[0]);}return m;};cmp.CertRepMessage={};cmp.CertRepMessage.toObject=function(n){var o=[];var l;var m;l=n.value[0];m=n.value[0];if(l.type==1){o.caPubs=[];l=l.value[0];l.value.forEach(function(p){var q;o.caPubs.push(c.certificateFromAsn1(p),true);});m=n.value[1];}o.response=[];m.value.forEach(function(p){o.response.push(a.CertResponse.toObject(p));});return o;};cmp.oid=oid;cmp.ErrorMsgContent={};cmp.ErrorMsgContent.toObject=function(l){var m={};m.pKIStatusInfo=cmp.PKIStatusInfo.toObject(l.value[0]);if(l.value.length>1){m.errorCode=l.value[1].value.charCodeAt(0);}if(l.value.length>2){m.errorDetails=cmp.PKIFreeText.toObject(l.value[2]);}return m;};cmp.GenRepContent={};cmp.GenRepContent.toObject=function(l){var m=[];l.value.forEach(function(n){m.push(cmp.InfoTypeAndValue.toObject(n));});return m;};cmp.InfoTypeAndValue={};cmp.InfoTypeAndValue.toAsn1=function(n){var l;var m;l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);m=e.create(e.Class.UNIVERSAL,e.Type.OID,false,e.oidToDer(n.infoType).getBytes());l.value.push(m);switch(n.infoType){case oid.id_it_caProtEncCert:m=undefined;break;default:throw "not supported oid for InfoTypeAndValue";}l.value.push(m);return l;};cmp.InfoTypeAndValue.toObject=function(l){var m={};m.infoType=e.derToOid(l.value[0].value);if(l.value.length>1){m.infoValue=e.toDer(l.value[1]);}return m;};cmp.PKIBody={};cmp.PKIBody.toAsn1=function(o){var m;var n;var l;if(o.hasOwnProperty("ir")){n=o.ir;l=0;m=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);n.forEach(function(p){m.value.push(a.CertReqMsg.toAsn1(p));});}else{if(o.hasOwnProperty("kur")){n=o.kur;l=7;m=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);n.forEach(function(p){m.value.push(a.CertReqMsg.toAsn1(p));});}else{if(o.hasOwnProperty("conf")){n=o.conf;l=19;m=e.create(e.Class.UNIVERSAL,e.Type.NULL,false,"");}else{if(o.hasOwnProperty("genm")){n=o.genm;l=21;m=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);if(n!=undefined){n.forEach(function(p){m.value.push(cmp.InfoTypeAndValue.toAsn1(p));});}}else{throw "not supported PKIBody type";}}}}return e.create(e.Class.CONTEXT_SPECIFIC,l,true,[m]);};cmp.PKIBody.toObject=function(l){var m={};switch(l.type){case 1:m.ip=forge.cmp.CertRepMessage.toObject(l.value[0]);break;case 8:m.kup=forge.cmp.CertRepMessage.toObject(l.value[0]);break;case 19:m.conf={};break;case 22:m.genp=forge.cmp.GenRepContent.toObject(l.value[0]);break;case 23:m.error=forge.cmp.ErrorMsgContent.toObject(l.value[0]);break;default:throw "not supported CMP message type:"+l.type;}return m;};cmp.PKIFailureInfo={};cmp.PKIFailureInfo.toObject=function(l){return 0;};cmp.PKIFreeText={};cmp.PKIFreeText.toAsn1=function(n){var l;var m;l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[]);n.forEach(function(o){m=e.create(e.Class.UNIVERSAL,e.Type.UTF8,false,b.encodeUtf8(o));l.value.push(m);});return l;};cmp.PKIFreeText.toObject=function(l){var n=[];var m;l.value.forEach(function(o){m=o.value;n.push(m);});return n;};cmp.PKISenderNonce={};cmp.PKISenderNonce.toObject=function(l){var m;m=forge.util.createBuffer();m.putBytes(l.value);return m;};cmp.PKIRecipNonce={};cmp.PKIRecipNonce.toObject=function(l){var m;m=forge.util.createBuffer();m.putBytes(l.value);return m;};cmp.PKIHeader={};cmp.PKIHeader.cmp1999=1;cmp.PKIHeader.cmp2000=2;cmp.PKIHeader.toAsn1=function(n){var l;var m;l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,false,e.integerToDer(n.pvno).getBytes()),c.GeneralName.toAsn1(n.sender),c.GeneralName.toAsn1(n.recipient)]);if("messageTime" in n){m=e.create(e.Class.CONTEXT_SPECIFIC,0,true,[e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,false,e.dateToGeneralizedTime(n.messageTime))]);l.value.push(m);}if("protectionAlg" in n){m=e.create(e.Class.CONTEXT_SPECIFIC,1,true,[c.AlgorithmIdentifier.toAsn1(n.protectionAlg)]);l.value.push(m);}if("senderKID" in n){m=e.create(e.Class.CONTEXT_SPECIFIC,2,true,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,false,n.senderKID)]);l.value.push(m);}if("recipKID" in n){m=e.create(e.Class.CONTEXT_SPECIFIC,3,true,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,false,n.recipKID)]);l.value.push(m);}if("transactionID" in n){m=e.create(e.Class.CONTEXT_SPECIFIC,4,true,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,false,n.transactionID)]);l.value.push(m);}if("senderNonce" in n){m=e.create(e.Class.CONTEXT_SPECIFIC,5,true,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,false,n.senderNonce)]);l.value.push(m);}if("recipNonce" in n){m=e.create(e.Class.CONTEXT_SPECIFIC,6,true,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,false,n.recipNonce)]);l.value.push(m);}if("freeText" in n){m=e.create(e.Class.CONTEXT_SPECIFIC,7,true,[cmp.PKIFreeText.toAsn1(n.freeText)]);l.value.push(m);}if("generalInfo" in n){m=e.create(e.Class.CONTEXT_SPECIFIC,8,true,[cmp.PKIFreeText.toAsn1(n.freeText)]);l.value.push(m);}return l;};cmp.PKIHeader.toObject=function(m){var o={};var l;var n;o.pvno=m.value[0].value.charCodeAt(0);o.sender=m.value[1].value;o.recipient=m.value[2].value;for(l=3;l<m.value.length;++l){n=m.value[l];switch(n.type){case 7:o.freeText=cmp.PKIFreeText.toObject(n.value[0]);break;case 5:o.senderNonce=n.value[0].value;break;case 6:o.recipNonce=n.value[0].value;break;default:}}return o;};cmp.PKIMessage={};cmp.PKIMessage.toAsn1=function(n){var l;l=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[cmp.PKIHeader.toAsn1(n.header),cmp.PKIBody.toAsn1(n.body)]);if("protection" in n){var m;m=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,false,String.fromCharCode(0)+n.protection);m=e.create(e.Class.CONTEXT_SPECIFIC,0,true,[m]);l.value.push(m);}return l;};cmp.PKIMessage.toObject=function(l){var m={};m.header=cmp.PKIHeader.toObject(l.value[0]);m.body=cmp.PKIBody.toObject(l.value[1]);return m;};cmp.PKIStatus={};cmp.PKIStatus.accepted=0;cmp.PKIStatus.grantedWithMods=1;cmp.PKIStatus.rejection=2;cmp.PKIStatus.waiting=3;cmp.PKIStatus.revocationWarning=4;cmp.PKIStatus.revocationNotification=5;cmp.PKIStatus.keyUpdateWarning=6;cmp.PKIStatusInfo={};cmp.PKIStatusInfo.toObject=function(l){var n={};var m="";n.status=l.value[0].value.charCodeAt(0);if(l.value.length>1){n.statusString=cmp.PKIFreeText.toObject(l.value[1]);}if(l.value.length>2){n.failInfo=cmp.PKIFailureInfo.toObject(l.value[2]);}switch(n.status){case cmp.PKIStatus.accepted:m="granted";break;case cmp.PKIStatus.grantedWithMods:m="grantedWithMods";break;case cmp.PKIStatus.rejection:m="rejection";break;case cmp.PKIStatus.waiting:m="waiting";break;case cmp.PKIStatus.revocationWarning:m="revocationWarning";break;case cmp.PKIStatus.revocationNotification:m="revocationNotification";break;case cmp.PKIStatus.keyUpdateWarning:m="keyUpdateWarning";break;default:}n.asnReason=m;return n;};cmp.ProtectedPart={};cmp.ProtectedPart.toAsn1=function(l){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,true,[cmp.PKIHeader.toAsn1(l.header),cmp.PKIBody.toAsn1(l.body)]);};forge.crmf=a;forge.cmp=cmp;})();(function(){var c;var a;var d;var b;c=forge.asn1;a=forge.pki;b=forge.oids;var e=sofo.pki;if(forge.kisa==undefined){forge.kisa={};}d=forge.kisa;if(forge.yessign==undefined){forge.yessign={};}yessign=forge.yessign;c.dateToGeneralizedTime=function(f){var l="";var h=[];h.push(""+f.getUTCFullYear());h.push(""+(f.getUTCMonth()+1));h.push(""+f.getUTCDate());h.push(""+f.getUTCHours());h.push(""+f.getUTCMinutes());h.push(""+f.getUTCSeconds());for(var g=0;g<h.length;++g){if(h[g].length<2){l+="0";}l+=h[g];}l+="Z";return l;};a.GeneralName={};a.GeneralName.toAsn1=function(h){var f;var g;if("rfc822Name" in h){contextID=1;g=h.rfc822Name;f=c.create(c.Class.CONTEXT_SPECIFIC,contextID,false,g);}else{if("directoryName" in h){contextID=4;g=e.distinguishedNameToAsn1(h.directoryName);f=c.create(c.Class.CONTEXT_SPECIFIC,contextID,true,[g]);}else{throw "not supported generalname";}}return f;};a.AlgorithmIdentifier={};a.AlgorithmIdentifier.toAsn1=function(h){var f;var g;if(h.hasOwnProperty("algorithm")==false){throw "AlgorithmIdentifier.algorithm does not defined as OID";}f=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,true,[c.create(c.Class.UNIVERSAL,c.Type.OID,false,c.oidToDer(h.algorithm).getBytes())]);if("parameters" in h){g=h.parameters;if(g==null){g=c.create(c.Class.UNIVERSAL,c.Type.NULL,false,"");}f.value.push(g);}return f;};a.AlgorithmIdentifier.toObject=function(g){var h={};var f;f=c.derToOid(g.value[0].value);h.algorithm=f;return h;};a.Validity={};a.Validity.toAsn1=function(f){return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,true,[c.create(c.Class.UNIVERSAL,c.Type.UTCTIME,false,c.dateToUtcTime(f.notBefore)),c.create(c.Class.UNIVERSAL,c.Type.UTCTIME,false,c.dateToUtcTime(f.notAfter))]);};SymmAlgorithms={};SymmAlgorithms.oid="1.2.840.113549.3.7";SymmAlgorithms.toAsn1=function(h){var f;var g;if(h.hasOwnProperty("algorithm")==false){throw "SymmAlgorithms.algorithm does not defined as OID";}f=c.create(c.Class.CONTEXT_SPECIFIC,1,true,[c.create(c.Class.UNIVERSAL,c.Type.OID,false,c.oidToDer(h.algorithm).getBytes())]);if("parameters" in h){g=h.parameters;if(g==null){g=c.create(c.Class.UNIVERSAL,c.Type.NULL,false,"");}else{g=c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,false,h.parameters);}f.value.push(g);}return f;};EncryptedAlgorithmIdentifier={};EncryptedAlgorithmIdentifier.toAsn1=function(h){var f;var g;if(h.hasOwnProperty("algorithm")==false){throw "SymmAlgorithms.algorithm does not defined as OID";}f=c.create(c.Class.CONTEXT_SPECIFIC,3,true,[c.create(c.Class.UNIVERSAL,c.Type.OID,false,c.oidToDer(h.algorithm).getBytes())]);if("parameters" in h){g=h.parameters;if(g==null){g=c.create(c.Class.UNIVERSAL,c.Type.NULL,false,"");}else{g=c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,false,h.parameters);}f.value.push(g);}return f;};EncryptedVID={};EncryptedVID.oid="1.2.410.200004.10.1.1.2";EncryptedVID.toAsn1=function(h){var f;var g;f=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,true,[]);g=c.create(c.Class.CONTEXT_SPECIFIC,0,true,[c.create(c.Class.UNIVERSAL,c.Type.INTEGER,false,c.integerToDer(h.version).getBytes())]);f.value.push(g);if("vidHashAlg" in h){g=c.create(c.Class.CONTEXT_SPECIFIC,1,true,[a.AlgorithmIdentifier.toAsn1(h.vidHashAlg)]);f.value.push(g);}g=c.create(c.Class.CONTEXT_SPECIFIC,2,true,[a.AlgorithmIdentifier.toAsn1(h.vidEncAlg)]);f.value.push(g);g=c.create(c.Class.CONTEXT_SPECIFIC,3,true,[IssuerAndSerialNumber.toAsn1(h.certID)]);f.value.push(g);g=c.create(c.Class.CONTEXT_SPECIFIC,4,true,[c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,false,h.encryptedVID)]);f.value.push(g);return f;};OldCertReqMsg={};OldCertReqMsg.oid="1.3.6.1.5.5.7.5.1.5";OldCertReqMsg.toAsn1=function(h){var f;var g;f=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,true,[]);g=c.create(c.Class.CONTEXT_SPECIFIC,4,true,[a.distinguishedNameToAsn1(h.certID.issuer)]);g.value.push(c.create(c.Class.UNIVERSAL,c.Type.INTEGER,false,c.integerToDer(h.certID.serialNumber).getBytes()));f.value.push(g);return f;};IssuerAndSerialNumber={};IssuerAndSerialNumber.toAsn1=function(g){var f;f=c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,true,[]);f.value.push(a.distinguishedNameToAsn1(g.issuer));f.value.push(c.create(c.Class.UNIVERSAL,c.Type.INTEGER,false,c.integerToDer(g.serialNumber).getBytes()));return f;};HashContent={};HashContent.toAsn1=function(f){return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,true,[c.create(c.Class.UNIVERSAL,c.Type.PRINTABLESTRING,false,f.idn),c.create(c.Class.UNIVERSAL,c.Type.BITSTRING,false,String.fromCharCode(0)+f.randomNum)]);};EncryptContent={};EncryptContent.toAsn1=function(f){return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,true,[VID.toAsn1(f.vid),c.create(c.Class.UNIVERSAL,c.Type.BITSTRING,false,String.fromCharCode(0)+f.randomNum)]);};VID={};VID.toAsn1=function(f){return c.create(c.Class.UNIVERSAL,c.Type.SEQUENCE,true,[a.AlgorithmIdentifier.toAsn1(f.hashAlg),c.create(c.Class.CONTEXT_SPECIFIC,0,true,[c.create(c.Class.UNIVERSAL,c.Type.OCTETSTRING,false,f.virtualID)])]);};PKIArchiveOptions={};PKIArchiveOptions.oid="1.3.6.1.5.5.7.5.1.4";PKIArchiveOptions.toAsn1=function(g){var f;f=c.create(c.Class.CONTEXT_SPECIFIC,0,true,[forge.crmf.EncryptedValue.toAsn1(g)]);return f;};d.EncryptedVID=EncryptedVID;d.EncryptContent=EncryptContent;yessign.VIDCertificate={};yessign.VIDCertificate.oid="1.2.410.200005.1.10.1";d.OldCertReqMsg=OldCertReqMsg;d.PKIArchiveOptions=PKIArchiveOptions;d.SymmAlgorithms=SymmAlgorithms;d.EncryptedAlgorithmIdentifier=EncryptedAlgorithmIdentifier;b["1.2.410.200004.1.15"]="seedCBCWithSHA1";b["seedCBCWithSHA1"]="1.2.410.200004.1.15";b["1.2.410.200004.1.4"]="seedCBC";b["seedCBC"]="1.2.410.200004.1.4";b["vid"]="1.2.410.200004.10.1.1.1";b["1.2.410.200004.10.1.1.1"]="vid";b["randomNum"]="1.2.410.200004.10.1.1.3";b["1.2.410.200004.10.1.1.3"]="randomNum";})();(function(){var e=sofo.cmp;var f=sofo.pki;var c=sofo.crypto;var b=sofo.error;var a=forge.asn1;var d=forge.pki.rsa;e.catype={YESSIGN_CA:"yessign",XECURE_CA:"xecureca"};e.caPkeyId={PKEYID_RSA:"rsa",PKEYID_KCDSA:"kcdsa"};e.getCmpClient=function(n,m,l,o,p,h){switch(n){case e.catype.YESSIGN_CA:return new e.client.YesSign(l,m,o,p,h);case e.catype.XECURE_CA:return new e.client.XecureCA(l,m,o,p,h);default:}return new e.client.Standard(l);};e.getWebCMPType=function(l){var h=l&255;switch(h){case 1:case 11:return e.catype.YESSIGN_CA;case 101:case 102:return e.catype.XECURE_CA;default:}return null;};e.getWebCMPpKeyID=function(l){var h=l&255;switch(h){case 1:case 11:case 101:return e.caPkeyId.PKEYID_RSA;case 102:return e.caPkeyId.PKEYID_KCDSA;default:}return null;};e.getWebCMPOnlySignCert=function(h){return h&256;};Standard=function(h){};Standard.generateProtection=function(p,h,m){var n;var o;var l;n=forge.cmp.ProtectedPart.toAsn1({header:p,body:h});l=a.toDer(n);o=Standard.calculatePasswordBasedMac(l,"aaaaabbbbb",m,2,forge.md.sha1.create(),c.cmac.create(),forge.des);return o.getBytes();};Standard.generateProtectionBySign=function(n,o,l,q,p,s){var m;var r;var h;m=forge.cmp.ProtectedPart.toAsn1({header:n,body:o});h=a.toDer(m);r=f.PrivateKeySignData(q,p,s,h.getBytes(),l.publicKey);return r;};Standard.calculatePasswordBasedMac=function(h,m,p,l,n,t,q){var s="";var o;var r=0;o=forge.util.createBuffer();o.putBytes(m);o.putBytes(p);s=o.getBytes();for(r=0;r<l;++r){n.start();n.update(s);s=n.digest().getBytes();}t.start(q,s);t.update(h);return t.getMac();};YesSign=function(l,o,n,m,h){this.url=l;this.pKeyId=o;this.workerNum=n;this.workerScriptPath=m;this.onlySignCertRequest=h;};YesSign.prototype.setKeyGenerator=function(h){this.keyGenerator=h;};YesSign.prototype.setKeyPair=function(h){this.generatedKeyPair=h;};YesSign.prototype.generateKeyPair=function(m,q,o,h){var p;if(this.hasOwnProperty("keyGenerator")){this.keyGenerator(m,q,o,h);}else{var l=this.generatedKeyPair;var n=function(s,r){p=r;h(p);};if(typeof l!="undefined"){n(null,l);}else{d.generateKeyPair({bits:2048,e:65537,workers:this.workerNum,workerScript:this.workerScriptPath},n);}}};YesSign.prototype.issue=function(m,l,p){var v=this;var o;var y;var q;var r;var n=true;var s=true;var u;if(m==undefined){throw "reference number is not defined.";}if(l==undefined){throw "authentication code is not defined.";}if(p==undefined){throw "resultCallback is not defined.";}u=forge.random.getBytesSync(16);function w(z){try{v.conf(m,l,u,function(B){if(B===b){z(B);return;}q=a.toDer(B).getBytes();HTTPTransfer.send(v.url,HTTPTransfer.pkiReq,q,function(E,D,G,C){if(E===b){z(E);return;}if(C!=undefined){try{}catch(F){b.setError(b.ERROR_REQUESTCERT,F);z(b);return;}}z(v.certAndKey);});});}catch(A){b.setError(b.ERROR_REQUESTCERT,A);z(b);}}function t(z){try{v.ir(m,l,u,function(B){if(B===b){z(B);return;}q=a.toDer(B).getBytes();HTTPTransfer.send(v.url,HTTPTransfer.pkiReq,q,function(E,D,G,C){if(E===b){z(E);return;}try{v.decodeMessage(C);}catch(F){b.setError(b.ERROR_REQUESTCERT,F);z(b);return;}w(z);});});}catch(A){b.setError(b.ERROR_REQUESTCERT,A);z(b);}}function h(z){o=v.genm(m,u);q=a.toDer(o).getBytes();HTTPTransfer.send(v.url,HTTPTransfer.pkiReq,q,function(C,B,E,A){if(C===b){z(C);return;}try{v.decodeMessage(A);t(z);}catch(D){b.setError(b.ERROR_REQUESTCERT,D);z(b);}});}h(p);};YesSign.prototype.update=function(C,h,p,t,s,B,v,E){var z=this;z.oldCert=C;z.oldKey=h;z.oldKMCert=p;z.oldKMKey=t;z.certSerial=parseInt("0x"+s).toString();var u;var r;var D;var w;var l=true;var A=true;var F;var m="23456";var y="9319205181606408713";if(m==undefined){throw "reference number is not defined.";}if(y==undefined){throw "authentication code is not defined.";}if(E==undefined){throw "resultCallback is not defined.";}F=forge.random.getBytesSync(16);function o(G){try{z.conf(m,y,F,function(I){if(I===b){G(I);return;}D=a.toDer(I).getBytes();HTTPTransfer.send(z.url,HTTPTransfer.pkiReq,D,function(L,K,N,J){if(L===b){G(L);return;}if(J!=undefined){try{}catch(M){b.setError(b.ERROR_RENEWCERT,M);G(b);return;}}G(z.certAndKey);});});}catch(H){b.setError(b.ERROR_RENEWCERT,H);G(b);}}function q(G){try{var I=null;if(v==1){var I=B;}z.kur(z.oldCert,z.oldKey,B,I,F,function(J){if(J===b){G(J);return;}D=a.toDer(J).getBytes();HTTPTransfer.send(z.url,HTTPTransfer.pkiReq,D,function(M,L,O,K){if(M===b){G(M);return;}try{z.decodeMessage(K);}catch(N){b.setError(b.ERROR_RENEWCERT,N);G(b);return;}o(G);});});}catch(H){b.setError(b.ERROR_RENEWCERT,H);G(b);}}function n(G){u=z.genmkur(z.certSerial,z.oldCert,F);D=a.toDer(u).getBytes();HTTPTransfer.send(z.url,HTTPTransfer.pkiReq,D,function(J,I,L,H){if(J===b){G(J);return;}try{z.decodeMessage(H);q(G);}catch(K){b.setError(b.ERROR_RENEWCERT,K);G(b);}});}n(E);};YesSign.prototype.decodeMessage=function(m){var l;var o;l=a.fromDer(m);o=forge.cmp.PKIMessage.toObject(l);if("error" in o.body){var n;var p;n=o.body.error.pKIStatusInfo;if(n.statusString!=undefined){var h=0;for(h=0;h<n.statusString.length;++h){n.statusString[h]=g.euckrToUTF8(n.statusString[h]);}p="recieved CMP Error Message from CA:"+n.statusString.join();console.log(p);throw p;}}else{if("genp" in o.body){this.parseGenp(o.body.genp);}else{if("ip" in o.body){this.parseIp(o.body.ip);this.parseIpHeader(o.header);}else{if("kup" in o.body){this.parseIp(o.body.kup);this.parseIpHeader(o.header);}else{if("conf" in o.body){}else{throw "unknown cmp message";}}}}}};YesSign.prototype.genm=function(h,l){var n;var m;m={};m.header={pvno:forge.cmp.PKIHeader.cmp1999,sender:{rfc822Name:" "},recipient:{rfc822Name:" "},senderKID:h,transactionID:l};m.body={};m.body.genm=[{infoType:forge.cmp.oid.id_it_caProtEncCert}];return forge.cmp.PKIMessage.toAsn1(m);};YesSign.prototype.genmkur=function(o,n,h){var m;var l;l={};l.header={pvno:forge.cmp.PKIHeader.cmp1999,sender:{directoryName:n.subject},recipient:{rfc822Name:" "},senderKID:o,transactionID:h};l.body={};l.body.genm=[{infoType:forge.cmp.oid.id_it_caProtEncCert}];return forge.cmp.PKIMessage.toAsn1(l);};YesSign.prototype.parseGenp=function(l){var h=this;l.forEach(function(m){if(m.infoType==forge.cmp.oids.it_ca_ProtEncCert){h.CAProtocolEncryptionCertificate=forge.pki.certificateFromAsn1(a.fromDer(m.infoValue));}else{if(m.infoType==forge.yessign.VIDCertificate.oid){h.VIDEncryptionCertificate=forge.pki.certificateFromAsn1(a.fromDer(m.infoValue));}}});};YesSign.prototype.ir=function(h,p,n,m){var l=this;var q;var r;this.keyPair=[];q={};this.senderNonce=forge.random.getBytesSync(16);q.header={pvno:forge.cmp.PKIHeader.cmp1999,sender:{rfc822Name:" "},recipient:{rfc822Name:" "},messageTime:new Date,protectionAlg:{algorithm:forge.cmp.oids.passwordBasedMac},senderKID:h,senderNonce:this.senderNonce,transactionID:n};q.body={};q.body.ir=[];var o={name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Array([1,0,1]),hash:{name:"SHA-256"}};this.generateKeyPair(o,true,["sign"],function(s){if(s===b){s.pushReason("generateKeyPair failed");m(s);return;}l.keyPair.push({publicKey:s.publicKey,privateKey:s.privateKey});l.generateCertReqMsg(0,s.publicKey,s.privateKey,null,function(t){if(t===b){t.pushReason("failed to generateCertReqMsg(0)");m(t);return;}q.body.ir.push(t);q.protection=Standard.generateProtection(q.header,q.body,p);m(forge.cmp.PKIMessage.toAsn1(q));});});};YesSign.prototype.parseIp=function(m){var l=this;var h;h=m.caPubs;this.certAndKey=[];m.response.forEach(function(q,t){var r;var n;var o;var s;if(q.status.status!=0){for(iter=0;iter<q.status.statusString.length;++iter){q.status.statusString[iter]=g.euckrToUTF8(q.status.statusString[iter]);}throw "CMP response is error:"+q.status.statusString.join();}r=q.certifiedKeyPair;n=r.certOrEncCert;if("encryptedCert" in n){o=n.encryptedCert;var v;var p;var u;v=l.keyPair[t].privateKey.decrypt(o.encSymmKey);p="01234567";u=forge.des.startDecrypting(v,p);u.update(forge.util.createBuffer(o.encValue));u.finish();}else{if("certificate" in n){s=n.certificate;}}l.certAndKey.push({certificate:s,privateKey:l.keyPair[t].privateKey,vid:l.keyPair[t].vid});});};YesSign.prototype.parseIpHeader=function(h){if("senderNonce" in h){this.senderNonce=h.senderNonce;}if("recipNonce" in h){this.recipNonce=h.recipNonce;}};YesSign.prototype.conf=function(h,n,m,l){var p;var o;o={};o.header={pvno:forge.cmp.PKIHeader.cmp1999,sender:{rfc822Name:" "},recipient:{rfc822Name:" "},messageTime:new Date,protectionAlg:{algorithm:forge.cmp.oids.passwordBasedMac},senderKID:h,senderNonce:this.recipNonce,recipNonce:this.senderNonce,transactionID:m};o.body={};o.body.conf=[];o.protection=Standard.generateProtection(o.header,o.body,n);l(forge.cmp.PKIMessage.toAsn1(o));};YesSign.prototype.kur=function(n,m,o,q,r,l){var s=this;var t;var h;this.keyPair=[];t={};this.senderNonce=forge.random.getBytesSync(16);t.header={pvno:forge.cmp.PKIHeader.cmp1999,sender:{directoryName:n.subject},recipient:{rfc822Name:" "},messageTime:new Date,protectionAlg:{algorithm:forge.oids["sha256WithRSAEncryption"]},senderNonce:this.senderNonce,transactionID:r};t.body={};t.body.kur=[];var p={name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Array([1,0,1]),hash:{name:"SHA-256"}};this.generateKeyPair(p,true,["sign"],function(u){if(u===b){u.pushReason("generateKeyPair failed");l(u);return;}s.keyPair.push({publicKey:u.publicKey,privateKey:u.privateKey});s.generateCertReqMsg(0,u.publicKey,u.privateKey,s.oldCert,function(v){if(v===b){v.pushReason("failed to generateCertReqMsg(0)");l(v);return;}t.body.kur.push(v);t.protection=Standard.generateProtectionBySign(t.header,t.body,n,m,o,q);l(forge.cmp.PKIMessage.toAsn1(t));});});};YesSign.prototype.generateCertReqMsg=function(r,t,u,p,l){var v=this;var n={};var s={};var q={};var o={};var h={};var m;v.exportKeyInfo(t,function(w){if(w===b){w.pushReason("failed to export publicKey");l(w);}m=w;n.certReq=s;s.certReqId=r;s.certTemplate=q;q.publicKey=m;if(p!=null){s.controls=[];h.certID={issuer:p.issuer,serialNumber:a.derToInteger(forge.util.hexToBytes(p.serialNumber))};o.type=forge.kisa.OldCertReqMsg.oid;o.value=h;s.controls.push(o);}var y=forge.oids["sha256WithRSAEncryption"];YesSign.generatePOPO(y,m,u,function(z){if(z===b){z.pushReason("failed to generate ProofOfPosession");l(z);return;}n.popo=z;n.regInfo=v.generateRegInfo(r);l(n);});});};YesSign.prototype.exportKeyInfo=function(l,h){h(sofo.pki.publicKeyToAsn1(l));};YesSign.prototype.generateRegInfo=function(h){var l=[];if(h!=0){return null;}this.keyPair[h].vid=forge.random.getBytesSync(20);l.push(YesSign.generateVID("1234561234567",this.keyPair[h].vid,this.VIDEncryptionCertificate));return l;};YesSign.calculateVID=function(l,m,n){var o;var h;o={idn:l,randomNum:m};h=a.toDer(HashContent.toAsn1(o)).getBytes();n.start();n.update(h);h=n.digest().getBytes();n.start();n.update(h);h=n.digest().getBytes();return h;};YesSign.generateVID=function(l,h,o){var n={};var m;var q;var s={};var p;var r={};q={hashAlg:{algorithm:forge.oids["sha256"]}};q.virtualID=this.calculateVID(l,h,forge.md.sha256.create());m=a.toDer(forge.kisa.EncryptContent.toAsn1({vid:q,randomNum:h}));p=o.publicKey.encrypt(m.getBytes());s.version=0;s.vidHashAlg={algorithm:q.hashAlg.algorithm};s.vidEncAlg={algorithm:forge.oids["rsaEncryption"],parameters:null};s.certID={issuer:o.issuer,serialNumber:a.derToInteger(forge.util.hexToBytes(o.serialNumber))};s.encryptedVID=p;n.type=forge.kisa.EncryptedVID.oid;n.value=s;return n;};YesSign.generatePOPO=function(m,r,t,n){var o={};var p={};var u={};var l;var q;var h;p={authInfo:{sender:{rfc822Name:" "}},publicKey:r};l=forge.crmf.POPOSigningKeyInput.toAsn1(p);q=a.toDer(l).getBytes();var s=forge.sha256.create();s.update(q);h=t.sign(s,"RSASSA-PKCS1-V1_5");if(h===b){h.pushReason("failed to generate POPSigningKey");n(h);return;}u.poposkInput=p;u.algorithmIdentifier={algorithm:m};u.signature=h;o.signature=u;n(o);};XecureCA=function(l,o,n,m,h){this.url=l;this.pKeyId=o;this.workerNum=n;this.workerScriptPath=m;this.onlySignCertRequest=h;};XecureCA.prototype.setKeyGenerator=function(h){this.keyGenerator=h;};XecureCA.prototype.setKeyPair=function(h){this.generatedKeyPair=h;};XecureCA.prototype.generateKeyPair=function(q,n,r,h,t,l){var p=[];if(this.hasOwnProperty("keyGenerator")){this.keyGenerator(q,n,r,l);}else{var s=1;var o=this.generatedKeyPair;var u=this;var m=function(){var v=function(z,y){p.push(y);if(s<t){s++;m();}else{l(p);}};if(h==e.caPkeyId.PKEYID_RSA||s>1){if(typeof o!="undefined"){v(null,o);}else{d.generateKeyPair({bits:2048,e:65537,workers:u.workerNum,workerScript:u.workerScriptPath},v);}}else{if(h==e.caPkeyId.PKEYID_KCDSA){var w=forge.kcdsa.generateKeyPair(u.KCDSAKeyParams);v(0,w);}}};m();}};XecureCA.prototype.issue=function(m,l,p){var v=this;var o;var y;var q;var r;var n=true;var s=true;var u;if(m==undefined){throw "reference number is not defined.";}if(l==undefined){throw "authentication code is not defined.";}if(p==undefined){throw "resultCallback is not defined.";}u=forge.random.getBytesSync(16);function w(z){try{v.conf(m,l,u,function(B){if(B===b){z(B);return;}q=a.toDer(B).getBytes();HTTPTransfer.send(v.url,HTTPTransfer.pkiReq,q,function(E,D,G,C){if(E===b){z(E);return;}if(C!=undefined){try{}catch(F){b.setError(b.ERROR_REQUESTCERT,F);z(b);return;}}z(v.certAndKey);});});}catch(A){b.setError(b.ERROR_REQUESTCERT,A);z(b);}}function t(z){try{v.ir(m,l,u,v.pKeyId,function(B){if(B===b){z(B);return;}q=a.toDer(B).getBytes();HTTPTransfer.send(v.url,HTTPTransfer.pkiReq,q,function(E,D,G,C){if(E===b){z(E);return;}try{v.decodeMessage(C);}catch(F){b.setError(b.ERROR_REQUESTCERT,F);z(b);return;}w(z);});});}catch(A){b.setError(b.ERROR_REQUESTCERT,A);z(b);}}function h(z){o=v.genm(m,u);q=a.toDer(o).getBytes();HTTPTransfer.send(v.url,HTTPTransfer.pkiReq,q,function(C,B,E,A){if(C===b){z(C);return;}try{v.decodeMessage(A);t(z);}catch(D){b.setError(b.ERROR_REQUESTCERT,D);z(b);}});}h(p);};XecureCA.prototype.update=function(C,h,p,t,s,B,v,E){var z=this;if(C==undefined||h==undefined){b.setError("Renew(old) Cert or Key (KMCert) is invalid.");E(b);}z.oldCert=C;z.oldKey=h;z.oldKMCert=p;z.oldKMKey=t;z.certSerial=s;var u;var r;var D;var w;var l=true;var A=true;var F;var m="23456";var y="9319205181606408713";if(m==undefined){throw "reference number is not defined.";}if(y==undefined){throw "authentication code is not defined.";}if(E==undefined){throw "resultCallback is not defined.";}F=forge.random.getBytesSync(16);function o(G){try{z.conf(m,y,F,function(I){if(I===b){G(I);return;}D=a.toDer(I).getBytes();HTTPTransfer.send(z.url,HTTPTransfer.pkiReq,D,function(L,K,N,J){if(L===b){G(L);return;}if(J!=undefined){try{}catch(M){b.setError(b.ERROR_RENEWCERT,M);G(b);return;}}G(z.certAndKey);});});}catch(H){b.setError(b.ERROR_RENEWCERT,H);G(b);}}function q(G){try{var I=null;if(v==1){var I=B;}z.kur(z.oldCert,z.oldKey,z.oldKMCert,z.oldKMKey,B,I,F,z.pKeyId,function(J){if(J===b){G(J);return;}D=a.toDer(J).getBytes();HTTPTransfer.send(z.url,HTTPTransfer.pkiReq,D,function(M,L,O,K){if(M===b){G(M);return;}try{z.decodeMessage(K);}catch(N){b.setError(b.ERROR_RENEWCERT,N);G(b);return;}o(G);});});}catch(H){b.setError(b.ERROR_RENEWCERT,H);G(b);}}function n(G){u=z.genmkur(z.certSerial,z.oldCert,F);D=a.toDer(u).getBytes();HTTPTransfer.send(z.url,HTTPTransfer.pkiReq,D,function(J,I,L,H){if(J===b){G(J);return;}try{z.decodeMessage(H);q(G);}catch(K){b.setError(b.ERROR_RENEWCERT,K);G(b);}});}n(E);};XecureCA.prototype.decodeMessage=function(m){var l;var o;l=a.fromDer(m);o=forge.cmp.PKIMessage.toObject(l);if("error" in o.body){var n;var p;n=o.body.error.pKIStatusInfo;if(n.statusString!=undefined){var h=0;for(h=0;h<n.statusString.length;++h){n.statusString[h]=g.euckrToUTF8(n.statusString[h]);}p="recieved CMP Error Message from CA:"+n.statusString.join();console.log(p);throw p;}}else{if("genp" in o.body){this.parseGenp(o.body.genp);this.parseGenpHeader(o.header);}else{if("ip" in o.body){this.parseIp(o.body.ip);this.parseIpHeader(o.header);}else{if("kup" in o.body){this.parseIp(o.body.kup);this.parseIpHeader(o.header);}else{if("conf" in o.body){}else{throw "unknown cmp message";}}}}}};XecureCA.prototype.genm=function(h,l){var n;var o="0000";this.senderNonce=forge.random.getBytesSync(16);var m;m={};m.header={pvno:0,sender:{rfc822Name:" "},recipient:{rfc822Name:"PKI"},senderKID:h,recipKID:o,senderNonce:this.senderNonce,transactionID:l};m.body={};m.body.genm=undefined;return forge.cmp.PKIMessage.toAsn1(m);};XecureCA.prototype.genmkur=function(o,n,h){var m;var l;l={};this.senderNonce=forge.random.getBytesSync(16);l.header={pvno:0,sender:{directoryName:n.subject},recipient:{rfc822Name:" "},senderKID:o,recipKID:forge.pki.getPublicKeyFingerprint(n.publicKey,{type:"SubjectPublicKeyInfo",encoding:"binary"}),senderNonce:this.senderNonce,transactionID:h};l.body={};l.body.genm=undefined;return forge.cmp.PKIMessage.toAsn1(l);};XecureCA.prototype.parseGenp=function(l){var h=this;l.forEach(function(o){if(o.infoType==forge.cmp.oids.it_ca_ProtEncCert){h.CAProtocolEncryptionCertificate=forge.pki.certificateFromAsn1(a.fromDer(o.infoValue));}else{if(o.infoType==forge.cmp.oids.it_ca_SignKeyPairTypes){h.SignKeyPairTypes=true;var m=a.fromDer(o.infoValue);var n=[];m.value.forEach(function(p){n.push(forge.cmp.InfoTypeAndValue.toObject(p));});n.forEach(function(p){if(p.infoType==forge.cmp.oids.algorithemKCDSA1){h.KCDSAKeyParams=forge.kcdsa.keyParameterFromAsn1(a.fromDer(p.infoValue));}});}else{if(o.infoType==forge.yessign.VIDCertificate.oid){h.VIDEncryptionCertificate=forge.pki.certificateFromAsn1(a.fromDer(o.infoValue));}}}});};XecureCA.prototype.ir=function(m,l,q,h,o){var r=this;var s;var n;var p;this.keyPair=[];s={};s.header={pvno:forge.cmp.PKIHeader.cmp1999,sender:{rfc822Name:" "},recipient:{rfc822Name:" "},messageTime:new Date,protectionAlg:{algorithm:forge.cmp.oids.passwordBasedMac},senderKID:m,senderNonce:this.recipNonce,recipNonce:this.senderNonce,transactionID:q};s.body={};s.body.ir=[];if(h==e.caPkeyId.PKEYID_RSA){p={name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Array([1,0,1]),hash:{name:"SHA-256"}};}this.generateKeyPair(p,true,["sign"],h,this.onlySignCertRequest?1:2,function(t){var u=0;if(t===b){t.pushReason("generateKeyPair failed");o(t);return;}t.forEach(function(v){r.keyPair.push({publicKey:v.publicKey,privateKey:v.privateKey});});r.generateCertReqMsg(u,r.keyPair[u].publicKey,r.keyPair[u].privateKey,null,function(v){if(v===b){v.pushReason("failed to generateCertReqMsg(0)");o(v);return;}s.body.ir.push(v);if(r.keyPair.length==1){s.protection=Standard.generateProtection(s.header,s.body,l);o(forge.cmp.PKIMessage.toAsn1(s));}else{u=1;r.generateCertReqMsg(u,r.keyPair[u].publicKey,r.keyPair[u].privateKey,null,function(w){if(w===b){w.pushReason("failed to generateCertReqMsg(1)");o(w);return;}s.body.ir.push(w);s.protection=Standard.generateProtection(s.header,s.body,l);o(forge.cmp.PKIMessage.toAsn1(s));});}});});};XecureCA.prototype.parseIp=function(m){var l=this;var h;h=m.caPubs;this.certAndKey=[];m.response.forEach(function(p,s){var q;var n;var o;var r;if(p.status.status!=0){for(iter=0;iter<p.status.statusString.length;++iter){p.status.statusString[iter]=g.euckrToUTF8(p.status.statusString[iter]);}throw "CMP response is error:"+p.status.statusString.join();}q=p.certifiedKeyPair;n=q.certOrEncCert;if("encryptedCert" in n){o=n.encryptedCert;var t;t=l.keyPair[s].privateKey.decrypt(o.encSymmKey);symmIV=o.symmAlgAndIV.infoValue.getBytes().substr(2);var u=forge.des.startDecrypting(t,symmIV);u.update(forge.util.createBuffer(o.encValue));u.finish();var v=u.output;r=forge.pki.certificateFromAsn1(a.fromDer(v.getBytes()));}else{if("certificate" in n){r=n.certificate;}}l.certAndKey.push({certificate:r,privateKey:l.keyPair[s].privateKey,vid:l.keyPair[s].vid});});};XecureCA.prototype.parseGenpHeader=function(h){if("senderNonce" in h){this.senderNonce=h.senderNonce;}if("recipNonce" in h){this.recipNonce=h.recipNonce;}};XecureCA.prototype.parseIpHeader=function(h){if("senderNonce" in h){this.senderNonce=h.senderNonce;}if("recipNonce" in h){this.recipNonce=h.recipNonce;}};XecureCA.prototype.conf=function(h,n,m,l){var p;var o;o={};o.header={pvno:forge.cmp.PKIHeader.cmp1999,sender:{rfc822Name:" "},recipient:{rfc822Name:" "},messageTime:new Date,protectionAlg:{algorithm:forge.cmp.oids.passwordBasedMac},senderKID:h,senderNonce:this.recipNonce,recipNonce:this.senderNonce,transactionID:m};o.body={};o.body.conf=[];o.protection=Standard.generateProtection(o.header,o.body,n);l(forge.cmp.PKIMessage.toAsn1(o));};XecureCA.prototype.kur=function(o,n,t,s,p,r,v,h,m){var u=this;var w;var l;this.keyPair=[];w={};w.header={pvno:0,sender:{directoryName:o.subject},recipient:{rfc822Name:" "},messageTime:new Date,protectionAlg:{algorithm:h==e.caPkeyId.PKEYID_RSA?forge.oids["sha256WithRSAEncryption"]:forge.oids["kcdsa1WithHAS160"]},senderNonce:this.recipNonce,recipNonce:this.senderNonce,transactionID:v};w.body={};w.body.kur=[];if(h==e.caPkeyId.PKEYID_RSA){var q={name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Array([1,0,1]),hash:{name:"SHA-256"}};}this.generateKeyPair(q,true,["sign"],h,this.onlySignCertRequest?1:2,function(y){var z=0;if(y===b){y.pushReason("generateKeyPair failed");m(y);return;}y.forEach(function(A){u.keyPair.push({publicKey:A.publicKey,privateKey:A.privateKey});});u.generateCertReqMsg(z,u.keyPair[z].publicKey,u.keyPair[z].privateKey,u.oldCert,function(A){if(A===b){A.pushReason("failed to generateCertReqMsg(0)");m(A);return;}w.body.kur.push(A);if(u.oldKMCert==undefined||u.oldKMKey==undefined||u.keyPair.length==1){w.protection=Standard.generateProtectionBySign(w.header,w.body,o,n,p,r);m(forge.cmp.PKIMessage.toAsn1(w));}else{z=1;u.generateCertReqMsg(z,u.keyPair[z].publicKey,u.keyPair[z].privateKey,u.oldKMCert,function(B){if(B===b){B.pushReason("failed to generateCertReqMsg(1)");m(B);return;}w.body.kur.push(B);w.protection=Standard.generateProtectionBySign(w.header,w.body,o,n,p,r);m(forge.cmp.PKIMessage.toAsn1(w));});}});});};XecureCA.prototype.generateCertReqMsg=function(s,w,z,q,m){var B=this;var o={};var v={};var r={};var h={};var p={};var l={};var y={};var A={};var u={};var t;var n;if(s==0){B.exportKeyInfo(w,function(C){if(C===b){C.pushReason("failed to export publicKey");m(C);}n=C;o.certReq=v;v.certReqId=s;v.certTemplate=r;r.publicKey=n;if(q!=null){v.controls=[];l.certID={issuer:q.issuer,serialNumber:a.derToInteger(forge.util.hexToBytes(q.serialNumber))};p.type=forge.kisa.OldCertReqMsg.oid;p.value=l;v.controls.push(p);}if(z.kcdsa){var D=forge.oids["kcdsa1WithHAS160"];}else{var D=forge.oids["sha256WithRSAEncryption"];}XecureCA.generatePOPO(D,n,z,w,function(E){if(E===b){E.pushReason("failed to generate ProofOfPosession");m(E);return;}o.popo=E;o.regInfo=B.generateRegInfo(s);m(o);});});}else{if(s==1){B.exportKeyInfo(w,function(D){if(D===b){D.pushReason("failed to export publicKey");m(D);}n=D;o.certReq=v;v.certReqId=s;v.certTemplate=r;r.publicKey=n;v.controls=[];if(q!=null){l.certID={issuer:q.issuer,serialNumber:a.derToInteger(forge.util.hexToBytes(q.serialNumber))};p.type=forge.kisa.OldCertReqMsg.oid;p.value=l;v.controls.push(p);}A=forge.random.getBytesSync(8);var H=parseInt("0x04").toString()+A.length.toString()+A;y.symmAlg={algorithm:forge.kisa.SymmAlgorithms.oid,parameters:H};t=24;u=forge.random.getBytesSync(t);var E=forge.cipher.createCipher("3DES-CBC",u);E.start({iv:A});E.update(forge.util.createBuffer(a.toDer(forge.pki.privateKeyToAsn1(z)).getBytes()));E.finish();var C=E.output;var F=B.CAProtocolEncryptionCertificate;var G=F.publicKey.encrypt(u);y.encSymmKey=G;y.encValue=C.getBytes();h.type=forge.kisa.PKIArchiveOptions.oid;h.value=y;y.keyAlg={algorithm:forge.oids["rsaEncryption"]};v.controls.push(h);m(o);});}}};XecureCA.prototype.exportKeyInfo=function(m,l){var h=this;l(sofo.pki.publicKeyToAsn1(m));};XecureCA.prototype.generateRegInfo=function(h){var l=[];if(h!=0){return null;}this.keyPair[h].vid=forge.random.getBytesSync(20);if(this.SignKeyPairTypes!==null&&typeof this.SignKeyPairTypes!=="undefined"){l.push(XecureCA.generateVID("1234561234567",this.keyPair[h].vid,this.CAProtocolEncryptionCertificate));}else{l.push(XecureCA.generateVID("1234561234567",this.keyPair[h].vid,this.VIDEncryptionCertificate));}return l;};XecureCA.calculateVID=function(l,m,n){var o;var h;o={idn:l,randomNum:m};h=a.toDer(HashContent.toAsn1(o)).getBytes();n.start();n.update(h);h=n.digest().getBytes();n.start();n.update(h);h=n.digest().getBytes();return h;};XecureCA.generateVID=function(l,h,o){var n={};var m;var q;var s={};var p;var r={};q={hashAlg:{algorithm:forge.oids["sha256"]}};q.virtualID=this.calculateVID(l,h,forge.md.sha256.create());m=a.toDer(forge.kisa.EncryptContent.toAsn1({vid:q,randomNum:h}));p=o.publicKey.encrypt(m.getBytes());s.version=0;s.vidHashAlg={algorithm:q.hashAlg.algorithm};s.vidEncAlg={algorithm:forge.oids["rsaEncryption"],parameters:null};s.certID={issuer:o.issuer,serialNumber:a.derToInteger(forge.util.hexToBytes(o.serialNumber))};s.encryptedVID=p;n.type=forge.kisa.EncryptedVID.oid;n.value=s;return n;};XecureCA.generatePOPO=function(m,p,v,s,n){var o={};var q={};var w={};var l;var r;var h;q={authInfo:{sender:{rfc822Name:" "}},publicKey:p};l=forge.crmf.POPOSigningKeyInput.toAsn1(q);r=a.toDer(l).getBytes();if(v.kcdsa){var u=v.sign("has160",r,s.y);h=a.toDer(u).getBytes();}else{var t=forge.sha256.create();t.update(r);h=v.sign(t,"RSASSA-PKCS1-V1_5");}if(h===b){h.pushReason("failed to generate POPSigningKey");n(h);return;}w.poposkInput=q;w.algorithmIdentifier={algorithm:m};w.signature=h;o.signature=w;n(o);};XecureCA.generateKMCertReqMsg=function(m,r,t,n){var o={};var p={};var u={};var l;var q;var h;p={authInfo:{sender:{rfc822Name:" "}},publicKey:r};l=forge.crmf.POPOSigningKeyInput.toAsn1(p);q=a.toDer(l).getBytes();var s=forge.sha256.create();s.update(q);h=t.sign(s,"RSASSA-PKCS1-V1_5");if(h===b){h.pushReason("failed to generate POPSigningKey");n(h);return;}u.poposkInput=p;u.algorithmIdentifier={algorithm:m};u.signature=h;o.signature=u;n(o);};e.client={};e.client.Standard=Standard;e.client.YesSign=YesSign;e.client.XecureCA=XecureCA;HTTPTransfer=function(){};HTTPTransfer.pkiReq=0;HTTPTransfer.pkiRep=5;HTTPTransfer.errorMsgRep=6;HTTPTransfer.send=function(l,n,p,h){var q=new XMLHttpRequest;var o;o=forge.util.createBuffer();o.putInt32(p.length+3);o.putByte(16);o.putByte(0);o.putByte(n);o.putBytes(p);q.open("POST",l,true);q.onreadystatechange=function(){if(q.readyState==4){var r;var v;var y;var t;var s;var u;var w;if(q.status!=200){if(q.status==545){h(545);return;}b.setError("WebCMP HTTPTransfer(XHR) recieved status code:["+q.status+"] with status message:["+q.statusText+"]");h(b);return;}v=forge.util.createBuffer(forge.util.decode64(decodeURIComponent(q.responseText)));y=v.getInt32();t=v.getByte();s=v.getByte();u=v.getByte();w=v.getBytes();h(t,s,u,w);}};o=forge.util.encode64(o.getBytes());q.setRequestHeader("Content-type","application/pkixcmp");try{q.send(o);}catch(m){b.setError(b.ERROR_REQUESTCERT,m);h(b);}};var g={};g.tableKSC5601=[12288,12289,12290,183,8229,8230,168,12291,173,8213,8741,65340,8764,8216,8217,8220,8221,12308,12309,12296,12297,12298,12299,12300,12301,12302,12303,12304,12305,177,215,247,8800,8804,8805,8734,8756,176,8242,8243,8451,8491,65504,65505,65509,9794,9792,8736,8869,8978,8706,8711,8801,8786,167,8251,9734,9733,9675,9679,9678,9671,9670,9633,9632,9651,9650,9661,9660,8594,8592,8593,8595,8596,12307,8810,8811,8730,8765,8733,8757,8747,8748,8712,8715,8838,8839,8834,8835,8746,8745,8743,8744,65506,8658,8660,8704,8707,180,65374,711,728,733,730,729,184,731,161,191,720,8750,8721,8719,164,8457,8240,9665,9664,9655,9654,9828,9824,9825,9829,9831,9827,8857,9672,9635,9680,9681,9618,9636,9637,9640,9639,9638,9641,9832,9743,9742,9756,9758,182,8224,8225,8597,8599,8601,8598,8600,9837,9833,9834,9836,12927,12828,8470,13255,8482,13250,13272,8481,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,65281,65282,65283,65284,65285,65286,65287,65288,65289,65290,65291,65292,65293,65294,65295,65296,65297,65298,65299,65300,65301,65302,65303,65304,65305,65306,65307,65308,65309,65310,65311,65312,65313,65314,65315,65316,65317,65318,65319,65320,65321,65322,65323,65324,65325,65326,65327,65328,65329,65330,65331,65332,65333,65334,65335,65336,65337,65338,65339,65510,65341,65342,65343,65344,65345,65346,65347,65348,65349,65350,65351,65352,65353,65354,65355,65356,65357,65358,65359,65360,65361,65362,65363,65364,65365,65366,65367,65368,65369,65370,65371,65372,65373,65507,12593,12594,12595,12596,12597,12598,12599,12600,12601,12602,12603,12604,12605,12606,12607,12608,12609,12610,12611,12612,12613,12614,12615,12616,12617,12618,12619,12620,12621,12622,12623,12624,12625,12626,12627,12628,12629,12630,12631,12632,12633,12634,12635,12636,12637,12638,12639,12640,12641,12642,12643,12644,12645,12646,12647,12648,12649,12650,12651,12652,12653,12654,12655,12656,12657,12658,12659,12660,12661,12662,12663,12664,12665,12666,12667,12668,12669,12670,12671,12672,12673,12674,12675,12676,12677,12678,12679,12680,12681,12682,12683,12684,12685,12686,8560,8561,8562,8563,8564,8565,8566,8567,8568,8569,-1,-1,-1,-1,-1,8544,8545,8546,8547,8548,8549,8550,8551,8552,8553,-1,-1,-1,-1,-1,-1,-1,913,914,915,916,917,918,919,920,921,922,923,924,925,926,927,928,929,931,932,933,934,935,936,937,-1,-1,-1,-1,-1,-1,-1,-1,945,946,947,948,949,950,951,952,953,954,955,956,957,958,959,960,961,963,964,965,966,967,968,969,-1,-1,-1,-1,-1,-1,9472,9474,9484,9488,9496,9492,9500,9516,9508,9524,9532,9473,9475,9487,9491,9499,9495,9507,9523,9515,9531,9547,9504,9519,9512,9527,9535,9501,9520,9509,9528,9538,9490,9489,9498,9497,9494,9493,9486,9485,9502,9503,9505,9506,9510,9511,9513,9514,9517,9518,9521,9522,9525,9526,9529,9530,9533,9534,9536,9537,9539,9540,9541,9542,9543,9544,9545,9546,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13205,13206,13207,8467,13208,13252,13219,13220,13221,13222,13209,13210,13211,13212,13213,13214,13215,13216,13217,13218,13258,13197,13198,13199,13263,13192,13193,13256,13223,13224,13232,13233,13234,13235,13236,13237,13238,13239,13240,13241,13184,13185,13186,13187,13188,13242,13243,13244,13245,13246,13247,13200,13201,13202,13203,13204,8486,13248,13249,13194,13195,13196,13270,13253,13229,13230,13231,13275,13225,13226,13227,13228,13277,13264,13267,13251,13257,13276,13254,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,198,208,170,294,-1,306,-1,319,321,216,338,186,222,358,330,-1,12896,12897,12898,12899,12900,12901,12902,12903,12904,12905,12906,12907,12908,12909,12910,12911,12912,12913,12914,12915,12916,12917,12918,12919,12920,12921,12922,12923,9424,9425,9426,9427,9428,9429,9430,9431,9432,9433,9434,9435,9436,9437,9438,9439,9440,9441,9442,9443,9444,9445,9446,9447,9448,9449,9312,9313,9314,9315,9316,9317,9318,9319,9320,9321,9322,9323,9324,9325,9326,189,8531,8532,188,190,8539,8540,8541,8542,230,273,240,295,305,307,312,320,322,248,339,223,254,359,331,329,12800,12801,12802,12803,12804,12805,12806,12807,12808,12809,12810,12811,12812,12813,12814,12815,12816,12817,12818,12819,12820,12821,12822,12823,12824,12825,12826,12827,9372,9373,9374,9375,9376,9377,9378,9379,9380,9381,9382,9383,9384,9385,9386,9387,9388,9389,9390,9391,9392,9393,9394,9395,9396,9397,9332,9333,9334,9335,9336,9337,9338,9339,9340,9341,9342,9343,9344,9345,9346,185,178,179,8308,8319,8321,8322,8323,8324,12353,12354,12355,12356,12357,12358,12359,12360,12361,12362,12363,12364,12365,12366,12367,12368,12369,12370,12371,12372,12373,12374,12375,12376,12377,12378,12379,12380,12381,12382,12383,12384,12385,12386,12387,12388,12389,12390,12391,12392,12393,12394,12395,12396,12397,12398,12399,12400,12401,12402,12403,12404,12405,12406,12407,12408,12409,12410,12411,12412,12413,12414,12415,12416,12417,12418,12419,12420,12421,12422,12423,12424,12425,12426,12427,12428,12429,12430,12431,12432,12433,12434,12435,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,12449,12450,12451,12452,12453,12454,12455,12456,12457,12458,12459,12460,12461,12462,12463,12464,12465,12466,12467,12468,12469,12470,12471,12472,12473,12474,12475,12476,12477,12478,12479,12480,12481,12482,12483,12484,12485,12486,12487,12488,12489,12490,12491,12492,12493,12494,12495,12496,12497,12498,12499,12500,12501,12502,12503,12504,12505,12506,12507,12508,12509,12510,12511,12512,12513,12514,12515,12516,12517,12518,12519,12520,12521,12522,12523,12524,12525,12526,12527,12528,12529,12530,12531,12532,12533,12534,-1,-1,-1,-1,-1,-1,-1,-1,1040,1041,1042,1043,1044,1045,1025,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1072,1073,1074,1075,1076,1077,1105,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44032,44033,44036,44039,44040,44041,44042,44048,44049,44050,44051,44052,44053,44054,44055,44057,44058,44059,44060,44061,44064,44068,44076,44077,44079,44080,44081,44088,44089,44092,44096,44107,44109,44116,44120,44124,44144,44145,44148,44151,44152,44154,44160,44161,44163,44164,44165,44166,44169,44170,44171,44172,44176,44180,44188,44189,44191,44192,44193,44200,44201,44202,44204,44207,44208,44216,44217,44219,44220,44221,44225,44228,44232,44236,44245,44247,44256,44257,44260,44263,44264,44266,44268,44271,44272,44273,44275,44277,44278,44284,44285,44288,44292,44294,44300,44301,44303,44305,44312,44316,44320,44329,44332,44333,44340,44341,44344,44348,44356,44357,44359,44361,44368,44372,44376,44385,44387,44396,44397,44400,44403,44404,44405,44406,44411,44412,44413,44415,44417,44418,44424,44425,44428,44432,44444,44445,44452,44471,44480,44481,44484,44488,44496,44497,44499,44508,44512,44516,44536,44537,44540,44543,44544,44545,44552,44553,44555,44557,44564,44592,44593,44596,44599,44600,44602,44608,44609,44611,44613,44614,44618,44620,44621,44622,44624,44628,44630,44636,44637,44639,44640,44641,44645,44648,44649,44652,44656,44664,44665,44667,44668,44669,44676,44677,44684,44732,44733,44734,44736,44740,44748,44749,44751,44752,44753,44760,44761,44764,44776,44779,44781,44788,44792,44796,44807,44808,44813,44816,44844,44845,44848,44850,44852,44860,44861,44863,44865,44866,44867,44872,44873,44880,44892,44893,44900,44901,44921,44928,44932,44936,44944,44945,44949,44956,44984,44985,44988,44992,44999,45000,45001,45003,45005,45006,45012,45020,45032,45033,45040,45041,45044,45048,45056,45057,45060,45068,45072,45076,45084,45085,45096,45124,45125,45128,45130,45132,45134,45139,45140,45141,45143,45145,45149,45180,45181,45184,45188,45196,45197,45199,45201,45208,45209,45210,45212,45215,45216,45217,45218,45224,45225,45227,45228,45229,45230,45231,45233,45235,45236,45237,45240,45244,45252,45253,45255,45256,45257,45264,45265,45268,45272,45280,45285,45320,45321,45323,45324,45328,45330,45331,45336,45337,45339,45340,45341,45347,45348,45349,45352,45356,45364,45365,45367,45368,45369,45376,45377,45380,45384,45392,45393,45396,45397,45400,45404,45408,45432,45433,45436,45440,45442,45448,45449,45451,45453,45458,45459,45460,45464,45468,45480,45516,45520,45524,45532,45533,45535,45544,45545,45548,45552,45561,45563,45565,45572,45573,45576,45579,45580,45588,45589,45591,45593,45600,45620,45628,45656,45660,45664,45672,45673,45684,45685,45692,45700,45701,45705,45712,45713,45716,45720,45721,45722,45728,45729,45731,45733,45734,45738,45740,45744,45748,45768,45769,45772,45776,45778,45784,45785,45787,45789,45794,45796,45797,45798,45800,45803,45804,45805,45806,45807,45811,45812,45813,45815,45816,45817,45818,45819,45823,45824,45825,45828,45832,45840,45841,45843,45844,45845,45852,45908,45909,45910,45912,45915,45916,45918,45919,45924,45925,45927,45929,45931,45934,45936,45937,45940,45944,45952,45953,45955,45956,45957,45964,45968,45972,45984,45985,45992,45996,46020,46021,46024,46027,46028,46030,46032,46036,46037,46039,46041,46043,46045,46048,46052,46056,46076,46096,46104,46108,46112,46120,46121,46123,46132,46160,46161,46164,46168,46176,46177,46179,46181,46188,46208,46216,46237,46244,46248,46252,46261,46263,46265,46272,46276,46280,46288,46293,46300,46301,46304,46307,46308,46310,46316,46317,46319,46321,46328,46356,46357,46360,46363,46364,46372,46373,46375,46376,46377,46378,46384,46385,46388,46392,46400,46401,46403,46404,46405,46411,46412,46413,46416,46420,46428,46429,46431,46432,46433,46496,46497,46500,46504,46506,46507,46512,46513,46515,46516,46517,46523,46524,46525,46528,46532,46540,46541,46543,46544,46545,46552,46572,46608,46609,46612,46616,46629,46636,46644,46664,46692,46696,46748,46749,46752,46756,46763,46764,46769,46804,46832,46836,46840,46848,46849,46853,46888,46889,46892,46895,46896,46904,46905,46907,46916,46920,46924,46932,46933,46944,46948,46952,46960,46961,46963,46965,46972,46973,46976,46980,46988,46989,46991,46992,46993,46994,46998,46999,47000,47001,47004,47008,47016,47017,47019,47020,47021,47028,47029,47032,47047,47049,47084,47085,47088,47092,47100,47101,47103,47104,47105,47111,47112,47113,47116,47120,47128,47129,47131,47133,47140,47141,47144,47148,47156,47157,47159,47160,47161,47168,47172,47185,47187,47196,47197,47200,47204,47212,47213,47215,47217,47224,47228,47245,47272,47280,47284,47288,47296,47297,47299,47301,47308,47312,47316,47325,47327,47329,47336,47337,47340,47344,47352,47353,47355,47357,47364,47384,47392,47420,47421,47424,47428,47436,47439,47441,47448,47449,47452,47456,47464,47465,47467,47469,47476,47477,47480,47484,47492,47493,47495,47497,47498,47501,47502,47532,47533,47536,47540,47548,47549,47551,47553,47560,47561,47564,47566,47567,47568,47569,47570,47576,47577,47579,47581,47582,47585,47587,47588,47589,47592,47596,47604,47605,47607,47608,47609,47610,47616,47617,47624,47637,47672,47673,47676,47680,47682,47688,47689,47691,47693,47694,47699,47700,47701,47704,47708,47716,47717,47719,47720,47721,47728,47729,47732,47736,47747,47748,47749,47751,47756,47784,47785,47787,47788,47792,47794,47800,47801,47803,47805,47812,47816,47832,47833,47868,47872,47876,47885,47887,47889,47896,47900,47904,47913,47915,47924,47925,47926,47928,47931,47932,47933,47934,47940,47941,47943,47945,47949,47951,47952,47956,47960,47969,47971,47980,48008,48012,48016,48036,48040,48044,48052,48055,48064,48068,48072,48080,48083,48120,48121,48124,48127,48128,48130,48136,48137,48139,48140,48141,48143,48145,48148,48149,48150,48151,48152,48155,48156,48157,48158,48159,48164,48165,48167,48169,48173,48176,48177,48180,48184,48192,48193,48195,48196,48197,48201,48204,48205,48208,48221,48260,48261,48264,48267,48268,48270,48276,48277,48279,48281,48282,48288,48289,48292,48295,48296,48304,48305,48307,48308,48309,48316,48317,48320,48324,48333,48335,48336,48337,48341,48344,48348,48372,48373,48374,48376,48380,48388,48389,48391,48393,48400,48404,48420,48428,48448,48456,48457,48460,48464,48472,48473,48484,48488,48512,48513,48516,48519,48520,48521,48522,48528,48529,48531,48533,48537,48538,48540,48548,48560,48568,48596,48597,48600,48604,48617,48624,48628,48632,48640,48643,48645,48652,48653,48656,48660,48668,48669,48671,48708,48709,48712,48716,48718,48724,48725,48727,48729,48730,48731,48736,48737,48740,48744,48746,48752,48753,48755,48756,48757,48763,48764,48765,48768,48772,48780,48781,48783,48784,48785,48792,48793,48808,48848,48849,48852,48855,48856,48864,48867,48868,48869,48876,48897,48904,48905,48920,48921,48923,48924,48925,48960,48961,48964,48968,48976,48977,48981,49044,49072,49093,49100,49101,49104,49108,49116,49119,49121,49212,49233,49240,49244,49248,49256,49257,49296,49297,49300,49304,49312,49313,49315,49317,49324,49325,49327,49328,49331,49332,49333,49334,49340,49341,49343,49344,49345,49349,49352,49353,49356,49360,49368,49369,49371,49372,49373,49380,49381,49384,49388,49396,49397,49399,49401,49408,49412,49416,49424,49429,49436,49437,49438,49439,49440,49443,49444,49446,49447,49452,49453,49455,49456,49457,49462,49464,49465,49468,49472,49480,49481,49483,49484,49485,49492,49493,49496,49500,49508,49509,49511,49512,49513,49520,49524,49528,49541,49548,49549,49550,49552,49556,49558,49564,49565,49567,49569,49573,49576,49577,49580,49584,49597,49604,49608,49612,49620,49623,49624,49632,49636,49640,49648,49649,49651,49660,49661,49664,49668,49676,49677,49679,49681,49688,49689,49692,49695,49696,49704,49705,49707,49709,49711,49713,49714,49716,49736,49744,49745,49748,49752,49760,49765,49772,49773,49776,49780,49788,49789,49791,49793,49800,49801,49808,49816,49819,49821,49828,49829,49832,49836,49837,49844,49845,49847,49849,49884,49885,49888,49891,49892,49899,49900,49901,49903,49905,49910,49912,49913,49915,49916,49920,49928,49929,49932,49933,49939,49940,49941,49944,49948,49956,49957,49960,49961,49989,50024,50025,50028,50032,50034,50040,50041,50044,50045,50052,50056,50060,50112,50136,50137,50140,50143,50144,50146,50152,50153,50157,50164,50165,50168,50184,50192,50212,50220,50224,50228,50236,50237,50248,50276,50277,50280,50284,50292,50293,50297,50304,50324,50332,50360,50364,50409,50416,50417,50420,50424,50426,50431,50432,50433,50444,50448,50452,50460,50472,50473,50476,50480,50488,50489,50491,50493,50500,50501,50504,50505,50506,50508,50509,50510,50515,50516,50517,50519,50520,50521,50525,50526,50528,50529,50532,50536,50544,50545,50547,50548,50549,50556,50557,50560,50564,50567,50572,50573,50575,50577,50581,50583,50584,50588,50592,50601,50612,50613,50616,50617,50619,50620,50621,50622,50628,50629,50630,50631,50632,50633,50634,50636,50638,50640,50641,50644,50648,50656,50657,50659,50661,50668,50669,50670,50672,50676,50678,50679,50684,50685,50686,50687,50688,50689,50693,50694,50695,50696,50700,50704,50712,50713,50715,50716,50724,50725,50728,50732,50733,50734,50736,50739,50740,50741,50743,50745,50747,50752,50753,50756,50760,50768,50769,50771,50772,50773,50780,50781,50784,50796,50799,50801,50808,50809,50812,50816,50824,50825,50827,50829,50836,50837,50840,50844,50852,50853,50855,50857,50864,50865,50868,50872,50873,50874,50880,50881,50883,50885,50892,50893,50896,50900,50908,50909,50912,50913,50920,50921,50924,50928,50936,50937,50941,50948,50949,50952,50956,50964,50965,50967,50969,50976,50977,50980,50984,50992,50993,50995,50997,50999,51004,51005,51008,51012,51018,51020,51021,51023,51025,51026,51027,51028,51029,51030,51031,51032,51036,51040,51048,51051,51060,51061,51064,51068,51069,51070,51075,51076,51077,51079,51080,51081,51082,51086,51088,51089,51092,51094,51095,51096,51098,51104,51105,51107,51108,51109,51110,51116,51117,51120,51124,51132,51133,51135,51136,51137,51144,51145,51148,51150,51152,51160,51165,51172,51176,51180,51200,51201,51204,51208,51210,51216,51217,51219,51221,51222,51228,51229,51232,51236,51244,51245,51247,51249,51256,51260,51264,51272,51273,51276,51277,51284,51312,51313,51316,51320,51322,51328,51329,51331,51333,51334,51335,51339,51340,51341,51348,51357,51359,51361,51368,51388,51389,51396,51400,51404,51412,51413,51415,51417,51424,51425,51428,51445,51452,51453,51456,51460,51461,51462,51468,51469,51471,51473,51480,51500,51508,51536,51537,51540,51544,51552,51553,51555,51564,51568,51572,51580,51592,51593,51596,51600,51608,51609,51611,51613,51648,51649,51652,51655,51656,51658,51664,51665,51667,51669,51670,51673,51674,51676,51677,51680,51682,51684,51687,51692,51693,51695,51696,51697,51704,51705,51708,51712,51720,51721,51723,51724,51725,51732,51736,51753,51788,51789,51792,51796,51804,51805,51807,51808,51809,51816,51837,51844,51864,51900,51901,51904,51908,51916,51917,51919,51921,51923,51928,51929,51936,51948,51956,51976,51984,51988,51992,52000,52001,52033,52040,52041,52044,52048,52056,52057,52061,52068,52088,52089,52124,52152,52180,52196,52199,52201,52236,52237,52240,52244,52252,52253,52257,52258,52263,52264,52265,52268,52270,52272,52280,52281,52283,52284,52285,52286,52292,52293,52296,52300,52308,52309,52311,52312,52313,52320,52324,52326,52328,52336,52341,52376,52377,52380,52384,52392,52393,52395,52396,52397,52404,52405,52408,52412,52420,52421,52423,52425,52432,52436,52452,52460,52464,52481,52488,52489,52492,52496,52504,52505,52507,52509,52516,52520,52524,52537,52572,52576,52580,52588,52589,52591,52593,52600,52616,52628,52629,52632,52636,52644,52645,52647,52649,52656,52676,52684,52688,52712,52716,52720,52728,52729,52731,52733,52740,52744,52748,52756,52761,52768,52769,52772,52776,52784,52785,52787,52789,52824,52825,52828,52831,52832,52833,52840,52841,52843,52845,52852,52853,52856,52860,52868,52869,52871,52873,52880,52881,52884,52888,52896,52897,52899,52900,52901,52908,52909,52929,52964,52965,52968,52971,52972,52980,52981,52983,52984,52985,52992,52993,52996,53000,53008,53009,53011,53013,53020,53024,53028,53036,53037,53039,53040,53041,53048,53076,53077,53080,53084,53092,53093,53095,53097,53104,53105,53108,53112,53120,53125,53132,53153,53160,53168,53188,53216,53217,53220,53224,53232,53233,53235,53237,53244,53248,53252,53265,53272,53293,53300,53301,53304,53308,53316,53317,53319,53321,53328,53332,53336,53344,53356,53357,53360,53364,53372,53373,53377,53412,53413,53416,53420,53428,53429,53431,53433,53440,53441,53444,53448,53449,53456,53457,53459,53460,53461,53468,53469,53472,53476,53484,53485,53487,53488,53489,53496,53517,53552,53553,53556,53560,53562,53568,53569,53571,53572,53573,53580,53581,53584,53588,53596,53597,53599,53601,53608,53612,53628,53636,53640,53664,53665,53668,53672,53680,53681,53683,53685,53690,53692,53696,53720,53748,53752,53767,53769,53776,53804,53805,53808,53812,53820,53821,53823,53825,53832,53852,53860,53888,53889,53892,53896,53904,53905,53909,53916,53920,53924,53932,53937,53944,53945,53948,53951,53952,53954,53960,53961,53963,53972,53976,53980,53988,53989,54000,54001,54004,54008,54016,54017,54019,54021,54028,54029,54030,54032,54036,54038,54044,54045,54047,54048,54049,54053,54056,54057,54060,54064,54072,54073,54075,54076,54077,54084,54085,54140,54141,54144,54148,54156,54157,54159,54160,54161,54168,54169,54172,54176,54184,54185,54187,54189,54196,54200,54204,54212,54213,54216,54217,54224,54232,54241,54243,54252,54253,54256,54260,54268,54269,54271,54273,54280,54301,54336,54340,54364,54368,54372,54381,54383,54392,54393,54396,54399,54400,54402,54408,54409,54411,54413,54420,54441,54476,54480,54484,54492,54495,54504,54508,54512,54520,54523,54525,54532,54536,54540,54548,54549,54551,54588,54589,54592,54596,54604,54605,54607,54609,54616,54617,54620,54624,54629,54632,54633,54635,54637,54644,54645,54648,54652,54660,54661,54663,54664,54665,54672,54693,54728,54729,54732,54736,54738,54744,54745,54747,54749,54756,54757,54760,54764,54772,54773,54775,54777,54784,54785,54788,54792,54800,54801,54803,54804,54805,54812,54816,54820,54829,54840,54841,54844,54848,54853,54856,54857,54859,54861,54865,54868,54869,54872,54876,54887,54889,54896,54897,54900,54915,54917,54924,54925,54928,54932,54941,54943,54945,54952,54956,54960,54969,54971,54980,54981,54984,54988,54993,54996,54999,55001,55008,55012,55016,55024,55029,55036,55037,55040,55044,55057,55064,55065,55068,55072,55080,55081,55083,55085,55092,55093,55096,55100,55108,55111,55113,55120,55121,55124,55126,55127,55128,55129,55136,55137,55139,55141,55145,55148,55152,55156,55164,55165,55169,55176,55177,55180,55184,55192,55193,55195,55197,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,20285,20339,20551,20729,21152,21487,21621,21733,22025,23233,23478,26247,26550,26551,26607,27468,29634,30146,31292,33499,33540,34903,34952,35382,36040,36303,36603,36838,39381,21051,21364,21508,24682,24932,27580,29647,33050,35258,35282,38307,20355,21002,22718,22904,23014,24178,24185,25031,25536,26438,26604,26751,28567,30286,30475,30965,31240,31487,31777,32925,33390,33393,35563,38291,20075,21917,26359,28212,30883,31469,33883,35088,34638,38824,21208,22350,22570,23884,24863,25022,25121,25954,26577,27204,28187,29976,30131,30435,30640,32058,37039,37969,37970,40853,21283,23724,30002,32987,37440,38296,21083,22536,23004,23713,23831,24247,24378,24394,24951,27743,30074,30086,31968,32115,32177,32652,33108,33313,34193,35137,35611,37628,38477,40007,20171,20215,20491,20977,22607,24887,24894,24936,25913,27114,28433,30117,30342,30422,31623,33445,33995,63744,37799,38283,21888,23458,22353,63745,31923,32697,37301,20520,21435,23621,24040,25298,25454,25818,25831,28192,28844,31067,36317,36382,63746,36989,37445,37624,20094,20214,20581,24062,24314,24838,26967,33137,34388,36423,37749,39467,20062,20625,26480,26688,20745,21133,21138,27298,30652,37392,40660,21163,24623,36850,20552,25001,25581,25802,26684,27268,28608,33160,35233,38548,22533,29309,29356,29956,32121,32365,32937,35211,35700,36963,40273,25225,27770,28500,32080,32570,35363,20860,24906,31645,35609,37463,37772,20140,20435,20510,20670,20742,21185,21197,21375,22384,22659,24218,24465,24950,25004,25806,25964,26223,26299,26356,26775,28039,28805,28913,29855,29861,29898,30169,30828,30956,31455,31478,32069,32147,32789,32831,33051,33686,35686,36629,36885,37857,38915,38968,39514,39912,20418,21843,22586,22865,23395,23622,24760,25106,26690,26800,26856,28330,30028,30328,30926,31293,31995,32363,32380,35336,35489,35903,38542,40388,21476,21481,21578,21617,22266,22993,23396,23611,24235,25335,25911,25925,25970,26272,26543,27073,27837,30204,30352,30590,31295,32660,32771,32929,33167,33510,33533,33776,34241,34865,34996,35493,63747,36764,37678,38599,39015,39640,40723,21741,26011,26354,26767,31296,35895,40288,22256,22372,23825,26118,26801,26829,28414,29736,34974,39908,27752,63748,39592,20379,20844,20849,21151,23380,24037,24656,24685,25329,25511,25915,29657,31354,34467,36002,38799,20018,23521,25096,26524,29916,31185,33747,35463,35506,36328,36942,37707,38982,24275,27112,34303,37101,63749,20896,23448,23532,24931,26874,27454,28748,29743,29912,31649,32592,33733,35264,36011,38364,39208,21038,24669,25324,36866,20362,20809,21281,22745,24291,26336,27960,28826,29378,29654,31568,33009,37979,21350,25499,32619,20054,20608,22602,22750,24618,24871,25296,27088,39745,23439,32024,32945,36703,20132,20689,21676,21932,23308,23968,24039,25898,25934,26657,27211,29409,30350,30703,32094,32761,33184,34126,34527,36611,36686,37066,39171,39509,39851,19992,20037,20061,20167,20465,20855,21246,21312,21475,21477,21646,22036,22389,22434,23495,23943,24272,25084,25304,25937,26552,26601,27083,27472,27590,27628,27714,28317,28792,29399,29590,29699,30655,30697,31350,32127,32777,33276,33285,33290,33503,34914,35635,36092,36544,36881,37041,37476,37558,39378,39493,40169,40407,40860,22283,23616,33738,38816,38827,40628,21531,31384,32676,35033,36557,37089,22528,23624,25496,31391,23470,24339,31353,31406,33422,36524,20518,21048,21240,21367,22280,25331,25458,27402,28099,30519,21413,29527,34152,36470,38357,26426,27331,28528,35437,36556,39243,63750,26231,27512,36020,39740,63751,21483,22317,22862,25542,27131,29674,30789,31418,31429,31998,33909,35215,36211,36917,38312,21243,22343,30023,31584,33740,37406,63752,27224,20811,21067,21127,25119,26840,26997,38553,20677,21156,21220,25027,26020,26681,27135,29822,31563,33465,33771,35250,35641,36817,39241,63753,20170,22935,25810,26129,27278,29748,31105,31165,33449,34942,34943,35167,63754,37670,20235,21450,24613,25201,27762,32026,32102,20120,20834,30684,32943,20225,20238,20854,20864,21980,22120,22331,22522,22524,22804,22855,22931,23492,23696,23822,24049,24190,24524,25216,26071,26083,26398,26399,26462,26827,26820,27231,27450,27683,27773,27778,28103,29592,29734,29738,29826,29859,30072,30079,30849,30959,31041,31047,31048,31098,31637,32000,32186,32648,32774,32813,32908,35352,35663,35912,36215,37665,37668,39138,39249,39438,39439,39525,40594,32202,20342,21513,25326,26708,37329,21931,20794,63755,63756,23068,25062,63757,25295,25343,63758,63759,63760,63761,63762,63763,37027,63764,63765,63766,63767,63768,35582,63769,63770,63771,63772,26262,63773,29014,63774,63775,38627,63776,25423,25466,21335,63777,26511,26976,28275,63778,30007,63779,63780,63781,32013,63782,63783,34930,22218,23064,63784,63785,63786,63787,63788,20035,63789,20839,22856,26608,32784,63790,22899,24180,25754,31178,24565,24684,25288,25467,23527,23511,21162,63791,22900,24361,24594,63792,63793,63794,29785,63795,63796,63797,63798,63799,63800,39377,63801,63802,63803,63804,63805,63806,63807,63808,63809,63810,63811,28611,63812,63813,33215,36786,24817,63814,63815,33126,63816,63817,23615,63818,63819,63820,63821,63822,63823,63824,63825,23273,35365,26491,32016,63826,63827,63828,63829,63830,63831,33021,63832,63833,23612,27877,21311,28346,22810,33590,20025,20150,20294,21934,22296,22727,24406,26039,26086,27264,27573,28237,30701,31471,31774,32222,34507,34962,37170,37723,25787,28606,29562,30136,36948,21846,22349,25018,25812,26311,28129,28251,28525,28601,30192,32835,33213,34113,35203,35527,35674,37663,27795,30035,31572,36367,36957,21776,22530,22616,24162,25095,25758,26848,30070,31958,34739,40680,20195,22408,22382,22823,23565,23729,24118,24453,25140,25825,29619,33274,34955,36024,38538,40667,23429,24503,24755,20498,20992,21040,22294,22581,22615,23566,23648,23798,23947,24230,24466,24764,25361,25481,25623,26691,26873,27330,28120,28193,28372,28644,29182,30428,30585,31153,31291,33796,35241,36077,36339,36424,36867,36884,36947,37117,37709,38518,38876,27602,28678,29272,29346,29544,30563,31167,31716,32411,35712,22697,24775,25958,26109,26302,27788,28958,29129,35930,38931,20077,31361,20189,20908,20941,21205,21516,24999,26481,26704,26847,27934,28540,30140,30643,31461,33012,33891,37509,20828,26007,26460,26515,30168,31431,33651,63834,35910,36887,38957,23663,33216,33434,36929,36975,37389,24471,23965,27225,29128,30331,31561,34276,35588,37159,39472,21895,25078,63835,30313,32645,34367,34746,35064,37007,63836,27931,28889,29662,32097,33853,63837,37226,39409,63838,20098,21365,27396,27410,28734,29211,34349,40478,21068,36771,23888,25829,25900,27414,28651,31811,32412,34253,35172,35261,25289,33240,34847,24266,26391,28010,29436,29701,29807,34690,37086,20358,23821,24480,33802,20919,25504,30053,20142,20486,20841,20937,26753,27153,31918,31921,31975,33391,35538,36635,37327,20406,20791,21237,21570,24300,24942,25150,26053,27354,28670,31018,34268,34851,38317,39522,39530,40599,40654,21147,26310,27511,28701,31019,36706,38722,24976,25088,25891,28451,29001,29833,32244,32879,34030,36646,36899,37706,20925,21015,21155,27916,28872,35010,24265,25986,27566,28610,31806,29557,20196,20278,22265,63839,23738,23994,24604,29618,31533,32666,32718,32838,36894,37428,38646,38728,38936,40801,20363,28583,31150,37300,38583,21214,63840,25736,25796,27347,28510,28696,29200,30439,32769,34310,34396,36335,36613,38706,39791,40442,40565,30860,31103,32160,33737,37636,40575,40595,35542,22751,24324,26407,28711,29903,31840,32894,20769,28712,29282,30922,36034,36058,36084,38647,20102,20698,23534,24278,26009,29134,30274,30637,32842,34044,36988,39719,40845,22744,23105,23650,27155,28122,28431,30267,32047,32311,34078,35128,37860,38475,21129,26066,26611,27060,27969,28316,28687,29705,29792,30041,30244,30827,35628,39006,20845,25134,38520,20374,20523,23833,28138,32184,36650,24459,24900,26647,63841,38534,21202,32907,20956,20940,26974,31260,32190,33777,38517,20442,21033,21400,21519,21774,23653,24743,26446,26792,28012,29313,29432,29702,29827,63842,30178,31852,32633,32696,33673,35023,35041,37324,37328,38626,39881,21533,28542,29136,29848,34298,36522,38563,40023,40607,26519,28107,29747,33256,38678,30764,31435,31520,31890,25705,29802,30194,30908,30952,39340,39764,40635,23518,24149,28448,33180,33707,37000,19975,21325,23081,24018,24398,24930,25405,26217,26364,28415,28459,28771,30622,33836,34067,34875,36627,39237,39995,21788,25273,26411,27819,33545,35178,38778,20129,22916,24536,24537,26395,32178,32596,33426,33579,33725,36638,37017,22475,22969,23186,23504,26151,26522,26757,27599,29028,32629,36023,36067,36993,39749,33032,35978,38476,39488,40613,23391,27667,29467,30450,30431,33804,20906,35219,20813,20885,21193,26825,27796,30468,30496,32191,32236,38754,40629,28357,34065,20901,21517,21629,26126,26269,26919,28319,30399,30609,33559,33986,34719,37225,37528,40180,34946,20398,20882,21215,22982,24125,24917,25720,25721,26286,26576,27169,27597,27611,29279,29281,29761,30520,30683,32791,33468,33541,35584,35624,35980,26408,27792,29287,30446,30566,31302,40361,27519,27794,22818,26406,33945,21359,22675,22937,24287,25551,26164,26483,28218,29483,31447,33495,37672,21209,24043,25006,25035,25098,25287,25771,26080,26969,27494,27595,28961,29687,30045,32326,33310,33538,34154,35491,36031,38695,40289,22696,40664,20497,21006,21563,21839,25991,27766,32010,32011,32862,34442,38272,38639,21247,27797,29289,21619,23194,23614,23883,24396,24494,26410,26806,26979,28220,28228,30473,31859,32654,34183,35598,36855,38753,40692,23735,24758,24845,25003,25935,26107,26108,27665,27887,29599,29641,32225,38292,23494,34588,35600,21085,21338,25293,25615,25778,26420,27192,27850,29632,29854,31636,31893,32283,33162,33334,34180,36843,38649,39361,20276,21322,21453,21467,25292,25644,25856,26001,27075,27886,28504,29677,30036,30242,30436,30460,30928,30971,31020,32070,33324,34784,36820,38930,39151,21187,25300,25765,28196,28497,30332,36299,37297,37474,39662,39747,20515,20621,22346,22952,23592,24135,24439,25151,25918,26041,26049,26121,26507,27036,28354,30917,32033,32938,33152,33323,33459,33953,34444,35370,35607,37030,38450,40848,20493,20467,63843,22521,24472,25308,25490,26479,28227,28953,30403,32972,32986,35060,35061,35097,36064,36649,37197,38506,20271,20336,24091,26575,26658,30333,30334,39748,24161,27146,29033,29140,30058,63844,32321,34115,34281,39132,20240,31567,32624,38309,20961,24070,26805,27710,27726,27867,29359,31684,33539,27861,29754,20731,21128,22721,25816,27287,29863,30294,30887,34327,38370,38713,63845,21342,24321,35722,36776,36783,37002,21029,30629,40009,40712,19993,20482,20853,23643,24183,26142,26170,26564,26821,28851,29953,30149,31177,31453,36647,39200,39432,20445,22561,22577,23542,26222,27493,27921,28282,28541,29668,29995,33769,35036,35091,35676,36628,20239,20693,21264,21340,23443,24489,26381,31119,33145,33583,34068,35079,35206,36665,36667,39333,39954,26412,20086,20472,22857,23553,23791,23792,25447,26834,28925,29090,29739,32299,34028,34562,36898,37586,40179,19981,20184,20463,20613,21078,21103,21542,21648,22496,22827,23142,23386,23413,23500,24220,63846,25206,25975,26023,28014,28325,29238,31526,31807,32566,33104,33105,33178,33344,33433,33705,35331,36000,36070,36091,36212,36282,37096,37340,38428,38468,39385,40167,21271,20998,21545,22132,22707,22868,22894,24575,24996,25198,26128,27774,28954,30406,31881,31966,32027,33452,36033,38640,63847,20315,24343,24447,25282,23849,26379,26842,30844,32323,40300,19989,20633,21269,21290,21329,22915,23138,24199,24754,24970,25161,25209,26000,26503,27047,27604,27606,27607,27608,27832,63848,29749,30202,30738,30865,31189,31192,31875,32203,32737,32933,33086,33218,33778,34586,35048,35513,35692,36027,37145,38750,39131,40763,22188,23338,24428,25996,27315,27567,27996,28657,28693,29277,29613,36007,36051,38971,24977,27703,32856,39425,20045,20107,20123,20181,20282,20284,20351,20447,20735,21490,21496,21766,21987,22235,22763,22882,23057,23531,23546,23556,24051,24107,24473,24605,25448,26012,26031,26614,26619,26797,27515,27801,27863,28195,28681,29509,30722,31038,31040,31072,31169,31721,32023,32114,32902,33293,33678,34001,34503,35039,35408,35422,35613,36060,36198,36781,37034,39164,39391,40605,21066,63849,26388,63850,20632,21034,23665,25955,27733,29642,29987,30109,31639,33948,37240,38704,20087,25746,27578,29022,34217,19977,63851,26441,26862,28183,33439,34072,34923,25591,28545,37394,39087,19978,20663,20687,20767,21830,21930,22039,23360,23577,23776,24120,24202,24224,24258,24819,26705,27233,28248,29245,29248,29376,30456,31077,31665,32724,35059,35316,35443,35937,36062,38684,22622,29885,36093,21959,63852,31329,32034,33394,29298,29983,29989,63853,31513,22661,22779,23996,24207,24246,24464,24661,25234,25471,25933,26257,26329,26360,26646,26866,29312,29790,31598,32110,32214,32626,32997,33298,34223,35199,35475,36893,37604,40653,40736,22805,22893,24109,24796,26132,26227,26512,27728,28101,28511,30707,30889,33990,37323,37675,20185,20682,20808,21892,23307,23459,25159,25982,26059,28210,29053,29697,29764,29831,29887,30316,31146,32218,32341,32680,33146,33203,33337,34330,34796,35445,36323,36984,37521,37925,39245,39854,21352,23633,26964,27844,27945,28203,33292,34203,35131,35373,35498,38634,40807,21089,26297,27570,32406,34814,36109,38275,38493,25885,28041,29166,63854,22478,22995,23468,24615,24826,25104,26143,26207,29481,29689,30427,30465,31596,32854,32882,33125,35488,37266,19990,21218,27506,27927,31237,31545,32048,63855,36016,21484,22063,22609,23477,23567,23569,24034,25152,25475,25620,26157,26803,27836,28040,28335,28703,28836,29138,29990,30095,30094,30233,31505,31712,31787,32032,32057,34092,34157,34311,35380,36877,36961,37045,37559,38902,39479,20439,23660,26463,28049,31903,32396,35606,36118,36895,23403,24061,25613,33984,36956,39137,29575,23435,24730,26494,28126,35359,35494,36865,38924,21047,63856,28753,30862,37782,34928,37335,20462,21463,22013,22234,22402,22781,23234,23432,23723,23744,24101,24833,25101,25163,25480,25628,25910,25976,27193,27530,27700,27929,28465,29159,29417,29560,29703,29874,30246,30561,31168,31319,31466,31929,32143,32172,32353,32670,33065,33585,33936,34010,34282,34966,35504,35728,36664,36930,36995,37228,37526,37561,38539,38567,38568,38614,38656,38920,39318,39635,39706,21460,22654,22809,23408,23487,28113,28506,29087,29729,29881,32901,33789,24033,24455,24490,24642,26092,26642,26991,27219,27529,27957,28147,29667,30462,30636,31565,32020,33059,33308,33600,34036,34147,35426,35524,37255,37662,38918,39348,25100,34899,36848,37477,23815,23847,23913,29791,33181,34664,28629,25342,32722,35126,35186,19998,20056,20711,21213,21319,25215,26119,32361,34821,38494,20365,21273,22070,22987,23204,23608,23630,23629,24066,24337,24643,26045,26159,26178,26558,26612,29468,30690,31034,32709,33940,33997,35222,35430,35433,35553,35925,35962,22516,23508,24335,24687,25325,26893,27542,28252,29060,31698,34645,35672,36606,39135,39166,20280,20353,20449,21627,23072,23480,24892,26032,26216,29180,30003,31070,32051,33102,33251,33688,34218,34254,34563,35338,36523,36763,63857,36805,22833,23460,23526,24713,23529,23563,24515,27777,63858,28145,28683,29978,33455,35574,20160,21313,63859,38617,27663,20126,20420,20818,21854,23077,23784,25105,29273,33469,33706,34558,34905,35357,38463,38597,39187,40201,40285,22538,23731,23997,24132,24801,24853,25569,27138,28197,37122,37716,38990,39952,40823,23433,23736,25353,26191,26696,30524,38593,38797,38996,39839,26017,35585,36555,38332,21813,23721,24022,24245,26263,30284,33780,38343,22739,25276,29390,40232,20208,22830,24591,26171,27523,31207,40230,21395,21696,22467,23830,24859,26326,28079,30861,33406,38552,38724,21380,25212,25494,28082,32266,33099,38989,27387,32588,40367,40474,20063,20539,20918,22812,24825,25590,26928,29242,32822,63860,37326,24369,63861,63862,32004,33509,33903,33979,34277,36493,63863,20335,63864,63865,22756,23363,24665,25562,25880,25965,26264,63866,26954,27171,27915,28673,29036,30162,30221,31155,31344,63867,32650,63868,35140,63869,35731,37312,38525,63870,39178,22276,24481,26044,28417,30208,31142,35486,39341,39770,40812,20740,25014,25233,27277,33222,20547,22576,24422,28937,35328,35578,23420,34326,20474,20796,22196,22852,25513,28153,23978,26989,20870,20104,20313,63871,63872,63873,22914,63874,63875,27487,27741,63876,29877,30998,63877,33287,33349,33593,36671,36701,63878,39192,63879,63880,63881,20134,63882,22495,24441,26131,63883,63884,30123,32377,35695,63885,36870,39515,22181,22567,23032,23071,23476,63886,24310,63887,63888,25424,25403,63889,26941,27783,27839,28046,28051,28149,28436,63890,28895,28982,29017,63891,29123,29141,63892,30799,30831,63893,31605,32227,63894,32303,63895,34893,36575,63896,63897,63898,37467,63899,40182,63900,63901,63902,24709,28037,63903,29105,63904,63905,38321,21421,63906,63907,63908,26579,63909,28814,28976,29744,33398,33490,63910,38331,39653,40573,26308,63911,29121,33865,63912,63913,22603,63914,63915,23992,24433,63916,26144,26254,27001,27054,27704,27891,28214,28481,28634,28699,28719,29008,29151,29552,63917,29787,63918,29908,30408,31310,32403,63919,63920,33521,35424,36814,63921,37704,63922,38681,63923,63924,20034,20522,63925,21000,21473,26355,27757,28618,29450,30591,31330,33454,34269,34306,63926,35028,35427,35709,35947,63927,37555,63928,38675,38928,20116,20237,20425,20658,21320,21566,21555,21978,22626,22714,22887,23067,23524,24735,63929,25034,25942,26111,26212,26791,27738,28595,28879,29100,29522,31613,34568,35492,39986,40711,23627,27779,29508,29577,37434,28331,29797,30239,31337,32277,34314,20800,22725,25793,29934,29973,30320,32705,37013,38605,39252,28198,29926,31401,31402,33253,34521,34680,35355,23113,23436,23451,26785,26880,28003,29609,29715,29740,30871,32233,32747,33048,33109,33694,35916,38446,38929,26352,24448,26106,26505,27754,29579,20525,23043,27498,30702,22806,23916,24013,29477,30031,63930,63931,20709,20985,22575,22829,22934,23002,23525,63932,63933,23970,25303,25622,25747,25854,63934,26332,63935,27208,63936,29183,29796,63937,31368,31407,32327,32350,32768,33136,63938,34799,35201,35616,36953,63939,36992,39250,24958,27442,28020,32287,35109,36785,20433,20653,20887,21191,22471,22665,23481,24248,24898,27029,28044,28263,28342,29076,29794,29992,29996,32883,33592,33993,36362,37780,37854,63940,20110,20305,20598,20778,21448,21451,21491,23431,23507,23588,24858,24962,26100,29275,29591,29760,30402,31056,31121,31161,32006,32701,33419,34261,34398,36802,36935,37109,37354,38533,38632,38633,21206,24423,26093,26161,26671,29020,31286,37057,38922,20113,63941,27218,27550,28560,29065,32792,33464,34131,36939,38549,38642,38907,34074,39729,20112,29066,38596,20803,21407,21729,22291,22290,22435,23195,23236,23491,24616,24895,25588,27781,27961,28274,28304,29232,29503,29783,33489,34945,36677,36960,63942,38498,39000,40219,26376,36234,37470,20301,20553,20702,21361,22285,22996,23041,23561,24944,26256,28205,29234,29771,32239,32963,33806,33894,34111,34655,34907,35096,35586,36949,38859,39759,20083,20369,20754,20842,63943,21807,21929,23418,23461,24188,24189,24254,24736,24799,24840,24841,25540,25912,26377,63944,26580,26586,63945,26977,26978,27833,27943,63946,28216,63947,28641,29494,29495,63948,29788,30001,63949,30290,63950,63951,32173,33278,33848,35029,35480,35547,35565,36400,36418,36938,36926,36986,37193,37321,37742,63952,63953,22537,63954,27603,32905,32946,63955,63956,20801,22891,23609,63957,63958,28516,29607,32996,36103,63959,37399,38287,63960,63961,63962,63963,32895,25102,28700,32104,34701,63964,22432,24681,24903,27575,35518,37504,38577,20057,21535,28139,34093,38512,38899,39150,25558,27875,37009,20957,25033,33210,40441,20381,20506,20736,23452,24847,25087,25836,26885,27589,30097,30691,32681,33380,34191,34811,34915,35516,35696,37291,20108,20197,20234,63965,63966,22839,23016,63967,24050,24347,24411,24609,63968,63969,63970,63971,29246,29669,63972,30064,30157,63973,31227,63974,32780,32819,32900,33505,33617,63975,63976,36029,36019,36999,63977,63978,39156,39180,63979,63980,28727,30410,32714,32716,32764,35610,20154,20161,20995,21360,63981,21693,22240,23035,23493,24341,24525,28270,63982,63983,32106,33589,63984,34451,35469,63985,38765,38775,63986,63987,19968,20314,20350,22777,26085,28322,36920,37808,39353,20219,22764,22922,23001,24641,63988,63989,31252,63990,33615,36035,20837,21316,63991,63992,63993,20173,21097,23381,33471,20180,21050,21672,22985,23039,23376,23383,23388,24675,24904,28363,28825,29038,29574,29943,30133,30913,32043,32773,33258,33576,34071,34249,35566,36039,38604,20316,21242,22204,26027,26152,28796,28856,29237,32189,33421,37196,38592,40306,23409,26855,27544,28538,30430,23697,26283,28507,31668,31786,34870,38620,19976,20183,21280,22580,22715,22767,22892,23559,24115,24196,24373,25484,26290,26454,27167,27299,27404,28479,29254,63994,29520,29835,31456,31911,33144,33247,33255,33674,33900,34083,34196,34255,35037,36115,37292,38263,38556,20877,21705,22312,23472,25165,26448,26685,26771,28221,28371,28797,32289,35009,36001,36617,40779,40782,29229,31631,35533,37658,20295,20302,20786,21632,22992,24213,25269,26485,26990,27159,27822,28186,29401,29482,30141,31672,32053,33511,33785,33879,34295,35419,36015,36487,36889,37048,38606,40799,21219,21514,23265,23490,25688,25973,28404,29380,63995,30340,31309,31515,31821,32318,32735,33659,35627,36042,36196,36321,36447,36842,36857,36969,37841,20291,20346,20659,20840,20856,21069,21098,22625,22652,22880,23560,23637,24283,24731,25136,26643,27583,27656,28593,29006,29728,30000,30008,30033,30322,31564,31627,31661,31686,32399,35438,36670,36681,37439,37523,37666,37931,38651,39002,39019,39198,20999,25130,25240,27993,30308,31434,31680,32118,21344,23742,24215,28472,28857,31896,38673,39822,40670,25509,25722,34678,19969,20117,20141,20572,20597,21576,22979,23450,24128,24237,24311,24449,24773,25402,25919,25972,26060,26230,26232,26622,26984,27273,27491,27712,28096,28136,28191,28254,28702,28833,29582,29693,30010,30555,30855,31118,31243,31357,31934,32142,33351,35330,35562,35998,37165,37194,37336,37478,37580,37664,38662,38742,38748,38914,40718,21046,21137,21884,22564,24093,24351,24716,25552,26799,28639,31085,31532,33229,34234,35069,35576,36420,37261,38500,38555,38717,38988,40778,20430,20806,20939,21161,22066,24340,24427,25514,25805,26089,26177,26362,26361,26397,26781,26839,27133,28437,28526,29031,29157,29226,29866,30522,31062,31066,31199,31264,31381,31895,31967,32068,32368,32903,34299,34468,35412,35519,36249,36481,36896,36973,37347,38459,38613,40165,26063,31751,36275,37827,23384,23562,21330,25305,29469,20519,23447,24478,24752,24939,26837,28121,29742,31278,32066,32156,32305,33131,36394,36405,37758,37912,20304,22352,24038,24231,25387,32618,20027,20303,20367,20570,23005,32964,21610,21608,22014,22863,23449,24030,24282,26205,26417,26609,26666,27880,27954,28234,28557,28855,29664,30087,31820,32002,32044,32162,33311,34523,35387,35461,36208,36490,36659,36913,37198,37202,37956,39376,31481,31909,20426,20737,20934,22472,23535,23803,26201,27197,27994,28310,28652,28940,30063,31459,34850,36897,36981,38603,39423,33537,20013,20210,34886,37325,21373,27355,26987,27713,33914,22686,24974,26366,25327,28893,29969,30151,32338,33976,35657,36104,20043,21482,21675,22320,22336,24535,25345,25351,25711,25903,26088,26234,26525,26547,27490,27744,27802,28460,30693,30757,31049,31063,32025,32930,33026,33267,33437,33463,34584,35468,63996,36100,36286,36978,30452,31257,31287,32340,32887,21767,21972,22645,25391,25634,26185,26187,26733,27035,27524,27941,28337,29645,29800,29857,30043,30137,30433,30494,30603,31206,32265,32285,33275,34095,34967,35386,36049,36587,36784,36914,37805,38499,38515,38663,20356,21489,23018,23241,24089,26702,29894,30142,31209,31378,33187,34541,36074,36300,36845,26015,26389,63997,22519,28503,32221,36655,37878,38598,24501,25074,28548,19988,20376,20511,21449,21983,23919,24046,27425,27492,30923,31642,63998,36425,36554,36974,25417,25662,30528,31364,37679,38015,40810,25776,28591,29158,29864,29914,31428,31762,32386,31922,32408,35738,36106,38013,39184,39244,21049,23519,25830,26413,32046,20717,21443,22649,24920,24921,25082,26028,31449,35730,35734,20489,20513,21109,21809,23100,24288,24432,24884,25950,26124,26166,26274,27085,28356,28466,29462,30241,31379,33081,33369,33750,33980,20661,22512,23488,23528,24425,25505,30758,32181,33756,34081,37319,37365,20874,26613,31574,36012,20932,22971,24765,34389,20508,63999,21076,23610,24957,25114,25299,25842,26021,28364,30240,33034,36448,38495,38587,20191,21315,21912,22825,24029,25797,27849,28154,29588,31359,33307,34214,36068,36368,36983,37351,38369,38433,38854,20984,21746,21894,24505,25764,28552,32180,36639,36685,37941,20681,23574,27838,28155,29979,30651,31805,31844,35449,35522,22558,22974,24086,25463,29266,30090,30571,35548,36028,36626,24307,26228,28152,32893,33729,35531,38737,39894,64000,21059,26367,28053,28399,32224,35558,36910,36958,39636,21021,21119,21736,24980,25220,25307,26786,26898,26970,27189,28818,28966,30813,30977,30990,31186,31245,32918,33400,33493,33609,34121,35970,36229,37218,37259,37294,20419,22225,29165,30679,34560,35320,23544,24534,26449,37032,21474,22618,23541,24740,24961,25696,32317,32880,34085,37507,25774,20652,23828,26368,22684,25277,25512,26894,27000,27166,28267,30394,31179,33467,33833,35535,36264,36861,37138,37195,37276,37648,37656,37786,38619,39478,39949,19985,30044,31069,31482,31569,31689,32302,33988,36441,36468,36600,36880,26149,26943,29763,20986,26414,40668,20805,24544,27798,34802,34909,34935,24756,33205,33795,36101,21462,21561,22068,23094,23601,28810,32736,32858,33030,33261,36259,37257,39519,40434,20596,20164,21408,24827,28204,23652,20360,20516,21988,23769,24159,24677,26772,27835,28100,29118,30164,30196,30305,31258,31305,32199,32251,32622,33268,34473,36636,38601,39347,40786,21063,21189,39149,35242,19971,26578,28422,20405,23522,26517,27784,28024,29723,30759,37341,37756,34756,31204,31281,24555,20182,21668,21822,22702,22949,24816,25171,25302,26422,26965,33333,38464,39345,39389,20524,21331,21828,22396,64001,25176,64002,25826,26219,26589,28609,28655,29730,29752,35351,37944,21585,22022,22374,24392,24986,27470,28760,28845,32187,35477,22890,33067,25506,30472,32829,36010,22612,25645,27067,23445,24081,28271,64003,34153,20812,21488,22826,24608,24907,27526,27760,27888,31518,32974,33492,36294,37040,39089,64004,25799,28580,25745,25860,20814,21520,22303,35342,24927,26742,64005,30171,31570,32113,36890,22534,27084,33151,35114,36864,38969,20600,22871,22956,25237,36879,39722,24925,29305,38358,22369,23110,24052,25226,25773,25850,26487,27874,27966,29228,29750,30772,32631,33453,36315,38935,21028,22338,26495,29256,29923,36009,36774,37393,38442,20843,21485,25420,20329,21764,24726,25943,27803,28031,29260,29437,31255,35207,35997,24429,28558,28921,33192,24846,20415,20559,25153,29255,31687,32232,32745,36941,38829,39449,36022,22378,24179,26544,33805,35413,21536,23318,24163,24290,24330,25987,32954,34109,38281,38491,20296,21253,21261,21263,21638,21754,22275,24067,24598,25243,25265,25429,64006,27873,28006,30129,30770,32990,33071,33502,33889,33970,34957,35090,36875,37610,39165,39825,24133,26292,26333,28689,29190,64007,20469,21117,24426,24915,26451,27161,28418,29922,31080,34920,35961,39111,39108,39491,21697,31263,26963,35575,35914,39080,39342,24444,25259,30130,30382,34987,36991,38466,21305,24380,24517,27852,29644,30050,30091,31558,33534,39325,20047,36924,19979,20309,21414,22799,24264,26160,27827,29781,33655,34662,36032,36944,38686,39957,22737,23416,34384,35604,40372,23506,24680,24717,26097,27735,28450,28579,28698,32597,32752,38289,38290,38480,38867,21106,36676,20989,21547,21688,21859,21898,27323,28085,32216,33382,37532,38519,40569,21512,21704,30418,34532,38308,38356,38492,20130,20233,23022,23270,24055,24658,25239,26477,26689,27782,28207,32568,32923,33322,64008,64009,38917,20133,20565,21683,22419,22874,23401,23475,25032,26999,28023,28707,34809,35299,35442,35559,36994,39405,39608,21182,26680,20502,24184,26447,33607,34892,20139,21521,22190,29670,37141,38911,39177,39255,39321,22099,22687,34395,35377,25010,27382,29563,36562,27463,38570,39511,22869,29184,36203,38761,20436,23796,24358,25080,26203,27883,28843,29572,29625,29694,30505,30541,32067,32098,32291,33335,34898,64010,36066,37449,39023,23377,31348,34880,38913,23244,20448,21332,22846,23805,25406,28025,29433,33029,33031,33698,37583,38960,20136,20804,21009,22411,24418,27842,28366,28677,28752,28847,29074,29673,29801,33610,34722,34913,36872,37026,37795,39336,20846,24407,24800,24935,26291,34137,36426,37295,38795,20046,20114,21628,22741,22778,22909,23733,24359,25142,25160,26122,26215,27627,28009,28111,28246,28408,28564,28640,28649,28765,29392,29733,29786,29920,30355,31068,31946,32286,32993,33446,33899,33983,34382,34399,34676,35703,35946,37804,38912,39013,24785,25110,37239,23130,26127,28151,28222,29759,39746,24573,24794,31503,21700,24344,27742,27859,27946,28888,32005,34425,35340,40251,21270,21644,23301,27194,28779,30069,31117,31166,33457,33775,35441,35649,36008,38772,64011,25844,25899,30906,30907,31339,20024,21914,22864,23462,24187,24739,25563,27489,26213,26707,28185,29029,29872,32008,36996,39529,39973,27963,28369,29502,35905,38346,20976,24140,24488,24653,24822,24880,24908,26179,26180,27045,27841,28255,28361,28514,29004,29852,30343,31681,31783,33618,34647,36945,38541,40643,21295,22238,24315,24458,24674,24724,25079,26214,26371,27292,28142,28590,28784,29546,32362,33214,33588,34516,35496,36036,21123,29554,23446,27243,37892,21742,22150,23389,25928,25989,26313,26783,28045,28102,29243,32948,37237,39501,20399,20505,21402,21518,21564,21897,21957,24127,24460,26429,29030,29661,36869,21211,21235,22628,22734,28932,29071,29179,34224,35347,26248,34216,21927,26244,29002,33841,21321,21913,27585,24409,24509,25582,26249,28999,35569,36637,40638,20241,25658,28875,30054,34407,24676,35662,40440,20807,20982,21256,27958,33016,40657,26133,27427,28824,30165,21507,23673,32007,35350,27424,27453,27462,21560,24688,27965,32725,33288,20694,20958,21916,22123,22221,23020,23305,24076,24985,24984,25137,26206,26342,29081,29113,29114,29351,31143,31232,32690,35440,0];g.euckrToUTF8=function(n){var m;var o=[];for(m=0;m<n.length;++m){var l;var h;l=n.charCodeAt(m);if(0<=l&&l<128){o.push(String.fromCharCode(l));}else{var p=0;var q;m++;h=n.charCodeAt(m);p=(l-161)*94+h-161;if(p<0||util.tableKSC5601.length<p){q="?";yt.console.log("unknown euckr code ("+l+":"+h+")");}else{q=util.tableKSC5601[p];}o.push(String.fromCharCode(q));}}return o.join("");};g.encodeEUCKR=function(o){var m;var n=[];for(m=0;m<o.length;++m){var q;var l;var h;q=o.charCodeAt(m);if(0<=q&&q<128){n.push(String.fromCharCode(q));}else{var r=0;var p;r=util.tableKSC5601.indexOf(q);if(r==-1){yt.console.log("unknown euckr code ("+q+")");n.push("?");continue;}p=Math.floor(r/94);l=p+161;h=r-p*94+161;n.push(String.fromCharCode(l));n.push(String.fromCharCode(h));}}return n.join("");};})();(function(){var a=sofo.error||{};var b=sofo.xfs||{};var c={code:0,msg_koKR:"",msg_enUS:"",internal:""};var d=[];a.INTERFACE_CHECKXCRYPTO=16777216;a.INTERFACE_SETLANGUAGE=33554432;a.INTERFACE_SETCHARSET=50331648;a.INTERFACE_SETLICENSE=67108864;a.INTERFACE_SETPROPERTY=83886080;a.INTERFACE_SETSECURITYCONTEXT=100663296;a.INTERFACE_SETISSUERCONVERTTABLE=117440512;a.INTERFACE_SETPOLICYCONVERTTABLE=134217728;a.INTERFACE_SETLASTLOCATION=150994944;a.INTERFACE_GETLASTLOCATION=167772160;a.INTERFACE_SETCACHECERTLOCATION=184549376;a.INTERFACE_GETCACHECERTLOCATION=201326592;a.INTERFACE_HASCACHEDDATA=218103808;a.INTERFACE_CLEARCACHEDDATA=234881024;a.INTERFACE_GETMEDIALIST=251658240;a.INTERFACE_GETCERTTREE=268435456;a.INTERFACE_SETCERT=285212672;a.INTERFACE_GETCERT=301989888;a.INTERFACE_IMPORTCERT=318767104;a.INTERFACE_EXPORTCERT=335544320;a.INTERFACE_DELETECERT=352321536;a.INTERFACE_CHECKPWD=369098752;a.INTERFACE_VERIFYCERTPWD=385875968;a.INTERFACE_CHANGECERTPWD=402653184;a.INTERFACE_VERIFYCERT=419430400;a.INTERFACE_VERIFYCERTOWNER=436207616;a.INTERFACE_SIGNDATA=452984832;a.INTERFACE_SIGNDATAADD=469762048;a.INTERFACE_VERIFYDATA=486539264;a.INTERFACE_GETSIGNEDDATA=503316480;a.INTERFACE_ENVELOPIDNUM=520093696;a.INTERFACE_ENVELOPEDATAWITHCERT=536870912;a.INTERFACE_ENVELOPEDATAWITHPEM=553648128;a.INTERFACE_ENVELOPEDATAWITHPWD=570425344;a.INTERFACE_DEENVELOPEDATAWITHCERT=587202560;a.INTERFACE_DEENVELOPEDATAWITHPWD=603979776;a.INTERFACE_REQUESTCERT=620756992;a.INTERFACE_RENEWCERT=637534208;a.INTERFACE_REVOKECERT=654311424;a.INTERFACE_HASHDATA=671088640;a.INTERFACE_XFSINIT=687865856;a.INTERFACE_XFSLOGIN=704643072;a.INTERFACE_XFSOTPREQUEST=721420288;a.INTERFACE_XFSLOGOUT=738197504;a.INTERFACE_SETCROSSSTORAGE=754974720;a.INTERFACE_ANYPIN_INITIALIZE=771751936;a.INTERFACE_ANYPIN_GETPINIDLIST=788529152;a.INTERFACE_ANYPIN_UPDATEPINLASTTIME=805306368;a.INTERFACE_ANYPIN_CHECKPIN=822083584;a.INTERFACE_ANYPIN_INITPIN=838860800;a.INTERFACE_ANYPIN_INITREGIST=855638016;a.INTERFACE_ANYPIN_REGISTPIN=872415232;a.INTERFACE_ANYPIN_INITSESSION=889192448;a.INTERFACE_ANYPIN_SETNODUEDAY=905969664;a.INTERFACE_ANYPIN_AUTHSESSION=922746880;a.INTERFACE_ANYPIN_ENDSESSION=939524096;a.INTERFACE_ANYPIN_SIGNPIN=956301312;a.INTERFACE_ANYPIN_DELETEPIN=973078528;a.INTERFACE_ANYPIN_DELETEALLPIN=989855744;a.INTERFACE_ANYPIN_CHANGEPIN=1006632960;a.INTERFACE_GETDEVICEINFO=1023410176;a.INTERFACE_SETOPENSTORAGE=1040187392;a.INTERFACE_ANYPIN_READDEVICEINFOLIST=1056964608;a.INTERFACE_ANYPIN_READDEVICEINFO=1073741824;a.INTERFACE_ANYPIN_DELETEDEVICE=1090519040;a.INTERFACE_ANYPIN_DELETEALLDEVICE=1107296256;a.INTERFACE_ANYPIN_READAUDITINFOLIST=1124073472;a.INTERFACE_ANYPIN_READAUDITINFO=1140850688;a.INTERFACE_ANYCERTRELAY_EXPORT=1157627904;a.INTERFACE_ANYCERTRELAY_IMPORT=1174405120;a.INTERFACE_SIGNDATA_UCPID=1191182336;a.XCRYPTO_SOFO_UTILS=65536;a.XCRYPTO_SOFO_CRYPTO=131072;a.XCRYPTO_SOFO_PKI=196608;a.XCRYPTO_SOFO_STORAGE=262144;a.XCRYPTO_SOFO_CMP=327680;a.XCRYPTO_SOFO_XFS=393216;a.XCRYPTO_SOFO_ANYPIN=458752;a.XCRYPTO_SOFO_OPEN=524288;a.XCRYPTO_SOFO_ANYCERTRELAY=589824;a.XCRYPTO_FORGE_UTIL=1048576;a.XCRYPTO_FORGE_ASN=1114112;a.XCRYPTO_FORGE_PKI=1179648;a.XCRYPTO_FORGE_PKI_CERTIFICATEFROMASN1=a.XCRYPTO_FORGE_PKI+256;a.XCRYPTO_FORGE_PKI_CERTIFICATETOASN1=a.XCRYPTO_FORGE_PKI+512;a.XCRYPTO_FORGE_PKI_CERTIFICATEFROMPEM=a.XCRYPTO_FORGE_PKI+768;a.XCRYPTO_FORGE_PKI_CERTIFICATETOPEM=a.XCRYPTO_FORGE_PKI+1024;a.XCRYPTO_SOFO_PKI_CHECKKEYWORD=a.XCRYPTO_SOFO_PKI+256;a.XCRYPTO_SOFO_PKI_CHECKKEYWORD2=a.XCRYPTO_SOFO_PKI+512;a.XCRYPTO_SOFO_PKI_CHECKPRIVATEKEY=a.XCRYPTO_SOFO_PKI+768;a.XCRYPTO_SOFO_PKI_CHANGEENCRYPTPRIVATEKEY=a.XCRYPTO_SOFO_PKI+1024;a.XCRYPTO_SOFO_PKI_SIGNDATA=a.XCRYPTO_SOFO_PKI+1280;a.XCRYPTO_SOFO_PKI_SIGNDATAADDITION=a.XCRYPTO_SOFO_PKI+1536;a.XCRYPTO_SOFO_PKI_VERIFYSIGNEDDATA=a.XCRYPTO_SOFO_PKI+1792;a.XCRYPTO_SOFO_PKI_CONVERTSIGNEDDATA=a.XCRYPTO_SOFO_PKI+2048;a.XCRYPTO_SOFO_PKI_VERIFYCERTIFICATE=a.XCRYPTO_SOFO_PKI+2304;a.XCRYPTO_SOFO_PKI_ENVELOPEIDNUM=a.XCRYPTO_SOFO_PKI+2560;a.XCRYPTO_SOFO_PKI_ENVELOPEDATA=a.XCRYPTO_SOFO_PKI+2816;a.XCRYPTO_SOFO_PKI_DEENVELOPEDATA=a.XCRYPTO_SOFO_PKI+3072;a.XCRYPTO_SOFO_PKI_CERTIFICATEFROMDER=a.XCRYPTO_SOFO_PKI+3328;a.XCRYPTO_SOFO_PKI_CERTIFICATEFROMPFX=a.XCRYPTO_SOFO_PKI+3584;a.XCRYPTO_SOFO_PKI_CERTIFICATEFROMCMP=a.XCRYPTO_SOFO_PKI+3840;a.XCRYPTO_SOFO_PKI_CERTIFICATETOPKCS12=a.XCRYPTO_SOFO_PKI+4096;a.XCRYPTO_SOFO_PKI_IDENTIFYVID=a.XCRYPTO_SOFO_PKI+4352;a.XCRYPTO_SOFO_PKI_HASHDATA=a.XCRYPTO_SOFO_PKI+4608;a.XCRYPTO_SOFO_PKI_SIGNDATA_UCPID=a.XCRYPTO_SOFO_PKI+4864;a.XCRYPTO_SOFO_STORAGE_SETSECUREID=a.XCRYPTO_SOFO_STORAGE+256;a.XCRYPTO_SOFO_STORAGE_SETLOCALSTORAGE=a.XCRYPTO_SOFO_STORAGE+512;a.XCRYPTO_SOFO_STORAGE_GETLOCALSTORAGE=a.XCRYPTO_SOFO_STORAGE+768;a.XCRYPTO_SOFO_STORAGE_SETSESSIONSTORAGE=a.XCRYPTO_SOFO_STORAGE+1024;a.XCRYPTO_SOFO_STORAGE_GETSESSIONSTORAGE=a.XCRYPTO_SOFO_STORAGE+1280;a.XCRYPTO_SOFO_STORAGE_DELETESESSIONSTORAGE=a.XCRYPTO_SOFO_STORAGE+1536;a.XCRYPTO_SOFO_STORAGE_SETCACHEDCERT=a.XCRYPTO_SOFO_STORAGE+1792;a.XCRYPTO_SOFO_STORAGE_GETCACHEDCERT=a.XCRYPTO_SOFO_STORAGE+2048;a.XCRYPTO_SOFO_STORAGE_SAVECERTKEY=a.XCRYPTO_SOFO_STORAGE+2304;a.XCRYPTO_SOFO_STORAGE_CHANGECERTPRIKEY=a.XCRYPTO_SOFO_STORAGE+2560;a.XCRYPTO_SOFO_STORAGE_DELETECERT=a.XCRYPTO_SOFO_STORAGE+2816;a.XCRYPTO_SOFO_STORAGE_GETCERTKEYLIST=a.XCRYPTO_SOFO_STORAGE+3072;a.XCRYPTO_SOFO_STORAGE_SAVEMEMCERTKEY=a.XCRYPTO_SOFO_STORAGE+3328;a.XCRYPTO_SOFO_STORAGE_GETMEMCERTKEYLIST=a.XCRYPTO_SOFO_STORAGE+3584;a.XCRYPTO_SOFO_STORAGE_CLEARMEMCERTKEYLIST=a.XCRYPTO_SOFO_STORAGE+3840;a.XCRYPTO_SOFO_STORAGE_SAVEXFSCERTKEY=a.XCRYPTO_SOFO_STORAGE+4096;a.XCRYPTO_SOFO_STORAGE_DELETEXFSCERTKEY=a.XCRYPTO_SOFO_STORAGE+4352;a.XCRYPTO_SOFO_STORAGE_GETXFSCERTKEYLIST=a.XCRYPTO_SOFO_STORAGE+4608;a.XCRYPTO_SOFO_STORAGE_CLEARXFSCERTKEYLIST=a.XCRYPTO_SOFO_STORAGE+4864;a.XCRYPTO_SOFO_STORAGE_SETCROSSSTORAGE=a.XCRYPTO_SOFO_STORAGE+5120;a.XCRYPTO_SOFO_CMP_GETWEBCMPTYPE=a.XCRYPTO_SOFO_CMP+256;a.XCRYPTO_SOFO_CMP_GETWEBCMPPKEYID=a.XCRYPTO_SOFO_CMP+512;a.XCRYPTO_SOFO_CMP_GETCMPCLIENT=a.XCRYPTO_SOFO_CMP+768;a.XCRYPTO_SOFO_CMP_GETCMPCLIENT_ISSUE=a.XCRYPTO_SOFO_CMP+1024;a.XCRYPTO_SOFO_CMP_GETCMPCLIENT_UPDATE=a.XCRYPTO_SOFO_CMP+1280;a.XCRYPTO_SOFO_XFS_USERLOGIN=a.XCRYPTO_SOFO_XFS+256;a.XCRYPTO_SOFO_XFS_USERLOGOUT=a.XCRYPTO_SOFO_XFS+512;a.XCRYPTO_SOFO_XFS_USEREXTENSION=a.XCRYPTO_SOFO_XFS+768;a.XCRYPTO_SOFO_XFS_OTPREQUEST=a.XCRYPTO_SOFO_XFS+1024;a.XCRYPTO_SOFO_XFS_OTPVALID=a.XCRYPTO_SOFO_XFS+1280;a.XCRYPTO_SOFO_XFS_CERTLIST=a.XCRYPTO_SOFO_XFS+1536;a.XCRYPTO_SOFO_XFS_CERTDETAIL=a.XCRYPTO_SOFO_XFS+1792;a.XCRYPTO_SOFO_XFS_CERTSIGN=a.XCRYPTO_SOFO_XFS+2048;a.XCRYPTO_SOFO_XFS_CERTDIGESTSIGN=a.XCRYPTO_SOFO_XFS+2304;a.XCRYPTO_SOFO_XFS_CERTDELETE=a.XCRYPTO_SOFO_XFS+2560;a.XCRYPTO_SOFO_XFS_CERTPASSWORDCONFIRM=a.XCRYPTO_SOFO_XFS+2816;a.XCRYPTO_SOFO_XFS_CERTPASSWORDUPDATE=a.XCRYPTO_SOFO_XFS+3072;a.XCRYPTO_SOFO_XFS_CERTPFXEXPORT=a.XCRYPTO_SOFO_XFS+3328;a.XCRYPTO_SOFO_XFS_CERTPFXIMPORT=a.XCRYPTO_SOFO_XFS+3584;a.XCRYPTO_SOFO_ANYPIN_SERVERCERT=a.XCRYPTO_SOFO_ANYPIN+256;a.XCRYPTO_SOFO_ANYPIN_HELLOREG=a.XCRYPTO_SOFO_ANYPIN+512;a.XCRYPTO_SOFO_ANYPIN_USERREGIST=a.XCRYPTO_SOFO_ANYPIN+768;a.XCRYPTO_SOFO_ANYPIN_CERTREGIST=a.XCRYPTO_SOFO_ANYPIN+1024;a.XCRYPTO_SOFO_ANYPIN_HELLOAUTH=a.XCRYPTO_SOFO_ANYPIN+1280;a.XCRYPTO_SOFO_ANYPIN_USERAUTH=a.XCRYPTO_SOFO_ANYPIN+1536;a.XCRYPTO_SOFO_ANYPIN_USERAUTHSIGN=a.XCRYPTO_SOFO_ANYPIN+1792;a.XCRYPTO_SOFO_ANYPIN_USERENDSESSION=a.XCRYPTO_SOFO_ANYPIN+2048;a.XCRYPTO_SOFO_ANYPIN_CERTUPDATE=a.XCRYPTO_SOFO_ANYPIN+2304;a.XCRYPTO_SOFO_ANYPIN_USERDELETE=a.XCRYPTO_SOFO_ANYPIN+2560;a.XCRYPTO_SOFO_ANYPIN_USERUPDATE=a.XCRYPTO_SOFO_ANYPIN+2816;a.XCRYPTO_SOFO_ANYPIN_USERLEAVE=a.XCRYPTO_SOFO_ANYPIN+3072;a.XCRYPTO_SOFO_ANYPIN_DEVICELIST=a.XCRYPTO_SOFO_ANYPIN+3328;a.XCRYPTO_SOFO_ANYPIN_AUDITLIST=a.XCRYPTO_SOFO_ANYPIN+3584;a.XCRYPTO_SOFO_ANYPIN_GETPINIDLIST=a.XCRYPTO_SOFO_ANYPIN+3840;a.XCRYPTO_SOFO_ANYPIN_UPDATEPINLASTTIME=a.XCRYPTO_SOFO_ANYPIN+4096;a.XCRYPTO_SOFO_ANYPIN_CHECKPIN=a.XCRYPTO_SOFO_ANYPIN+4352;a.XCRYPTO_SOFO_ANYPIN_INITPIN=a.XCRYPTO_SOFO_ANYPIN+4608;a.XCRYPTO_SOFO_ANYPIN_INITREGIST=a.XCRYPTO_SOFO_ANYPIN+4864;a.XCRYPTO_SOFO_ANYPIN_REGISTPIN=a.XCRYPTO_SOFO_ANYPIN+5120;a.XCRYPTO_SOFO_ANYPIN_INITSESSION=a.XCRYPTO_SOFO_ANYPIN+5376;a.XCRYPTO_SOFO_ANYPIN_SETNODUEDAY=a.XCRYPTO_SOFO_ANYPIN+5632;a.XCRYPTO_SOFO_ANYPIN_AUTHSESSION=a.XCRYPTO_SOFO_ANYPIN+5888;a.XCRYPTO_SOFO_ANYPIN_ENDSESSION=a.XCRYPTO_SOFO_ANYPIN+6144;a.XCRYPTO_SOFO_ANYPIN_SIGNPIN=a.XCRYPTO_SOFO_ANYPIN+6400;a.XCRYPTO_SOFO_ANYPIN_DELETEPIN=a.XCRYPTO_SOFO_ANYPIN+6656;a.XCRYPTO_SOFO_ANYPIN_DELETEALLPIN=a.XCRYPTO_SOFO_ANYPIN+6912;a.XCRYPTO_SOFO_ANYPIN_CHANGEPIN=a.XCRYPTO_SOFO_ANYPIN+7168;a.XCRYPTO_SOFO_ANYPIN_READDEVICEINFOLIST=a.XCRYPTO_SOFO_ANYPIN+7424;a.XCRYPTO_SOFO_ANYPIN_READDEVICEINFO=a.XCRYPTO_SOFO_ANYPIN+7680;a.XCRYPTO_SOFO_ANYPIN_DELETEDEVICE=a.XCRYPTO_SOFO_ANYPIN+7936;a.XCRYPTO_SOFO_ANYPIN_DELETEALLDEVICE=a.XCRYPTO_SOFO_ANYPIN+8192;a.XCRYPTO_SOFO_ANYPIN_READAUDITINFOLIST=a.XCRYPTO_SOFO_ANYPIN+8448;a.XCRYPTO_SOFO_ANYPIN_READAUDITINFO=a.XCRYPTO_SOFO_ANYPIN+8704;a.XCRYPTO_SOFO_OPEN_INIT=a.XCRYPTO_SOFO_OPEN+256;a.XCRYPTO_SOFO_OPEN_SETCERTOPENSTORAGE=a.XCRYPTO_SOFO_OPEN+512;a.XCRYPTO_SOFO_OPEN_GETCERTOPENSTORAGE=a.XCRYPTO_SOFO_OPEN+768;a.XCRYPTO_SOFO_OPEN_REMOVECERT=a.XCRYPTO_SOFO_OPEN+1024;a.XCRYPTO_SOFO_OPEN_MERGECERT=a.XCRYPTO_SOFO_OPEN+1280;a.XCRYPTO_SOFO_OPEN_SETSECUREINPUT=a.XCRYPTO_SOFO_OPEN+1536;a.XCRYPTO_SOFO_OPEN_SETSECUREINPUT=a.XCRYPTO_SOFO_OPEN+1536;a.ERROR_0=0;d[a.ERROR_0]={msg_koKR:"",msg_enUS:""};a.ERROR_API_FAIL=1;d[a.ERROR_API_FAIL]={msg_koKR:"api fail",msg_enUS:"api fail"};a.ERROR_INCORRECT_PARAM=2;d[a.ERROR_INCORRECT_PARAM]={msg_koKR:"입력값이 올바르지 않습니다.",msg_enUS:"Incorrect Input parameters."};a.ERROR_NOT_SUPPORTED_MEDIA=3;d[a.ERROR_NOT_SUPPORTED_MEDIA]={msg_koKR:"지원하지 않는 저장매체입니다.",msg_enUS:"Unsupported media."};a.ERROR_DIFFRENT_PASSWORD=4;d[a.ERROR_DIFFRENT_PASSWORD]={msg_koKR:"입력하신 비밀번호가 일치하지 않습니다.",msg_enUS:"The passwords entered do not match."};a.ERROR_INCORRECT_PASSWORD=5;d[a.ERROR_INCORRECT_PASSWORD]={msg_koKR:"인증서 암호가 올바르지 않습니다. 인증서 암호는 대문자 소문자를 구분합니다. <Caps Lock>키가 켜져 있는지 확인하시고 다시 입력하십시오.",msg_enUS:"The password is incorrect. Letters in passwords must be typed using the correct case. Make sure that <Caps Lock> is not on and retype your password."};a.ERROR_INCORRECT_PASSWORD_KMCERT=6;d[a.ERROR_INCORRECT_PASSWORD_KMCERT]={msg_koKR:"암호화용 인증서 비밀번호가 올바르지 않습니다.",msg_enUS:"Encryption certificate password is incorrect."};a.ERROR_INPUT_LENGTH=7;d[a.ERROR_INPUT_LENGTH]={msg_koKR:"비밀번호는 최소 8자 이상 최대 16자 이하입니다.",msg_enUS:"Password is 16 characters or less more than 8 characters."};a.ERROR_INPUT_LENGTH_10=8;d[a.ERROR_INPUT_LENGTH_10]={msg_koKR:"비밀번호는 최소 10자 이상 최대 56자 이하입니다.",msg_enUS:"The password length should be from 10 to 56-characters."};a.ERROR_PASSWORD_IS_WRONG=9;d[a.ERROR_PASSWORD_IS_WRONG]={msg_koKR:"비밀번호는 문자와 숫자를 조합해야 합니다.",msg_enUS:"The password needs to be at least 8 characters long and it must be alphanumeric."};a.ERROR_PASSWORD_MIX_DISIT_ALPHA_PUNCT=10;d[a.ERROR_PASSWORD_MIX_DISIT_ALPHA_PUNCT]={msg_koKR:"비밀번호는 문자/숫자/특수기호를 조합해야 합니다.",msg_enUS:"The password is must be combined to characters/numbers/special characters."};a.ERROR_PASSWORD_NOT_ALLOW_CHARACTER=11;d[a.ERROR_PASSWORD_NOT_ALLOW_CHARACTER]={msg_koKR:"비밀번호에는 특수문자 ' \" \\ |를 사용할 수 없습니다.",msg_enUS:"The following special characters are not available. (' \" \\ |)"};a.ERROR_CONFIRMED_PASSWORD_DOES_NOT_MATCH=12;d[a.ERROR_CONFIRMED_PASSWORD_DOES_NOT_MATCH]={msg_koKR:"새 비밀번호가 일치하지 않습니다.",msg_enUS:"The passwords do not match."};a.ERROR_GETCERTIFICATE=13;d[a.ERROR_GETCERTIFICATE]={msg_koKR:"인증서 찾기에 실패했습니다.",msg_enUS:"Failed to find certificate."};a.ERROR_GETCERT=14;d[a.ERROR_GETCERT]={msg_koKR:"인증서 찾기에 실패했습니다.",msg_enUS:"Failed to find certificate."};a.ERROR_USE_CERT_FAIL=15;d[a.ERROR_USE_CERT_FAIL]={msg_koKR:"사용할 수 없는 인증서 입니다.",msg_enUS:"Not use certificate."};a.ERROR_GETCERTTREE=16;d[a.ERROR_GETCERTTREE]={msg_koKR:"인증서 트리 찾기에 실패했습니다.",msg_enUS:"Failed to certificate tree search."};a.ERROR_SAVECERT=17;d[a.ERROR_SAVECERT]={msg_koKR:"인증서 복사 요구에 실패했습니다.",msg_enUS:"Failed to copy certificate."};a.ERROR_IMPORTCERT_FAIL=18;d[a.ERROR_IMPORTCERT_FAIL]={msg_koKR:"인증서 가져오기 요구에 실패했습니다.",msg_enUS:"Fail to import certificate."};a.ERROR_EXPORTCERT=19;d[a.ERROR_EXPORTCERT]={msg_koKR:"인증서 내보내기 요구에 실패했습니다.",msg_enUS:"Fail to export certificate."};a.ERROR_DELETECERT=20;d[a.ERROR_DELETECERT]={msg_koKR:"인증서 삭제 요구에 실패했습니다.",msg_enUS:"Fail to delete cert."};a.ERROR_VERIFYPASSWORD=21;d[a.ERROR_VERIFYPASSWORD]={msg_koKR:"인증서 비밀번호 검증 요구에 실패했습니다.",msg_enUS:"Failed password verification certificate required."};a.ERROR_CHANGECERTPASSWORD=22;d[a.ERROR_CHANGECERTPASSWORD]={msg_koKR:"인증서 비밀번호 변경 요구에 실패했습니다.",msg_enUS:"Fail to change password of certificate."};a.ERROR_VERIFYCERT=23;d[a.ERROR_VERIFYCERT]={msg_koKR:"인증서 검증 요구에 실패했습니다.",msg_enUS:"Failed to verify the certificate request."};a.ERROR_VERIFYCERTOWNER=24;d[a.ERROR_VERIFYCERTOWNER]={msg_koKR:"인증서 소유자 검증 요구에 실패했습니다.",msg_enUS:"Failed to verify the certificate owner."};a.ERROR_CREATE_SIGNDATA=25;d[a.ERROR_CREATE_SIGNDATA]={msg_koKR:"전자서명 데이터 생성 요청에 실패했습니다.",msg_enUS:"Failed to generate requests for signature data."};a.ERROR_GETPLAINDATAOFSIGNDATA=26;d[a.ERROR_GETPLAINDATAOFSIGNDATA]={msg_koKR:"전자서명 데이터를 평문으로 변환하는 요청에 실패했습니다.",msg_enUS:"Request to convert digital signature data to plain text failed."};a.ERROR_ENVELOPIDNUM=27;d[a.ERROR_ENVELOPIDNUM]={msg_koKR:"주민등록(사업자등록)번호 정보를 암호화 할 수 없습니다.",msg_enUS:"Cannot encrypt the information for identification."};a.ERROR_ENVELOP_FAIL=28;d[a.ERROR_ENVELOP_FAIL]={msg_koKR:"암호화에 실패하였습니다.",msg_enUS:"Envelop Failed."};a.ERROR_DEENVELOP_FAIL=29;d[a.ERROR_DEENVELOP_FAIL]={msg_koKR:"암호화된 데이터 복호화에 실패하였습니다.",msg_enUS:"Deenvelop Failed."};a.ERROR_REQUESTCERT=30;d[a.ERROR_REQUESTCERT]={msg_koKR:"인증서 발급 요구에 실패했습니다.",msg_enUS:"Fail to generate cert request."};a.ERROR_RENEWCERT=31;d[a.ERROR_RENEWCERT]={msg_koKR:"인증서 갱신 요구에 실패했습니다.",msg_enUS:"Fail to generate cert renew."};a.ERROR_RECOVERCERT=32;d[a.ERROR_RECOVERCERT]={msg_koKR:"인증서 복구 요구에 실패했습니다.",msg_enUS:"Fail to generate cert restore."};a.ERROR_REVOKECERT=33;d[a.ERROR_REVOKECERT]={msg_koKR:"인증서 폐기 요구에 실패했습니다.",msg_enUS:"Fail to revoke cert."};a.ERROR_HASHDATA=34;d[a.ERROR_HASHDATA]={msg_koKR:"해쉬데이터 생성 요청에 실패했습니다.",msg_enUS:"Request to generate hash data failed."};a.ERROR_ENCRYPT_PRIKEY=35;d[a.ERROR_ENCRYPT_PRIKEY]={msg_koKR:"개인키 암호화에 실패하였습니다.",msg_enUS:"Fail to encrypt the private key."};a.ERROR_DECRYPT_PRIKEY=36;d[a.ERROR_DECRYPT_PRIKEY]={msg_koKR:"개인키 복호화에 실패하였습니다.",msg_enUS:"Fail to decrypt the private key."};a.ERROR_PKCS8_NO_VID=37;d[a.ERROR_PKCS8_NO_VID]={msg_koKR:"인증서에서 주민등록(사업자등록)번호 정보를 가져올 수 없습니다.",msg_enUS:"Cannot retrieve the information for identification from certificate."};a.ERROR_PKCS8_NO_RANDOM=38;d[a.ERROR_PKCS8_NO_RANDOM]={msg_koKR:"랜덤값을 구할 수 없습니다.",msg_enUS:"Fail to generate the random number."};a.ERROR_SIGN_DUPLICATE_CERT=39;d[a.ERROR_SIGN_DUPLICATE_CERT]={msg_koKR:"동일한 인증서로 이미 서명되어 있습니다. 다른 인증서를 선택해 주십시오.",msg_enUS:"The selected certificate is already used for signature. Please, select different certificate."};a.ERROR_SAVE_CERT_ALREADY_EXIST=40;d[a.ERROR_SAVE_CERT_ALREADY_EXIST]={msg_koKR:"이미 동일한 인증서 존재합니다.",msg_enUS:"The same certificate already exists."};a.ERROR_CERT_EXPIRED=41;d[a.ERROR_CERT_EXPIRED]={msg_koKR:"Cert is expired.",msg_enUS:"Cert is expired."};a.ERROR_SETLICENSE_FAIL=42;d[a.ERROR_SETLICENSE_FAIL]={msg_koKR:"라이센스 검증에 실패했습니다.",msg_enUS:"License validation failed."};a.ERROR_SETCROSSSTORAGE_FAIL=43;d[a.ERROR_SETCROSSSTORAGE_FAIL]={msg_koKR:"브라우저 인증서 도메인 공유기능 설정에 실패했습니다.",msg_enUS:"Browser Certificate CrossDomain share function set failed."};a.ERROR_LOCALSTORAGE_FAIL=44;d[a.ERROR_LOCALSTORAGE_FAIL]={msg_koKR:"로컬스토리지 기능에 예외가 발생하였습니다.",msg_enUS:"localstorage function has occurred exception."};a.ERROR_INDEXEDDB_FAIL=45;d[a.ERROR_INDEXEDDB_FAIL]={msg_koKR:"IndexedDB 기능에 예외가 발생하였습니다.",msg_enUS:"IndexedDB function has occurred exception."};a.ERROR_INDEXEDDB_GET_FAIL=46;d[a.ERROR_INDEXEDDB_GET_FAIL]={msg_koKR:"IndexedDB 에서 데이터 읽기가 실패하거나 예외가 발생하였습니다.",msg_enUS:"IndexedDB get data function has failed or occurred exception."};a.ERROR_INDEXEDDB_SET_FAIL=47;d[a.ERROR_INDEXEDDB_SET_FAIL]={msg_koKR:"IndexedDB 에서 데이터 저장이 실패하거나 예외가 발생하였습니다.",msg_enUS:"IndexedDB put data function has failed or occurred exception."};a.ERROR_INDEXEDDB_DELETE_FAIL=48;d[a.ERROR_INDEXEDDB_DELETE_FAIL]={msg_koKR:"IndexedDB 에서 데이터 삭제가 실패하거나 예외가 발생하였습니다.",msg_enUS:"IndexedDB delete data function has failed or occurred exception."};a.ERROR_WEBCRYPTO_EXPORTKEY_EXCEPTION=49;d[a.ERROR_WEBCRYPTO_EXPORTKEY_EXCEPTION]={msg_koKR:"WebCrypto exportKey API 에서 예외가 발생하였습니다.",msg_enUS:"WebCrypto exportKey API method has occurred exception."};a.ERROR_WEBCRYPTO_GENERATEKEY_EXCEPTION=50;d[a.ERROR_WEBCRYPTO_GENERATEKEY_EXCEPTION]={msg_koKR:"WebCrypto generateKey API 에서 예외가 발생하였습니다.",msg_enUS:"WebCrypto generateKey API method has occurred exception."};a.ERROR_WEBCRYPTO_ENCRYPT_EXCEPTION=51;d[a.ERROR_WEBCRYPTO_ENCRYPT_EXCEPTION]={msg_koKR:"WebCrypto encrypt API 에서 예외가 발생하였습니다.",msg_enUS:"WebCrypto encrypt API method has occurred exception."};a.ERROR_WEBCRYPTO_DECRYPT_EXCEPTION=52;d[a.ERROR_WEBCRYPTO_DECRYPT_EXCEPTION]={msg_koKR:"WebCrypto decrypt API 에서 예외가 발생하였습니다.",msg_enUS:"WebCrypto decrypt API method has occurred exception."};a.ERROR_OPENCERT_INITIALIZE_FAIL=53;d[a.ERROR_OPENCERT_INITIALIZE_FAIL]={msg_koKR:"브라우저 공동저장소 초기화를 실패하거나 예외가 발생하였습니다.",msg_enUS:"Browser common storage initailization has failed or occurred exception."};a.ERROR_OPENCERT_SETPKCS12_FAIL=54;d[a.ERROR_OPENCERT_SETPKCS12_FAIL]={msg_koKR:"브라우저 공동저장소에 인증서 저장이 실패하거나 예외가 발생하였습니다.",msg_enUS:"Storing the certificate in the browser common storage failed or an exception occurred."};a.ERROR_OPENCERT_GETPKCS12_FAIL=55;d[a.ERROR_OPENCERT_GETPKCS12_FAIL]={msg_koKR:"브라우저 공동저장소에서 인증서를 가져오는것이 실패하거나 예외가 발생하였습니다.",msg_enUS:"Exporting a certificate from the browser common storage failed or an exception occurred."};a.ERROR_OPENCERT_REMOVEPKCS12_FAIL=56;d[a.ERROR_OPENCERT_REMOVEPKCS12_FAIL]={msg_koKR:"브라우저 공동저장소에 인증서 삭제가 실패하거나 예외가 발생하였습니다.",msg_enUS:"Removing a certificate from the browser common storage failed or an exception occurred."};a.ERROR_OPENCERT_MERGECERTINFOS_FAIL=57;d[a.ERROR_OPENCERT_MERGECERTINFOS_FAIL]={msg_koKR:"브라우저 공동저장소와 브라우저 일반저장소의 인증서정보 동기화가 실패하거나 예외가 발생하였습니다.",msg_enUS:"Synchronization of certificate information in browser common storage and browser general local storage failed or an exception occurred."};a.ERROR_OPENCERT_CERTVIEW_NOT_SUPPORT_FAIL=58;d[a.ERROR_OPENCERT_CERTVIEW_NOT_SUPPORT_FAIL]={msg_koKR:"인증서 상세보기가 지원되지 않는 인증서입니다.",msg_enUS:"Certificate details view is not supported."};a.ERROR_OPENCERT_OPENCERTJS_LOAD_FAIL=59;d[a.ERROR_OPENCERT_OPENCERTJS_LOAD_FAIL]={msg_koKR:"금융결제원의 브라우저 공동저장소 기능 실행에 실패하였습니다.",msg_enUS:"KFTC's browser common storage function failed."};a.ERROR_SERVER_CONNECT_FAIL=60;d[a.ERROR_SERVER_CONNECT_FAIL]={msg_koKR:"서버 연결에 실패하였습니다.",msg_enUS:"Failed to connect server."};a.ERROR_HASH_CONFIRM=61;d[a.ERROR_HASH_CONFIRM]={msg_koKR:"무결성 검증에 실패 했습니다. 다시 확인해 주십시요.",msg_enUS:"An error occurred. Hash not confirm. Please reconfirm."};a.ERROR_ACR_GEN_PKCS12_PW=62;d[a.ERROR_ACR_GEN_PKCS12_PW]={msg_koKR:"PKCS12 패스워드 생성에 실패하였습니다.",msg_enUS:"Failed to generate pkcs12 password."};a.ERROR_ACR_CERTIFICATEFROMPFX=63;d[a.ERROR_ACR_CERTIFICATEFROMPFX]={msg_koKR:"PFX에서 인증서 가져오기에  실패하였습니다.",msg_enUS:"Failed to get certificate from PFX."};a.ERROR_ACR_REG_AUTHCODE=64;d[a.ERROR_ACR_REG_AUTHCODE]={msg_koKR:"인증코드 등록에  실패하였습니다.",msg_enUS:"Failed to regist authcode."};a.ERROR_ACR_EXPORT_CERT=65;d[a.ERROR_ACR_EXPORT_CERT]={msg_koKR:"인증서 내보내기에  실패하였습니다.",msg_enUS:"Failed to export certificate."};a.ERROR_ACR_IMPORT_CERT=66;d[a.ERROR_ACR_IMPORT_CERT]={msg_koKR:"인증서 가져오기에  실패하였습니다.",msg_enUS:"Failed to import certificate."};a.ERROR_NOT_SUPPORTED_BROWSERCERT=67;d[a.ERROR_NOT_SUPPORTED_BROWSERCERT]={msg_koKR:"브라우저 인증서는 해당 기능을 지원하지 않습니다.",msg_enUS:"Browser Cert is not supported."};a.ERROR_CREATE_UCPID_SIGNDATA=68;d[a.ERROR_CREATE_UCPID_SIGNDATA]={msg_koKR:"UCPID 전자서명 데이터 생성 요청에 실패했습니다.",msg_enUS:"Failed to generate requests for UCPID signature data."};a.setError=function(m,n,l,e){if(typeof m==="number"){c.code=m;if(e){c.msg_koKR=n;c.msg_enUS=l;c.internal=e;}else{if(l){c.msg_koKR=n;c.msg_enUS=l;c.internal="";}else{var h=m;var g=0;if(h>16777215){var f=Math.floor(h/65536);g=f-Math.floor(f/256)*256;}else{if(h>65535){g=Math.floor(h/65536);}}if(h>255){h=h-Math.floor(h/256)*256;}if(g==6&&b){var o=b.getError(h);if(o){c.msg_koKR=o.msg_koKR;c.msg_enUS=o.msg_enUS;if(n){c.internal=n;}}else{if(n){c.msg_koKR=n;c.msg_enUS=n;c.internal=n;}else{c.msg_koKR="";c.msg_enUS="";c.internal="";}}}else{if(d[h]){c.msg_koKR=d[h].msg_koKR?d[h].msg_koKR:"";c.msg_enUS=d[h].msg_enUS?d[h].msg_enUS:"";if(n){c.internal=n;}}else{if(n){c.msg_koKR=n;c.msg_enUS=n;c.internal=n;}else{c.msg_koKR="";c.msg_enUS="";c.internal="";}}}}}}else{c.code=0;c.msg_koKR=m;c.msg_enUS=m;c.internal=m;}};a.addError=function(e){if(typeof e!=="number"||e<0){return;}if(c.code>0||!c.msg_koKR&&!c.msg_enUS&&!c.internal){c.code+=e;}else{setError(e);}};a.resetError=function(){c.code=0;c.msg_koKR="";c.msg_enUS="";c.internal="";};a.getError=function(){return c;};})();(function(){var C=sofo.storage;var y=sofo.xfs=sofo.xfs||{};var z=y.error=y.error||{};var v="";var t="";var l=2;var E=true;var F=1000;var o=null;var c=0;var e=16;var a=null;y.init=function(H,G,J,I){v=H;t=G;l=J;if(I){o=I;}};y._setSecureInput=function(G){a=G;};function p(G){if(G==undefined||G==null||G==""){return "";}if(a==-1){return f(G);}var I=G.split("$");if(I.length<2){return f(I[0]);}if(I[0]==c){return f(I[1]);}if(I[0]==e){var H=I[1].split("|");return f(H[2])+"&keypadType=XECUREKEYPAD&keypadSessionId="+f(H[0])+"&keypadSessionToken="+f(H[1]);}return f(I[0]);}function B(J,I){if(!J){return null;}if(!a){return J;}var N=-1;var K="";if(typeof J==="string"){var H=J.indexOf("$");if(H==-1){return null;}N=parseInt(J.substring(0,H));if(J.length>H+1){K=J.substring(H+1);}}else{return null;}var P=a.split("$");var G=0;var O="";var M=false;for(var L=0;L<P.length;L++){var H=P[L].indexOf("|");if(H==-1){G=parseInt(P[L]);}else{G=parseInt(P[L].substring(0,H));if(P[L].length>H+1){O=P[L].substring(H+1);}}if(G==N){M=true;break;}}if(!M){return null;}if(N==c){return f(K);}else{if(N==e){var Q=K.split("|");if(I){return f(Q[2])+"&keypadType=XECUREKEYPAD&keypadSessionId"+I+"="+f(Q[0])+"&keypadSessionToken"+I+"="+f(Q[1]);}else{return f(Q[2])+"&keypadType=XECUREKEYPAD&keypadSessionId="+f(Q[0])+"&keypadSessionToken="+f(Q[1]);}}else{return null;}}}function f(G){return encodeURIComponent(G);}function g(G,H){return C.setSessionStorage("xfs_token",G,0,H);}function h(){var G=function(H){if(H){return "&xfsAccessToken="+H;}else{return "";}};return C.getSessionStorage("xfs_token",0,G);}function w(G){switch(G){case 0:return false;case 1:return true;case 2:return E;default:}return false;}function m(N,P,O,M){var L=O;var H,I;var K;if(window.XMLHttpRequest){K=new window.XMLHttpRequest;}else{if(M){M("");return-1;}else{return "";}}try{K.open("POST",N,O);}catch(J){if(!O&&M){L=true;K.open("POST",N,L);}else{return null;}}if(K.withCredentials!=undefined){K.withCredentials=true;}if(L){var G=null;if(o&&O){G=o({type:"",args:"",onconfirm:"",oncancel:function(){G.dispose();}});G.show();}K.onreadystatechange=function(Q){if(K.readyState==4){I=(new Date).getTime();if(I-H<F){E=false;}else{E=true;}if(G){G.dispose();G=null;}if(K.status==200){M(K.responseText);}else{M(K.responseText);}}};}K.setRequestHeader("Content-type","application/x-www-form-urlencoded");H=(new Date).getTime();K.send(P);if(L){return 0;}else{if(M){M(K.responseText);return 0;}else{return K.responseText;}}}function A(M,H,K,I){if(!v||!t){z.setError(z.ERROR_INVALID_PARAM);if(I){I(-1);}return-1;}var L=v+(v.charAt(v.length-1)=="/"?"":"/")+M;function J(O){if(!O){z.setError(z.ERROR_SERVER_CONNECT_FAIL);return-1;}var P=JSON.parse(O);if(P.code!=200){z.setError(Number(P.detailCode),P.code,P.message,P.detailCode,P.detailMessage);}return P;}if(I){var G=function(O){I(J(O));};return m(L,H,K,G);}else{var N=m(L,H,false);return J(N);}}var d={key:0,msg_koKR:"",msg_enUS:"",code:0,message:"Success",detailCode:0,detailMessage:""};var u=[];var z={};z.ERROR_0=0;u[z.ERROR_0]={code:0,msg_koKR:"",msg_enUS:""};z.ERROR_UNKNOWN=255;u[z.ERROR_UNKNOWN]={code:255,msg_koKR:"오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error has occurred. Please contact your administrator."};z.ERROR_API_FAIL=1;u[z.ERROR_API_FAIL]={code:1,msg_koKR:"api fail",msg_enUS:"api fail"};z.ERROR_INVALID_PARAM=2;u[z.ERROR_INVALID_PARAM]={code:2,msg_koKR:"입력값이 올바르지 않습니다.",msg_enUS:"Incorrect Input parameters."};z.ERROR_SERVER_CONNECT_FAIL=400;u[z.ERROR_SERVER_CONNECT_FAIL]={code:3,msg_koKR:"서버 접속에 실패하였습니다. 잠시 후 다시 시도해 주세요.",msg_enUS:"Server connection failed. Please try again in a few minutes."};z.ERROR_NOT_LOGIN=1879376156;u[z.ERROR_NOT_LOGIN]={code:4,msg_koKR:"서버와의 연결이 끊어졌습니다. 다시 로그인 하시기 바랍니다.",msg_enUS:"The connection to the server has been lost. Please login again."};z.ERROR_USER_LOGIN_NOT_FOUND_USERID=1677787420;u[z.ERROR_USER_LOGIN_NOT_FOUND_USERID]={code:5,msg_koKR:"입력한 아이디가 존재하지 않습니다. 아이디를 다시 한번 입력해 주세요.",msg_enUS:"The ID you entered does not exist. Please enter your ID again."};z.ERROR_OPT_RESULST_NOT_FOUND_USERID=1761804572;u[z.ERROR_OPT_RESULST_NOT_FOUND_USERID]={code:5,msg_koKR:"입력한 아이디가 존재하지 않습니다. 아이디를 다시 한번 입력해 주세요.",msg_enUS:"The ID you entered does not exist. Please enter your ID again."};z.ERROR_USER_LOGIN_INVALID_USERID=1677856784;u[z.ERROR_USER_LOGIN_INVALID_USERID]={code:6,msg_koKR:"입력한 아이디가 유효하지 않습니다. 아이디를 다시 한번 입력해 주세요.",msg_enUS:"The ID you entered is not valid. Please enter your ID again."};z.ERROR_OPT_RESULST_INVALID_USERID=1761742864;u[z.ERROR_OPT_RESULST_INVALID_USERID]={code:6,msg_koKR:"입력한 아이디가 유효하지 않습니다. 아이디를 다시 한번 입력해 주세요.",msg_enUS:"The ID you entered is not valid. Please enter your ID again."};z.ERROR_USER_LOGIN_INVALID_PASSWD=1677856783;u[z.ERROR_USER_LOGIN_INVALID_PASSWD]={code:7,msg_koKR:"입력한 비밀번호가 일치하지 않습니다. 비밀번호를 다시 한번 입력해 주세요.",msg_enUS:"The password you entered does not match. Please enter your password again."};z.ERROR_USER_LOGIN_INVALID_PASSWD1=1678311724;u[z.ERROR_USER_LOGIN_INVALID_PASSWD1]={code:7,msg_koKR:"입력한 비밀번호가 일치하지 않습니다. 비밀번호를 다시 한번 입력해 주세요.",msg_enUS:"The password you entered does not match. Please enter your password again."};z.ERROR_USER_LOGIN_INVALID_PASSWD2=1678508328;u[z.ERROR_USER_LOGIN_INVALID_PASSWD2]={code:8,msg_koKR:"2차 인증 비밀번호가 일치하지 않습니다.\n2차 인증 비밀번호를 다시 입력하거나 인증번호 재요청 후 2차 인증 비밀번호를 다시 한번 입력해 주세요.",msg_enUS:"Secondary authentication code do not match.\nPlease re-enter your secondary verification code or request your secondary verification again and enter your secondary verification code."};z.ERROR_USER_LOGIN_EXPIRED_PASSWD2=1678508316;u[z.ERROR_USER_LOGIN_EXPIRED_PASSWD2]={code:9,msg_koKR:"2차 인증번호를 요청하지 않았거나 인증 비밀번호가 만료되었습니다.\n인증번호 재요청 후 2차 인증 비밀번호를 다시 한번 입력해 주세요.",msg_enUS:"You did not request a secondary verification number or your authentication password has expired.\nAfter re-requesting the authentication number, please enter the second authentication password again."};z.ERROR_CERT_PASSWORD_CONFIRM_INVALID_PASSWD=1694633999;u[z.ERROR_CERT_PASSWORD_CONFIRM_INVALID_PASSWD]={code:10,msg_koKR:"입력한 비밀번호가 일치하지 않습니다.",msg_enUS:"The password you entered does not match."};z.ERROR_CERT_PASSWORD_CONFIRM_INVALID_PASSWD1=822608172;u[z.ERROR_CERT_PASSWORD_CONFIRM_INVALID_PASSWD1]={code:10,msg_koKR:"입력한 비밀번호가 일치하지 않습니다.",msg_enUS:"The password you entered does not match."};z.ERROR_CERT_SIGN_INVALID_PASSWD=1627717915;u[z.ERROR_CERT_SIGN_INVALID_PASSWD]={code:10,msg_koKR:"입력한 비밀번호가 일치하지 않습니다.",msg_enUS:"The password you entered does not match."};z.ERROR_CERT_PFX_EXPORT_INVALID_PASSWD=1695220012;u[z.ERROR_CERT_PFX_EXPORT_INVALID_PASSWD]={code:10,msg_koKR:"입력한 비밀번호가 일치하지 않습니다.",msg_enUS:"The password you entered does not match."};z.ERROR_CERT_PFX_IMPORT_INVALID_PASSWD=1694765071;u[z.ERROR_CERT_PFX_IMPORT_INVALID_PASSWD]={code:10,msg_koKR:"입력한 비밀번호가 일치하지 않습니다.",msg_enUS:"The password you entered does not match."};z.ERROR_CERT_PASSWORD_UPDATE_FAIL=1694634008;u[z.ERROR_CERT_PASSWORD_UPDATE_FAIL]={code:11,msg_koKR:"입력한 비밀번호가 올바르지 않습니다.",msg_enUS:"The password you entered is incorrect."};z.ERROR_CERT_PASSWORD_UPDATE_FAIL1=1694634009;u[z.ERROR_CERT_PASSWORD_UPDATE_FAIL1]={code:11,msg_koKR:"입력한 비밀번호가 올바르지 않습니다.",msg_enUS:"The password you entered is incorrect."};z.ERROR_CERT_PASSWORD_UPDATE_FAIL2=1694630176;u[z.ERROR_CERT_PASSWORD_UPDATE_FAIL2]={code:11,msg_koKR:"입력한 비밀번호가 올바르지 않습니다.",msg_enUS:"The password you entered is incorrect."};z.ERROR_NOT_FOUND_CERTIFICATE_1=1694634003;u[z.ERROR_NOT_FOUND_CERTIFICATE_1]={code:12,msg_koKR:"인증서 찾기에 실패했습니다.",msg_enUS:"Failed to find certificate."};z.ERROR_NOT_FOUND_CERTIFICATE_2=1694564636;u[z.ERROR_NOT_FOUND_CERTIFICATE_2]={code:12,msg_koKR:"인증서 찾기에 실패했습니다.",msg_enUS:"Failed to find certificate."};z.ERROR_CERT_PFX_IMPORT_CERT_ALREADY_EXIST=1694564623;u[z.ERROR_CERT_PFX_IMPORT_CERT_ALREADY_EXIST]={code:13,msg_koKR:"등록된 인증서 정보가 존재합니다.",msg_enUS:"Registered certificate information exists."};z.ERROR_CERT_PFX_IMPORT_CERT_EXPIRED=1695023393;u[z.ERROR_CERT_PFX_IMPORT_CERT_EXPIRED]={code:14,msg_koKR:"유효기간이 만료된 인증서 입니다.",msg_enUS:"The certificate has expired."};z.ERROR_CERT_PFX_IMPORT_CERT_VERIFY_ERROR=1695285531;u[z.ERROR_CERT_PFX_IMPORT_CERT_VERIFY_ERROR]={code:15,msg_koKR:"인증서 검증에 실패하였습니다.",msg_enUS:"Certificate validation failed."};z.ERROR_CERT_PFX_IMPORT_CERT_DECODE_ERROR=1695416600;u[z.ERROR_CERT_PFX_IMPORT_CERT_DECODE_ERROR]={code:16,msg_koKR:"유효하지 않는 인증서 입니다.",msg_enUS:"Invalid certificate."};z.ERROR_USER_LOGIN=17;u[z.ERROR_USER_LOGIN]={code:17,msg_koKR:"로그인 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error signing in. Please contact your administrator."};z.ERROR_USER_LOGOUT=18;u[z.ERROR_USER_LOGOUT]={code:18,msg_koKR:"로그아웃 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error signing out. Please contact your administrator."};z.ERROR_USER_EXTENSION=19;u[z.ERROR_USER_EXTENSION]={code:19,msg_koKR:"서버 접속 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error connecting to the server. Please contact your administrator."};z.ERROR_OTP_REQUEST=20;u[z.ERROR_OTP_REQUEST]={code:20,msg_koKR:"인증번호 요청 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error requesting your verification number. Please contact your administrator."};z.ERROR_OTP_VALID=21;u[z.ERROR_OTP_VALID]={code:21,msg_koKR:"인증번호 요청 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error occurred while verifying the verification number. Please contact your administrator."};z.ERROR_CERT_LIST=22;u[z.ERROR_CERT_LIST]={code:22,msg_koKR:"인증서 리스트 검색 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error occurred while retrieving the certificate list. Please contact your administrator."};z.ERROR_CERT_DETAIL=23;u[z.ERROR_CERT_DETAIL]={code:23,msg_koKR:"인증서 정보 검색 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error occurred while retrieving certificate information. Please contact your administrator."};z.ERROR_CREATE_SIGNDATA=24000003;u[z.ERROR_CREATE_SIGNDATA]={code:24,msg_koKR:"전자서명 데이터 생성 요청에 실패했습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"Failed to generate requests for signature data. Please contact your administrator."};z.ERROR_CERT_DELETE=25;u[z.ERROR_CERT_DELETE]={code:25,msg_koKR:"인증서 삭제 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error deleting the certificate. Please contact your administrator."};z.ERROR_CERT_PWD_CONFIRM=26;u[z.ERROR_CERT_PWD_CONFIRM]={code:26,msg_koKR:"인증서 비밀번호 검증 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error occurred while verifying the certificate password. Please contact your administrator."};z.ERROR_CERT_PWD_UPDATE=27;u[z.ERROR_CERT_PWD_UPDATE]={code:27,msg_koKR:"인증서 비밀번호 변경 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error occurred while changing the certificate password. Please contact your administrator."};z.ERROR_CERT_PFX_EXPORT=28;u[z.ERROR_CERT_PFX_EXPORT]={code:28,msg_koKR:"인증서 내보내기 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error occurred while exporting the certificate. Please contact your administrator."};z.ERROR_CERT_PFX_IMPORT=29;u[z.ERROR_CERT_PFX_IMPORT]={code:29,msg_koKR:"인증서 가져오기 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error occurred while importing the certificate. Please contact your administrator."};z.setError=function(H,J,K,G,I){d.key=H;if(u[H]){d.key=u[H].code;d.msg_koKR=u[H].msg_koKR;d.msg_enUS=u[H].msg_enUS;}else{d.key=u[z.ERROR_UNKNOWN].code;d.msg_koKR=u[z.ERROR_UNKNOWN].msg_koKR;d.msg_enUS=u[z.ERROR_UNKNOWN].msg_enUS;}if(typeof J==="number"&&K!=undefined){d.code=J;d.message=K;}if(typeof G==="number"&&I!=undefined){d.detailCode=G;d.detailMessage=I;}if(H==z.ERROR_CERT_PASSWORD_UPDATE_FAIL1){if(d.detailMessage=="New password parameter is invalid"){sofo.error.setError(d.key,"암호는 문자/숫자/특수기호를 조합해야 합니다.","The password is must be combined to characters/numbers/special characters.",d.detailMessage);}else{if(d.detailMessage=="NewPasswordConfirm parameter is invalid"){sofo.error.setError(d.key,"새 암호가 일치하지 않습니다.","The passwords do not match.",d.detailMessage);}else{sofo.error.setError(d.key,d.msg_koKR,d.msg_enUS,d.detailMessage);}}}else{if(H==z.ERROR_CERT_PASSWORD_UPDATE_FAIL2){if(d.detailMessage=="New password is mismatch"){sofo.error.setError(d.key,"새 암호가 일치하지 않습니다.","The passwords do not match.",d.detailMessage);}else{if(d.detailMessage=="Existing password is the same"){sofo.error.setError(d.key,"변경 전 암호와 동일합니다.","It is the same as the password before change.",d.detailMessage);}else{sofo.error.setError(d.key,d.msg_koKR,d.msg_enUS,d.detailMessage);}}}else{if(H==z.ERROR_UNKNOWN){sofo.error.setError(d.key,d.msg_koKR+" ("+d.detailMessage+")",d.msg_enUS+" ("+d.detailMessage+")",d.detailMessage);}else{sofo.error.setError(d.key,d.msg_koKR,d.msg_enUS,d.detailMessage);}}}};z.resetError=function(){d.key=0;d.msg_koKR="";d.msg_enUS="";d.code=200;d.message="Success";d.detailCode=0;d.detailMessage="";sofo.error.resetError();};z.getError=function(){return d;};y.getError=function(G){for(var H in u){if(u[H].code==G){return u[H];}}return null;};y.userLogin=function(I,Q,L,G,M){z.resetError();var O=w(l);if(O==true&&typeof M!="function"){z.setError(z.ERROR_INVALID_PARAM);return-1;}var K="user/login";var H="serviceKey="+t+"&"+"userId="+f(I)+"&"+"password="+B(Q);if(L){H+="&"+"secondPassYn=Y&"+"secondPassword="+G;}var J=function(S){if(S==-1||S.code!=200){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_USER_LOGIN);}return-1;}else{if(S.xfsAccessToken){var R=function(T){if(T==0){return 0;}else{if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_USER_LOGIN);}return-1;}};return g(S.xfsAccessToken,R);}return 0;}};if(M){var P=function(R){M(J(R));};A(K,H,O,P);}else{var N=A(K,H,false);return J(N);}};y.userLogout=function(H){z.resetError();var J=w(l);if(J==true&&typeof H!="function"){z.setError(z.ERROR_INVALID_PARAM);return-1;}var K="user/logout";var M="serviceKey="+t+h();var I=function(O){var N=function(){if(O==-1||O.code!=200){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_USER_LOGOUT);}return-1;}else{return 0;}};return g("",N);};if(H){var G=function(N){H(I(N));};A(K,M,J,G);}else{var L=A(K,M,false);return I(L);}};y.userExtension=function(H){z.resetError();var J=w(l);if(J==true&&typeof H!="function"){z.setError(z.ERROR_INVALID_PARAM);return-1;}var K="user/extension";var M="serviceKey="+t+h();var I=function(N){if(N==-1||N.code!=200){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_USER_EXTENSION);}return-1;}else{return 0;}};if(H){var G=function(N){H(I(N));};A(K,M,J,G);}else{var L=A(K,M,false);return I(L);}};y.otpRequest=function(J,H){z.resetError();var K=w(l);if(K==true&&typeof H!="function"){z.setError(z.ERROR_INVALID_PARAM);return-1;}var L="otp/request";var N="serviceKey="+t+"&"+"userId="+f(J);var I=function(O){if(O==-1||O.code!=200){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_OTP_REQUEST);}return-1;}else{return 0;}};if(H){var G=function(O){H(I(O));};A(L,N,K,G);}else{var M=A(L,N,false);return I(M);}};y.otpValid=function(H,N,K){z.resetError();var M=w(l);if(M==true&&typeof K!="function"){z.setError(z.ERROR_INVALID_PARAM);return-1;}var J="otp/valid";var G="serviceKey="+t+"&"+"userId="+f(H)+"&"+"password="+B(N);var I=function(P){if(P==-1||P.code!=200){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_OTP_VALID);}return-1;}else{return 0;}};if(K){var O=function(P){K(I(P));};A(J,G,M,O);}else{var L=A(J,G,false);return I(L);}};var D=5;y.certList=function(N){z.resetError();var Q=w(l);if(Q==true&&typeof N!="function"){z.setError(z.ERROR_INVALID_PARAM);return "";}var L="cert/list";var H="serviceKey="+t+h()+"&"+"expireDate=&"+"issueDate=&"+"subjectDn=&"+"issuerDn=&"+"status=&"+"description=&"+"countPerPage="+D+"&"+"pageNo=";var J=0;var M=1;var O=[];function K(S){if(S==-1||S.code!=200){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_CERT_LIST);}return-1;}if(S.totalCount){J=Math.ceil(S.totalCount/S.countPerPage);}O=O.concat(S.item);if(M<J){M++;return 1;}else{return 0;}}if(N){var R=function(T){var S=K(T);if(S==1){G();}else{N(O);}};var G=function(){A(L,H+M,Q,R);};G();}else{var I=1;do{var P=A(L,H+M,false);I=K(P);}while(I==1);return O;}};y.certDetail=function(H,O,K){z.resetError();var M=w(l);if(M==true&&typeof K!="function"){z.setError(z.ERROR_INVALID_PARAM);return "";}var J="cert/detail";var G="serviceKey="+t+"&"+"issuerDn="+f(H)+"&"+"serial="+O+h();var I=function(P){if(P==-1||P.code!=200){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_CERT_DETAIL);}return "";}else{return P.item;}};if(K){var N=function(P){K(I(P));};A(J,G,M,N);}else{var L=A(J,G,false);return I(L);}};var s=256;var b=512;var q=4096;var r=65536;var n=8388608;y.certSign=function(H,S,R,K,I,J,N){z.resetError();var P=w(l);if(P==true&&typeof N!="function"){z.setError(z.ERROR_INVALID_PARAM);return "";}var M="cert/sign";var G="serviceKey="+t+"&"+"issuerDn="+f(H)+"&"+"serial="+S+"&"+"password="+B(R)+"&"+"plain="+f(K)+"&"+"charset="+J+"&"+h();var L=function(W){if(W==-1||W.code!=200||!W.item[0].sign||typeof W.item[0].sign!=="string"||W.item[0].sign.length==0){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_CREATE_SIGNDATA);}return "";}else{var T=W.item[0].sign;var U;if(T.charAt(0)=="3"){U=0;}else{if(T.charAt(0)=="M"){U=1;}else{z.setError(z.ERROR_CREATE_SIGNDATA);return "";}}if(I&s){if(U==1){return W.item[0].sign;}else{try{var X=forge.util.hexToBytes(W.item[0].sign);return forge.util.encode64(X);}catch(V){z.setError(z.ERROR_CREATE_SIGNDATA);return "";}}}else{if(U==0){return W.item[0].sign;}else{try{var X=forge.util.decode64(W.item[0].sign);return forge.util.bytesToHex(X);}catch(V){z.setError(z.ERROR_CREATE_SIGNDATA);return "";}}}}};if(N){var Q=function(T){N(L(T));};A(M,G,P,Q);}else{var O=A(M,G,false);return L(O);}};y.certDigestSign=function(H,R,Q,J,I,M){z.resetError();var O=w(l);if(O==true&&typeof M!="function"){z.setError(z.ERROR_INVALID_PARAM);return "";}var L="cert/digestSign";var G="serviceKey="+t+"&"+"issuerDn="+f(H)+"&"+"serial="+R+"&"+"password="+B(Q)+"&"+"digest="+f(J)+h();var K=function(V){if(V==-1||V.code!=200||!V.item[0].sign||typeof V.item[0].sign!=="string"||V.item[0].sign.length==0){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_CREATE_SIGNDATA);}return "";}else{var S=V.item[0].sign;var T;if(S.charAt(0)=="3"){T=0;}else{if(S.charAt(0)=="M"){T=1;}else{z.setError(z.ERROR_CREATE_SIGNDATA);return "";}}if(I&s){if(T==1){return V.item[0].sign;}else{try{var W=forge.util.hexToBytes(V.item[0].sign);return forge.util.encode64(W);}catch(U){z.setError(z.ERROR_CREATE_SIGNDATA);return "";}}}else{if(T==0){return V.item[0].sign;}else{try{var W=forge.util.decode64(V.item[0].sign);return forge.util.bytesToHex(W);}catch(U){z.setError(z.ERROR_CREATE_SIGNDATA);return "";}}}}};if(M){var P=function(S){M(K(S));};A(L,G,O,P);}else{var N=A(L,G,false);return K(N);}};y.certDelete=function(H,O,K){z.resetError();var M=w(l);if(M==true&&typeof K!="function"){z.setError(z.ERROR_INVALID_PARAM);return-1;}var J="cert/delete";var G="serviceKey="+t+"&"+"issuerDn="+f(H)+"&"+"serial="+O+h();var I=function(P){if(P==-1||P.code!=200){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_CERT_DELETE);}return-1;}else{return 0;}};if(K){var N=function(P){K(I(P));};A(J,G,M,N);}else{var L=A(J,G,false);return I(L);}};y.certPasswordConfirm=function(H,P,O,K){z.resetError();var M=w(l);if(M==true&&typeof K!="function"){z.setError(z.ERROR_INVALID_PARAM);return-1;}var J="cert/password/confirm";var G="serviceKey="+t+"&"+"issuerDn="+f(H)+"&"+"serial="+P+"&"+"password="+B(O)+h();var I=function(Q){if(Q==-1||Q.code!=200){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_CERT_PWD_CONFIRM);}return-1;}else{return 0;}};if(K){var N=function(Q){K(I(Q));};A(J,G,M,N);}else{var L=A(J,G,false);return I(L);}};y.certPasswordUpdate=function(J,R,G,H,N,M){z.resetError();var P=w(l);if(P==true&&typeof M!="function"){z.setError(z.ERROR_INVALID_PARAM);return-1;}var L="cert/password/update";var I="serviceKey="+t+"&"+"issuerDn="+f(J)+"&"+"serial="+R+"&"+"oldPassword="+B(G)+"&"+"newPassword="+B(H,"2")+"&"+"newPasswordConfirm="+B(N,"3")+h();var K=function(S){if(S==-1||S.code!=200){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_CERT_PWD_UPDATE);}else{}return-1;}else{return 0;}};if(M){var Q=function(S){M(K(S));};A(L,I,P,Q);}else{var O=A(L,I,false);return K(O);}};y.certPfxExport=function(H,P,O,K){z.resetError();var M=w(l);if(M==true&&typeof K!="function"){z.setError(z.ERROR_INVALID_PARAM);return "";}var J="cert/pfx/export";var G="serviceKey="+t+"&"+"issuerDn="+f(H)+"&"+"serial="+P+"&"+"password="+B(O)+h();var I=function(R){if(R==-1||R.code!=200){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_CERT_PFX_EXPORT);}return "";}else{var Q=R.item[0].pfxCert;if(Q.charAt(0)=="3"||Q.charAt(0)=="M"){return R.item[0].pfxCert;}else{z.setError(z.ERROR_EXPORTCERT);return "";}}};if(K){var N=function(Q){K(I(Q));};A(J,G,M,N);}else{var L=A(J,G,false);return I(L);}};y.certPfxImport=function(J,N,K){z.resetError();var M=w(l);if(M==true&&typeof K!="function"){z.setError(z.ERROR_INVALID_PARAM);return-1;}var I="cert/pfx/import";var G="serviceKey="+t+"&"+"pfxCert="+f(J)+"&"+"password="+B(N)+h();var H=function(P){if(P==-1||P.code!=200){if(!z.getError().msg_koKR||!z.getError().msg_enUS){z.setError(z.ERROR_CERT_PFX_IMPORT);}return-1;}else{return 0;}};if(K){var O=function(P){K(H(P));};A(I,G,M,O);}else{var L=A(I,G,false);return H(L);}};})();(function(){var t=sofo.storage;var U=sofo.pki;var aj=sofo.cmp;var D=sofo.anypin=sofo.anypin||{};var am=D.error=D.error||{};var ao="";var H="";var G="";var h=0;var F=4;var f="worker.min.js";var A={osName:"",osVersion:"",browserName:"",browserVersion:"",deviceType:""};var p=2;var ac=true;var l=1000;var at=null;var g=0;var m=13;var aK=17;var aC=18;var r=null;var z=0;var ap=1;var au=16;var a=1000000000000000;var L=64;var y=0;var ai=1;var C=2;var aD=1;var e=2;var aH=1;var q=2;var al=4;var aa=256;var P=1;var az=2;var aF=4;var J="501";var ah="502";var I="503";var B="504";var d=1;var V=2;var ay=4;var N="success";var aE="success";var aB="update";var w=101;var v=102;var u=103;var s=104;var av=201;var ar=202;var T=301;var S=302;var R=303;var Q=304;var O=305;var M=400;var X={id:null,serverCert:null};var c={id:null,index:null,keyBlock:null,r2:null,seqnum:null,snonce:null,signed:null};var aq=0;function af(){var aN=navigator.userAgent,aL,aM;if(aN.indexOf("MSIE")>=0||aN.indexOf("Trident")>=0){if(document.documentMode){aL=document.documentMode;}else{aM=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");}}else{return false;}if(aM&&aM.exec(aN)!=null){aL=parseFloat(RegExp.$1);}return aL;}function aw(aL){var aM=[];aL.attributes.forEach(function(aN){aM.push(aN.shortName.toLowerCase()+"="+aN.value);});return forge.util.decodeUtf8(aM.reverse().join(","));}function n(aN){var aQ=aN.getFullYear();var aR=aN.getMonth()+1;var aM=aN.getDate();var aL=aN.getHours();var aO=aN.getMinutes();var aP=aN.getSeconds();return aQ+(aR<10?"0"+aR:aR.toString())+(aM<10?"0"+aM:aM.toString())+(aL<10?"0"+aL:aL.toString())+(aO<10?"0"+aO:aO.toString())+(aP<10?"0"+aP:aP.toString());}function Y(aL){return typeof window!=="undefined"&&t.getAPNIndexedDBEnable()&&typeof window.crypto==="object"&&typeof window.crypto.subtle==="object"&&typeof window.crypto.subtle[aL]==="function"&&typeof window.crypto.webkitSubtle==="undefined";}function ax(aL){return typeof window!=="undefined"&&t.getAPNIndexedDBEnable()&&typeof window.msCrypto==="object"&&typeof window.msCrypto.subtle==="object"&&typeof window.msCrypto.subtle[aL]==="function";}function W(aL){return forge.util.createBuffer(aL).getBytes();}function ad(aM){var aL=forge.util.binary.raw.decode(aM);return aL.buffer;}D.init=function(aM,aL,aQ,aP,aS,aR,aO,aN){H=aM;G=aL;h=aQ;F=aP;f=aS;A.osName=aR.osName;A.osVersion=aR.osVersion;A.browserName=aR.browserName;A.browserVersion=aR.browserVersion;A.deviceType=aR.deviceType;p=aO;if(aN){at=aN;}};D.setLicense=function(aL){ao=aL;};D._setSecureInput=function(aL){r=aL;};function ag(aL){if(aL==undefined||aL==null||aL==""){return "";}if(r==-1){return E(aL);}var aM=aL.split("$");if(aM.length<2){return E(aM[0]);}if(aM[0]==g){return E(aM[1]);}return E(aM[0]);}function b(aN){var aU={type:0,input:""};if(!aN){return null;}if(r==null||r==undefined||typeof r=="string"&&r==""||typeof r=="number"&&r<0){aU.input=aN;return aU;}var aR=-1;var aO="";if(typeof aN==="string"){var aM=aN.indexOf("$");if(aM==-1){return null;}aR=parseInt(aN.substring(0,aM));if(aN.length>aM+1){aO=aN.substring(aM+1);}}else{if(typeof aN==="object"){if(typeof aN.type!=="number"){return null;}aR=aN.type;if(aR==m){if(!aN.keypad||aN.keypad==null||aN.keypad=="undefined"){return null;}}else{if(aR==aK){if(aN.pattern=="undefined"){return null;}}else{if(aR==aC){if(aN.template=="undefined"){return null;}}else{return null;}}}}else{return null;}}var aS="";var aQ=false;if(typeof r==="string"){var aT=r.split("$");var aL=0;for(var aP=0;aP<aT.length;aP++){var aM=aT[aP].indexOf("|");if(aM==-1){aL=parseInt(aT[aP]);}else{aL=parseInt(aT[aP].substring(0,aM));if(aT[aP].length>aM+1){aS=aT[aP].substring(aM+1);}}if(aL==aR){aQ=true;break;}}}else{if(typeof r==="number"){if(r==aR){aQ=true;}}else{return null;}}if(!aQ){return null;}if(aR==g){aU.input=aO;return aU;}else{if(aR==m){aU.type=m;aU.input=aN.keypad.get_input();return aU;}else{if(aR==aK){aU.type=aK;aU.input=aN.pattern.get_input();return aU;}else{if(aR==aC){aU.type=aC;if(aO){aU.input=aO;if(aS=="reg"||aS=="1"){aU.mode=ap;}else{aU.mode=z;}}else{aU.input=aN.template;aU.mode=aN.mode;}return aU;}else{return null;}}}}}function E(aL){return encodeURIComponent(aL);}function aJ(aL){switch(aL){case 0:return false;case 1:return true;case 2:return ac;default:}return false;}function an(aS,aU,aT,aR){var aQ=aT;var aM,aN;var aP;if(window.XMLHttpRequest){aP=new window.XMLHttpRequest;}else{if(aR){aR("");return-1;}else{return "";}}try{aP.open("POST",aS,aT);}catch(aO){if(!aT&&aR){aQ=true;aP.open("POST",aS,aQ);}else{return null;}}if(aQ){var aL=null;if(at&&aT){aL=at({type:"",args:"",onconfirm:"",oncancel:function(){aL.dispose();}});aL.show();}aP.onreadystatechange=function(aV){if(aP.readyState==4){aN=(new Date).getTime();if(aN-aM<l){ac=false;}else{ac=true;}if(aL){aL.dispose();aL=null;}if(aP.status==200){aR(aP.responseText);}else{aR(aP.responseText);}}};}aP.setRequestHeader("Content-type","application/json; charset=UTF-8");aM=(new Date).getTime();try{aP.send(aU);}catch(aO){if(aR){aR("");return-1;}else{return "";}}if(aQ){return 0;}else{if(aR){aR(aP.responseText);return 0;}else{return aP.responseText;}}}function aA(aR,aM,aP,aN){if(!H||!G){am.setError(am.ERROR_INVALID_PARAM);if(aN){aN(-1);}return-1;}var aQ=H+(H.charAt(H.length-1)=="/"?"":"/")+aR;function aO(aT){if(!aT){am.setError(am.ERROR_SERVER_CONNECT_FAIL);return-1;}var aU=JSON.parse(aT);if(aU.code!=200){am.setError(Number(aU.detailCode),aU.code,aU.message,aU.detailCode,aU.detailMessage);}return aU;}if(aN){var aL=function(aT){aN(aO(aT));};return an(aQ,aM,aP,aL);}else{var aS=an(aQ,aM,false);return aO(aS);}}var ak={key:0,msg_koKR:"",msg_enUS:"",code:0,message:"Success",detailCode:0,detailMessage:""};var K=[];var am={};am.ERROR_0=0;K[am.ERROR_0]={code:0,msg_koKR:"",msg_enUS:""};am.ERROR_API_FAIL=1;K[am.ERROR_API_FAIL]={code:1,msg_koKR:"api fail",msg_enUS:"api fail"};am.ERROR_INVALID_PARAM=2;K[am.ERROR_INVALID_PARAM]={code:2,msg_koKR:"입력값이 올바르지 않습니다.",msg_enUS:"Incorrect Input parameters."};am.ERROR_UNKNOWN=255;K[am.ERROR_UNKNOWN]={code:255,msg_koKR:"오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error has occurred. Please contact your administrator."};am.ERROR_STORAGE_PIN_NOT_EXIST=16;K[am.ERROR_STORAGE_PIN_NOT_EXIST]={code:16,msg_koKR:"핀 정보가 존재하지 않습니다.",msg_enUS:"PIN information does not exist."};am.ERROR_STORAGE_PIN_NOT_FOUND=17;K[am.ERROR_STORAGE_PIN_NOT_FOUND]={code:17,msg_koKR:"검색한 핀 정보가 없습니다.",msg_enUS:"No PIN information found."};am.ERROR_STORAGE_PIN_SAVE_FAILED=18;K[am.ERROR_STORAGE_PIN_SAVE_FAILED]={code:18,msg_koKR:"핀 정보 저장을 실패하였습니다.",msg_enUS:"Failed to save PIN information."};am.ERROR_STORAGE_PIN_DELETE_FAILED=19;K[am.ERROR_STORAGE_PIN_DELETE_FAILED]={code:19,msg_koKR:"핀 정보 삭제를 실패하였습니다.",msg_enUS:"Failed to delete PIN information."};am.ERROR_STORAGE_PIN_ENCRYPT_FAILED=20;K[am.ERROR_STORAGE_PIN_ENCRYPT_FAILED]={code:20,msg_koKR:"핀 정보 암호화에 실패했습니다.",msg_enUS:"Failed to encrypt PIN information."};am.ERROR_STORAGE_PIN_DECRYPT_FAILED=21;K[am.ERROR_STORAGE_PIN_DECRYPT_FAILED]={code:21,msg_koKR:"암호화된 핀 정보 복호화에 실패했습니다.",msg_enUS:"Failed to decrypt PIN information."};am.ERROR_STORAGE_PIN_GET_FAILED=22;K[am.ERROR_STORAGE_PIN_GET_FAILED]={code:22,msg_koKR:"핀 정보 저장소에서 데이터 조회 중 오류가 발생하였습니다.",msg_enUS:"An error occurred while get PIN data from the storage."};am.ERROR_STORAGE_PIN_EXCEPTION=23;K[am.ERROR_STORAGE_PIN_EXCEPTION]={code:23,msg_koKR:"핀 정보 저장소에 오류가 발생하였습니다. 핀 정보 저장소를 초기화 합니다.",msg_enUS:"An error occurred in storage of PIN data . All Pin data storage will be deleted."};am.ERROR_SERVER_API_SERVER_CERT=48;K[am.ERROR_SERVER_API_SERVER_CERT]={code:48,msg_koKR:"서버 인증서 가져오기에 실패하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"Failed to import server certificate. Please contact your administrator."};am.ERROR_SERVER_API_HELLO_REG=49;K[am.ERROR_SERVER_API_HELLO_REG]={code:49,msg_koKR:"핀 정보 등록을 위한 세션 초기화 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error occurred during session initialization for PIN information registration. Please contact your administrator."};am.ERROR_SERVER_API_USER_REGIST=50;K[am.ERROR_SERVER_API_USER_REGIST]={code:50,msg_koKR:"핀 정보 등록 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error registering your PIN information. Please contact your administrator."};am.ERROR_SERVER_API_CERT_REGIST=51;K[am.ERROR_SERVER_API_CERT_REGIST]={code:51,msg_koKR:"핀 인증서 등록 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error registering your PIN certificate. Please contact your administrator."};am.ERROR_SERVER_API_HELLO_AUTH=52;K[am.ERROR_SERVER_API_HELLO_AUTH]={code:52,msg_koKR:"핀 인증을 위한 세션 초기화 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error occurred during session initialization for PIN authentication. Please contact your administrator."};am.ERROR_SERVER_API_USER_AUTH=53;K[am.ERROR_SERVER_API_USER_AUTH]={code:53,msg_koKR:"핀 인증 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error authenticating your PIN. Please contact your administrator."};am.ERROR_SERVER_API_USER_AUTHSIGN=54;K[am.ERROR_SERVER_API_USER_AUTHSIGN]={code:54,msg_koKR:"핀 인증 및 서명 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error authenticating and signing your PIN. Please contact your administrator."};am.ERROR_SERVER_API_USER_ENDSESSION=55;K[am.ERROR_SERVER_API_USER_ENDSESSION]={code:55,msg_koKR:"세션 종료 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An end-of-session error occurred. Please contact your administrator."};am.ERROR_SERVER_API_CERT_UPDATE=56;K[am.ERROR_SERVER_API_CERT_UPDATE]={code:56,msg_koKR:"핀 정보 업데이트 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error updating your PIN information. Please contact your administrator."};am.ERROR_SERVER_API_USER_DELETE=57;K[am.ERROR_SERVER_API_USER_DELETE]={code:57,msg_koKR:"핀 정보 삭제 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error deleting your PIN information. Please contact your administrator."};am.ERROR_SERVER_API_USER_UPDATE=58;K[am.ERROR_SERVER_API_USER_UPDATE]={code:58,msg_koKR:"핀 변경 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error changing your PIN. Please contact your administrator."};am.ERROR_SERVER_API_USER_LEAVE=59;K[am.ERROR_SERVER_API_USER_LEAVE]={code:59,msg_koKR:"핀 정보 해제 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"There was an error clearing your PIN information. Please contact your administrator."};am.ERROR_SERVER_API_DEVICE_LIST=60;K[am.ERROR_SERVER_API_DEVICE_LIST]={code:60,msg_koKR:"ERROR_SERVER_API_DEVICE_LIST",msg_enUS:"ERROR_SERVER_API_DEVICE_LIST"};am.ERROR_SERVER_API_AUDIT_LIST=61;K[am.ERROR_SERVER_API_AUDIT_LIST]={code:61,msg_koKR:"ERROR_SERVER_API_AUDIT_LIST",msg_enUS:"ERROR_SERVER_API_AUDIT_LIST"};am.ERROR_SERVER_API_USER_FACEPHIREG=62;K[am.ERROR_SERVER_API_USER_FACEPHIREG]={code:62,msg_koKR:"얼굴 정보 등록 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error occurred while registering face information. Please contact your administrator."};am.ERROR_SERVER_API_USER_FACEPHIAUTH=63;K[am.ERROR_SERVER_API_USER_FACEPHIAUTH]={code:63,msg_koKR:"얼굴 인증 중 오류가 발생하였습니다. 관리자에게 문의하시기 바랍니다.",msg_enUS:"An error occurred during face verification. Please contact your administrator."};am.ERROR_SERVER_CONNECT_FAIL=400;K[am.ERROR_SERVER_CONNECT_FAIL]={code:64,msg_koKR:"서버 접속에 실패하였습니다. 잠시 후 다시 시도해 주세요.",msg_enUS:"Server connection failed. Please try again in a few minutes."};am.ERROR_SERVER_INTERNAL_INVALID_SESSION=1275396380;K[am.ERROR_SERVER_INTERNAL_INVALID_SESSION]={code:65,msg_koKR:"세션이 유효하지 않거나 만료되었습니다.",msg_enUS:"Session is invalid or has expired."};am.ERROR_SERVER_INTERNAL_PIN_NOT_EXIST_AND_DELETE=1208025372;K[am.ERROR_SERVER_INTERNAL_PIN_NOT_EXIST_AND_DELETE]={code:66,msg_koKR:"등록된 핀 정보가 존재하지 않습니다. 핀 정보를 삭제합니다.",msg_enUS:"The registered PIN information does not exist. Deletes the PIN information."};am.ERROR_PIN_NOT_VALID=96;K[am.ERROR_PIN_NOT_VALID]={code:96,msg_koKR:"핀 정보가 유효하지 않습니다.",msg_enUS:"PIN information is not valid."};am.ERROR_HELLO_AUTH_PIN_EXPIRED=97;K[am.ERROR_HELLO_AUTH_PIN_EXPIRED]={code:97,msg_koKR:"핀 정보가 만료되었습니다.",msg_enUS:"The PIN information has expired."};am.ERROR_HELLO_AUTH_PIN_EXPIRED_AND_DELETE=98;K[am.ERROR_HELLO_AUTH_PIN_EXPIRED_AND_DELETE]={code:98,msg_koKR:"핀 정보가 만료되었습니다. 핀 정보를 삭제합니다.",msg_enUS:"The PIN information has expired. Deletes the PIN information."};am.ERROR_USER_AUTH_PIN_NOT_MATHCH=99;K[am.ERROR_USER_AUTH_PIN_NOT_MATHCH]={code:99,msg_koKR:"잘못된 핀번호를 입력하였습니다. 남은 횟수 : ",msg_enUS:"You have entered an incorrect PIN number. Remaining number :"};am.ERROR_USER_AUTH_FAILED_AND_DELETE=100;K[am.ERROR_USER_AUTH_FAILED_AND_DELETE]={code:100,msg_koKR:"더이상 핀 인증을 할 수 없습니다. 핀 정보를 삭제합니다.",msg_enUS:"PIN authentication is no longer possible. Deletes the PIN information."};am.ERROR_USER_AUTH_CERT_EXPIRED_AND_DELETE=101;K[am.ERROR_USER_AUTH_CERT_EXPIRED_AND_DELETE]={code:101,msg_koKR:"인증 정보가 만료되었습니다. 핀 정보를 삭제합니다.",msg_enUS:"The authentication information has expired. Deletes the PIN information."};am.ERROR_PIN_NOT_MATHCH=102;K[am.ERROR_PIN_NOT_MATHCH]={code:102,msg_koKR:"핀 번호가 일치하지 않습니다.",msg_enUS:"The PIN do not match."};am.ERROR_PIN_INVALID_LENGTH=103;K[am.ERROR_PIN_INVALID_LENGTH]={code:103,msg_koKR:"핀 번호는 최소 4자리 이상 최대 56자 이하입니다.",msg_enUS:"The PIN number must be a minimum of 4 digits and a maximum of 56 characters."};am.ERROR_PIN_INVALID_MIN_LENGTH=104;K[am.ERROR_PIN_INVALID_MIN_LENGTH]={code:104,msg_koKR:"입력한 핀 번호가 허용 가능한 최소 자릿수보다 작습니다.",msg_enUS:"The PIN number you entered is less than the allowable minimum number of digits."};am.ERROR_PIN_INVALID_MAX_LENGTH=105;K[am.ERROR_PIN_INVALID_MAX_LENGTH]={code:105,msg_koKR:"입력한 핀 번호가 허용 가능한 최대 자릿수를 초과하였습니다.",msg_enUS:"The entered PIN number exceeds the maximum allowable number of digits."};am.ERROR_PIN_NOT_NUMBER=106;K[am.ERROR_PIN_NOT_NUMBER]={code:106,msg_koKR:"핀 번호는 숫자만 가능합니다.",msg_enUS:"PIN numbers are numeric only."};am.ERROR_PIN_NOT_ALLOW_PATTERN=107;K[am.ERROR_PIN_NOT_ALLOW_PATTERN]={code:107,msg_koKR:"핀 번호는 3자리 이상 동일한 숫자와 연속된 숫자를 사용할 수 없습니다.",msg_enUS:"PIN numbers can not contain the same number and consecutive numbers more than three digits."};am.ERROR_SERVERCERT_DECODE_FAILED=108;K[am.ERROR_SERVERCERT_DECODE_FAILED]={code:108,msg_koKR:"서버 인증서 처리 중 오류가 발생하였습니다.",msg_enUS:"An error occurred while processing the server certificate."};am.ERROR_SERVERCERT_VERIFY_FAILED=109;K[am.ERROR_SERVERCERT_VERIFY_FAILED]={code:109,msg_koKR:"서버 인증서 검증 요구에 실패했습니다.",msg_enUS:"Server certificate validation request failed."};am.ERROR_SERVERCERT_EXPIRED=110;K[am.ERROR_SERVERCERT_EXPIRED]={code:110,msg_koKR:"서버 인증서가 만료되었습니다.",msg_enUS:"The server certificate has expired."};am.ERROR_SERVERCERT_LICENSE_FAILED=111;K[am.ERROR_SERVERCERT_LICENSE_FAILED]={code:111,msg_koKR:"서버 인증서 라이센스 검증에 실패했습니다.",msg_enUS:"Server certificate license validation failed."};am.ERROR_CREATE_SIGNDATA=112;K[am.ERROR_CREATE_SIGNDATA]={code:112,msg_koKR:"전자서명 데이터 생성 요청에 실패했습니다.",msg_enUS:"Failed to generate requests for signature data."};am.ERROR_CERT_REGISTRATION_FAILED=113;K[am.ERROR_CERT_REGISTRATION_FAILED]={code:113,msg_koKR:"인증서 등록 요청에 실패했습니다.",msg_enUS:"Certificate enrollment request failed."};am.ERROR_REQUESTCERT=114;K[am.ERROR_REQUESTCERT]={code:114,msg_koKR:"인증서 발급 요구에 실패했습니다.",msg_enUS:"Fail to generate cert request."};am.ERROR_CERT_RENEW_REGISTRATION_FAILED=115;K[am.ERROR_CERT_RENEW_REGISTRATION_FAILED]={code:115,msg_koKR:"인증서 갱신 등록 요청에 실패했습니다.",msg_enUS:"Certificate enrollment request failed."};am.ERROR_RENEWCERT=116;K[am.ERROR_RENEWCERT]={code:116,msg_koKR:"인증서 갱신 요구에 실패했습니다.",msg_enUS:"Fail to generate cert request."};am.ERROR_IMPORTCERT_FAIL=117;K[am.ERROR_IMPORTCERT_FAIL]={code:117,msg_koKR:"인증서 가져오기 요구에 실패했습니다.",msg_enUS:"Fail to import certificate."};am.ERROR_VERIFYCERTPASSWORD=118;K[am.ERROR_VERIFYCERTPASSWORD]={code:118,msg_koKR:"인증서 비밀번호 검증 요구에 실패했습니다.",msg_enUS:"Fail to verify password of certificate."};am.ERROR_CHANGECERTPASSWORD=119;K[am.ERROR_CHANGECERTPASSWORD]={code:119,msg_koKR:"인증서 비밀번호 변경 요구에 실패했습니다.",msg_enUS:"Fail to change password of certificate."};am.ERROR_SESSION_NOT_VALID=120;K[am.ERROR_SESSION_NOT_VALID]={code:120,msg_koKR:"세션이 유효하지 않습니다.",msg_enUS:"The session is not valid."};am.ERROR_SESSION_ENCRYPT_FAILED=121;K[am.ERROR_SESSION_ENCRYPT_FAILED]={code:121,msg_koKR:"세션 암호화 중 오류가 발생하였습니다.",msg_enUS:"An error occurred while encrypting the session."};am.ERROR_SESSION_DECRYPT_FAILED=122;K[am.ERROR_SESSION_DECRYPT_FAILED]={code:122,msg_koKR:"세션 복호화 중 오류가 발생하였습니다.",msg_enUS:"An error occurred during session decryption."};am.ERROR_SESSION_DECRYPT_FAILED_AND_DELETE=123;K[am.ERROR_SESSION_DECRYPT_FAILED_AND_DELETE]={code:123,msg_koKR:"세션 복호화 중 오류가 발생하였습니다. 핀 정보를 삭제합니다.",msg_enUS:"An error occurred during session decryption. Deletes the PIN information."};am.ERROR_INVALID_SERVER_RESPONSE=124;K[am.ERROR_INVALID_SERVER_RESPONSE]={code:124,msg_koKR:"서버 응답 데이터가 유효하지 않습니다.",msg_enUS:"Server response data is invalid."};am.ERROR_PIN_SAME=125;K[am.ERROR_PIN_SAME]={code:125,msg_koKR:"핀 번호가 동일합니다.",msg_enUS:"Pin numbers are the same."};am.ERROR_PUBKEY_GENERATEKEYPAIR_FAILED=126;K[am.ERROR_PUBKEY_GENERATEKEYPAIR_FAILED]={code:126,msg_koKR:"공개키 키쌍 생성에 실패하였습니다.",msg_enUS:"Fail to generate public and private key pair."};am.ERROR_WEBCRYPTO_EXPORTKEY_EXCEPTION=144;K[am.ERROR_WEBCRYPTO_EXPORTKEY_EXCEPTION]={msg_koKR:"WebCrypto exportKey API 에서 예외가 발생하였습니다.",msg_enUS:"WebCrypto exportKey API method has occurred exception."};am.ERROR_WEBCRYPTO_GENERATEKEY_EXCEPTION=145;K[am.ERROR_WEBCRYPTO_GENERATEKEY_EXCEPTION]={msg_koKR:"WebCrypto generateKey API 에서 예외가 발생하였습니다.",msg_enUS:"WebCrypto generateKey API method has occurred exception."};am.ERROR_WEBCRYPTO_ENCRYPT_EXCEPTION=146;K[am.ERROR_WEBCRYPTO_ENCRYPT_EXCEPTION]={msg_koKR:"WebCrypto encrypt API 에서 예외가 발생하였습니다.",msg_enUS:"WebCrypto encrypt API method has occurred exception."};am.ERROR_WEBCRYPTO_DECRYPT_EXCEPTION=147;K[am.ERROR_WEBCRYPTO_DECRYPT_EXCEPTION]={msg_koKR:"WebCrypto decrypt API 에서 예외가 발생하였습니다.",msg_enUS:"WebCrypto decrypt API method has occurred exception."};am.ERROR_FACEPHI_ALREADY_REGISTRATION=1140916495;K[am.ERROR_FACEPHI_ALREADY_REGISTRATION]={code:127,msg_koKR:"얼굴 정보가 이미 등록되어 있습니다.",msg_enUS:"Face information is already registered."};am.ERROR_FACEPHI_NOT_REGISTRATION=1140916508;K[am.ERROR_FACEPHI_NOT_REGISTRATION]={code:128,msg_koKR:"얼굴 정보가 등록되어 있지 않습니다.",msg_enUS:"Face information is not registered."};am.ERROR_FACEPHI_AUTH_BAD=1141506344;K[am.ERROR_FACEPHI_AUTH_BAD]={code:129,msg_koKR:"얼굴 인증에 실패하였습니다.",msg_enUS:"Face verification failed."};am.ERROR_CERT_RENEW_REQUESTSIGNEDMESSAGE_VERIFY_FAILED=130;K[am.ERROR_CERT_RENEW_REQUESTSIGNEDMESSAGE_VERIFY_FAILED]={code:130,msg_koKR:"인증서 갱신 요청 메시지의 전자서명값 검증에 실패했습니다.",msg_enUS:"Verification of the digital signature value in the certificate renewal request message failed."};am.ERROR_USER_AUTH_PIN_DELAY=160;K[am.ERROR_USER_AUTH_PIN_DELAY]={code:160,msg_koKR:"잘못된 핀번호를 입력하였습니다. 연속 실패 시 딜레이 페널티가 발생됩니다. 남은 횟수 :",msg_enUS:"Please try again in a few minutes. Remaining time :"};am.ERROR_USER_AUTH_PIN_DELAY_TIME_SECONDS=161;K[am.ERROR_USER_AUTH_PIN_DELAY_TIME_SECONDS]={code:161,msg_koKR:"잘못된 핀번호를 입력하였습니다. 잠시 후 다시 시도해주세요.\n남은 시간(초) :",msg_enUS:"You have entered an incorrect PIN number. Please try again in a few minutes.\nRemaining time(seconds) :"};am.ERROR_USER_AUTH_PIN_DELAY_TIME_SECONDS_DELETE=162;K[am.ERROR_USER_AUTH_PIN_DELAY_TIME_SECONDS_DELETE]={code:162,msg_koKR:"잘못된 핀번호를 입력하였습니다. 잠시 후 다시 시도해주세요.\n남은 횟수 :\n남은 시간(초) :",msg_enUS:"You have entered an incorrect PIN number. Please try again in a few minutes.\nRemaining number :\nRemaining time(seconds) :"};am.ERROR_USER_AUTH_PIN_DELAY_TIME_MINUTES=163;K[am.ERROR_USER_AUTH_PIN_DELAY_TIME_MINUTES]={code:163,msg_koKR:"잘못된 핀번호를 입력하였습니다. 잠시 후 다시 시도해주세요.\n남은 시간(분) :",msg_enUS:"You have entered an incorrect PIN number. Please try again in a few minutes.\nRemaining time(minutes) :"};am.ERROR_USER_AUTH_PIN_DELAY_TIME_MINUTES_DELETE=164;K[am.ERROR_USER_AUTH_PIN_DELAY_TIME_MINUTES_DELETE]={code:164,msg_koKR:"잘못된 핀번호를 입력하였습니다. 잠시 후 다시 시도해주세요.\n남은 횟수 :\n남은 시간(분) :",msg_enUS:"You have entered an incorrect PIN number. Please try again in a few minutes.\nRemaining number :\nRemaining time(minutes) :"};am.ERROR_USER_AUTH_PIN_DELAY_PENALTY_TIME_SECONDS=165;K[am.ERROR_USER_AUTH_PIN_DELAY_PENALTY_TIME_SECONDS]={code:165,msg_koKR:"인증 실패 페널티가 발생했습니다. 잠시 후 다시 시도해주세요.\n남은 시간(초) :",msg_enUS:"Authentication failure penalty has occurred. Please try again in a few minutes.\nRemaining time(seconds) :"};am.ERROR_USER_AUTH_PIN_DELAY_PENALTY_TIME_MINUTES=166;K[am.ERROR_USER_AUTH_PIN_DELAY_PENALTY_TIME_MINUTES]={code:166,msg_koKR:"인증 실패 페널티가 발생했습니다. 잠시 후 다시 시도해주세요.\n남은 시간(분) :",msg_enUS:"Authentication failure penalty has occurred. Please try again in a few minutes.\nRemaining time(minutes) :"};am.setError=function(aM,aO,aP,aL,aN){ak.key=aM;if(K[aM]){ak.key=K[aM].code;ak.msg_koKR=K[aM].msg_koKR;ak.msg_enUS=K[aM].msg_enUS;}else{ak.key=K[am.ERROR_UNKNOWN].code;ak.msg_koKR=K[am.ERROR_UNKNOWN].msg_koKR;ak.msg_enUS=K[am.ERROR_UNKNOWN].msg_enUS;}if(typeof aO==="number"&&aP!=undefined){ak.code=aO;ak.message=aP;}else{if(typeof aO==="string"){ak.detailMessage=aO;}}if(typeof aL==="number"&&aN!=undefined){ak.detailCode=aL;ak.detailMessage=aN;}if(ak.key==am.ERROR_UNKNOWN){sofo.error.setError(ak.key,ak.msg_koKR+" ("+ak.detailMessage+")",ak.msg_enUS+" ("+ak.detailMessage+")",ak.detailMessage);}else{sofo.error.setError(ak.key,ak.msg_koKR,ak.msg_enUS,ak.detailMessage);}};am.addErrorMsg=function(aL){sofo.error.setError(ak.key,ak.msg_koKR+aL,ak.msg_enUS+aL,ak.detailMessage);};am.resetError=function(){ak.key=0;ak.msg_koKR="";ak.msg_enUS="";ak.code=200;ak.message="Success";ak.detailCode=0;ak.detailMessage="";sofo.error.resetError();};am.getError=function(){return ak;};D.getError=function(aL){for(var aM in K){if(K[aM].code==aL){return K[aM];}}return null;};D.serverCert=function(aS,aM){am.resetError();var aO=aJ(p);if(aO==true&&typeof aM!="function"){am.setError(am.ERROR_INVALID_PARAM);return "";}var aP="server/cert";var aR={};aR.serviceKey=G;aR.userId=aS;aR=JSON.stringify(aR);var aN=function(aU){if(aU==-1||aU.code!=200||!aU.item[0].cert||typeof aU.item[0].cert!=="string"||aU.item[0].cert.length==0){var aT=am.getError();if(aT.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_SERVER_CERT);if(aT.detailMessage){am.addErrorMsg(" ("+aT.detailMessage+")");}}return "";}else{return aU.item[0];}};if(aM){var aL=function(aT){aM(aN(aT));};aA(aP,aR,aO,aL);}else{var aQ=aA(aP,aR,false);return aN(aQ);}};D.helloReg=function(aQ,aM){am.resetError();var aO=aJ(p);if(aO==true&&typeof aM!="function"){am.setError(am.ERROR_INVALID_PARAM);return "";}var aP="hello/reg";var aS={};aS.serviceKey=G;aS.anypinClientData=aQ;aS=JSON.stringify(aS);var aN=function(aU){if(aU==-1||aU.code!=200||!aU.item[0].anypinServerData||typeof aU.item[0].anypinServerData!=="string"||aU.item[0].anypinServerData.length==0){var aT=am.getError();if(aT.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_HELLO_REG);if(aT.detailMessage){am.addErrorMsg(" ("+aT.detailMessage+")");}}return "";}else{return aU.item[0].anypinServerData;}};if(aM){var aL=function(aT){aM(aN(aT));};aA(aP,aS,aO,aL);}else{var aR=aA(aP,aS,false);return aN(aR);}};D.userRegist=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return-1;}var aN="user/regist";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aV){if(aV==-1||aV.code!=200||!aV.item[0].anypinServerData||typeof aV.item[0].anypinServerData!=="string"||aV.item[0].anypinServerData.length==0){var aU=am.getError();if(aU.key==am.ERROR_UNKNOWN){if(h==C){am.setError(am.ERROR_SERVER_API_CERT_REGIST);}else{am.setError(am.ERROR_SERVER_API_USER_REGIST);}if(aU.detailMessage){am.addErrorMsg(" ("+aU.detailMessage+")");}}return "";}else{return aV.item[0].anypinServerData;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.certRegist=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return "";}var aN="cert/regist";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aV){if(aV==-1||aV.code!=200||!aV.item[0].anypinServerData||typeof aV.item[0].anypinServerData!=="string"||aV.item[0].anypinServerData.length==0){var aU=am.getError();if(aU.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_CERT_REGIST);if(aU.detailMessage){am.addErrorMsg(" ("+aU.detailMessage+")");}}return "";}else{return aV.item[0].anypinServerData;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.helloAuth=function(aQ,aM){am.resetError();var aO=aJ(p);if(aO==true&&typeof aM!="function"){am.setError(am.ERROR_INVALID_PARAM);return "";}var aP="hello/auth";var aS={};aS.serviceKey=G;aS.anypinClientData=aQ;aS=JSON.stringify(aS);var aN=function(aU){if(aU==-1||aU.code!=200||!aU.item[0].anypinServerData||typeof aU.item[0].anypinServerData!=="string"||aU.item[0].anypinServerData.length==0){var aT=am.getError();if(aT.key==am.ERROR_UNKNOWN){if(aT.detailCode==1208156449){if(aT.detailMessage.indexOf("expired")!==-1){am.setError(am.ERROR_HELLO_AUTH_PIN_EXPIRED);}else{if(aT.detailMessage.indexOf("long-term dormant state")!==-1){am.setError(am.ERROR_HELLO_AUTH_PIN_EXPIRED_AND_DELETE);}else{am.setError(am.ERROR_SERVER_API_HELLO_AUTH);}}if(aT.detailMessage){am.addErrorMsg(" ("+aT.detailMessage+")");}}else{am.setError(am.ERROR_SERVER_API_HELLO_AUTH);if(aT.detailMessage){am.addErrorMsg(" ("+aT.detailMessage+")");}}}return "";}else{return aU.item[0].anypinServerData;}};if(aM){var aL=function(aT){aM(aN(aT));};aA(aP,aS,aO,aL);}else{var aR=aA(aP,aS,false);return aN(aR);}};D.userAuth=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return "";}var aN="user/auth";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aV){if(aV==-1||aV.code!=200||!aV.item[0].anypinServerData||typeof aV.item[0].anypinServerData!=="string"||aV.item[0].anypinServerData.length==0){var aU=am.getError();if(aU.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_USER_AUTH);if(aU.detailMessage){am.addErrorMsg(" ("+aU.detailMessage+")");}}return "";}else{return aV.item[0].anypinServerData;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.userAuthSign=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return "";}var aN="user/authSign";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aW){if(aW==-1||aW.code!=200||!aW.item[0].anypinServerData||typeof aW.item[0].anypinServerData!=="string"||aW.item[0].anypinServerData.length==0){var aV=am.getError();if(aV.key==am.ERROR_UNKNOWN){if(aV.code==400&&aV.detailCode==1275396395){if(aV.detailMessage.indexOf("seconds")!==-1){am.setError(am.ERROR_USER_AUTH_PIN_DELAY_PENALTY_TIME_SECONDS);}else{am.setError(am.ERROR_USER_AUTH_PIN_DELAY_PENALTY_TIME_MINUTES);}var aU="\n"+aV.detailMessage.replace(/[^0-9]/g,"");am.addErrorMsg(aU);}else{am.setError(am.ERROR_SERVER_API_USER_AUTHSIGN);if(aV.detailMessage){am.addErrorMsg(" ("+aV.detailMessage+")");}}}return "";}else{return aW.item[0].anypinServerData;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.userEndSession=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return-1;}var aN="user/endSession";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aV){if(aV==-1||aV.code!=200){var aU=am.getError();if(aU.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_USER_ENDSESSION);if(aU.detailMessage){am.addErrorMsg(" ("+aU.detailMessage+")");}}return-1;}else{return 0;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.certUpdate=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return "";}var aN="cert/update";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aV){if(aV==-1||aV.code!=200||!aV.item[0].anypinServerData||typeof aV.item[0].anypinServerData!=="string"||aV.item[0].anypinServerData.length==0){var aU=am.getError();if(aU.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_CERT_UPDATE);if(aU.detailMessage){am.addErrorMsg(" ("+aU.detailMessage+")");}}return "";}else{return aV.item[0].anypinServerData;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.userDelete=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return-1;}var aN="user/delete";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aV){if(aV==-1||aV.code!=200){var aU=am.getError();if(aU.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_USER_DELETE);if(aU.detailMessage){am.addErrorMsg(" ("+aU.detailMessage+")");}}return-1;}else{return 0;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.userUpdate=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return "";}var aN="user/update";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aV){if(aV==-1||aV.code!=200||!aV.item[0].anypinServerData||typeof aV.item[0].anypinServerData!=="string"||aV.item[0].anypinServerData.length==0){var aU=am.getError();if(aU.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_USER_UPDATE);if(aU.detailMessage){am.addErrorMsg(" ("+aU.detailMessage+")");}}return "";}else{return aV.item[0].anypinServerData;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.userLeave=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return-1;}var aN="user/leave";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aV){if(aV==-1||aV.code!=200){var aU=am.getError();if(aU.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_USER_LEAVE);if(aU.detailMessage){am.addErrorMsg(" ("+aU.detailMessage+")");}}return-1;}else{return 0;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.userFacephiReg=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return "";}var aN="user/facephiReg";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aV){if(aV==-1||aV.code!=200||!aV.item[0].anypinServerData||typeof aV.item[0].anypinServerData!=="string"||aV.item[0].anypinServerData.length==0){var aU=am.getError();if(aU.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_USER_FACEPHIREG);if(aU.detailMessage){am.addErrorMsg(" ("+aU.detailMessage+")");}}return "";}else{return aV.item[0].anypinServerData;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.userFacephiAuth=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return "";}var aN="user/facephiAuth";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aV){if(aV==-1||aV.code!=200||!aV.item[0].anypinServerData||typeof aV.item[0].anypinServerData!=="string"||aV.item[0].anypinServerData.length==0){var aU=am.getError();if(aU.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_USER_FACEPHIAUTH);if(aU.detailMessage){am.addErrorMsg(" ("+aU.detailMessage+")");}}return "";}else{return aV.item[0].anypinServerData;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.userFacephiDel=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return "";}var aN="user/facephiDelete";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aV){if(aV==-1||aV.code!=200){var aU=am.getError();if(aU.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_USER_FACEPHIREG);if(aU.detailMessage){am.addErrorMsg(" ("+aU.detailMessage+")");}}return-1;}else{return 0;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.deviceList=function(aP,aO,aQ){am.resetError();var aS=aJ(p);if(aS==true&&typeof aQ!="function"){am.setError(am.ERROR_INVALID_PARAM);return "";}var aN="device/list";var aL={};aL.serviceKey=G;aL.anypinToken=aP;aL.anypinClientData=aO;aL=JSON.stringify(aL);var aM=function(aV){if(aV==-1||aV.code!=200||!aV.item[0].anypinServerData||typeof aV.item[0].anypinServerData!=="string"||aV.item[0].anypinServerData.length==0){var aU=am.getError();if(aU.key==am.ERROR_UNKNOWN){am.setError(am.ERROR_SERVER_API_USER_UPDATE);if(aU.detailMessage){am.addErrorMsg(" ("+aU.detailMessage+")");}}return "";}else{return aV.item[0].anypinServerData;}};if(aQ){var aT=function(aU){aQ(aM(aU));};aA(aN,aL,aS,aT);}else{var aR=aA(aN,aL,false);return aM(aR);}};D.storage={};D.storage.getPinIDList=function(aM,aP,aO,aN,aL){aN=aN||"utf8";if(aN=="utf-8"){aN="utf8";}if(typeof aM!="number"||aM&~23){am.setError(am.ERROR_INVALID_PARAM);aL("");return;}if(typeof aP!="string"||aP.length<=0){am.setError(am.ERROR_INVALID_PARAM);aL("");return;}if(aM>0){if(typeof aO!="string"||aO.length<=0){am.setError(am.ERROR_INVALID_PARAM);aL("");return;}if(aP==aO){am.setError(am.ERROR_INVALID_PARAM);aL("");return;}}var aQ=function(aS){if(aS==null||aS.length==0){am.setError(am.ERROR_STORAGE_PIN_NOT_EXIST);aL("");return;}if(aS==-1||typeof aS!="object"){var aU=function(aW){am.setError(am.ERROR_STORAGE_PIN_EXCEPTION);aL("");return;};t.clearAPNStorage(aU);return;}var aR=function(aW){try{if(aN=="euc-kr"){return sofo.utils.ksc5601_to_ucs2(aW);}else{return forge.util.decodeUtf8(aW);}}catch(aX){return "";}};var aV=aS[0].id;if(aM&aH){aV+=aO;aV+=aS[0].apn_nickname?aR(aS[0].apn_nickname):"";}if(aM&q){aV+=aO;aV+=aS[0].apn_type;}if(aM&al){aV+=aO;aV+=aS[0].apn_lastTime;}for(var aT=1;aT<aS.length;aT++){aV+=aP;aV+=aS[aT].id;if(aM&aH){aV+=aO;aV+=aS[aT].apn_nickname?aR(aS[aT].apn_nickname):"";}if(aM&q){aV+=aO;aV+=aS[aT].apn_type;}if(aM&al){aV+=aO;aV+=aS[aT].apn_lastTime;}}aL(aV);};t.getAPNStorage("pindata",aQ);};D.storage.updateLastTime=function(aM,aL){var aN=function(aO){if(aO==null||aO.length==0){am.setError(am.ERROR_STORAGE_PIN_NOT_EXIST);aL(-1);return;}if(aO==-1||typeof aO!="object"){var aS=function(aT){am.setError(am.ERROR_STORAGE_PIN_EXCEPTION);aL(-1);return;};t.clearAPNStorage(aS);return;}var aQ=false;for(var aP=0;aP<aO.length;aP++){if(aO[aP].id==aM){aQ=true;aO[aP].apn_lastTime=(new Date).getTime();break;}}if(aQ){var aR=function(aT){if(aT!=0){am.setError(am.ERROR_STORAGE_PIN_SAVE_FAILED);}aL(aT);};t.setAPNStorage("pindata",aO,aR);}else{am.setError(am.ERROR_STORAGE_PIN_NOT_FOUND);aL(-1);}};t.getAPNStorage("pindata",aN);};D.storage.updateNoDueDay=function(aN,aM,aL){var aO=function(aP){if(aP==null||aP.length==0){am.setError(am.ERROR_STORAGE_PIN_NOT_EXIST);aL(-1);return;}if(aP==-1||typeof aP!="object"){var aT=function(aU){am.setError(am.ERROR_STORAGE_PIN_EXCEPTION);aL("");return;};t.clearAPNStorage(aT);return;}var aR=false;for(var aQ=0;aQ<aP.length;aQ++){if(aP[aQ].id==aN){aR=true;aP[aQ].apn_noDueday=aM;break;}}if(aR){var aS=function(aU){if(aU!=0){am.setError(am.ERROR_STORAGE_PIN_SAVE_FAILED);}aL(aU);};t.setAPNStorage("pindata",aP,aS);}else{am.setError(am.ERROR_STORAGE_PIN_NOT_FOUND);aL(-1);}};t.getAPNStorage("pindata",aO);};D.storage.getPinData=function(aM,aL){var aN=function(a0){if(a0==null||a0.length==0){am.setError(am.ERROR_STORAGE_PIN_NOT_EXIST);aL("");return;}if(a0==-1||typeof a0!="object"){var a1=function(a7){am.setError(am.ERROR_STORAGE_PIN_EXCEPTION);aL("");return;};t.clearAPNStorage(a1);return;}for(var a4=0;a4<a0.length;a4++){if(a0[a4].id==aM){t.setAPNIndexedDBEnable(a0[a4].isIndexedDBEnable);if(a0[a4].id&&a0[a4].apn_encSymm&&a0[a4].apn_encPindata){if(Y("decrypt")==false&&ax("decrypt")==false){var a5=forge.util.createBuffer(forge.util.decode64(a0[a4].apn_keyPairPubKey));var aO=forge.util.createBuffer(forge.util.decode64(a0[a4].apn_keyPairPriKey));}var aQ=forge.util.createBuffer(forge.util.decode64(a0[a4].apn_encSymm));var aR=forge.util.createBuffer(forge.util.decode64(a0[a4].apn_encPindata));var a6={};var a3=function(ba){try{var bh=ba.substring(0,16);var bc=ba.substring(16,32);var be=forge.seed.createDecryptionCipher(bh,"CBC");be.start(bc);be.update(aR);be.finish();var bk=be.output;var bf=JSON.parse(bk.getBytes());var a8=bf.apn_userCert;var bb=bf.apn_serverCert;var bg=bf.apn_fid;var bj={};var a7=null;if(a8){a7={};a7.signCert=forge.pki.certificateFromAsn1(forge.asn1.fromDer(forge.util.createBuffer(a8.signCert)),true);a7.signKey=forge.asn1.fromDer(forge.util.createBuffer(a8.signKey));if(a8.kmCert&&a8.kmKey){a7.kmCert=forge.pki.certificateFromAsn1(forge.asn1.fromDer(forge.util.createBuffer(a8.kmCert)),true);a7.kmKey=forge.asn1.fromDer(forge.util.createBuffer(a8.kmKey));}}var bd=forge.pki.certificateFromAsn1(forge.asn1.fromDer(forge.util.createBuffer(bb)),true);bj.id=a0[a4].id;bj.version=a0[a4].apn_version;bj.nickname=a0[a4].apn_nickname;bj.type=a0[a4].apn_type;bj.lastTime=a0[a4].apn_lastTime;bj.noDueday=a0[a4].apn_noDueday;bj.isIndexedDBEnable=typeof a0[a4].isIndexedDBEnable==="undefined"?true:a0[a4].isIndexedDBEnable;bj.userCert=a7;bj.serverCert=bd;bj.fid=bg;if(Y("decrypt")==false&&ax("decrypt")==false){bj.keypair=a6;}}catch(bi){var a9=function(bm){a0.splice(a4,1);var bl=function(bn){if(bn!=0){am.setError(am.ERROR_STORAGE_PIN_DELETE_FAILED);aL(null);return;}am.setError(am.ERROR_STORAGE_PIN_DECRYPT_FAILED,bi);aL(null);return;};t.setAPNStorage("pindata",a0,bl);return;};if(Y("decrypt")||ax("decrypt")){t.deleteAPNIndexedDB(a0[a4].id,a9);}else{a9(0);}return;}aL(bj);return;};if(Y("decrypt")||ax("decrypt")){var a1=function(a7){if(a7==-1){var a8=function(ba){a0.splice(a4,1);var a9=function(bb){if(bb!=0){am.setError(am.ERROR_STORAGE_PIN_DELETE_FAILED);aL(null);return;}aL(null);return;};t.setAPNStorage("pindata",a0,a9);return;};t.deleteAPNIndexedDB(a0[a4].id,a8);return;}a6.publicKey=a7.publicKey;a6.privateKey=a7.privateKey;(window.crypto||window.msCrypto).subtle.decrypt({name:"RSA-OAEP",hash:{name:"SHA-256"}},a6.privateKey,ad(aQ.getBytes())).then(function(ba){var a9=W(ba);a3(a9);}).then(undefined,function(a9){am.setError(am.ERROR_WEBCRYPTO_DECRYPT_EXCEPTION,a9);aL(null);return;});};t.getAPNIndexedDB(aM,a1);}else{if(typeof a0[a4].apn_version!=="undefined"){var aP=getPCUID();var aU=forge.md.sha256.create();aU.start();aU.update(aP);var aY=aU.digest().getBytes();var aW=forge.util.bytesToHex(aY);}else{a5=a5.getBytes();var a2=forge.md.sha256.create();a2.start();a2.update(a5);var aZ=a2.digest().getBytes();var aW=forge.util.bytesToHex(aZ);}a6.publicKey=U.publicKeyFromAsn1(forge.asn1.fromDer(forge.util.createBuffer(a5),true));var aV=U.decryptPrivateKeyInfo(forge.asn1.fromDer(aO),aW);var aS=U.privateKeyFromAsn1(aV);a6.privateKey=aS.key;var aT=a6.privateKey.decrypt(aQ.getBytes(),"RSA-OAEP",{md:forge.md.sha256.create()});a3(aT);}return;}else{var aX=function(a8){a0.splice(a4,1);var a7=function(a9){if(a9!=0){am.setError(am.ERROR_STORAGE_PIN_DELETE_FAILED);aL(null);return;}am.setError(am.ERROR_STORAGE_PIN_GET_FAILED);aL(null);return;};t.setAPNStorage("pindata",a0,a7);return;};if(Y("decrypt")||ax("decrypt")){t.deleteAPNIndexedDB(aM,aX);}else{aX(0);}}return;}}am.setError(am.ERROR_STORAGE_PIN_NOT_FOUND);aL(null);return;};t.getAPNStorage("pindata",aN);};D.storage.deletePinData=function(aM,aL){var aN=function(aO){if(aO==null||aO.length==0){am.setError(am.ERROR_STORAGE_PIN_NOT_EXIST);aL(-1);return;}if(aO==-1||typeof aO!="object"){var aS=function(aT){am.setError(am.ERROR_STORAGE_PIN_EXCEPTION);aL(-1);return;};t.clearAPNStorage(aS);return;}var aQ=false;for(var aP=0;aP<aO.length;aP++){if(aO[aP].id==aM){t.setAPNIndexedDBEnable(aO[aP].isIndexedDBEnable);aQ=true;aO.splice(aP,1);aP--;}}if(aQ){var aR=function(aU){var aT=function(aV){if(aV!=0){am.setError(am.ERROR_STORAGE_PIN_DELETE_FAILED);}aL(aV);};t.setAPNStorage("pindata",aO,aT);};if(Y("decrypt")||ax("decrypt")){t.deleteAPNIndexedDB(aM,aR);}else{aR(0);}}else{am.setError(am.ERROR_STORAGE_PIN_NOT_FOUND);aL(-1);}return;};t.getAPNStorage("pindata",aN);};D.storage.setPinData=function(aT,a5,aZ,aQ,aL,a6,aX,a1){var aW={};var aU={};if(!aT||!a6){am.setError(am.ERROR_INVALID_PARAM);a1(-1);return;}try{var aV=null;if(aL){aV={};aV.signCert=forge.asn1.toDer(forge.pki.certificateToAsn1(aL.signCert));aV.signKey=forge.asn1.toDer(aL.signKey);if(aL.kmCert&&aL.kmKey){aV.kmCert=forge.asn1.toDer(forge.pki.certificateToAsn1(aL.kmCert));aV.kmKey=forge.asn1.toDer(aL.kmKey);}}var aR=forge.asn1.toDer(forge.pki.certificateToAsn1(a6));aU.apn_userCert=aV;aU.apn_serverCert=aR;aU.apn_fid=aZ;var aS=forge.random.getBytesSync(32);var a4=aS.substring(0,16);var aP=aS.substring(16,32);var aM=forge.seed.createEncryptionCipher(a4,"CBC");aM.start(aP);aM.update(forge.util.createBuffer(JSON.stringify(aU)));aM.finish();var a2=aM.output.getBytes();var aO=forge.util.encode64(a2);}catch(a0){am.setError(am.ERROR_STORAGE_PIN_ENCRYPT_FAILED,a0);a1(-1);return;}var a3=function(bg){try{var bb=null;var bf=null;if(Y("encrypt")==false&&ax("encrypt")==false){var bc=forge.asn1.toDer(forge.pki.rsa.publicKeyToAsn1(aX.publicKey)).getBytes();bf=forge.util.encode64(bc);var a9=getPCUID();var a7=forge.md.sha256.create();a7.start();a7.update(a9);var a8=a7.digest().getBytes();var bd=forge.util.bytesToHex(a8);var bh=U.wrapPrivateKey(aX.privateKey,null);var ba={};ba.algorithm="seed";var bi=forge.asn1.toDer(U.encryptPrivateKeyInfo(bh,bd,ba));bb=forge.util.encode64(bi.getBytes());}aW.id=aT;aW.apn_version=1;aW.apn_nickname=a5?a5:"";aW.apn_type=aQ;aW.apn_lastTime=(new Date).getTime();aW.apn_noDueday=0;aW.isIndexedDBEnable=t.getAPNIndexedDBEnable();aW.apn_keyPairPubKey=bf;aW.apn_keyPairPriKey=bb;aW.apn_encSymm=bg;aW.apn_encPindata=aO;}catch(be){am.setError(am.ERROR_STORAGE_PIN_ENCRYPT_FAILED,be);a1(-1);return;}var bj=function(bl){if(bl!=0){a1(bl);return;}var bk=function(bm){if(bm==-1){var bp=function(bq){am.setError(am.ERROR_STORAGE_PIN_EXCEPTION);a1(-1);return;};t.clearAPNStorage(bp);return;}if(bm==null||bm.length==0){bm=[];}for(var bn=0;bn<bm.length;bn++){if(bm[bn].id==aT){bm.splice(bn,1);bn--;}}bm.push(aW);var bo=function(bq){if(bq!=0){am.setError(am.ERROR_STORAGE_PIN_SAVE_FAILED);}a1(bq);};t.setAPNStorage("pindata",bm,bo);};t.getAPNStorage("pindata",bk);};if(Y("encrypt")||ax("encrypt")){t.setAPNIndexedDB(aT,aX,bj);return;}else{bj(0);}};var aN;var aY;if(Y("encrypt")||ax("encrypt")){(window.crypto||window.msCrypto).subtle.encrypt({name:"RSA-OAEP",hash:{name:"SHA-256"}},aX.publicKey,ad(aS)).then(function(a7){aN=W(a7);aY=forge.util.encode64(aN);a3(aY);}).then(undefined,function(a7){am.setError(am.ERROR_WEBCRYPTO_ENCRYPT_EXCEPTION,a7);a1(-1);return;});}else{aN=aX.publicKey.encrypt(aS,"RSA-OAEP",{md:forge.md.sha256.create()});aY=forge.util.encode64(aN);a3(aY);}};D.storage.updatePinData=function(aO,aL,aQ,aN,aM){if(!aO){am.setError(am.ERROR_INVALID_PARAM);aM(-1);return;}var aP=function(a4){if(a4==-1){var a6=function(bc){am.setError(am.ERROR_STORAGE_PIN_EXCEPTION);aM(-1);return;};t.clearAPNStorage(a6);return;}if(a4==null||a4.length==0){am.setError(am.ERROR_STORAGE_PIN_NOT_EXIST);aM(-1);return;}for(var a8=0;a8<a4.length;a8++){if(a4[a8].id==aO){if(!(a4[a8].id&&a4[a8].apn_encSymm&&a4[a8].apn_encPindata)){am.setError(am.ERROR_STORAGE_PIN_GET_FAILED);aM(-1);return;}var a0={};var bb={};if(Y("decrypt")==false&&ax("decrypt")==false){var a9=forge.util.createBuffer(forge.util.decode64(a4[a8].apn_keyPairPubKey));var aR=forge.util.createBuffer(forge.util.decode64(a4[a8].apn_keyPairPriKey));}var aS=forge.util.createBuffer(forge.util.decode64(a4[a8].apn_encSymm));var aU=forge.util.createBuffer(forge.util.decode64(a4[a8].apn_encPindata));var a5=function(bf){try{var bl=bf.substring(0,16);var bg=bf.substring(16,32);var bh=forge.seed.createDecryptionCipher(bl,"CBC");bh.start(bg);bh.update(aU);bh.finish();var bp=bh.output;var bi=JSON.parse(bp.getBytes());a0.apn_serverCert=bi.apn_serverCert;a0.apn_fid=bi.apn_fid;}catch(bm){am.setError(am.ERROR_STORAGE_PIN_DECRYPT_FAILED,bm);aM(-1);return;}try{var be=null;if(aQ){be={};be.signCert=forge.asn1.toDer(forge.pki.certificateToAsn1(aQ.signCert));be.signKey=forge.asn1.toDer(aQ.signKey);if(aQ.kmCert&&aQ.kmKey){be.kmCert=forge.asn1.toDer(forge.pki.certificateToAsn1(aQ.kmCert));be.kmKey=forge.asn1.toDer(aQ.kmKey);}}a0.apn_userCert=be;var bo=forge.random.getBytesSync(32);var bl=bo.substring(0,16);var bg=bo.substring(16,32);var bk=forge.seed.createEncryptionCipher(bl,"CBC");bk.start(bg);bk.update(forge.util.createBuffer(JSON.stringify(a0)));bk.finish();var bj=bk.output.getBytes();var bc=forge.util.encode64(bj);}catch(bm){am.setError(am.ERROR_STORAGE_PIN_ENCRYPT_FAILED,bm);aM(-1);return;}var bd=function(bt){var bz=null;var bD=null;var bs=function(bH){if(bH!=0){aM(bH);return;}a4[a8].apn_type=aL;a4[a8].apn_noDueday=0;a4[a8].apn_keyPairPubKey=bD;a4[a8].apn_keyPairPriKey=bz;a4[a8].apn_encSymm=bt;a4[a8].apn_encPindata=bc;var bG=function(bI){if(bI!=0){am.setError(am.ERROR_STORAGE_PIN_SAVE_FAILED);}aM(bI);};t.setAPNStorage("pindata",a4,bG);return;};if(Y("encrypt")||ax("encrypt")){t.setAPNIndexedDB(aO,aN,bs);return;}else{try{var bA=forge.asn1.toDer(forge.pki.rsa.publicKeyToAsn1(aN.publicKey)).getBytes();var bD=forge.util.encode64(bA);if(typeof a4[a8].apn_version!=="undefined"){var bx=getPCUID();var br=forge.md.sha256.create();br.start();br.update(bx);var bv=br.digest().getBytes();var bB=forge.util.bytesToHex(bv);}else{var bw=forge.md.sha256.create();bw.start();bw.update(bA);var bu=bw.digest().getBytes();var bB=forge.util.bytesToHex(bu);}var bE=U.wrapPrivateKey(aN.privateKey,null);var by={};by.algorithm="seed";var bF=forge.asn1.toDer(U.encryptPrivateKeyInfo(bE,bB,by));var bz=forge.util.encode64(bF.getBytes());}catch(bC){am.setError(am.ERROR_STORAGE_PIN_ENCRYPT_FAILED,bC);aM(-1);return;}bs(0);return;}};var bq;var bn;if(Y("encrypt")||ax("encrypt")){(window.crypto||window.msCrypto).subtle.encrypt({name:"RSA-OAEP",hash:{name:"SHA-256"}},aN.publicKey,ad(bo)).then(function(br){bq=W(br);bn=forge.util.encode64(bq);bd(bn);}).then(undefined,function(br){am.setError(am.ERROR_WEBCRYPTO_ENCRYPT_EXCEPTION,br);aM(-1);return;});}else{bq=aN.publicKey.encrypt(bo,"RSA-OAEP",{md:forge.md.sha256.create()});bn=forge.util.encode64(bq);bd(bn);}return;};try{if(Y("decrypt")||ax("decrypt")){var a3=function(bc){if(bc==-1){aM("");return;}bb.publicKey=bc.publicKey;bb.privateKey=bc.privateKey;(window.crypto||window.msCrypto).subtle.decrypt({name:"RSA-OAEP",hash:{name:"SHA-256"}},bb.privateKey,ad(aS.getBytes())).then(function(be){var bd=W(be);a5(bd);}).then(undefined,function(bd){am.setError(am.ERROR_WEBCRYPTO_DECRYPT_EXCEPTION,bd);aM(-1);return;});};t.getAPNIndexedDB(aO,a3);}else{if(typeof a4[a8].apn_version!=="undefined"){var aT=getPCUID();var aX=forge.md.sha256.create();aX.start();aX.update(aT);var a1=aX.digest().getBytes();var aZ=forge.util.bytesToHex(a1);}else{a9=a9.getBytes();var a7=forge.md.sha256.create();a7.start();a7.update(a9);var a2=a7.digest().getBytes();var aZ=forge.util.bytesToHex(a2);}bb.publicKey=U.publicKeyFromAsn1(forge.asn1.fromDer(forge.util.createBuffer(a9),true));var aY=U.decryptPrivateKeyInfo(forge.asn1.fromDer(aR),aZ);var aV=U.privateKeyFromAsn1(aY);bb.privateKey=aV.key;var aW=bb.privateKey.decrypt(aS.getBytes(),"RSA-OAEP",{md:forge.md.sha256.create()});a5(aW);}return;}catch(ba){am.setError(am.ERROR_STORAGE_PIN_DECRYPT_FAILED,ba);aM(-1);return;}}}am.setError(am.ERROR_STORAGE_PIN_NOT_FOUND);aM(-1);return;};t.getAPNStorage("pindata",aP);};isRegistSession=function(aL){if(X.id||X.serverCert){if(aL==X.id){return true;}else{return false;}}else{return false;}};resetRegistSession=function(){X.id=null;X.serverCert=null;};setRegistSession=function(aM,aL){X.id=aM;X.serverCert=aL;};getRegistSession=function(){return X;};resetSession=function(){c.id=null;c.index=null;c.keyBlock=null;c.r2=null;c.facephiSecret=null;c.seqnum=null;c.snonce=null;c.signed=null;};var ae=null;setSession=function(aS,aN,aR){c.id=aS;c.index=aN;c.r2=null;c.facephiSecret=null;c.seqnum=null;c.snonce=null;c.signed=null;ae=forge.random.getBytesSync(32);function aM(aT){return forge.md.sha256.create().update(aT).digest().getBytes();}var aQ=aS+aN+ae+getPCUID()+window.location.protocol+"//"+window.location.host;var aP=aM(aM(aQ.substr(0,16))+aM(aQ.substr(16,16)));var aO=aM(aP+ae);var aL=forge.seed.createEncryptionCipher(aO.substring(0,16),"CBC");aL.start(aO.substring(16,32));aL.update(forge.util.createBuffer(JSON.stringify(aR)));aL.finish();c.keyBlock=aL.output.getBytes();};setSessionR2=function(aR,aM){if(c.id!=aR){return false;}else{if(aM){function aN(aS){return forge.md.sha256.create().update(aS).digest().getBytes();}var aQ=aR+c.index+ae+getPCUID()+window.location.protocol+"//"+window.location.host;var aP=aN(aN(aQ.substr(0,16))+aN(aQ.substr(16,16)));var aO=aN(aP+ae);var aL=forge.seed.createEncryptionCipher(aO.substring(0,16),"CBC");aL.start(aO.substring(16,32));aL.update(forge.util.createBuffer(JSON.stringify(aM)));aL.finish();c.r2=aL.output.getBytes();}return true;}};setSessionFacephiSecret=function(aQ,aR){if(c.id!=aQ){return false;}else{if(aR){function aM(aS){return forge.md.sha256.create().update(aS).digest().getBytes();}var aP=aQ+c.index+ae+getPCUID()+window.location.protocol+"//"+window.location.host;var aO=aM(aM(aP.substr(0,16))+aM(aP.substr(16,16)));var aN=aM(aO+ae);var aL=forge.seed.createEncryptionCipher(aN.substring(0,16),"CBC");aL.start(aN.substring(16,32));aL.update(forge.util.createBuffer(JSON.stringify(aR)));aL.finish();c.facephiSecret=aL.output.getBytes();}return true;}};setSessionSigned=function(aN,aM,aL,aO){if(c.id!=aN){return false;}else{c.seqnum=aM;c.snonce=aL;c.signed=aO;return true;}};isSession=function(aL){if(c.id!=aL){return false;}else{return true;}};isSessionR2=function(aL){if(c.id!=aL||!c.r2){return false;}else{return true;}};isSessionFacephiSecret=function(aL){if(c.id!=aL||!c.facephiSecret){return false;}else{return true;}};isSessionSigned=function(aL){if(c.id!=aL||!c.signed){return false;}else{return true;}};getSession=function(){var aL={id:null,index:null,keyBlock:null,r2:null,facephiSecret:null,seqnum:null,snonce:null,signed:null};try{function aM(aT){function aP(aU){return forge.md.sha256.create().update(aU).digest().getBytes();}var aS=c.id+c.index+ae+getPCUID()+window.location.protocol+"//"+window.location.host;var aR=aP(aP(aS.substr(0,16))+aP(aS.substr(16,16)));var aQ=aP(aR+ae);var aO=forge.seed.createDecryptionCipher(aQ.substring(0,16),"CBC");aO.start(aQ.substring(16,32));aO.update(forge.util.createBuffer(aT));aO.finish();return JSON.parse(aO.output.getBytes());}aL.id=c.id;aL.index=c.index;if(c.keyBlock){aL.keyBlock=aM(c.keyBlock);}if(c.r2){aL.r2=aM(c.r2);}if(c.facephiSecret){aL.facephiSecret=aM(c.facephiSecret);}aL.seqnum=c.seqnum;aL.snonce=c.snonce;aL.signed=c.signed;return aL;}catch(aN){return aL;}};generateKeyBlock=function(aM,aL){var aO={client:{mac:null,key:null,iv:null},server:{mac:null,key:null,iv:null},apnsv:null};var aN=forge.tls.prf_sha2(aM,"AP key expansion",aL,160).getBytes();aO.client.mac=aN.substring(0,32);aO.server.mac=aN.substring(32,64);aO.client.key=aN.substring(64,80);aO.server.key=aN.substring(80,96);aO.client.iv=aN.substring(96,112);aO.server.iv=aN.substring(112,128);aO.apnsv=aN.substring(128,160);return aO;};encryptKeyBlock=function(aM,aR){var aL=forge.seed.createEncryptionCipher(aR.key,"CBC");aL.start(aR.iv);aL.update(forge.util.createBuffer(aM));aL.finish();var aN=aL.output.getBytes();var aP=forge.md.sha256.create();var aO=forge.hmac.create();aO.start(aP,aR.mac);aO.update(aN);var aQ=aO.digest().getBytes();return forge.util.encode64(aN)+";"+forge.util.encode64(aQ);};decryptKeyBlock=function(aO,aS){var aR=aO.split(";");if(aR.length<2){return null;}var aT=forge.util.decode64(aR[0]);if(!aT){return null;}var aL=forge.util.decode64(aR[1]);if(!aL){return null;}var aQ=forge.md.sha256.create();var aM=forge.hmac.create();aM.start(aQ,aS.mac);aM.update(aT);var aP=aM.digest().getBytes();if(aL!=aP){return null;}var aN=forge.seed.createDecryptionCipher(aS.key,"CBC");aN.start(aS.iv);aN.update(forge.util.createBuffer(aT));aN.finish();return aN.output.getBytes();};verifyServerCert=function(aL){var aP=U.verifyCertificate(aL,0);if(aP!=0&&aP!=1){if(sofo.error.getError().code==sofo.error.ERROR_CERT_EXPIRED){am.setError(am.ERROR_SERVERCERT_EXPIRED);}else{am.setError(am.ERROR_SERVERCERT_VERIFY_FAILED);}return-1;}var aQ=aw(aL.subject);var aN=forge.md.sha1.create();aN.start();aN.update(aQ);var aM=aN.digest().getBytes();var aO=forge.util.bytesToHex(aM);if(aO!=ao){am.setError(am.ERROR_SERVERCERT_LICENSE_FAILED);return-1;}return 0;};signData=function(aL,aR,aQ,aP,aO,aN){var aM=U.signDataCMS(aL,aR,aQ,aP,aO,aN,au);if(!aM){am.setError(am.ERROR_CREATE_SIGNDATA);return "";}return aM;};convertSignedData=function(aP,aO,aN,aM){var aL=U.convertSignedData(aP,aO,aN,aM);if(!aL){am.setError(am.ERROR_CREATE_SIGNDATA);return "";}return aL;};getPCUID=function(){var a1="|";var aM=document.createElement("canvas");var aZ=aM.getContext("2d");var aU="AnyPin Canvas";aZ.textBaseline="top";aZ.font="14px 'Arial'";aZ.textBaseline="alphabetic";aZ.fillStyle="#f60";aZ.fillRect(125,1,62,20);aZ.fillStyle="#069";aZ.fillText(aU,2,15);aZ.fillStyle="rgba(102, 204, 0, 0.7)";aZ.fillText(aU,4,17);var aL=screen.deviceXDPI;var aO=screen.deviceYDPI;var aV=screen.colorDepth;var aP=aL+a1+aO+a1+aV;var aT=navigator.userAgent;var aQ=navigator.cpuClass;var a5=navigator.platform;var aX=navigator.language;var a2=navigator.systemLanguage;var aS=navigator.cookieEnabled;var aW=aT+a1+aQ+a1+a5+a1+aX+a1+a2+a1+aS;var aR=!!window.localStorage;var a4=!!window.sessionStorage;var a3=!!window.indexedDB;var aN=aR+a1+a4+a1+a3;var aY=(new Date).getTimezoneOffset();var a0=aM.toDataURL()+a1+aP+a1+aW+a1+aN+a1+aY;return a0;};gen_hf1=function(aN,aM){var aL=forge.md.sha256.create();return forge.pkcs5.pbkdf2(aN,aM,2048,32,aL);};getDeviceID=function(aN,aL){var aM=forge.md.sha256.create();aM.start();aM.update(aL);aM.update(aN);aM.update(window.location.protocol+"//"+window.location.host);if(h==y){return "AP"+forge.util.bytesToHex(aM.digest().getBytes());}else{if(h==ai){return "AN"+forge.util.bytesToHex(aM.digest().getBytes());}else{if(h==C){return "AC"+forge.util.bytesToHex(aM.digest().getBytes());}}}};getDeleteDeviceCount=function(aP,aN){if(!aP){if(aCallback){aCallback(-1);}return-1;}var aL;try{aL=decryptKeyBlock(aP,aN);}catch(aO){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,aO);if(aCallback){aCallback(-1);}return-1;}if(!aL){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,aO);if(aCallback){aCallback(-1);}return-1;}try{var aM=JSON.parse(aL);if(typeof aM.DeleteDeviceCount=="undefined"){am.setError(am.ERROR_INVALID_SERVER_RESPONSE);if(aCallback){aCallback(-1);}return-1;}aq=parseInt(aM.DeleteDeviceCount);}catch(aO){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,aO);if(aCallback){aCallback(-1);}return-1;}return 0;};D.getPinIDList=function(aM,aP,aO,aN,aL){return D.storage.getPinIDList(aM,aP,aO,aN,aL);};D.updatePinLastTime=function(aM,aL){return D.storage.updateLastTime(aM,aL);};D.checkPin=function(aO,aM,aN,aP,aR){am.resetError();if(aN<1||aP<1||aN>aP){am.setError(am.ERROR_INVALID_PARAM);return-1;}aR&=~4;if(typeof aR!="number"||aR&~(aD+e)){am.setError(am.ERROR_INVALID_PARAM);return-1;}var aU=b(aO);if(!aU||!aU.input){am.setError(am.ERROR_INVALID_PARAM);return-1;}var aT;if(aR&aD||aR&e){aT=b(aM);if(!aT||!aT.input){am.setError(am.ERROR_INVALID_PARAM);return-1;}}if(aU.input.length<aN){am.setError(am.ERROR_PIN_INVALID_MIN_LENGTH);return-1;}if(aU.input.length>aP){am.setError(am.ERROR_PIN_INVALID_MAX_LENGTH);return-1;}var aQ=[];for(var aS=0;aS<aU.input.length;aS++){aQ[aS]=aU.input.charCodeAt(aS);if(!(aQ[aS]>47&&aQ[aS]<58)){am.setError(am.ERROR_PIN_NOT_NUMBER);return-1;}}if(aU.type!=aK){var aL,aV;aV=-2;for(var aS=0;aS<aQ.length+1;aS++){aL=aQ[aS]-aQ[aS+1];if(aL==aV){if(aL==0||aL==1||aL==-1){am.setError(am.ERROR_PIN_NOT_ALLOW_PATTERN);return-1;}}aV=aL;}}if(aR&e){if(aT.input.length<aN){am.setError(am.ERROR_PIN_INVALID_MIN_LENGTH);return-1;}if(aT.input.length>aP){am.setError(am.ERROR_PIN_INVALID_MAX_LENGTH);return-1;}aQ=[];for(var aS=0;aS<aT.input.length;aS++){aQ[aS]=aT.input.charCodeAt(aS);if(!(aQ[aS]>47&&aQ[aS]<58)){am.setError(am.ERROR_PIN_NOT_NUMBER);return-1;}}if(aT.type!=aK){aV=-2;for(var aS=0;aS<aQ.length+1;aS++){aL=aQ[aS]-aQ[aS+1];if(aL==aV){if(aL==0||aL==1||aL==-1){am.setError(am.ERROR_PIN_NOT_ALLOW_PATTERN);return-1;}}aV=aL;}}}if(aR&aD){if(aU.input!=aT.input){am.setError(am.ERROR_PIN_NOT_MATHCH);return-1;}}if(aR&e){if(aU.input==aT.input){am.setError(am.ERROR_PIN_SAME);return-1;}}return 0;};D.initPin=function(aO,aN,aL){if(!aO){am.setError(am.ERROR_INVALID_PARAM);if(aL){aL("");}return "";}var aM=function(aP){if(!aP){if(aL){aL("");}return "";}var aR=aP.serverCert;if(!aR||!aR.subject){am.setError(am.ERROR_SERVERCERT_DECODE_FAILED);if(aL){aL("");}return "";}var aQ=aw(aR.subject);if(!aQ){am.setError(am.ERROR_SERVERCERT_DECODE_FAILED);if(aL){aL("");}return "";}if(verifyServerCert(aR)!=0){if(aL){aL("");}return "";}if(aL){aL(aQ);}return aQ;};return D.storage.getPinData(aO,aM);};D.initRegist=function(aP,aM,aL){resetRegistSession();if(!aP){am.setError(am.ERROR_INVALID_PARAM);if(aL){aL("");}return "";}if(typeof aP!="string"||aP.length>100){am.setError(am.ERROR_INVALID_PARAM);if(aL){aL("");}return "";}for(var aN=0;aN<aP.length;aN++){tmpCode=aP.charCodeAt(aN);if(tmpCode<48||tmpCode>57&&tmpCode<65||tmpCode>90&&tmpCode<97||tmpCode>122){am.setError(am.ERROR_INVALID_PARAM);if(aL){aL("");}return "";}}var aO=function(aT){if(!aT||!aT.cert){if(aL){aL("");}return "";}var aS;try{aS=forge.pki.certificateFromPem(aT.cert,true);}catch(aR){am.setError(am.ERROR_SERVERCERT_DECODE_FAILED);if(aL){aL("");}return "";}var aQ=aw(aS.subject);if(!aQ){am.setError(am.ERROR_SERVERCERT_DECODE_FAILED);if(aL){aL("");}return "";}if(verifyServerCert(aS)!=0){if(aL){aL("");}return "";}setRegistSession(aP,aS);if(aT.userRegCode){if(aL){aL(aQ+"$"+aT.userRegCode);}return aQ+"$"+aT.userRegCode;}else{if(aL){aL(aQ);}return aQ;}};D.serverCert(aP,aO);};D.registPin=function(bj,bc,a4,a5,aP,bm,aQ,aW,aZ,a3){var bb;var bn;var aT;var aV;if(!bj){am.setError(am.ERROR_INVALID_PARAM);if(a3){a3(-1);}return-1;}if(typeof bj!="string"||bj.length>100){am.setError(am.ERROR_INVALID_PARAM);if(a3){a3(-1);}return-1;}for(var bi=0;bi<bj.length;bi++){tmpCode=bj.charCodeAt(bi);if(tmpCode<48||tmpCode>57&&tmpCode<65||tmpCode>90&&tmpCode<97||tmpCode>122){am.setError(am.ERROR_INVALID_PARAM);if(a3){a3(-1);}return-1;}}if(typeof aZ!="number"||aZ&~(P+az+aF)){am.setError(am.ERROR_INVALID_PARAM);if(a3){a3(-1);}return-1;}if(h==y){if(typeof bm!="function"){am.setError(am.ERROR_INVALID_PARAM);if(a3){a3(-1);}return-1;}bb=aj.getWebCMPType(Number(aQ));bn=aj.getWebCMPpKeyID(Number(aQ));aT=aj.getWebCMPOnlySignCert(Number(aQ));aV=aj.getCmpClient(bb,bn,aW,F,f,aT);}var bl=null;if(aZ&az&&typeof a4=="string"&&a4.length>0){if(a4.length>aa){am.setError(am.ERROR_INVALID_PARAM);if(a3){a3(-1);}return-1;}if(a5=="euc-kr"){bl=sofo.utils.ucs2_to_ksc5601(a4).getBytes();}else{bl=forge.util.createBuffer(a4,"utf8").getBytes();}bl=forge.util.encode64(bl);if(bl.length>aa){am.setError(am.ERROR_INVALID_PARAM);if(a3){a3(-1);}return-1;}}var bk=b(aP);if(!bk||!bk.input){am.setError(am.ERROR_INVALID_PARAM);if(a3){a3(-1);}return-1;}var bf=null;if(bc){if(a5=="euc-kr"){bf=sofo.utils.ucs2_to_ksc5601(bc).getBytes();}else{bf=forge.util.createBuffer(bc,"utf8").getBytes();}}if(!isRegistSession(bj)){am.setError(am.ERROR_SESSION_NOT_VALID);if(a3){a3(-1);}return-1;}var a2;var aL;var a0;var aY;var aO;var aU;var aN;var a1;var be;var bh;var a9=function(br){if(!br){if(a3){a3(-1);}return-1;}var bq;var bo=function(by){var bx=by;var bt=JSON.parse(bx);bq=forge.util.decode64(bt.serverRandom);try{aN=generateKeyBlock(bq,a0);var bu=forge.md.sha256.create();bu.start();bu.update(aO);bu.update(a0);a1=bu.digest().getBytes();a1=forge.util.bytesToHex(a1);}catch(bw){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,bw);if(a3){a3(-1);}return-1;}if(bk.type==aC){if(bk.mode==ap){var bs={template:bk.input};var bv;try{bv=encryptKeyBlock(JSON.stringify(bs),aN.client);}catch(bw){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,bw);if(a3){a3(-1);}return-1;}D.userFacephiReg(a1,bv,aM);}else{var bs={template:bk.input};var bv;try{bv=encryptKeyBlock(JSON.stringify(bs),aN.client);}catch(bw){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,bw);if(a3){a3(-1);}return-1;}D.userFacephiAuth(a1,bv,aM);}}else{aS();}};if(Y("decrypt")||ax("decrypt")){(window.crypto||window.msCrypto).subtle.decrypt({name:"RSA-OAEP",hash:{name:"SHA-256"}},a2.privateKey,ad(forge.util.decode64(br))).then(function(bt){var bs=W(bt);bo(bs);}).then(undefined,function(bs){am.setError(am.ERROR_WEBCRYPTO_DECRYPT_EXCEPTION,bs);a3(-1);return;});}else{var bp=a2.privateKey.decrypt(forge.util.decode64(br),"RSA-OAEP",{md:forge.md.sha256.create()});bo(bp);}};var aM=function(br){if(!br){if(a3){a3(-1);}return-1;}var bo;try{bo=decryptKeyBlock(br,aN.server);}catch(bq){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,bq);if(a3){a3(-1);}return-1;}if(!bo){am.setError(am.ERROR_SESSION_DECRYPT_FAILED);if(a3){a3(-1);}return-1;}try{var bp=JSON.parse(bo);bk.input=bp.secret;}catch(bq){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,bq);if(a3){a3(-1);}return-1;}aS();};var bg;var aS=function(){var by;try{bg=getPCUID();var br=forge.md.sha256.create();br.start();br.update(bg);var bq=br.digest().getBytes();bq=forge.util.bytesToHex(bq);var bt=forge.md.sha256.create();bt.start();bt.update(aO);var bp=bt.digest().getBytes();bp=forge.util.bytesToHex(bp);bg=bq+bp;be=gen_hf1(bg,bk.input);bh=getDeviceID(bj,bg);var bo={authPin:forge.util.encode64(be),deviceId:bh};var bu=false;if(aZ&P&&bf){var bv=forge.util.encode64(bf);bo.nickName=bv;bu=true;}if(aZ&az&&bl){bo.description=bl;bu=true;}if(bu){bo.charset=a5;}if(bk.type==g){bo.authenticationDeviceCode=J;}else{if(bk.type==m){bo.authenticationDeviceCode=ah;}else{if(bk.type==aK){bo.authenticationDeviceCode=I;}else{if(bk.type==aC){bo.authenticationDeviceCode=B;}}}}if(aZ&aF&&A){var bx={osName:A.osName,osVersion:A.osVersion,browserName:A.browserName,browserVersion:A.browserVersion,deviceType:A.deviceType};bo.deviceInformation=forge.util.encode64(JSON.stringify(bx));}}catch(bw){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,bw);if(a3){a3(-1);}return-1;}var bs=function(bz,bA){if(bz){am.setError(am.ERROR_PUBKEY_GENERATEKEYPAIR_FAILED);if(a3){a3(-1);}return-1;}aL=bA;if(typeof bA!=="undefined"){bSignPubKey=forge.asn1.toDer(forge.pki.rsa.publicKeyToAsn1(aL.publicKey)).getBytes();bo.signPubKey=forge.util.encode64(bSignPubKey);}by=encryptKeyBlock(JSON.stringify(bo),aN.client);D.userRegist(a1,by,a7);};if(h==C){if(typeof XDomainRequest!="undefined"||af()<11&&af()!=false){bs(null,a2);}else{forge.pki.rsa.generateKeyPair({bits:2048,e:65537,workers:F,workerScript:f},bs);}}else{bs(null,undefined);}};var a7=function(bq){if(bq==""){if(a3){a3(-1);}return-1;}var bo;if(h==y){bo=getDeleteDeviceCount(bq,aN.server);if(bo!=0){if(a3){a3(-1);}return-1;}var bp={id:bj,deviceId:bh};return bm(aX,bp);}else{if(h==C){var br=[];br.push({certificate:null,privateKey:aL.privateKey,vid:null});ba(br,bq);}else{bo=getDeleteDeviceCount(bq,aN.server);if(bo!=0){if(a3){a3(-1);}return-1;}a6();}}};var bd=null;var aX=function(bp,bo){if(!bp||!bo){am.setError(am.ERROR_CERT_REGISTRATION_FAILED);if(a3){a3(-1);}return-1;}if(!aV){am.setError(am.ERROR_REQUESTCERT);if(a3){a3(-1);}return-1;}aV.issue(bp,bo,function(bq){if(bq===sofo.error){am.setError(am.ERROR_REQUESTCERT);a3(-1);return;}ba(bq);});};var ba=function(br,bp){if(typeof bp==="undefined"){var bq;try{var bo={deviceId:bh,issuerDn:aw(br[0].certificate.issuer),serialNo:br[0].certificate.serialNumber,issueDate:n(br[0].certificate.validity.notBefore),expireDate:n(br[0].certificate.validity.notAfter)};bq=encryptKeyBlock(JSON.stringify(bo),aN.client);}catch(bt){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,bt);if(a3){a3(-1);}return-1;}}var bs=function(bB){if(!bB){if(a3){a3(-1);}return-1;}var bw;var bv;try{bv=decryptKeyBlock(bB,aN.server);}catch(bA){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,bA);if(a3){a3(-1);}return-1;}if(!bv){am.setError(am.ERROR_SESSION_DECRYPT_FAILED);if(a3){a3(-1);}return-1;}try{var by=JSON.parse(bv);bw=by.deviceSecret;if(h==C){if(typeof by.signCertData=="undefined"){am.setError(am.ERROR_INVALID_SERVER_RESPONSE);if(a3){a3(-1);}return-1;}aq=parseInt(by.DeleteDeviceCount);var bx=by.signCertData;var bu=forge.util.decode64(bx);br[0].certificate=forge.pki.certificateFromAsn1(forge.asn1.fromDer(forge.util.createBuffer(bu)),true);}}catch(bA){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,bA);if(a3){a3(-1);}return-1;}var bz=be+bw+bk.input;bd=U.certificateFromCMP(br[0].certificate,br[0].privateKey,br[1]?br[1].certificate:null,br[1]?br[1].privateKey:null,bz,br[0].vid,au);if(!bd){am.setError(am.ERROR_IMPORTCERT_FAIL);a3(-1);return;}a6();};if(typeof bp==="undefined"){D.certRegist(a1,bq,bs);}else{bs(bp);}};var a6=function(){var bo=function(bq){var br=function(){resetRegistSession();a3(aq);};var bp=function(bs){if(bs!=0){a3(-1);}else{br();}};if(bq!=0){if(am.getError().key==am.ERROR_STORAGE_PIN_EXCEPTION){am.resetError();D.storage.setPinData(bj,bf,bg,bk.type,bd,aY,a2,bp);}else{a3(-1);}}else{br();}};D.storage.setPinData(bj,bf,bg,bk.type,bd,aY,a2,bo);};var a8=function(bq,bt){if(bq){am.setError(am.ERROR_PUBKEY_GENERATEKEYPAIR_FAILED);if(a3){a3(-1);}return-1;}a2=bt;if(typeof XDomainRequest!="undefined"||af()<11&&af()!=false){if(h==y){if(!aV){am.setError(am.ERROR_REQUESTCERT);if(a3){a3(-1);}return-1;}aV.setKeyPair(a2);}}try{a0=forge.random.getBytesSync(32);aY=getRegistSession().serverCert;aO=forge.asn1.toDer(forge.pki.publicKeyToRSAPublicKey(a2.publicKeyPkcs7?a2.publicKeyPkcs7:a2.publicKey)).getBytes();var bo={userId:bj,anypinPubkey:forge.util.encode64(aO),clientRandom:forge.util.encode64(a0)};var bp=sofo.pki.createEnvelopedData();bp.addRecipient(aY);bp.setContent(forge.util.createBuffer(JSON.stringify(bo)));bp.encrypt();var br=bp.toAsn1();aU=forge.util.encode64(forge.asn1.toDer(br).getBytes());}catch(bs){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,bs);if(a3){a3(-1);}return-1;}D.helloReg(aU,a9);};var aR=function(bo){t.setAPNIndexedDBEnable(bo);forge.pki.rsa.generateKeyPair({bits:2048,e:65537,workers:F,workerScript:f,algorithmName:"RSA-OAEP"},a8);};t.checkAPNIndexedDBEnable(aR);};D.initSession=function(aR,aP,aM){resetSession();if(!aR){am.setError(am.ERROR_INVALID_PARAM);if(aM){aM("");}return "";}var aO;var aL;var aN=function(a0){if(!a0){if(aM){aM("");}return "";}aO=a0;var aS;try{aL=forge.random.getBytesSync(32);var aU=aO.fid;var aY=getDeviceID(aR,aU);var aV=aO.serverCert;var aZ={userId:aO.id,deviceId:aY,clientRandom:forge.util.encode64(aL)};var aX=sofo.pki.createEnvelopedData();aX.addRecipient(aV);aX.setContent(forge.util.createBuffer(JSON.stringify(aZ)));aX.encrypt();var aT=aX.toAsn1();aS=forge.util.encode64(forge.asn1.toDer(aT).getBytes());}catch(aW){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,aW);if(aM){aM("");}return "";}D.helloAuth(aS,aQ);};var aQ=function(aY){if(!aY){if(am.getError().detailCode==am.ERROR_SERVER_INTERNAL_PIN_NOT_EXIST_AND_DELETE){var aT=function(a1){am.setError(am.ERROR_SERVER_INTERNAL_PIN_NOT_EXIST_AND_DELETE);if(aM){aM("");}return "";};return D.storage.deletePinData(aR,aT);}else{if(aM){aM("");}return "";}}var aW=0;var aU="";var a0="";var aX=function(a7){var a9=JSON.parse(a7);aW=parseInt(a9.pinStateCode);if(a9.serverRandom){aU=forge.util.decode64(a9.serverRandom);}if(a9.dueDay){a0=a9.dueDay;}if(aW==w||aW==v){try{var a8=generateKeyBlock(aU,aL);var a4=forge.asn1.toDer(forge.pki.publicKeyToRSAPublicKey(aO.keypair.publicKeyPkcs7?aO.keypair.publicKeyPkcs7:aO.keypair.publicKey)).getBytes();var a6=forge.md.sha256.create();a6.start();a6.update(a4);a6.update(aL);var a3=a6.digest().getBytes();var a1=forge.util.bytesToHex(a3);setSession(aR,a1,a8);var ba=N;if(aW==v&&a0){if(!aO.noDueday||aO.noDueday<(new Date).getTime()){(new Date).getTime();ba+="=";ba+=a0;}}}catch(a5){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,a5);if(aM){aM("");}return "";}if(aM){aM(ba);}return ba;}else{if(aW==u){am.setError(am.ERROR_HELLO_AUTH_PIN_EXPIRED);if(aM){aM("");}return "";}else{if(aW==s){var a2=function(bb){am.setError(am.ERROR_HELLO_AUTH_PIN_EXPIRED_AND_DELETE);if(aM){aM("");}return "";};return D.storage.deletePinData(aR,a2);}else{am.setError(am.ERROR_SERVER_API_HELLO_AUTH);if(aM){aM("");}return "";}}}};if(Y("decrypt")||ax("decrypt")){var aZ=function(a1){if(a1==-1){aM("");return;}var a2={};a2.publicKey=a1.publicKey;a2.privateKey=a1.privateKey;a2.publicKeyPkcs7=a1.publicKeyPkcs7;aO.keypair=a2;(window.crypto||window.msCrypto).subtle.decrypt({name:"RSA-OAEP",hash:{name:"SHA-256"}},aO.keypair.privateKey,ad(forge.util.decode64(aY))).then(function(a4){var a3=W(a4);aX(a3);}).then(undefined,function(a3){am.setError(am.ERROR_WEBCRYPTO_DECRYPT_EXCEPTION,a3);aM(-1);return;});};t.getAPNIndexedDB(aR,aZ);return;}else{try{var aS=aO.keypair.privateKey.decrypt(forge.util.decode64(aY),"RSA-OAEP",{md:forge.md.sha256.create()});}catch(aV){var aT=function(a1){am.setError(am.ERROR_SESSION_DECRYPT_FAILED_AND_DELETE);if(aM){aM("");}return "";};return D.storage.deletePinData(aR,aT);}aX(aS);}};return D.storage.getPinData(aR,aN);};D.setNoDueDay=function(aO,aN,aL){if(!aO){am.setError(am.ERROR_INVALID_PARAM);if(aL){aL(-1);}return-1;}aN=parseInt(aN);if(isNaN(aN)||parseInt(aN)<0){am.setError(am.ERROR_INVALID_PARAM);if(aL){aL(-1);}return-1;}var aM=function(aQ){if(!aQ){if(aL){aL(-1);}return-1;}var aP=function(aR){if(aL){aL(aR);}return aR;};return D.storage.updateNoDueDay(aO,aN,aP);};return D.storage.getPinData(aO,aM);};D.authSession=function(aW,aQ,aV,aR,aL,aX,a3,aS,a8){if(!aW){am.setError(am.ERROR_INVALID_PARAM);if(a8){a8("");}return "";}if(typeof aS!="number"||aS&~(d+V+ay)){am.setError(am.ERROR_INVALID_PARAM);if(a8){a8("");}return "";}if(h==ai&&aS&d){if(aV==undefined||aV==null||aV==""){aV=null;}else{if(typeof aV=="number"){if(aV<0||aV>a||Math.round(aV)%1!=0){am.setError(am.ERROR_INVALID_PARAM);if(a8){a8("");}return "";}aV=aV.toString();}else{if(typeof aV=="string"){if(aV.length>L){am.setError(am.ERROR_INVALID_PARAM);if(a8){a8("");}return "";}var aU=0;for(var a6=0;a6<aV.length;a6++){aU=aV.charCodeAt(a6);if(aU==35||aU==36||aU==124||aU==38||aU==39||aU==34){am.setError(am.ERROR_INVALID_PARAM);if(a8){a8("");}return "";}}}else{am.setError(am.ERROR_INVALID_PARAM);if(a8){a8("");}return "";}}}}var a4=b(aQ);if(!a4||!a4.input){am.setError(am.ERROR_INVALID_PARAM);if(a8){a8("");}return "";}if(!isSession(aW)){am.setError(am.ERROR_SESSION_NOT_VALID);if(a8){a8("");}return "";}var aO=getSession();var aP=aO.index;var aY=aO.keyBlock;var aM;var aN;var a7;var a5;var aT;var aZ=function(ba){if(!ba){if(a8){a8("");}return "";}aM=ba.userCert;aN=ba.fid;if(h==y||h==C){if(!aM||!aM.signCert||!aM.signKey){am.setError(am.ERROR_PIN_NOT_VALID);if(a8){a8("");}return "";}}if(a4.type==aC){var a9={template:a4.input};var bb;try{bb=encryptKeyBlock(JSON.stringify(a9),aY.client);}catch(bc){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,bc);if(a8){a8("");}return "";}D.userFacephiAuth(aP,bb,a2);}else{a1();}};var a2=function(bc){if(!bc){if(a8){a8("");}return "";}var a9;try{a9=decryptKeyBlock(bc,aY.server);}catch(bb){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,bb);if(a8){a8("");}return "";}if(!a9){am.setError(am.ERROR_SESSION_DECRYPT_FAILED);if(a8){a8("");}return "";}try{var ba=JSON.parse(a9);a4.input=ba.secret;setSessionFacephiSecret(aW,a4.input);}catch(bb){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,bb);if(a8){a8("");}return "";}a1();};var a1=function(){var a9;try{a7=gen_hf1(aN,a4.input);var ba;if(h==y||h==C){ba={authPin:forge.util.encode64(a7),issuerDn:aw(aM.signCert.issuer),serialNo:aM.signCert.serialNumber};if(aS&d){ba.endSession="true";}}else{if(aS&d){if(aV){ba={authPin:forge.util.encode64(a7),seqNum:aV,endSession:"true"};}else{ba={authPin:forge.util.encode64(a7),endSession:"true"};}}else{ba={authPin:forge.util.encode64(a7)};}}a9=encryptKeyBlock(JSON.stringify(ba),aY.client);}catch(bb){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,bb);if(a8){a8("");}return "";}if(h==ai&&aS&d){D.userAuthSign(aP,a9,a0);}else{D.userAuth(aP,a9,a0);}};var a0=function(bc){if(!bc){if(a8){a8("");}return "";}var bp=-1;var bm=-1;var bl="";var be=-1;var ba=-1;var a9="";var bh="";var br;try{br=decryptKeyBlock(bc,aY.server);}catch(bo){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,bo);if(a8){a8("");}return "";}if(!br){am.setError(am.ERROR_SESSION_DECRYPT_FAILED);if(a8){a8("");}return "";}try{var bi=JSON.parse(br);bp=parseInt(bi.resultCode);if(bi.certStatusCode){bm=parseInt(bi.certStatusCode);}if(bi.deviceSecret){bl=bi.deviceSecret;}if(bi.policyCount){be=parseInt(bi.policyCount);}if(bi.failCount){ba=parseInt(bi.failCount);}if(bi.serverSign){a9=bi.serverSign;}if(bi.serverNonce){bh=bi.serverNonce;}if(bi.useDelayOption){useDelayOption=bi.useDelayOption;}if(bi.useDeletePinOption){useDeletePinOption=bi.useDeletePinOption;}if(bi.noDelayTryCount){noDelayTryCount=parseInt(bi.noDelayTryCount);}if(bi.delayTime){delayTime=parseInt(bi.delayTime);}}catch(bo){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,bo);if(a8){a8("");}return "";}if(bp==T){if(h==y||h==C){var bq=a7+bl+a4.input;if(U.checkPrivateKey(aM.signKey,bq,au)!=0){am.setError(am.ERROR_VERIFYCERTPASSWORD);if(a8){a8("");}return "";}}else{if(aS&d){if(!a9){am.setError(am.ERROR_INVALID_SERVER_RESPONSE);if(a8){a8("");}return "";}}}var bb=function(){setSessionR2(aW,bl);if(h==y||h==C){}else{setSessionSigned(aW,aV,bh,a9);}if(a8){a8(aE);}return aE;};aS=parseInt(aS);if(aS&V){bm=ar;}if((h==y||h==C)&&bm==ar){var bd=function(bu){if(!(bu==undefined||bu==0)){am.setError(am.ERROR_CERT_RENEW_REGISTRATION_FAILED);if(a8){a8("");}return "";}var bt=function(by,bE){if(by){am.setError(am.ERROR_PUBKEY_GENERATEKEYPAIR_FAILED);if(a8){a8(-1);}return-1;}var bF=a7+bl+a4.input;if(h==C){if(typeof XDomainRequest!="undefined"||af()<11&&af()!=false){a5=bE;}aT=bE;var bA=bl;var bC=256;var bD=signData(aM.signCert,aM.signKey,bF,bA,bC,a3);bF="";var bw=[];bw.push({certificate:null,privateKey:aT.privateKey,publicKey:aT.publicKey,vid:null,signedData:bD});bn(bw);}else{a5=bE;var bB=aj.getWebCMPType(Number(aL));var bv=aj.getWebCMPpKeyID(Number(aL));var bx=aj.getWebCMPOnlySignCert(Number(aL));var bz=aj.getCmpClient(bB,bv,aX,F,f,bx);if(typeof XDomainRequest!="undefined"||af()<11&&af()!=false){if(!bz){am.setError(am.ERROR_RENEWCERT);if(a8){a8(-1);}return-1;}bz.setKeyPair(a5);}if(!bz){am.setError(am.ERROR_RENEWCERT);if(a8){a8("");}return "";}bz.update(aM.signCert,aM.signKey,aM.kmCert,aM.kmKey,aM.signCert.serialNumber,bF,1,function(bG){if(bG===sofo.error){am.setError(am.ERROR_RENEWCERT);a8("");return "";}bF="";bn(bG);});}};if(typeof XDomainRequest!="undefined"||af()<11&&af()!=false||h==C){forge.pki.rsa.generateKeyPair({bits:2048,e:65537,workers:F,workerScript:f},bt);}else{bt(null,undefined);}};var bs=getDeviceID(aW,aN);var bn=function(bv){var by;var bw=function(bI){if(!bI){if(a8){a8("");}return "";}var bD="";var bJ;try{bJ=decryptKeyBlock(bI,aY.server);}catch(bH){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,bH);if(a8){a8("");}return "";}if(!bJ){am.setError(am.ERROR_SESSION_DECRYPT_FAILED);if(a8){a8("");}return "";}try{var bE=JSON.parse(bJ);var bC=-1;bD=bE.deviceSecret;if(h==C){if(typeof bE.resultCode!=="undefined"){bC=parseInt(bE.resultCode);if(bC===O){if(aS&ay){return bb();}else{am.setError(am.ERROR_CERT_RENEW_REQUESTSIGNEDMESSAGE_VERIFY_FAILED);if(a8){a8("");}return "";}}}var bG=bE.signCertData;var bA=forge.util.decode64(bG);bv[0].certificate=forge.pki.certificateFromAsn1(forge.asn1.fromDer(forge.util.createBuffer(bA)),true);}}catch(bH){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,bH);if(a8){a8("");}return "";}var bK=a7+bD+a4.input;var bF=U.certificateFromCMP(bv[0].certificate,bv[0].privateKey,bv[1]?bv[1].certificate:null,bv[1]?bv[1].privateKey:null,bK,bv[0].vid,au);if(!bF){var bB=function(){am.setError(am.ERROR_IMPORTCERT_FAIL);if(a8){a8("");}return "";};return D.storage.deletePinData(aW,bB);}var bz=function(bM){if(bM!=0){var bL=function(){if(a8){a8("");}return "";};return D.storage.deletePinData(aW,bL);}setSessionR2(aW,bD);if(a8){a8(aB);}return aB;};D.storage.updatePinData(aW,a4.type,bF,by,bz);};try{var bu;var bt=function(bB,bD){if(bB){am.setError(am.ERROR_PUBKEY_GENERATEKEYPAIR_FAILED);if(a8){a8(-1);}return-1;}by=bD;var bE=forge.asn1.toDer(forge.pki.publicKeyToRSAPublicKey(by.publicKeyPkcs7?by.publicKeyPkcs7:by.publicKey)).getBytes();if(h==C){var bz=forge.asn1.toDer(forge.pki.rsa.publicKeyToAsn1(bv[0].publicKey)).getBytes();var bC=forge.util.encode64(bz);var bA={deviceId:bs,newAnypinPubkey:forge.util.encode64(bE),oldCertSignData:bv[0].signedData,newSignPubKey:bC};bu=encryptKeyBlock(JSON.stringify(bA),aY.client);D.certUpdate(aP,bu,bw);}else{var bA={deviceId:bs,deviceSecret:bl,newAnypinPubkey:forge.util.encode64(bE),issuerDn:aw(bv[0].certificate.issuer),serialNo:bv[0].certificate.serialNumber,issueDate:n(bv[0].certificate.validity.notBefore),expireDate:n(bv[0].certificate.validity.notAfter)};bu=encryptKeyBlock(JSON.stringify(bA),aY.client);D.certUpdate(aP,bu,bw);}};}catch(bx){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,bx);if(a8){a8("");}return "";}if(typeof a5!=="undefined"){bt(null,a5);}else{forge.pki.rsa.generateKeyPair({bits:2048,e:65537,workers:F,workerScript:f,algorithmName:"RSA-OAEP"},bt);}};if(h==C){return bd();}else{if(typeof aR=="function"){var bf={id:aW,deviceId:bs};return aR(bd,bf);}else{return bb();}}}else{return bb();}}else{if(bp==S){am.setError(am.ERROR_USER_AUTH_PIN_NOT_MATHCH);if(be>0&&ba>0){if(typeof useDeletePinOption!="undefined"&&useDeletePinOption=="no"){am.setError(am.ERROR_USER_AUTH_PIN_DELAY);am.addErrorMsg(noDelayTryCount-ba);}else{am.addErrorMsg(be-ba);}}if(typeof delayTime!="undefined"){var bg=parseInt(delayTime/1000)%60;var bk=parseFloat(delayTime/(1000*60)%60).toFixed(2);if(noDelayTryCount<ba){if(useDeletePinOption=="yes"){if(bk<1){am.setError(am.ERROR_USER_AUTH_PIN_DELAY_TIME_SECONDS_DELETE);am.addErrorMsg("\n"+(be-ba)+" / "+bg);}else{am.setError(am.ERROR_USER_AUTH_PIN_DELAY_TIME_MINUTES_DELETE);am.addErrorMsg("\n"+(be-ba)+" / "+bk);}}else{if(bk<1){am.setError(am.ERROR_USER_AUTH_PIN_DELAY_TIME_SECONDS);am.addErrorMsg("\n"+bg);}else{am.setError(am.ERROR_USER_AUTH_PIN_DELAY_TIME_MINUTES);am.addErrorMsg("\n"+bk);}}}}if(a8){a8("");}return "";}else{if(bp==R){var bj=function(){am.setError(am.ERROR_USER_AUTH_FAILED_AND_DELETE);if(a8){a8("");}return "";};return D.storage.deletePinData(aW,bj);}else{if(bp==Q){var bj=function(){am.setError(am.ERROR_USER_AUTH_CERT_EXPIRED_AND_DELETE);if(a8){a8("");}return "";};return D.storage.deletePinData(aW,bj);}else{am.setError(am.ERROR_SERVER_API_USER_AUTH);if(a8){a8("");}return "";}}}}};return D.storage.getPinData(aW,aZ);};D.endSession=function(aN,aR){if(!aN){am.setError(am.ERROR_INVALID_PARAM);if(aR){aR(-1);}return-1;}if(!isSession(aN)){if(!isRegistSession(aN)){am.setError(am.ERROR_SESSION_NOT_VALID);if(aR){aR(-1);}return-1;}resetRegistSession();if(aR){aR(0);}return 0;}var aL=getSession();var aP=aL.index;var aS=aL.keyBlock;var aT;var aO={userId:aN};try{aT=encryptKeyBlock(JSON.stringify(aO),aS.client);}catch(aQ){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,aQ);if(aR){aR(-1);}return-1;}var aM=function(aU){resetRegistSession();resetSession();if(aU!=0){if(aR){aR(-1);}return-1;}else{if(aR){aR(0);}return 0;}};return D.userEndSession(aP,aT,aM);};var aG=256;var Z=512;var aI=4096;var o=65536;var ab=8388608;D.signPin=function(aM,aR,aP,aO,aN,aS){if(!aM){am.setError(am.ERROR_INVALID_PARAM);if(aS){aS("");}return "";}if(typeof aN!="number"||aN&~(aG+Z+aI+o+ab)){am.setError(am.ERROR_INVALID_PARAM);if(aS){aS("");}return "";}if(h==y||h==C){var aQ=b(aR);if(!aQ||!aQ.input){am.setError(am.ERROR_INVALID_PARAM);if(aS){aS("");}return "";}if(!isSessionR2(aM)){am.setError(am.ERROR_SESSION_NOT_VALID);if(aS){aS("");}return "";}var aL=getSession();if(aQ.type==aC){if(!isSessionFacephiSecret(aM)){am.setError(am.ERROR_SESSION_NOT_VALID);if(aS){aS("");}return "";}aQ.input=aL.facephiSecret;}var aU=function(aY){if(!aY){if(aS){aS("");}return "";}var a2=aY.userCert;if(!a2||!a2.signCert||!a2.signKey){am.setError(am.ERROR_PIN_NOT_VALID);if(aS){aS("");}return "";}var aW;try{var a1=aY.fid;aW=gen_hf1(a1,aQ.input);}catch(a0){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,a0);if(aS){aS("");}return "";}var aZ=aW+aL.r2+aQ.input;var aX=signData(a2.signCert,a2.signKey,aZ,aP,aN,aO);if(!aX){if(aS){aS("");}return "";}else{resetSession();if(aS){aS(aX);}return aX;}};return D.storage.getPinData(aM,aU);}else{if(!isSessionSigned(aM)){am.setError(am.ERROR_SESSION_NOT_VALID);if(aS){aS("");}return "";}var aL=getSession();var aV="id="+aM+"&apnsv="+forge.util.bytesToHex(aL.keyBlock.apnsv);if(aL.seqnum){aV+="&seqnum=";aV+=aL.seqnum;}var aT=convertSignedData(aL.signed,aV,aN,aO);if(!aT){if(aS){aS("");}return "";}else{resetSession();if(aS){aS(aT);}return aT;}}};D.deletePin=function(aN,aO,aR){if(!aN){am.setError(am.ERROR_INVALID_PARAM);if(aR){aR(-1);}return-1;}if(!isSession(aN)){am.setError(am.ERROR_SESSION_NOT_VALID);if(aR){aR(-1);}return-1;}var aL=getSession();var aP=aL.index;var aS=aL.keyBlock;var aT=function(aU){if(!aU){if(aR){aR(-1);}return-1;}var aV;try{var aZ=aU.fid;var aY=getDeviceID(aN,aZ);var aW={deviceId:aY};aV=encryptKeyBlock(JSON.stringify(aW),aS.client);}catch(aX){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,aX);if(aR){aR(-1);}return-1;}if(aO==1&&aU.type==aC){D.userFacephiDel(aP,aV,aQ);}else{D.userDelete(aP,aV,aQ);}};var aQ=function(aU){if(aU!=0){if(aR){aR(-1);}return-1;}D.storage.deletePinData(aN,aM);};var aM=function(aU){if(aU!=0){if(aR){aR(-1);}return-1;}else{resetSession();if(aR){aR(0);}return 0;}};return D.storage.getPinData(aN,aT);};D.deleteAllPin=function(aN,aO,aR){if(!aN){am.setError(am.ERROR_INVALID_PARAM);if(aR){aR(-1);}return-1;}if(!isSessionR2(aN)){am.setError(am.ERROR_SESSION_NOT_VALID);if(aR){aR(-1);}return-1;}var aL=getSession();var aP=aL.index;var aS=aL.keyBlock;var aT=function(aU){if(!aU){if(aR){aR(-1);}return-1;}var aV;try{var aZ=aU.fid;var aY=getDeviceID(aN,aZ);var aW={deviceId:aY,deviceSecret:aL.r2};aV=encryptKeyBlock(JSON.stringify(aW),aS.client);}catch(aX){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,aX);if(aR){aR(-1);}return-1;}D.userLeave(aP,aV,aQ);};var aQ=function(aU){if(aU!=0){if(aR){aR(-1);}return-1;}D.storage.deletePinData(aN,aM);};var aM=function(aU){if(aU!=0){if(aR){aR(-1);}return-1;}else{resetSession();if(aR){aR(0);}return 0;}};return D.storage.getPinData(aN,aT);};D.deletePinLocal=function(aP,aO,aM){if(!aP){am.setError(am.ERROR_INVALID_PARAM);if(aM){aM(-1);}return-1;}var aN=function(aQ){if(!aQ){if(aM){aM(-1);}return-1;}D.storage.deletePinData(aP,aL);};var aL=function(aQ){if(aQ!=0){if(aM){aM(-1);}return-1;}else{if(aM){aM(0);}return 0;}};return D.storage.getPinData(aP,aN);};D.changePin=function(aS,aV,a1,aQ,a2){if(!aS){am.setError(am.ERROR_INVALID_PARAM);if(a2){a2(-1);}return-1;}var aP=b(aV);if(!aP||!aP.input){am.setError(am.ERROR_INVALID_PARAM);if(a2){a2(-1);}return-1;}var aW=b(a1);if(!aW||!aW.input){am.setError(am.ERROR_INVALID_PARAM);if(a2){a2(-1);}return-1;}if(!isSessionR2(aS)){am.setError(am.ERROR_SESSION_NOT_VALID);if(a2){a2(-1);}return-1;}var aN=getSession();var aO=aN.index;var aT=aN.keyBlock;var aZ;var aM;var a0;var a3;var aY;var aX;var aL;var aU=function(a6){if(!a6){if(a2){a2(-1);}return-1;}aZ=a6;aL=aZ.userCert;if(h==y||h==C){if(!aL||!aL.signCert||!aL.signKey){am.setError(am.ERROR_PIN_NOT_VALID);if(a2){a2(-1);}return-1;}}var a5=function(bb,be){if(bb){am.setError(am.ERROR_PUBKEY_GENERATEKEYPAIR_FAILED);if(a2){a2(-1);}return-1;}try{aM=aZ.fid;a3=gen_hf1(aM,aP.input);}catch(bd){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,bd);if(a2){a2(-1);}return-1;}var a8=aN.r2;if(h==y||h==C){aX=a3+a8+aP.input;if(U.checkPrivateKey(aZ.userCert.signKey,aX,au)!=0){am.setError(am.ERROR_VERIFYCERTPASSWORD);if(a2){a2(-1);}return-1;}}var ba;try{a0=be;aY=gen_hf1(aM,aW.input);var bc=getDeviceID(aS,aM);var a7=forge.asn1.toDer(forge.pki.publicKeyToRSAPublicKey(a0.publicKeyPkcs7?a0.publicKeyPkcs7:a0.publicKey)).getBytes();var a9={deviceId:bc,deviceSecret:a8,newAnypinPubkey:forge.util.encode64(a7),newAuthPin:forge.util.encode64(aY)};ba=encryptKeyBlock(JSON.stringify(a9),aT.client);}catch(bd){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,bd);if(a2){a2(-1);}return-1;}D.userUpdate(aO,ba,a4);};forge.pki.rsa.generateKeyPair({bits:2048,e:65537,workers:F,workerScript:f,algorithmName:"RSA-OAEP"},a5);};var a4=function(bb){if(!bb){if(a2){a2(-1);}return-1;}var a8;var a5;try{a5=decryptKeyBlock(bb,aT.server);}catch(a9){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,a9);if(a2){a2(-1);}return-1;}if(!a5){am.setError(am.ERROR_SESSION_DECRYPT_FAILED);if(a2){a2(-1);}return-1;}try{var a6=JSON.parse(a5);a8=a6.deviceSecret;}catch(a9){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,a9);if(a2){a2(-1);}return-1;}if(h==y||h==C){var a7=aY+a8+aW.input;var bc=U.changeEncryptPrivateKey(aL.signKey,aX,a7,au);if(!bc){am.setError(am.ERROR_CHANGECERTPASSWORD);if(a2){a2(-1);}return-1;}var ba=null;if(aL.kmCert&&aL.kmKey){ba=U.changeEncryptPrivateKey(aL.kmKey,aX,a7,au);if(!ba){am.setError(am.ERROR_CHANGECERTPASSWORD);if(a2){a2(-1);}return-1;}}aZ.userCert.signKey=bc;aZ.userCert.kmKey=ba;}D.storage.updatePinData(aS,aW.type,aZ.userCert,a0,aR);};var aR=function(a5){if(a5!=0){if(a2){a2(-1);}return-1;}else{resetSession();if(a2){a2(0);}return 0;}};return D.storage.getPinData(aS,aU);};D.readDeviceInfoList=function(aQ,aY,aU,aR,aV){if(!aQ){am.setError(am.ERROR_INVALID_PARAM);if(aCallback){aCallback(-1);}return-1;}if(!aY||parseInt(aY)<1){am.setError(am.ERROR_INVALID_PARAM);if(aCallback){aCallback(-1);}return-1;}if(!aU||parseInt(aU)<1){am.setError(am.ERROR_INVALID_PARAM);if(aCallback){aCallback(-1);}return-1;}if(!isSessionR2(aQ)){am.setError(am.ERROR_SESSION_NOT_VALID);if(aCallback){aCallback(-1);}return-1;}var aL=getSession();var aS=aL.index;var aX=aL.keyBlock;var aN=parseInt(aY);var aW=parseInt(aU);var aM=aL.r2;var aZ;try{var aP={deviceSecret:aM,countPerPage:aN,pageNo:aW};aZ=encryptKeyBlock(JSON.stringify(aP),aX.client);}catch(aT){am.setError(am.ERROR_SESSION_ENCRYPT_FAILED,aT);if(aCallback){aCallback(-1);}return-1;}var aO=function(a4){if(!a4){if(aCallback){aCallback(-1);}return-1;}var a2;var a0;try{a0=decryptKeyBlock(a4,aX.server);}catch(a3){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,a3);if(aCallback){aCallback(-1);}return-1;}if(!a0){am.setError(am.ERROR_SESSION_DECRYPT_FAILED);if(aCallback){aCallback(-1);}return-1;}try{var a1=JSON.parse(a0);a2=a1;}catch(a3){am.setError(am.ERROR_SESSION_DECRYPT_FAILED,a3);if(aCallback){aCallback(-1);}return-1;}if(typeof a2!=="array"){resetSession();am.setError(am.ERROR_SESSION_DECRYPT_FAILED,a3);if(aCallback){aCallback(-1);}return-1;}resetSession();if(aCallback){aCallback(a2);}return 0;};D.deviceList(aS,aZ,aO);};})();(function(){function c(N){var O=function(ag,ar,am,af){var al=N.util.createBuffer();var au=ag.length>>1;var ao=au+(ag.length&1);var aw=ag.substr(0,ao);var at=ag.substr(au,ao);var aq=N.util.createBuffer();var an=N.hmac.create();am=ar+am;var aj=Math.ceil(af/16);var ak=Math.ceil(af/20);an.start("MD5",aw);var av=N.util.createBuffer();aq.putBytes(am);for(var ah=0;ah<aj;++ah){an.start(null,null);an.update(aq.getBytes());aq.putBuffer(an.digest());an.start(null,null);an.update(aq.bytes()+am);av.putBuffer(an.digest());}an.start("SHA1",at);var ap=N.util.createBuffer();aq.clear();aq.putBytes(am);for(var ah=0;ah<ak;++ah){an.start(null,null);an.update(aq.getBytes());aq.putBuffer(an.digest());an.start(null,null);an.update(aq.bytes()+am);ap.putBuffer(an.digest());}al.putBytes(N.util.xorBytes(av.getBytes(),ap.getBytes(),af));return al;};var n=function(ah,ap,al,af){var ak=N.util.createBuffer();var an=N.util.createBuffer();var am=N.hmac.create();al=ap+al;var ag=Math.ceil(af/32)+1;var ao=N.md.sha256.create();am.start(ao,ah);var aq=N.util.createBuffer();an.putBytes(al);for(var aj=0;aj<ag;++aj){am.start(null,null);am.update(an.getBytes());an.putBuffer(am.digest());am.start(null,null);am.update(an.bytes()+al);aq.putBuffer(am.digest());}ak.putBytes(aq.getBytes(af));return ak;};var r=function(ah,aj,ag){var ai=N.hmac.create();ai.start("SHA1",ah);var af=N.util.createBuffer();af.putInt32(aj[0]);af.putInt32(aj[1]);af.putByte(ag.type);af.putByte(ag.version.major);af.putByte(ag.version.minor);af.putInt16(ag.length);af.putBytes(ag.fragment.bytes());ai.update(af.getBytes());return ai.digest().getBytes();};var E=function(ak,ag,ai){var aj=false;try{var af=ak.deflate(ag.fragment.getBytes());ag.fragment=N.util.createBuffer(af);ag.length=af.length;aj=true;}catch(ah){console.log("Exception : sf_tls - deflate");}return aj;};var y=function(ak,ag,ai){var aj=false;try{var af=ak.inflate(ag.fragment.getBytes());ag.fragment=N.util.createBuffer(af);ag.length=af.length;aj=true;}catch(ah){console.log("Exception : sf_tls - inflate");}return aj;};var m=function(ah,ag){var af=0;switch(ag){case 1:af=ah.getByte();break;case 2:af=ah.getInt16();break;case 3:af=ah.getInt24();break;case 4:af=ah.getInt32();break;default:}return N.util.createBuffer(ah.getBytes(af));};var v=function(ag,af,ah){ag.putInt(ah.length(),af<<3);ag.putBuffer(ah);};var o={};o.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};o.SupportedVersions=[o.Versions.TLS_1_1,o.Versions.TLS_1_0];o.Version=o.SupportedVersions[0];o.MaxFragment=16384-1024;o.ConnectionEnd={server:0,client:1};o.PRFAlgorithm={tls_prf_sha256:0};o.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};o.CipherType={stream:0,block:1,aead:2};o.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};o.CompressionMethod={none:0,deflate:1};o.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};o.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};o.Alert={};o.Alert.Level={warning:1,fatal:2};o.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};o.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};o.CipherSuites={};o.getCipherSuite=function(af){var ai=null;for(var ag in o.CipherSuites){var ah=o.CipherSuites[ag];if(ah.id[0]===af.charCodeAt(0)&&ah.id[1]===af.charCodeAt(1)){ai=ah;break;}}return ai;};o.handleUnexpected=function(ah,af){var ag=!ah.open&&ah.entity===o.ConnectionEnd.client;if(!ag){ah.error(ah,{message:"Unexpected message. Received TLS record out of order.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unexpected_message}});}};o.handleHelloRequest=function(ah,af,ag){if(!ah.handshaking&&ah.handshakes>0){o.queue(ah,o.createAlert(ah,{level:o.Alert.Level.warning,description:o.Alert.Description.no_renegotiation}));o.flush(ah);}ah.process();};o.parseHelloMessage=function(ap,ao,ah){var ai=null;var aj=ap.entity===o.ConnectionEnd.client;if(ah<38){ap.error(ap,{message:aj?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});}else{var ar=ao.fragment;var ak=ar.length();ai={version:{major:ar.getByte(),minor:ar.getByte()},random:N.util.createBuffer(ar.getBytes(32)),session_id:m(ar,1),extensions:[]};if(aj){ai.cipher_suite=ar.getBytes(2);ai.compression_method=ar.getByte();}else{ai.cipher_suites=m(ar,2);ai.compression_methods=m(ar,1);}ak=ah-(ak-ar.length());if(ak>0){var al=m(ar,2);while(al.length()>0){ai.extensions.push({type:[al.getByte(),al.getByte()],data:m(al,2)});}if(!aj){for(var an=0;an<ai.extensions.length;++an){var ag=ai.extensions[an];if(ag.type[0]===0&&ag.type[1]===0){var af=m(ag.data,2);while(af.length()>0){var aq=af.getByte();if(aq!==0){break;}ap.session.extensions.server_name.serverNameList.push(m(af,2).getBytes());}}}}}if(ap.session.version){if(ai.version.major!==ap.session.version.major||ai.version.minor!==ap.session.version.minor){return ap.error(ap,{message:"TLS version change is disallowed during renegotiation.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.protocol_version}});}}if(aj){ap.session.cipherSuite=o.getCipherSuite(ai.cipher_suite);}else{var am=N.util.createBuffer(ai.cipher_suites.bytes());while(am.length()>0){ap.session.cipherSuite=o.getCipherSuite(am.getBytes(2));if(ap.session.cipherSuite!==null){break;}}}if(ap.session.cipherSuite===null){return ap.error(ap,{message:"No cipher suites in common.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.handshake_failure},cipherSuite:N.util.bytesToHex(ai.cipher_suite)});}if(aj){ap.session.compressionMethod=ai.compression_method;}else{ap.session.compressionMethod=o.CompressionMethod.none;}}return ai;};o.createSecurityParameters=function(ak,ah){var af=ak.entity===o.ConnectionEnd.client;var ag=ah.random.bytes();var aj=af?ak.session.sp.client_random:ag;var ai=af?ag:o.createRandom().getBytes();ak.session.sp={entity:ak.entity,prf_algorithm:o.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:ak.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:aj,server_random:ai};};o.handleServerHello=function(aj,af,ag){var ai=o.parseHelloMessage(aj,af,ag);if(aj.fail){return;}if(ai.version.minor<=aj.version.minor){aj.version.minor=ai.version.minor;}else{return aj.error(aj,{message:"Incompatible TLS version.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.protocol_version}});}aj.session.version=aj.version;var ah=ai.session_id.bytes();if(ah.length>0&&ah===aj.session.id){aj.expect=S;aj.session.resuming=true;aj.session.sp.server_random=ai.random.bytes();}else{aj.expect=R;aj.session.resuming=false;o.createSecurityParameters(aj,ai);}aj.session.id=ah;aj.process();};o.handleClientHello=function(am,ag,ai){var al=o.parseHelloMessage(am,ag,ai);if(am.fail){return;}var ak=al.session_id.bytes();var aj=null;if(am.sessionCache){aj=am.sessionCache.getSession(ak);if(aj===null){ak="";}else{if(aj.version.major!==al.version.major||aj.version.minor>al.version.minor){aj=null;ak="";}}}if(ak.length===0){ak=N.random.getBytes(32);}am.session.id=ak;am.session.clientHelloVersion=al.version;am.session.sp={};if(aj){am.version=am.session.version=aj.version;am.session.sp=aj.sp;}else{var af;for(var ah=1;ah<o.SupportedVersions.length;++ah){af=o.SupportedVersions[ah];if(af.minor<=al.version.minor){break;}}am.version={major:af.major,minor:af.minor};am.session.version=am.version;}if(aj!==null){am.expect=H;am.session.resuming=true;am.session.sp.client_random=al.random.bytes();}else{am.expect=am.verifyClient!==false?F:l;am.session.resuming=false;o.createSecurityParameters(am,al);}am.open=true;o.queue(am,o.createRecord(am,{type:o.ContentType.handshake,data:o.createServerHello(am)}));if(am.session.resuming){o.queue(am,o.createRecord(am,{type:o.ContentType.change_cipher_spec,data:o.createChangeCipherSpec()}));am.state.pending=o.createConnectionState(am);am.state.current.write=am.state.pending.write;o.queue(am,o.createRecord(am,{type:o.ContentType.handshake,data:o.createFinished(am)}));}else{o.queue(am,o.createRecord(am,{type:o.ContentType.handshake,data:o.createCertificate(am)}));if(!am.fail){o.queue(am,o.createRecord(am,{type:o.ContentType.handshake,data:o.createServerKeyExchange(am)}));if(am.verifyClient!==false){o.queue(am,o.createRecord(am,{type:o.ContentType.handshake,data:o.createCertificateRequest(am)}));}o.queue(am,o.createRecord(am,{type:o.ContentType.handshake,data:o.createServerHelloDone(am)}));}}o.flush(am);am.process();};o.handleCertificate=function(an,al,af){if(af<3){return an.error(an,{message:"Invalid Certificate message. Message too short.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});}var ao=al.fragment;var ag={certificate_list:m(ao,3)};var aj,ai;var ak=[];try{while(ag.certificate_list.length()>0){aj=m(ag.certificate_list,3);ai=N.asn1.fromDer(aj);aj=N.pki.certificateFromAsn1(ai,true);ak.push(aj);}}catch(am){return an.error(an,{message:"Could not parse certificate list.",cause:am,send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.bad_certificate}});}var ah=an.entity===o.ConnectionEnd.client;if((ah||an.verifyClient===true)&&ak.length===0){an.error(an,{message:ah?"No server certificate provided.":"No client certificate provided.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});}else{if(ak.length===0){an.expect=ah?s:l;}else{if(ah){an.session.serverCertificate=ak[0];}else{an.session.clientCertificate=ak[0];}if(o.verifyCertificateChain(an,ak)){an.expect=ah?s:l;}}}an.process();};o.handleServerKeyExchange=function(ah,af,ag){if(ag>0){return ah.error(ah,{message:"Invalid key parameters. Only RSA is supported.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unsupported_certificate}});}ah.expect=G;ah.process();};o.handleClientKeyExchange=function(al,ai,ag){if(ag<48){return al.error(al,{message:"Invalid key parameters. Only RSA is supported.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unsupported_certificate}});}var am=ai.fragment;var ah={enc_pre_master_secret:m(am,2).getBytes()};var an=null;if(al.getPrivateKey){try{an=al.getPrivateKey(al,al.session.serverCertificate);an=N.pki.privateKeyFromPem(an);}catch(ak){al.error(al,{message:"Could not get private key.",cause:ak,send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}});}}if(an===null){return al.error(al,{message:"No private key set.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}});}try{var af=al.session.sp;af.pre_master_secret=an.decrypt(ah.enc_pre_master_secret);var aj=al.session.clientHelloVersion;if(aj.major!==af.pre_master_secret.charCodeAt(0)||aj.minor!==af.pre_master_secret.charCodeAt(1)){throw new Error("TLS version rollback attack detected.");}}catch(ak){af.pre_master_secret=N.random.getBytes(48);}al.expect=H;if(al.session.clientCertificate!==null){al.expect=C;}al.process();};o.handleCertificateRequest=function(aj,ag,ah){if(ah<3){return aj.error(aj,{message:"Invalid CertificateRequest. Message too short.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});}var af=ag.fragment;var ai={certificate_types:m(af,1),certificate_authorities:m(af,2)};aj.session.certificateRequest=ai;aj.expect=q;aj.process();};o.handleCertificateVerify=function(al,aj,af){if(af<2){return al.error(al,{message:"Invalid CertificateVerify. Message too short.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});}var an=aj.fragment;an.read-=4;var ah=an.bytes();an.read+=4;var ag={signature:m(an,2).getBytes()};var am=N.util.createBuffer();am.putBuffer(al.session.md5.digest());am.putBuffer(al.session.sha1.digest());am=am.getBytes();try{var ai=al.session.clientCertificate;if(!ai.publicKey.verify(am,ag.signature,"NONE")){throw new Error("CertificateVerify signature does not match.");}al.session.md5.update(ah);al.session.sha1.update(ah);}catch(ak){return al.error(al,{message:"Bad signature in CertificateVerify.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.handshake_failure}});}al.expect=H;al.process();};o.handleServerHelloDone=function(al,af,ai){if(ai>0){return al.error(al,{message:"Invalid ServerHelloDone message. Invalid length.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.record_overflow}});}if(al.serverCertificate===null){var ah={message:"No server certificate provided. Not enough security.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.insufficient_security}};var aj=0;var ag=al.verify(al,ah.alert.description,aj,[]);if(ag!==true){if(ag||ag===0){if(typeof ag==="object"&&!N.util.isArray(ag)){if(ag.message){ah.message=ag.message;}if(ag.alert){ah.alert.description=ag.alert;}}else{if(typeof ag==="number"){ah.alert.description=ag;}}}return al.error(al,ah);}}if(al.session.certificateRequest!==null){af=o.createRecord(al,{type:o.ContentType.handshake,data:o.createCertificate(al)});o.queue(al,af);}af=o.createRecord(al,{type:o.ContentType.handshake,data:o.createClientKeyExchange(al)});o.queue(al,af);al.expect=g;var ak=function(an,am){if(an.session.certificateRequest!==null&&an.session.clientCertificate!==null){o.queue(an,o.createRecord(an,{type:o.ContentType.handshake,data:o.createCertificateVerify(an,am)}));}o.queue(an,o.createRecord(an,{type:o.ContentType.change_cipher_spec,data:o.createChangeCipherSpec()}));an.state.pending=o.createConnectionState(an);an.state.current.write=an.state.pending.write;o.queue(an,o.createRecord(an,{type:o.ContentType.handshake,data:o.createFinished(an)}));an.expect=S;o.flush(an);an.process();};if(al.session.certificateRequest===null||al.session.clientCertificate===null){return ak(al,null);}o.getClientSignature(al,ak);};o.handleChangeCipherSpec=function(ah,ag){if(ag.fragment.getByte()!==1){return ah.error(ah,{message:"Invalid ChangeCipherSpec message received.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});}var af=ah.entity===o.ConnectionEnd.client;if(ah.session.resuming&&af||!ah.session.resuming&&!af){ah.state.pending=o.createConnectionState(ah);}ah.state.current.read=ah.state.pending.read;if(!ah.session.resuming&&af||ah.session.resuming&&!af){ah.state.pending=null;}ah.expect=af?P:D;ah.process();};o.handleFinished=function(an,al,ah){var ao=al.fragment;ao.read-=4;var ai=ao.bytes();ao.read+=4;var am=al.fragment.getBytes();ao=N.util.createBuffer();ao.putBuffer(an.session.md5.digest());ao.putBuffer(an.session.sha1.digest());var ak=an.entity===o.ConnectionEnd.client;var ap=ak?"server finished":"client finished";var af=an.session.sp;var ag=12;var aj=O;ao=aj(af.master_secret,ap,ao.getBytes(),ag);if(ao.getBytes()!==am){return an.error(an,{message:"Invalid verify_data in Finished message.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.decrypt_error}});}an.session.md5.update(ai);an.session.sha1.update(ai);if(an.session.resuming&&ak||!an.session.resuming&&!ak){o.queue(an,o.createRecord(an,{type:o.ContentType.change_cipher_spec,data:o.createChangeCipherSpec()}));an.state.current.write=an.state.pending.write;an.state.pending=null;o.queue(an,o.createRecord(an,{type:o.ContentType.handshake,data:o.createFinished(an)}));}an.expect=ak?B:z;an.handshaking=false;++an.handshakes;an.peerCertificate=ak?an.session.serverCertificate:an.session.clientCertificate;o.flush(an);an.isConnected=true;an.connected(an);an.process();};o.handleAlert=function(aj,ag){var af=ag.fragment;var ai={level:af.getByte(),description:af.getByte()};var ah;switch(ai.description){case o.Alert.Description.close_notify:ah="Connection closed.";break;case o.Alert.Description.unexpected_message:ah="Unexpected message.";break;case o.Alert.Description.bad_record_mac:ah="Bad record MAC.";break;case o.Alert.Description.decryption_failed:ah="Decryption failed.";break;case o.Alert.Description.record_overflow:ah="Record overflow.";break;case o.Alert.Description.decompression_failure:ah="Decompression failed.";break;case o.Alert.Description.handshake_failure:ah="Handshake failure.";break;case o.Alert.Description.bad_certificate:ah="Bad certificate.";break;case o.Alert.Description.unsupported_certificate:ah="Unsupported certificate.";break;case o.Alert.Description.certificate_revoked:ah="Certificate revoked.";break;case o.Alert.Description.certificate_expired:ah="Certificate expired.";break;case o.Alert.Description.certificate_unknown:ah="Certificate unknown.";break;case o.Alert.Description.illegal_parameter:ah="Illegal parameter.";break;case o.Alert.Description.unknown_ca:ah="Unknown certificate authority.";break;case o.Alert.Description.access_denied:ah="Access denied.";break;case o.Alert.Description.decode_error:ah="Decode error.";break;case o.Alert.Description.decrypt_error:ah="Decrypt error.";break;case o.Alert.Description.export_restriction:ah="Export restriction.";break;case o.Alert.Description.protocol_version:ah="Unsupported protocol version.";break;case o.Alert.Description.insufficient_security:ah="Insufficient security.";break;case o.Alert.Description.internal_error:ah="Internal error.";break;case o.Alert.Description.user_canceled:ah="User canceled.";break;case o.Alert.Description.no_renegotiation:ah="Renegotiation not supported.";break;default:ah="Unknown error.";break;}if(ai.description===o.Alert.Description.close_notify){return aj.close();}aj.error(aj,{message:ah,send:false,origin:aj.entity===o.ConnectionEnd.client?"server":"client",alert:ai});aj.process();};o.handleHandshake=function(ak,ah){var af=ah.fragment;var ai=af.getByte();var aj=af.getInt24();if(aj>af.length()){ak.fragmented=ah;ah.fragment=N.util.createBuffer();af.read-=4;return ak.process();}ak.fragmented=null;af.read-=4;var ag=af.bytes(aj+4);af.read+=4;if(ai in Q[ak.entity][ak.expect]){if(ak.entity===o.ConnectionEnd.server&&!ak.open&&!ak.fail){ak.handshaking=true;ak.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:N.md.md5.create(),sha1:N.md.sha1.create()};}if(ai!==o.HandshakeType.hello_request&&ai!==o.HandshakeType.certificate_verify&&ai!==o.HandshakeType.finished){ak.session.md5.update(ag);ak.session.sha1.update(ag);}Q[ak.entity][ak.expect][ai](ak,ah,aj);}else{o.handleUnexpected(ak,ah);}};o.handleApplicationData=function(ag,af){ag.data.putBuffer(af.fragment);ag.dataReady(ag);ag.process();};o.handleHeartbeat=function(ak,ag){var af=ag.fragment;var ah=af.getByte();var ai=af.getInt16();var aj=af.getBytes(ai);if(ah===o.HeartbeatMessageType.heartbeat_request){if(ak.handshaking||ai>aj.length){return ak.process();}o.queue(ak,o.createRecord(ak,{type:o.ContentType.heartbeat,data:o.createHeartbeat(o.HeartbeatMessageType.heartbeat_response,aj)}));o.flush(ak);}else{if(ah===o.HeartbeatMessageType.heartbeat_response){if(aj!==ak.expectedHeartbeatPayload){return ak.process();}if(ak.heartbeatReceived){ak.heartbeatReceived(ak,N.util.createBuffer(aj));}}}ak.process();};var p=0;var R=1;var s=2;var G=3;var q=4;var S=5;var P=6;var B=7;var g=8;var h=0;var F=1;var l=2;var C=3;var H=4;var D=5;var z=6;var T=7;var ae=o.handleUnexpected;var M=o.handleChangeCipherSpec;var L=o.handleAlert;var K=o.handleHandshake;var J=o.handleApplicationData;var I=o.handleHeartbeat;var w=[];w[o.ConnectionEnd.client]=[[ae,L,K,ae,I],[ae,L,K,ae,I],[ae,L,K,ae,I],[ae,L,K,ae,I],[ae,L,K,ae,I],[M,L,ae,ae,I],[ae,L,K,ae,I],[ae,L,K,J,I],[ae,L,K,ae,I]];w[o.ConnectionEnd.server]=[[ae,L,K,ae,I],[ae,L,K,ae,I],[ae,L,K,ae,I],[ae,L,K,ae,I],[M,L,ae,ae,I],[ae,L,K,ae,I],[ae,L,K,J,I],[ae,L,K,ae,I]];var ad=o.handleHelloRequest;var ac=o.handleServerHello;var ab=o.handleCertificate;var aa=o.handleServerKeyExchange;var Z=o.handleCertificateRequest;var Y=o.handleServerHelloDone;var X=o.handleFinished;var Q=[];Q[o.ConnectionEnd.client]=[[ae,ae,ac,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ad,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ab,aa,Z,Y,ae,ae,ae,ae,ae,ae],[ad,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,aa,Z,Y,ae,ae,ae,ae,ae,ae],[ad,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,Z,Y,ae,ae,ae,ae,ae,ae],[ad,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,Y,ae,ae,ae,ae,ae,ae],[ad,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ad,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,X],[ad,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ad,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae]];var W=o.handleClientHello;var V=o.handleClientKeyExchange;var U=o.handleCertificateVerify;Q[o.ConnectionEnd.server]=[[ae,W,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ab,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,V,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,U,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,X],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae],[ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae,ae]];o.generateKeys=function(am,ak){var aj=O;var ai=ak.client_random+ak.server_random;if(!am.session.resuming){ak.master_secret=aj(ak.pre_master_secret,"master secret",ai,48).bytes();ak.pre_master_secret=null;}ai=ak.server_random+ak.client_random;var ah=2*ak.mac_key_length+2*ak.enc_key_length;var ag=am.version.major===o.Versions.TLS_1_0.major&&am.version.minor===o.Versions.TLS_1_0.minor;if(ag){ah+=2*ak.fixed_iv_length;}var af=aj(ak.master_secret,"key expansion",ai,ah);var al={client_write_MAC_key:af.getBytes(ak.mac_key_length),server_write_MAC_key:af.getBytes(ak.mac_key_length),client_write_key:af.getBytes(ak.enc_key_length),server_write_key:af.getBytes(ak.enc_key_length)};if(ag){al.client_write_IV=af.getBytes(ak.fixed_iv_length);al.server_write_IV=af.getBytes(ak.fixed_iv_length);}return al;};o.createConnectionState=function(aj){var ag=aj.entity===o.ConnectionEnd.client;var af=function(){var ak={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(al){return true;},compressionState:null,compressFunction:function(al){return true;},updateSequenceNumber:function(){if(ak.sequenceNumber[1]===4294967295){ak.sequenceNumber[1]=0;++ak.sequenceNumber[0];}else{++ak.sequenceNumber[1];}}};return ak;};var ai={read:af(),write:af()};ai.read.update=function(al,ak){if(!ai.read.cipherFunction(ak,ai.read)){al.error(al,{message:"Could not decrypt record or bad MAC.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.bad_record_mac}});}else{if(!ai.read.compressFunction(al,ak,ai.read)){al.error(al,{message:"Could not decompress record.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.decompression_failure}});}}return!al.fail;};ai.write.update=function(al,ak){if(!ai.write.compressFunction(al,ak,ai.write)){al.error(al,{message:"Could not compress record.",send:false,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}});}else{if(!ai.write.cipherFunction(ak,ai.write)){al.error(al,{message:"Could not encrypt record.",send:false,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}});}}return!al.fail;};if(aj.session){var ah=aj.session.sp;aj.session.cipherSuite.initSecurityParameters(ah);ah.keys=o.generateKeys(aj,ah);ai.read.macKey=ag?ah.keys.server_write_MAC_key:ah.keys.client_write_MAC_key;ai.write.macKey=ag?ah.keys.client_write_MAC_key:ah.keys.server_write_MAC_key;aj.session.cipherSuite.initConnectionState(ai,aj,ah);switch(ah.compression_algorithm){case o.CompressionMethod.none:break;case o.CompressionMethod.deflate:ai.read.compressFunction=y;ai.write.compressFunction=E;break;default:throw new Error("Unsupported compression algorithm.");}}return ai;};o.createRandom=function(){var ah=new Date;var af=+ah+ah.getTimezoneOffset()*60000;var ag=N.util.createBuffer();ag.putInt32(af);ag.putBytes(N.random.getBytes(28));return ag;};o.createRecord=function(ah,ag){if(!ag.data){return null;}var af={type:ag.type,version:{major:ah.version.major,minor:ah.version.minor},length:ag.data.length(),fragment:ag.data};return af;};o.createAlert=function(ah,ag){var af=N.util.createBuffer();af.putByte(ag.level);af.putByte(ag.description);return o.createRecord(ah,{type:o.ContentType.alert,data:af});};o.createClientHello=function(ap){ap.session.clientHelloVersion={major:ap.version.major,minor:ap.version.minor};var at=N.util.createBuffer();for(var al=0;al<ap.cipherSuites.length;++al){var an=ap.cipherSuites[al];at.putByte(an.id[0]);at.putByte(an.id[1]);}var ar=at.length();var au=N.util.createBuffer();au.putByte(o.CompressionMethod.none);var ag=au.length();var aq=N.util.createBuffer();if(ap.virtualHost){var ai=N.util.createBuffer();ai.putByte(0);ai.putByte(0);var af=N.util.createBuffer();af.putByte(0);v(af,2,N.util.createBuffer(ap.virtualHost));var ao=N.util.createBuffer();v(ao,2,af);v(ai,2,ao);aq.putBuffer(ai);}var ak=aq.length();if(ak>0){ak+=2;}var aj=ap.session.id;var ah=aj.length+1+2+4+28+2+ar+1+ag+ak;var am=N.util.createBuffer();am.putByte(o.HandshakeType.client_hello);am.putInt24(ah);am.putByte(ap.version.major);am.putByte(ap.version.minor);am.putBytes(ap.session.sp.client_random);v(am,1,N.util.createBuffer(aj));v(am,2,at);v(am,1,au);if(ak>0){v(am,2,aq);}return am;};o.createServerHello=function(ai){var ah=ai.session.id;var af=ah.length+1+2+4+28+2+1;var ag=N.util.createBuffer();ag.putByte(o.HandshakeType.server_hello);ag.putInt24(af);ag.putByte(ai.version.major);ag.putByte(ai.version.minor);ag.putBytes(ai.session.sp.server_random);v(ag,1,N.util.createBuffer(ah));ag.putByte(ai.session.cipherSuite.id[0]);ag.putByte(ai.session.cipherSuite.id[1]);ag.putByte(ai.session.compressionMethod);return ag;};o.createCertificate=function(ar){var ah=ar.entity===o.ConnectionEnd.client;var al=null;if(ar.getCertificate){var ak;if(ah){ak=ar.session.certificateRequest;}else{ak=ar.session.extensions.server_name.serverNameList;}al=ar.getCertificate(ar,ak);}var at=N.util.createBuffer();if(al!==null){try{if(!N.util.isArray(al)){al=[al];}var ai=null;for(var am=0;am<al.length;++am){var ag=N.pem.decode(al[am])[0];if(ag.type!=="CERTIFICATE"&&ag.type!=="X509 CERTIFICATE"&&ag.type!=="TRUSTED CERTIFICATE"){var aq=new Error("Could not convert certificate from PEM; PEM "+'header type is not "CERTIFICATE", "X509 CERTIFICATE", or '+'"TRUSTED CERTIFICATE".');aq.headerType=ag.type;throw aq;}if(ag.procType&&ag.procType.type==="ENCRYPTED"){throw new Error("Could not convert certificate from PEM; PEM is encrypted.");}var ap=N.util.createBuffer(ag.body);if(ai===null){ai=N.asn1.fromDer(ap.bytes(),false);}var aj=N.util.createBuffer();v(aj,3,ap);at.putBuffer(aj);}al=N.pki.certificateFromAsn1(ai);if(ah){ar.session.clientCertificate=al;}else{ar.session.serverCertificate=al;}}catch(ao){return ar.error(ar,{message:"Could not send certificate list.",cause:ao,send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.bad_certificate}});}}var af=3+at.length();var an=N.util.createBuffer();an.putByte(o.HandshakeType.certificate);an.putInt24(af);v(an,3,at);return an;};o.createClientKeyExchange=function(ak){var af=N.util.createBuffer();af.putByte(ak.session.clientHelloVersion.major);af.putByte(ak.session.clientHelloVersion.minor);af.putBytes(N.random.getBytes(46));var ai=ak.session.sp;ai.pre_master_secret=af.getBytes();var ag=ak.session.serverCertificate.publicKey;af=ag.encrypt(ai.pre_master_secret);var ah=af.length+2;var aj=N.util.createBuffer();aj.putByte(o.HandshakeType.client_key_exchange);aj.putInt24(ah);aj.putInt16(af.length);aj.putBytes(af);return aj;};o.createServerKeyExchange=function(ah){var af=0;var ag=N.util.createBuffer();if(af>0){ag.putByte(o.HandshakeType.server_key_exchange);ag.putInt24(af);}return ag;};o.getClientSignature=function(ah,ag){var af=N.util.createBuffer();af.putBuffer(ah.session.md5.digest());af.putBuffer(ah.session.sha1.digest());af=af.getBytes();ah.getSignature=ah.getSignature||function(am,ai,al){var aj=null;if(am.getPrivateKey){try{aj=am.getPrivateKey(am,am.session.clientCertificate);aj=N.pki.privateKeyFromPem(aj);}catch(ak){am.error(am,{message:"Could not get private key.",cause:ak,send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}});}}if(aj===null){am.error(am,{message:"No private key set.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}});}else{ai=aj.sign(ai,null);}al(am,ai);};ah.getSignature(ah,af,ag);};o.createCertificateVerify=function(ai,af){var ag=af.length+2;var ah=N.util.createBuffer();ah.putByte(o.HandshakeType.certificate_verify);ah.putInt24(ag);ah.putInt16(af.length);ah.putBytes(af);return ah;};o.createCertificateRequest=function(am){var ah=N.util.createBuffer();ah.putByte(1);var ag=N.util.createBuffer();for(var aj in am.caStore.certs){var ai=am.caStore.certs[aj];var af=N.pki.distinguishedNameToAsn1(ai.subject);ag.putBuffer(N.asn1.toDer(af));}var ak=1+ah.length()+2+ag.length();var al=N.util.createBuffer();al.putByte(o.HandshakeType.certificate_request);al.putInt24(ak);v(al,1,ah);v(al,2,ag);return al;};o.createServerHelloDone=function(ag){var af=N.util.createBuffer();af.putByte(o.HandshakeType.server_hello_done);af.putInt24(0);return af;};o.createChangeCipherSpec=function(){var af=N.util.createBuffer();af.putByte(1);return af;};o.createFinished=function(am){var af=N.util.createBuffer();af.putBuffer(am.session.md5.digest());af.putBuffer(am.session.sha1.digest());var ag=am.entity===o.ConnectionEnd.client;var ak=am.session.sp;var ai=12;var aj=O;var ah=ag?"client finished":"server finished";af=aj(ak.master_secret,ah,af.getBytes(),ai);var al=N.util.createBuffer();al.putByte(o.HandshakeType.finished);al.putInt24(af.length());al.putBuffer(af);return al;};o.createHeartbeat=function(ai,ak,ah){if(typeof ah==="undefined"){ah=ak.length;}var aj=N.util.createBuffer();aj.putByte(ai);aj.putInt16(ah);aj.putBytes(ak);var af=aj.length();var ag=Math.max(16,af-ah-3);aj.putBytes(N.random.getBytes(ag));return aj;};o.queue=function(am,ag){if(!ag){return;}if(ag.type===o.ContentType.handshake){var af=ag.fragment.bytes();am.session.md5.update(af);am.session.sha1.update(af);af=null;}var ah;if(ag.fragment.length()<=o.MaxFragment){ah=[ag];}else{ah=[];var ak=ag.fragment.bytes();while(ak.length>o.MaxFragment){ah.push(o.createRecord(am,{type:ag.type,data:N.util.createBuffer(ak.slice(0,o.MaxFragment))}));ak=ak.slice(o.MaxFragment);}if(ak.length>0){ah.push(o.createRecord(am,{type:ag.type,data:N.util.createBuffer(ak)}));}}for(var ai=0;ai<ah.length&&!am.fail;++ai){var al=ah[ai];var aj=am.state.current.write;if(aj.update(am,al)){am.records.push(al);}}};o.flush=function(ah){for(var ag=0;ag<ah.records.length;++ag){var af=ah.records[ag];ah.tlsData.putByte(af.type);ah.tlsData.putByte(af.version.major);ah.tlsData.putByte(af.version.minor);ah.tlsData.putInt16(af.fragment.length());ah.tlsData.putBuffer(ah.records[ag].fragment);}ah.records=[];return ah.tlsDataReady(ah);};var u=function(af){switch(af){case true:return true;case N.pki.certificateError.bad_certificate:return o.Alert.Description.bad_certificate;case N.pki.certificateError.unsupported_certificate:return o.Alert.Description.unsupported_certificate;case N.pki.certificateError.certificate_revoked:return o.Alert.Description.certificate_revoked;case N.pki.certificateError.certificate_expired:return o.Alert.Description.certificate_expired;case N.pki.certificateError.certificate_unknown:return o.Alert.Description.certificate_unknown;case N.pki.certificateError.unknown_ca:return o.Alert.Description.unknown_ca;default:return o.Alert.Description.bad_certificate;}};var t=function(af){switch(af){case true:return true;case o.Alert.Description.bad_certificate:return N.pki.certificateError.bad_certificate;case o.Alert.Description.unsupported_certificate:return N.pki.certificateError.unsupported_certificate;case o.Alert.Description.certificate_revoked:return N.pki.certificateError.certificate_revoked;case o.Alert.Description.certificate_expired:return N.pki.certificateError.certificate_expired;case o.Alert.Description.certificate_unknown:return N.pki.certificateError.certificate_unknown;case o.Alert.Description.unknown_ca:return N.pki.certificateError.unknown_ca;default:return N.pki.certificateError.bad_certificate;}};o.verifyCertificateChain=function(aj,ag){try{N.pki.verifyCertificateChain(aj.caStore,ag,function ai(an,ap,am){var ao=u(an);var al=aj.verify(aj,an,ap,am);if(al!==true){if(typeof al==="object"&&!N.util.isArray(al)){var ak=new Error("The application rejected the certificate.");ak.send=true;ak.alert={level:o.Alert.Level.fatal,description:o.Alert.Description.bad_certificate};if(al.message){ak.message=al.message;}if(al.alert){ak.alert.description=al.alert;}throw ak;}if(al!==an){al=t(al);}}return al;});}catch(af){var ah=af;if(typeof ah!=="object"||N.util.isArray(ah)){ah={send:true,alert:{level:o.Alert.Level.fatal,description:u(af)}};}if(!("send" in ah)){ah.send=true;}if(!("alert" in ah)){ah.alert={level:o.Alert.Level.fatal,description:u(ah.error)};}aj.error(aj,ah);}return!aj.fail;};o.createSessionCache=function(ag,af){var ai=null;if(ag&&ag.getSession&&ag.setSession&&ag.order){ai=ag;}else{ai={};ai.cache=ag||{};ai.capacity=Math.max(af||100,1);ai.order=[];for(var ah in ag){if(ai.order.length<=af){ai.order.push(ah);}else{delete ag[ah];}}ai.getSession=function(am){var al=null;var ak=null;if(am){ak=N.util.bytesToHex(am);}else{if(ai.order.length>0){ak=ai.order[0];}}if(ak!==null&&ak in ai.cache){al=ai.cache[ak];delete ai.cache[ak];for(var aj in ai.order){if(ai.order[aj]===ak){ai.order.splice(aj,1);break;}}}return al;};ai.setSession=function(al,ak){if(ai.order.length===ai.capacity){var aj=ai.order.shift();delete ai.cache[aj];}var aj=N.util.bytesToHex(al);ai.order.push(aj);ai.cache[aj]=ak;};}return ai;};o.createConnection=function(ao){var af=null;if(ao.caStore){if(N.util.isArray(ao.caStore)){af=N.pki.createCaStore(ao.caStore);}else{af=ao.caStore;}}else{af=N.pki.createCaStore();}var al=ao.cipherSuites||null;if(al===null){al=[];for(var am in o.CipherSuites){al.push(o.CipherSuites[am]);}}var ai=ao.server||false?o.ConnectionEnd.server:o.ConnectionEnd.client;var ah=ao.sessionCache?o.createSessionCache(ao.sessionCache):null;var ak={version:{major:o.Version.major,minor:o.Version.minor},entity:ai,sessionId:ao.sessionId,caStore:af,sessionCache:ah,cipherSuites:al,connected:ao.connected,virtualHost:ao.virtualHost||null,verifyClient:ao.verifyClient||false,verify:ao.verify||function(at,ap,ar,aq){return ap;},getCertificate:ao.getCertificate||null,getPrivateKey:ao.getPrivateKey||null,getSignature:ao.getSignature||null,input:N.util.createBuffer(),tlsData:N.util.createBuffer(),data:N.util.createBuffer(),tlsDataReady:ao.tlsDataReady,dataReady:ao.dataReady,heartbeatReceived:ao.heartbeatReceived,closed:ao.closed,error:function(ar,ap){ap.origin=ap.origin||(ar.entity===o.ConnectionEnd.client?"client":"server");if(ap.send){o.queue(ar,o.createAlert(ar,ap.alert));o.flush(ar);}var aq=ap.fatal!==false;if(aq){ar.fail=true;}ao.error(ar,ap);if(aq){ar.close(false);}},deflate:ao.deflate||null,inflate:ao.inflate||null};ak.reset=function(ap){ak.version={major:o.Version.major,minor:o.Version.minor};ak.record=null;ak.session=null;ak.peerCertificate=null;ak.state={pending:null,current:null};ak.expect=ak.entity===o.ConnectionEnd.client?p:h;ak.fragmented=null;ak.records=[];ak.open=false;ak.handshakes=0;ak.handshaking=false;ak.isConnected=false;ak.fail=!(ap||typeof ap==="undefined");ak.input.clear();ak.tlsData.clear();ak.data.clear();ak.state.current=o.createConnectionState(ak);};ak.reset();var an=function(at,ap){var ar=ap.type-o.ContentType.change_cipher_spec;var aq=w[at.entity][at.expect];if(ar in aq){aq[ar](at,ap);}else{o.handleUnexpected(at,ap);}};var aj=function(au){var at=0;var aq=au.input;var ap=aq.length();if(ap<5){at=5-ap;}else{au.record={type:aq.getByte(),version:{major:aq.getByte(),minor:aq.getByte()},length:aq.getInt16(),fragment:N.util.createBuffer(),ready:false};var ar=au.record.version.major===au.version.major;if(ar&&au.session&&au.session.version){ar=au.record.version.minor===au.version.minor;}if(!ar){au.error(au,{message:"Incompatible TLS version.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.protocol_version}});}}return at;};var ag=function(au){var at=0;var aq=au.input;var ap=aq.length();if(ap<au.record.length){at=au.record.length-ap;}else{au.record.fragment.putBytes(aq.getBytes(au.record.length));aq.compact();var ar=au.state.current.read;if(ar.update(au,au.record)){if(au.fragmented!==null){if(au.fragmented.type===au.record.type){au.fragmented.fragment.putBuffer(au.record.fragment);au.record=au.fragmented;}else{au.error(au,{message:"Invalid fragmented record.",send:true,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unexpected_message}});}}au.record.ready=true;}}return at;};ak.handshake=function(aq){if(ak.entity!==o.ConnectionEnd.client){ak.error(ak,{message:"Cannot initiate handshake as a server.",fatal:false});}else{if(ak.handshaking){ak.error(ak,{message:"Handshake already in progress.",fatal:false});}else{if(ak.fail&&!ak.open&&ak.handshakes===0){ak.fail=false;}ak.handshaking=true;aq=aq||"";var ap=null;if(aq.length>0){if(ak.sessionCache){ap=ak.sessionCache.getSession(aq);}if(ap===null){aq="";}}if(aq.length===0&&ak.sessionCache){ap=ak.sessionCache.getSession();if(ap!==null){aq=ap.id;}}ak.session={id:aq,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:N.md.md5.create(),sha1:N.md.sha1.create()};if(ap){ak.version=ap.version;ak.session.sp=ap.sp;}ak.session.sp.client_random=o.createRandom().getBytes();ak.open=true;o.queue(ak,o.createRecord(ak,{type:o.ContentType.handshake,data:o.createClientHello(ak)}));o.flush(ak);}}};ak.process=function(ap){var aq=0;if(ap){ak.input.putBytes(ap);}if(!ak.fail){if(ak.record!==null&&ak.record.ready&&ak.record.fragment.isEmpty()){ak.record=null;}if(ak.record===null){aq=aj(ak);}if(!ak.fail&&ak.record!==null&&!ak.record.ready){aq=ag(ak);}if(!ak.fail&&ak.record!==null&&ak.record.ready){an(ak,ak.record);}}return aq;};ak.prepare=function(ap){o.queue(ak,o.createRecord(ak,{type:o.ContentType.application_data,data:N.util.createBuffer(ap)}));return o.flush(ak);};ak.prepareHeartbeatRequest=function(aq,ap){if(aq instanceof N.util.ByteBuffer){aq=aq.bytes();}if(typeof ap==="undefined"){ap=aq.length;}ak.expectedHeartbeatPayload=aq;o.queue(ak,o.createRecord(ak,{type:o.ContentType.heartbeat,data:o.createHeartbeat(o.HeartbeatMessageType.heartbeat_request,aq,ap)}));return o.flush(ak);};ak.close=function(ap){if(!ak.fail&&ak.sessionCache&&ak.session){var aq={id:ak.session.id,version:ak.session.version,sp:ak.session.sp};aq.sp.keys=null;ak.sessionCache.setSession(aq.id,aq);}if(ak.open){ak.open=false;ak.input.clear();if(ak.isConnected||ak.handshaking){ak.isConnected=ak.handshaking=false;o.queue(ak,o.createAlert(ak,{level:o.Alert.Level.warning,description:o.Alert.Description.close_notify}));o.flush(ak);}ak.closed(ak);}ak.reset(ap);};return ak;};N.tls=N.tls||{};for(var A in o){if(typeof o[A]!=="function"){N.tls[A]=o[A];}}N.tls.prf_tls1=O;N.tls.prf_sha2=n;N.tls.hmac_sha1=r;N.tls.createSessionCache=o.createSessionCache;N.tls.createConnection=o.createConnection;}var b="tls";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./asn1","./hmac","./md","./pem","./pki","./random","./util"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();(function(){function c(s){if(s.prime){return;}var g=s.prime=s.prime||{};var l=s.jsbn.BigInteger;var t=[6,4,2,4,2,4,6,2];var n=new l(null);n.fromInt(30);var m=function(v,w){return v|w;};g.generateProbablePrime=function(A,y,B){if(typeof y==="function"){B=y;y={};}y=y||{};var w=y.algorithm||"PRIMEINC";if(typeof w==="string"){w={name:w};}w.options=w.options||{};var z=y.prng||s.random;var v={nextBytes:function(D){var C=z.getBytesSync(D.length);for(var E=0;E<D.length;++E){D[E]=C.charCodeAt(E);}}};if(w.name==="PRIMEINC"){return r(A,v,w.options,B);}throw new Error("Invalid prime generation algorithm: "+w.name);};function r(y,v,w,z){if("workers" in w){return p(y,v,w,z);}return o(y,v,w,z);}function o(A,v,y,D){var w=u(A,v);var z=0;var C=h(w.bitLength());if("millerRabinTests" in y){C=y.millerRabinTests;}var B=10;if("maxBlockTime" in y){B=y.maxBlockTime;}q(w,A,v,z,C,B,D);}function q(w,z,v,y,B,A,D){var C=+new Date;do{if(w.bitLength()>z){w=u(z,v);}if(w.isProbablePrime(B)){return D(null,w);}w.dAddOffset(t[y++%8],0);}while(A<0||+new Date-C<A);s.util.setImmediate(function(){q(w,z,v,y,B,A,D);});}function p(D,v,E,C){if(typeof Worker==="undefined"){return o(D,v,E,C);}var y=u(D,v);var F=E.workers;var B=E.workLoad||100;var z=B*30/8;var w=E.workerScript||"forge/prime.worker.js";if(F===-1){return s.util.estimateCores(function(H,G){if(H){G=2;}F=G-1;A();});}A();function A(){F=Math.max(1,F);var G=[];for(var I=0;I<F;++I){G[I]=new Worker(w);}var H=F;for(var I=0;I<F;++I){G[I].addEventListener("message",K);}var J=false;function K(O){if(J){return;}--H;var N=O.data;if(N.found){for(var L=0;L<G.length;++L){G[L].terminate();}J=true;return C(null,new l(N.prime,16));}if(y.bitLength()>D){y=u(D,v);}var M=y.toString(16);O.target.postMessage({hex:M,workLoad:B});y.dAddOffset(z,0);}}}function u(z,w){var y=new l(z,w);var v=z-1;if(!y.testBit(v)){y.bitwiseTo(l.ONE.shiftLeft(v),m,y);}y.dAddOffset(31-y.mod(n).byteValue(),0);return y;}function h(v){if(v<=100){return 27;}if(v<=150){return 18;}if(v<=200){return 15;}if(v<=250){return 12;}if(v<=300){return 9;}if(v<=350){return 8;}if(v<=400){return 7;}if(v<=500){return 6;}if(v<=600){return 5;}if(v<=800){return 4;}if(v<=1250){return 3;}return 2;}}var b="prime";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./util","./jsbn","./random"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();if(typeof forge==="undefined"){forge={};}(function(n,e){var C="0.7.18",E="",D="?",u="function",g="undefined",c="object",s="string",d="major",w="model",f="name",q="type",m="vendor",z="version",a="architecture",h="console",t="mobile",A="tablet",p="smarttv",B="wearable",v="embedded";var b={extend:function(F,I){var G={};for(var H in F){if(I[H]&&I[H].length%2===0){G[H]=I[H].concat(F[H]);}else{G[H]=F[H];}}return G;},has:function(G,F){if(typeof G==="string"){return F.toLowerCase().indexOf(G.toLowerCase())!==-1;}else{return false;}},lowerize:function(F){return F.toLowerCase();},major:function(F){return typeof F===s?F.replace(/[^\d\.]/g,"").split(".")[0]:e;},trim:function(F){return F.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");}};var y={rgx:function(G,I){var L=0,K,J,H,F,N,M;while(L<I.length&&!N){var P=I[L],O=I[L+1];K=J=0;while(K<P.length&&!N){N=P[K++].exec(G);if(!!N){for(H=0;H<O.length;H++){M=N[++J];F=O[H];if(typeof F===c&&F.length>0){if(F.length==2){if(typeof F[1]==u){this[F[0]]=F[1].call(this,M);}else{this[F[0]]=F[1];}}else{if(F.length==3){if(typeof F[1]===u&&!(F[1].exec&&F[1].test)){this[F[0]]=M?F[1].call(this,M,F[2]):e;}else{this[F[0]]=M?M.replace(F[1],F[2]):e;}}else{if(F.length==4){this[F[0]]=M?F[3].call(this,M.replace(F[1],F[2])):e;}}}}else{this[F]=M?M:e;}}}}L+=2;}},str:function(I,H){for(var G in H){if(typeof H[G]===c&&H[G].length>0){for(var F=0;F<H[G].length;F++){if(b.has(H[G][F],I)){return G===D?e:G;}}}else{if(b.has(H[G],I)){return G===D?e:G;}}}return I;}};var r={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}};var o={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[f,z],[/(opios)[\/\s]+([\w\.]+)/i],[[f,"Opera Mini"],z],[/\s(opr)\/([\w\.]+)/i],[[f,"Opera"],z],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark)\/([\w\.-]+)/i],[f,z],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[f,"IE"],z],[/(edge|edgios|edgea)\/((\d+)?[\w\.]+)/i],[[f,"Edge"],z],[/(yabrowser)\/([\w\.]+)/i],[[f,"Yandex"],z],[/(puffin)\/([\w\.]+)/i],[[f,"Puffin"],z],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[f,"UCBrowser"],z],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],z],[/(micromessenger)\/([\w\.]+)/i],[[f,"WeChat"],z],[/(qqbrowserlite)\/([\w\.]+)/i],[f,z],[/(QQ)\/([\d\.]+)/i],[f,z],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[f,z],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[f,z],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[f,z],[/(MetaSr)[\/\s]?([\w\.]+)/i],[f],[/(LBBROWSER)/i],[f],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[z,[f,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[z,[f,"Facebook"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[z,[f,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[f,/(.+)/,"$1 WebView"],z],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[f,/(.+(?:g|us))(.+)/,"$1 $2"],z],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[z,[f,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[f,z],[/(dolfin)\/([\w\.]+)/i],[[f,"Dolphin"],z],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[f,"Chrome"],z],[/(coast)\/([\w\.]+)/i],[[f,"Opera Coast"],z],[/fxios\/([\w\.-]+)/i],[z,[f,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[z,[f,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[z,f],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[f,"GSA"],z],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[f,[z,y.str,r.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[f,z],[/(navigator|netscape)\/([\w\.-]+)/i],[[f,"Netscape"],z],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[f,z]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[a,"amd64"]],[/(ia32(?=;))/i],[[a,b.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[a,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[a,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[a,/ower/,"",b.lowerize]],[/(sun4\w)[;\)]/i],[[a,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[a,b.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[w,m,[q,A]],[/applecoremedia\/[\w\.]+ \((ipad)/],[w,[m,"Apple"],[q,A]],[/(apple\s{0,1}tv)/i],[[w,"Apple TV"],[m,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[m,w,[q,A]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[w,[m,"Amazon"],[q,A]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[w,y.str,r.device.amazon.model],[m,"Amazon"],[q,t]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[w,m,[q,t]],[/\((ip[honed|\s\w*]+);/i],[w,[m,"Apple"],[q,t]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[m,w,[q,t]],[/\(bb10;\s(\w+)/i],[w,[m,"BlackBerry"],[q,t]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[w,[m,"Asus"],[q,A]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[m,"Sony"],[w,"Xperia Tablet"],[q,A]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[w,[m,"Sony"],[q,t]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[m,w,[q,h]],[/android.+;\s(shield)\sbuild/i],[w,[m,"Nvidia"],[q,h]],[/(playstation\s[34portablevi]+)/i],[w,[m,"Sony"],[q,h]],[/(sprint\s(\w+))/i],[[m,y.str,r.device.sprint.vendor],[w,y.str,r.device.sprint.model],[q,t]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[m,w,[q,A]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[m,[w,/_/g," "],[q,t]],[/(nexus\s9)/i],[w,[m,"HTC"],[q,A]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[w,[m,"Huawei"],[q,t]],[/(microsoft);\s(lumia[\s\w]+)/i],[m,w,[q,t]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[w,[m,"Microsoft"],[q,h]],[/(kin\.[onetw]{3})/i],[[w,/\./g," "],[m,"Microsoft"],[q,t]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[w,[m,"Motorola"],[q,t]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[w,[m,"Motorola"],[q,A]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[m,b.trim],[w,b.trim],[q,p]],[/hbbtv.+maple;(\d+)/i],[[w,/^/,"SmartTV"],[m,"Samsung"],[q,p]],[/\(dtv[\);].+(aquos)/i],[w,[m,"Sharp"],[q,p]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[m,"Samsung"],w,[q,A]],[/smart-tv.+(samsung)/i],[m,[q,p],w],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[m,"Samsung"],w,[q,t]],[/sie-(\w*)/i],[w,[m,"Siemens"],[q,t]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[m,"Nokia"],w,[q,t]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[w,[m,"Acer"],[q,A]],[/android.+([vl]k\-?\d{3})\s+build/i],[w,[m,"LG"],[q,A]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[m,"LG"],w,[q,A]],[/(lg) netcast\.tv/i],[m,w,[q,p]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[w,[m,"LG"],[q,t]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[w,[m,"Lenovo"],[q,A]],[/linux;.+((jolla));/i],[m,w,[q,t]],[/((pebble))app\/[\d\.]+\s/i],[m,w,[q,B]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[m,w,[q,t]],[/crkey/i],[[w,"Chromecast"],[m,"Google"]],[/android.+;\s(glass)\s\d/i],[w,[m,"Google"],[q,B]],[/android.+;\s(pixel c)\s/i],[w,[m,"Google"],[q,A]],[/android.+;\s(pixel xl|pixel)\s/i],[w,[m,"Google"],[q,t]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[w,/_/g," "],[m,"Xiaomi"],[q,t]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[w,/_/g," "],[m,"Xiaomi"],[q,A]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[w,[m,"Meizu"],[q,A]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[w,[m,"OnePlus"],[q,t]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[w,[m,"RCA"],[q,A]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[w,[m,"Dell"],[q,A]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[w,[m,"Verizon"],[q,A]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[m,"Barnes & Noble"],w,[q,A]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[w,[m,"NuVision"],[q,A]],[/android.+;\s(k88)\sbuild/i],[w,[m,"ZTE"],[q,A]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[w,[m,"Swiss"],[q,t]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[w,[m,"Swiss"],[q,A]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[w,[m,"Zeki"],[q,A]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[m,"Dragon Touch"],w,[q,A]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[w,[m,"Insignia"],[q,A]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[w,[m,"NextBook"],[q,A]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[m,"Voice"],w,[q,t]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[m,"LvTel"],w,[q,t]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[w,[m,"Envizen"],[q,A]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[m,w,[q,A]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[w,[m,"MachSpeed"],[q,A]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[m,w,[q,A]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[w,[m,"Rotor"],[q,A]],[/android.+(KS(.+))\s+build/i],[w,[m,"Amazon"],[q,A]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[m,w,[q,A]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[q,b.lowerize],m,w],[/(android[\w\.\s\-]{0,9});.+build/i],[w,[m,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[z,[f,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[f,z],[/rv\:([\w\.]{1,9}).+(gecko)/i],[z,f]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[f,z],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[f,[z,y.str,r.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[f,"Windows"],[z,y.str,r.os.windows.version]],[/\((bb)(10);/i],[[f,"BlackBerry"],z],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]*)/i,/linux;.+(sailfish);/i],[f,z],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[f,"Symbian"],z],[/\((series40);/i],[f],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[f,"Firefox OS"],z],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[f,z],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[f,"Chromium OS"],z],[/(sunos)\s?([\w\.\d]*)/i],[[f,"Solaris"],z],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[f,z],[/(haiku)\s(\w+)/i],[f,z],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[z,/_/g,"."],[f,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[f,"Mac OS"],[z,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]*)/i],[f,z]]};var l=function(G,I){if(typeof G==="object"){I=G;G=e;}if(!(this instanceof l)){return new l(G,I).getResult();}var H=G||(n&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:E);var F=I?b.extend(o,I):o;this.getBrowser=function(){var J={name:e,version:e};y.rgx.call(J,H,F.browser);J.major=b.major(J.version);return J;};this.getCPU=function(){var J={architecture:e};y.rgx.call(J,H,F.cpu);return J;};this.getDevice=function(){var J={vendor:e,model:e,type:e};y.rgx.call(J,H,F.device);return J;};this.getEngine=function(){var J={name:e,version:e};y.rgx.call(J,H,F.engine);return J;};this.getOS=function(){var J={name:e,version:e};y.rgx.call(J,H,F.os);return J;};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()};};this.getUA=function(){return H;};this.setUA=function(J){H=J;return this;};return this;};l.VERSION=C;l.BROWSER={NAME:f,MAJOR:d,VERSION:z};l.CPU={ARCHITECTURE:a};l.DEVICE={MODEL:w,VENDOR:m,TYPE:q,CONSOLE:h,MOBILE:t,SMARTTV:p,TABLET:A,WEARABLE:B,EMBEDDED:v};l.ENGINE={NAME:f,VERSION:z};l.OS={NAME:f,VERSION:z};forge.UAParser=l;})(typeof window==="object"?window:this);(function(){function c(h){var g=h.pkcs1=h.pkcs1||{};g.encode_rsa_oaep=function(E,t,m){var r;var n;var D;var q;if(typeof m==="string"){r=m;n=arguments[3]||undefined;D=arguments[4]||undefined;}else{if(m){r=m.label||undefined;n=m.seed||undefined;D=m.md||undefined;if(m.mgf1&&m.mgf1.md){q=m.mgf1.md;}}}if(!D){D=h.md.sha1.create();}else{D.start();}if(!q){q=D;}var y=Math.ceil(E.n.bitLength()/8);var o=y-2*D.digestLength-2;if(t.length>o){var w=new Error("RSAES-OAEP input message length is too long.");w.length=t.length;w.maxLength=o;throw w;}if(!r){r="";}D.update(r,"raw");var C=D.digest();var u="";var F=o-t.length;for(var A=0;A<F;A++){u+="\0";}var z=C.getBytes()+u+""+t;if(!n){n=h.random.getBytes(D.digestLength);}else{if(n.length!==D.digestLength){var w=new Error("Invalid RSAES-OAEP seed. The seed length must "+"match the digest length.");w.seedLength=n.length;w.digestLength=D.digestLength;throw w;}}var v=l(n,y-D.digestLength-1,q);var s=h.util.xorBytes(z,v,z.length);var B=l(s,D.digestLength,q);var p=h.util.xorBytes(n,B,n.length);return "\0"+p+s;};g.decode_rsa_oaep=function(L,n,o){var t;var K;var q;if(typeof o==="string"){t=o;K=arguments[3]||undefined;}else{if(o){t=o.label||undefined;K=o.md||undefined;if(o.mgf1&&o.mgf1.md){q=o.mgf1.md;}}}var E=Math.ceil(L.n.bitLength()/8);if(n.length!==E){var C=new Error("RSAES-OAEP encoded message length is invalid.");C.length=n.length;C.expectedLength=E;throw C;}if(K===undefined){K=h.md.sha1.create();}else{K.start();}if(!q){q=K;}if(E<2*K.digestLength+2){throw new Error("RSAES-OAEP key is too short for the hash function.");}if(!t){t="";}K.update(t,"raw");var J=K.digest().getBytes();var w=n.charAt(0);var r=n.substring(1,K.digestLength+1);var v=n.substring(1+K.digestLength);var I=l(v,K.digestLength,q);var p=h.util.xorBytes(r,I,r.length);var B=l(p,E-K.digestLength-1,q);var H=h.util.xorBytes(v,B,v.length);var z=H.substring(0,K.digestLength);var C=w!=="\0";for(var F=0;F<K.digestLength;++F){C|=J.charAt(F)!==z.charAt(F);}var u=1;var s=K.digestLength;for(var D=K.digestLength;D<H.length;D++){var m=H.charCodeAt(D);var A=m&1^1;var G=u?65534:0;C|=m&G;u=u&A;s+=u;}if(C||H.charCodeAt(s)!==1){throw new Error("Invalid RSAES-OAEP padding.");}return H.substring(s+1);};function l(m,s,q){if(!q){q=h.md.sha1.create();}var o="";var p=Math.ceil(s/q.digestLength);for(var n=0;n<p;++n){var r=String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255);q.start();q.update(m+r);o+=q.digest().getBytes();}return o.substring(0,s);}}var b="pkcs1";if(typeof define!=="function"){if(typeof module==="object"&&module.exports){var d=true;define=function(h,g){g(require,module);};}else{if(typeof forge==="undefined"){forge={};}return c(forge);}}var f;var a=function(g,h){h.exports=function(m){var n=f.map(function(o){return g(o);}).concat(c);m=m||{};m.defined=m.defined||{};if(m.defined[b]){return m[b];}m.defined[b]=true;for(var l=0;l<n.length;++l){n[l](m);}return m[b];};};var e=define;define=function(h,g){f=typeof h==="string"?g.slice(2):h.slice(2);if(d){delete define;return e.apply(null,Array.prototype.slice.call(arguments,0));}define=e;return define.apply(null,Array.prototype.slice.call(arguments,0));};define(["require","module","./util","./random","./sha1"],function(){a.apply(null,Array.prototype.slice.call(arguments,0));});})();
