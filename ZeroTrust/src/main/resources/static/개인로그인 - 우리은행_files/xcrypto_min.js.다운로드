XCrypto=function(){var bm=sofo.utils||{};var bn=sofo.crypto||{};var b=sofo.pki||{};var aA=sofo.storage||{};var bW=sofo.cmp||{};var ae=sofo.error||{};var X=sofo.xfs||{};var E=sofo.anypin||{};var a4=sofo.xcs||{};var bB=window.console||{log:function(){}};aA.setSecureID("AnySignLiteXCrypto");var V=2e3;var l=2100;var r=2200;var Y=2300;var bH=2400;var s=2592e3;var a1=0;var bN=5;var I=0;var bz=20;var aP=24;var h=0;var v=1;var k=2;var aW="";var aG="";var aH={osName:"",osVersion:"",browserName:"",browserVersion:"",deviceType:""};var x={enable:false,desktop:false,mobile:false};var K={enable:false,desktop:false,mobile:false,cert:null};var L={enable:false,desktop:false,mobile:false};var bO="anysignlite";var y="anypin";var aD="anycertrelay";var a0="anypin_servercert";var bx="desktop";var u="mobile";var aI=false;var ai=0;var i=1;var bP=ai;function au(){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))){aG=u}else{aG=bx}if(forge.UAParser){var ca=new forge.UAParser;aH.osName=ca.getOS().name;aH.osVersion=ca.getOS().version;aH.browserName=ca.getBrowser().name;aH.browserVersion=ca.getBrowser().version;aH.deviceType=aG}}function b3(){if(!aG){au()}if(aG==u){return true}else{return false}}function am(){if(!aG){au()}if(!aH.osName||!aH.osVersion||!aH.browserName||!aH.browserVersion||!aH.deviceType){w(ae.INTERFACE_GETDEVICEINFO+ae.ERROR_API_FAIL);return""}return aH.osName+"|"+aH.osVersion+"|"+aH.browserName+"|"+aH.browserVersion+"|"+aH.deviceType}function bG(ca){if(ca){if(typeof ca==="number"){if(ca==i){bP=i}else{bP=ai}}else{if(typeof ca==="string"&&ca.toLowerCase()=="en-us"){bP=i}else{bP=ai}}}else{bP=ai}}var aF="utf-8";var q="euc-kr";var at=aF;function C(ca){if(ca){if(typeof ca==="number"){if(ca==1){at=q}else{at=aF}}else{if(typeof ca==="string"&&ca.toLowerCase()==q){at=q}else{at=aF}}}else{at=q}}var bF="";var aa="";var aj=[];var an={};var bT={};forge.pki.oids["1.3.6.1.5.5.7.48.1"]="ocsp";forge.pki.oids["ocsp"]="1.3.6.1.5.5.7.48.1";forge.pki.oids["1.2.410.200004.10.1.1"]="kisa-identifyData";forge.pki.oids["kisa-identifyData"]="1.2.410.200004.10.1.1";var aR=[];aR["yessignCA"]="금융결제원";aR["yessignCA Class 1"]="금융결제원";aR["yessignCA Class 2"]="금융결제원";aR["yessignCA Class 3"]="금융결제원";aR["SignKorea CA"]="코스콤(증권전산)";aR["SignKorea CA2"]="코스콤(증권전산)";aR["SignKorea CA3"]="코스콤(증권전산)";aR["SignKorea CA4"]="코스콤(증권전산)";aR["signGATE CA"]="한국정보인증(SignGATE)";aR["signGATE CA2"]="한국정보인증(SignGATE)";aR["signGATE CA4"]="한국정보인증(SignGATE)";aR["signGATE CA5"]="한국정보인증(SignGATE)";aR["signGATE CA6"]="한국정보인증(SignGATE)";aR["CrossCert Certificate Authority"]="한국전자인증";aR["CrossCertCA"]="한국전자인증";aR["CrossCertCA2"]="한국전자인증";aR["CrossCertCA3"]="한국전자인증";aR["CrossCertCA4"]="한국전자인증";aR["TradeSignCA"]="한국무역정보통신";aR["TradeSignCA2"]="한국무역정보통신";aR["TradeSignCA3"]="한국무역정보통신";aR["TradeSignCA4"]="한국무역정보통신";aR["NCASign CA"]="한국전산원";aR["CertRSA01"]="한국정보보호진흥원(KISA)";aR["KISA RootCA 1"]="한국정보보호진흥원(KISA)";aR["KISA RootCA 4"]="한국정보보호진흥원(KISA)";aR["CA131100001"]="행정자치부";aR["CA131100002"]="교육부";aR["CA128000031"]="대검찰청";aR["CA128000032"]="대검찰청";aR["CA974000031"]="대법원";aR["CA130000031"]="병무청";aR["INIPASS CA"]="이니텍(주)";var br=[];var B="일반인증서";var H=[];H["1.2.410.200004.2.1"]="공인인증기관";H["2.5.29.32.0"]="공인인증기관";H["1.2.410.100001.2.2.1"]="공인인증기관";H["1.2.410.100001.2.1.1,1.2.410.100001.2.1.2"]="공인인증기관";H["1.2.410.100001.2.1.1,1.2.410.100001.2.1.2,1.2.410.100001.2.2.1"]="공인인증기관";H["1.2.410.200005.1.1.1"]="범용개인";H["1.2.410.200005.1.1.2"]="은행기업";H["1.2.410.200005.1.1.4"]="은행개인";H["1.2.410.200005.1.1.5"]="범용기업";H["1.2.410.200005.1.1.6"]="용도제한용";H["1.2.410.200005.1.1.6.1"]="기업뱅킹";H["1.2.410.200005.1.1.6.2"]="신용카드";H["1.2.410.200004.5.1.1.1"]="스페셜 개인";H["1.2.410.200004.5.1.1.2"]="스페셜 개인서버";H["1.2.410.200004.5.1.1.3"]="스페셜 법인";H["1.2.410.200004.5.1.1.4"]="스페셜 서버";H["1.2.410.200004.5.1.1.5"]="범용개인";H["1.2.410.200004.5.1.1.6"]="범용 개인서버";H["1.2.410.200004.5.1.1.7"]="범용기업";H["1.2.410.200004.5.1.1.8"]="범용 서버";H["1.2.410.200004.5.1.1.9"]="증권/보험용";H["1.2.410.200004.5.1.1.9.2"]="신용카드";H["1.2.410.200004.5.1.1.10"]="골드 개인서버";H["1.2.410.200004.5.1.1.11"]="실버 개인";H["1.2.410.200004.5.1.1.12"]="실버 법인";H["1.2.410.200004.2.1,1.2.410.200012.1.1.1"]="전자거래 서명용(개인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.2"]="전자거래 암호용(개인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.3"]="전자거래 서명용(법인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.4"]="전자거래 암호용(법인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.5"]="전자거래 서명용(서버)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.6"]="전자거래 암호용(서버)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.7"]="전자무역 서명용(개인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.8"]="전자무역 암호용(개인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.9"]="전자무역 서명용(법인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.10"]="전자무역 암호용(법인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.11"]="전자무역 서명용(서버)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.12"]="전자무역 암호용(서버)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.101"]="은행/보험용";H["1.2.410.200004.2.1,1.2.410.200012.1.1.103"]="증권/보험용";H["1.2.410.200004.2.1,1.2.410.200012.1.1.105"]="신용카드용";H["1.2.410.200004.5.4.1.1"]="범용개인";H["1.2.410.200004.5.4.1.2"]="범용기업";H["1.2.410.200004.5.4.1.3"]="범용(서버)";H["1.2.410.200004.5.4.1.4"]="특수목적용(개인)";H["1.2.410.200004.5.4.1.5"]="특수목적용(법인)";H["1.2.410.200004.5.4.1.101"]="은행개인";H["1.2.410.200004.5.4.1.102"]="증권거래용";H["1.2.410.200004.5.4.1.103"]="신용카드";H["1.2.410.200004.5.4.1.104"]="전자민원용";H["1.2.410.200004.5.2.1.1"]="범용기업";H["1.2.410.200004.5.2.1.2"]="범용개인";H["1.2.410.200004.5.2.1.3"]="특별등급(전자입찰)";H["1.2.410.200004.5.2.1.4"]="1등급인증서(서버)";H["1.2.410.200004.5.2.1.5"]="특별등급 법인";H["1.2.410.200004.5.2.1.7.1"]="은행개인";H["1.2.410.200004.5.2.1.7.2"]="증권/보험용";H["1.2.410.200004.5.2.1.7.3"]="신용카드";H["1.2.410.200004.5.3.1.1"]="범용기업";H["1.2.410.200004.5.3.1.2"]="범용기업";H["1.2.410.200004.5.3.1.3"]="1등급(서버)";H["1.2.410.200004.5.3.1.5"]="특수목적용(기관/단체)";H["1.2.410.200004.5.3.1.6"]="특수목적용(법인)";H["1.2.410.200004.5.3.1.7"]="특수목적용(서버)";H["1.2.410.200004.5.3.1.8"]="특수목적용(개인)";H["1.2.410.200004.5.3.1.9"]="범용개인";H["1.2.410.200012.1.1.1"]="범용개인";H["1.2.410.200012.1.1.3"]="범용기업";H["1.2.410.200012.1.1.101"]="은행개인";H["1.2.410.200012.1.1.105"]="신용카드";H["1.2.410.200004.5.5.1.1"]="범용(개인)";H["1.2.410.200004.5.5.1.2"]="범용(기업)";H["1.2.410.200004.5.5.1.3.1"]="제휴기관용(개인)";H["1.2.410.200004.5.5.1.4.1"]="제휴기관용(기업)";H["1.2.410.200004.5.5.1.4.2"]="전자세금용(기업)";var A="Common";var c=[];c["1.2.410.200004.2.1"]="National";c["2.5.29.32.0"]="National";c["1.2.410.100001.2.2.1"]="National";c["1.2.410.100001.2.1.1,1.2.410.100001.2.1.2"]="National";c["1.2.410.100001.2.1.1,1.2.410.100001.2.1.2,1.2.410.100001.2.2.1"]="National";c["1.2.410.200005.1.1.1"]="Financial";c["1.2.410.200005.1.1.2"]="Financial";c["1.2.410.200005.1.1.4"]="Financial";c["1.2.410.200005.1.1.5"]="Commercial";c["1.2.410.200005.1.1.6"]="National";c["1.2.410.200005.1.1.6.1"]="Financial";c["1.2.410.200005.1.1.6.2"]="Financial";c["1.2.410.200004.5.1.1.1"]="National";c["1.2.410.200004.5.1.1.2"]="National";c["1.2.410.200004.5.1.1.3"]="National";c["1.2.410.200004.5.1.1.4"]="National";c["1.2.410.200004.5.1.1.5"]="Commercial";c["1.2.410.200004.5.1.1.6"]="Commercial";c["1.2.410.200004.5.1.1.7"]="Commercial";c["1.2.410.200004.5.1.1.8"]="Commercial";c["1.2.410.200004.5.1.1.9"]="Financial";c["1.2.410.200004.5.1.1.9.2"]="Financial";c["1.2.410.200004.5.1.1.10"]="National";c["1.2.410.200004.5.1.1.11"]="National";c["1.2.410.200004.5.1.1.12"]="National";c["1.2.410.200004.2.1,1.2.410.200012.1.1.1"]="National";c["1.2.410.200004.2.1,1.2.410.200012.1.1.2"]="National";c["1.2.410.200004.2.1.1.2.410.200012.1.1.3"]="National";c["1.2.410.200004.2.1,1.2.410.200012.1.1.4"]="National";c["1.2.410.200004.2.1,1.2.410.200012.1.1.5"]="National";c["1.2.410.200004.2.1,1.2.410.200012.1.1.6"]="National";c["1.2.410.200004.2.1,1.2.410.200012.1.1.7"]="Commercial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.8"]="Commercial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.9"]="Commercial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.10"]="Commercial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.11"]="Commercial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.12"]="Commercial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.101"]="Financial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.103"]="Financial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.105"]="Financial";c["1.2.410.200004.5.4.1.1"]="Commercial";c["1.2.410.200004.5.4.1.2"]="Commercial";c["1.2.410.200004.5.4.1.3"]="Commercial";c["1.2.410.200004.5.4.1.4"]="National";c["1.2.410.200004.5.4.1.5"]="National";c["1.2.410.200004.5.4.1.101"]="Financial";c["1.2.410.200004.5.4.1.102"]="Financial";c["1.2.410.200004.5.4.1.103"]="Financial";c["1.2.410.200004.5.4.1.104"]="National";c["1.2.410.200004.5.2.1.1"]="National";c["1.2.410.200004.5.2.1.2"]="National";c["1.2.410.200004.5.2.1.3"]="National";c["1.2.410.200004.5.2.1.4"]="National";c["1.2.410.200004.5.2.1.5"]="National";c["1.2.410.200004.5.2.1.7.1"]="Financial";c["1.2.410.200004.5.2.1.7.2"]="Financial";c["1.2.410.200004.5.2.1.7.3"]="Financial";c["1.2.410.200004.5.3.1.1"]="National";c["1.2.410.200004.5.3.1.2"]="National";c["1.2.410.200004.5.3.1.3"]="National";c["1.2.410.200004.5.3.1.5"]="National";c["1.2.410.200004.5.3.1.6"]="National";c["1.2.410.200004.5.3.1.7"]="National";c["1.2.410.200004.5.3.1.8"]="National";c["1.2.410.200004.5.3.1.9"]="National";c["1.2.410.200012.1.1.1"]="National";c["1.2.410.200012.1.1.3"]="National";c["1.2.410.200012.1.1.101"]="Financial";c["1.2.410.200012.1.1.105"]="Financial";c["1.2.410.200004.5.5.1.1"]="National";c["1.2.410.200004.5.5.1.2"]="Commercial";c["1.2.410.200004.5.5.1.3.1"]="National";c["1.2.410.200004.5.5.1.4.1"]="Commercial";c["1.2.410.200004.5.5.1.4.2"]="Commercial";var bb=[];var av=1;bb[av]={msg_koKR:"이미 동일한 인증서가 저장되어 있습니다.\n기존의 인증서를 삭제하고 이 인증서를 저장하시겠습니까?",msg_enUS:"Already the same certificate has been saved.\nDo you want to delete the existing certificate and save this certificate?"};function o(cb){var ca;if(bP==ai){ca=bb[cb].msg_koKR}else{ca=bb[cb].msg_enUS}return confirm(ca)}function ak(){try{if(!sofo||!sofo.utils||!sofo.crypto||!sofo.pki||!sofo.storage||!sofo.error||!sofo.cmp||!sofo.xfs){return-1}if(!window.localStorage||typeof localStorage=="undefined"){return-2}if(!window.FileReader||typeof FileReader=="undefined"){return-3}}catch(ca){return-4}return 0}function b4(cd,cb,ca){var cc=function(ce){if(ce!=0){a9(ae.XCRYPTO_SOFO_STORAGE+ae.XCRYPTO_SOFO_STORAGE_SETCROSSSTORAGE)}if(ca){ca(ce)}else{return ce}};return aA.setCrossStorage(cd,cb,cc)}function bQ(cf,ce,cb,ca,cc){var cd=function(cg){if(cg!==0){aI=false}else{aI=true}if(cc){cc(cg)}else{return cg}};return aA.setOpenStorage(cf,ce,cb,ca,cd)}function m(cc){var cd=b.verifySignedData(cc,"",0);if(!cd){return""}var cb="e=camaster@softforum.com,cn=Softforum Root Authority,o=Softforum Corporation,c=KR";if(cb!=W(cd.cert[0].issuer)){return""}var ca=cd.plain.substring(2,cd.plain.length-1);return ca}function W(ca){var cb=[];ca.attributes.forEach(function(cc){cb.push(cc.shortName.toLowerCase()+"="+cc.value)});return forge.util.decodeUtf8(cb.reverse().join(","))}function bM(cd,cc){var ca=0;var cb=(cc.getTime()-cd.getTime())/1e3;if(cb<0){ca=2}else{if(cb>s){ca=0}else{ca=1}}return ca}function Q(cd){var cb=[];if(!cd){return""}function ca(cf){if(!cf){return}if(cf.composed&&cf.value instanceof Array){for(var ce=0;ce<cf.value.length;ce++){if(cf.value[ce].value instanceof Array){cb.push(cf.value[ce].value)}else{cb.push(forge.util.bytesToHex(cf.value[ce].value))}}}}try{ca(forge.asn1.fromDer(cd.value));if(cb.length>0){return cb[0]}else{return""}}catch(cc){return""}}function a3(cf){var cb={policy:[],unotice:[],cps:[]};var cc=false;var cg=false;if(!cf){return cb}function ce(cj){if(cj.composed&&cj.value instanceof Array){for(var ci=0;ci<cj.value.length;ci++){ce(cj.value[ci])}}else{if(cj.tagClass==forge.asn1.Class.UNIVERSAL&&cj.type==forge.asn1.Type.OID){var ch=forge.asn1.derToOid(cj.value);if(ch=="1.3.6.1.5.5.7.2.2"){cc=true}else{if(ch=="1.3.6.1.5.5.7.2.1"){cg=true}else{cc=false;cg=false}}}else{if(cc){cb.unotice.push(cj.value)}else{if(cg){cb.cps.push(cj.value)}}cc=false;cg=false}}}function ca(cj){if(!cj){return}if(cj.composed&&cj.value instanceof Array){for(var ci=0;ci<cj.value.length;ci++){if(cj.value[ci].composed&&cj.value[ci].value instanceof Array){for(var ch=0;ch<cj.value[ci].value.length;ch++){if(cj.value[ci].value[ch].tagClass==forge.asn1.Class.UNIVERSAL&&cj.value[ci].value[ch].type==forge.asn1.Type.OID){cb.policy.push(forge.asn1.derToOid(cj.value[ci].value[ch].value))}else{ce(cj.value[ci].value[ch])}}}}}}try{ca(forge.asn1.fromDer(cf.value));return cb}catch(cd){return cb}}function b6(cb){var ck=[];var cj="digitalSignature";var ci="nonRepudiation";var ch="keyEncipherment";var cg="dataEncipherment";var cf="keyAgreement";var ce="keyCertSign";var cd="cRLSign";var cc="encipherOnly";var ca="decipherOnly";if(!cb){return""}if(cb.digitalSignature){ck.push(cj)}if(cb.nonRepudiation){ck.push(ci)}if(cb.keyEncipherment){ck.push(ch)}if(cb.dataEncipherment){ck.push(cg)}if(cb.keyAgreement){ck.push(cf)}if(cb.keyCertSign){ck.push(ce)}if(cb.cRLSign){ck.push(cd)}if(cb.encipherOnly){ck.push(cc)}if(cb.decipherOnly){ck.push(ca)}return ck}function J(cb){var ca="";if(!cb){return""}if(cb.cA){if("pathLenConstraint"in cb){ca="Subject Type=CA, Path Length Constraint="+cb.pathLenConstraint}else{ca="Subject Type=CA, Path Length Constraint=None"}}else{ca="Subject Type=End Entity"}return ca}function ar(cd){function cb(ci){if(!ci){return}if(ci.composed&&ci.value instanceof Array){for(var cg=0;cg<ci.value.length;cg++){if(ci.value[cg].tagClass==forge.asn1.Class.CONTEXT_SPECIFIC&&ci.value[cg].type==0){var ch="ON=";if(ci.value[cg].composed&&ci.value[cg].value instanceof Array){for(var cf=0;cf<ci.value[cg].value.length;cf++){if(ci.value[cg].value[cf].tagClass==forge.asn1.Class.UNIVERSAL&&ci.value[cg].value[cf].type==forge.asn1.Type.OID){var cj=forge.asn1.derToOid(ci.value[cg].value[cf].value);var ce=forge.pki.oids[cj]?forge.pki.oids[cj]:cj;if(ce.toLowerCase()=="kisa-identifyData".toLowerCase()){ch+="VID"}else{ch+=ce}ch+="="}else{ch+=forge.util.bytesToHex(forge.asn1.toDer(ci.value[cg].value[cf].value[0]).getBytes())}}}ca.push(ch)}else{if(ci.value[cg].tagClass==forge.asn1.Class.CONTEXT_SPECIFIC&&ci.value[cg].type==1){var ch="RN="}else{}}}}}var ca=[];if(!cd){return""}try{cb(forge.asn1.fromDer(cd.value));return ca}catch(cc){return""}}function a2(cd){function cb(cf){if(!cf){return""}if(cf.composed&&cf.value instanceof Array){for(var ce=0;ce<cf.value.length;ce++){cb(cf.value[ce])}return ca}else{ca.push(cf.value)}}var ca=[];if(!cd){return""}try{return cb(forge.asn1.fromDer(cd.value))}catch(cc){return""}}function aL(cd){function cb(ci){if(!ci){return}if(ci.composed&&ci.value instanceof Array){for(var ch=0;ch<ci.value.length;ch++){if(ci.value[ch].composed&&ci.value[ch].value instanceof Array){if(ci.value[ch].value.length==2){var cj=forge.asn1.derToOid(ci.value[ch].value[0].value);var cf=forge.pki.oids[cj]?forge.pki.oids[cj].toUpperCase():cj;ca.push(cf+":URL="+ci.value[ch].value[1].value)}else{var ce="";for(var cg=0;cg<ci.value[ch].value.length;cg++){if(ci.value[ch].value[cg].tagClass==forge.asn1.Class.UNIVERSAL&&ci.value[ch].value[cg].type==forge.asn1.Type.OID){var cj=forge.asn1.derToOid(ci.value[ch].value[cg].value);var cf=forge.pki.oids[cj]?forge.pki.oids[cj].toUpperCase():cj;if(ce){ce+=":"}ce+=cf}else{if(ce){ce+=":"}ce+=ci.value[ch].value[cg].value}}if(ce){ca.push(ce)}}}}}}var ca=[];if(!cd){return""}try{cb(forge.asn1.fromDer(cd.value));return ca}catch(cc){return""}}function by(cC,ca){if(ca==bN){if(!cC.status){cC.status=bM(new Date,new Date(cC.validity.notAfter))}var cm=cC.validity.notAfter.getFullYear();var cA=cC.validity.notAfter.getMonth()+1;var cz=cC.validity.notAfter.getDate();var cB=cm+"-"+(cA<10?"0"+cA:cA)+"-"+(cz<10?"0"+cz:cz);var ch=cC.subject.getField("OU");var cb=a3(cC.getExtension("certificatePolicies"));var cs="";var ce="";if(ch){if(ch.value=="personalB"||ch.value=="corporation4ECB"){ce="브라우저 인증서"}else{ce=Z(cb.policy)}}else{ce=Z(cb.policy)}var cs="";var co=cC.issuer.getField("CN");if(co){cs=n(forge.util.decodeUtf8(co.value))}var cc=cC.status+"$"+ce+"$"+W(cC.subject)+"$"+cs+"$"+cB+"$"+W(cC.issuer)+"$"+cC.serialNumber+"\t\n";return cc}else{var cv=bM(new Date,new Date(cC.validity.notAfter));var cf=cC.validity.notBefore.getFullYear();var cy=cC.validity.notBefore.getMonth()+1;var cu=cC.validity.notBefore.getDate();var ci=cC.validity.notBefore.getHours();var cw=cC.validity.notBefore.getMinutes();var cq=cC.validity.notBefore.getSeconds();var cj=cf+"-"+(cy<10?"0"+cy:cy)+"-"+(cu<10?"0"+cu:cu)+" "+(ci<10?"0"+ci:ci)+":"+(cw<10?"0"+cw:cw)+":"+(cq<10?"0"+cq:cq);var cd=cC.validity.notAfter.getFullYear();var cx=cC.validity.notAfter.getMonth()+1;var cr=cC.validity.notAfter.getDate();var cg=cC.validity.notAfter.getHours();var ct=cC.validity.notAfter.getMinutes();var cp=cC.validity.notAfter.getSeconds();var cB=cd+"-"+(cx<10?"0"+cx:cx)+"-"+(cr<10?"0"+cr:cr)+" "+(cg<10?"0"+cg:cg)+":"+(ct<10?"0"+ct:ct)+":"+(cp<10?"0"+cp:cp);var cb=a3(cC.getExtension("certificatePolicies"));var cn=cb.policy;var cl=cb.cps;var ck=cb.unotice;var cc=cv+"$"+(cC.version+1)+"$"+cC.serialNumber+"$"+(forge.pki.oids[cC.signatureOid]?forge.pki.oids[cC.signatureOid]:cC.signatureOid)+"$"+W(cC.issuer)+"$"+cj+"$"+cB+"$"+W(cC.subject)+"$"+(cC.publicKey.kcdsa?"KCDSA":"RSA")+" ("+cC.publicKey.bit+" Bits)"+"$"+cC.publicKey.obj+"$"+(cC.signature?forge.util.bytesToHex(cC.signature):"")+"$"+Q(cC.getExtension("authorityKeyIdentifier"))+"$"+cn+"$"+b6(cC.getExtension("keyUsage"))+"$"+J(cC.getExtension("basicConstraints"))+"$"+ar(cC.getExtension("subjectAltName"))+"$"+"URL="+a2(cC.getExtension("cRLDistributionPoints"))+"$"+ck+"$"+cl+"$"+aL(cC.getExtension({id:"1.3.6.1.5.5.7.1.1"}))+"\t\n";return cc}}function aB(cA,cb){if(cb==bN){var cz=cA.notAfter.substring(0,10);var cv=bM(new Date,new Date(cz));var cq;if(cA.cloud==true){cv+=4}var ce="";if(cA.subject.toUpperCase().indexOf("OU=PERSONALB")>=0||cA.subject.toUpperCase().indexOf("OU=CORPORATION4ECB")>=0){ce="브라우저 인증서"}else{ce=Z(cA.policyOID)}var cs="";var cn=cA.issuer.split(",");cs=n(forge.util.decodeUtf8(cn[0].substring(3)));var ci=cA.fingerprint;var cc=cv+"$"+ce+"$"+cA.subject+"$"+cs+"$"+cz+"$"+cA.issuer+"$"+ci+"$"+cA.source+"\t\n";return cc}else{var cv=bM(new Date,new Date(cA.validity.notAfter));var cf=cA.validity.notBefore.getFullYear();var cy=cA.validity.notBefore.getMonth()+1;var cu=cA.validity.notBefore.getDate();var ch=cA.validity.notBefore.getHours();var cw=cA.validity.notBefore.getMinutes();var cp=cA.validity.notBefore.getSeconds();var cj=cf+"-"+(cy<10?"0"+cy:cy)+"-"+(cu<10?"0"+cu:cu)+" "+(ch<10?"0"+ch:ch)+":"+(cw<10?"0"+cw:cw)+":"+(cp<10?"0"+cp:cp);var cd=cA.validity.notAfter.getFullYear();var cx=cA.validity.notAfter.getMonth()+1;var cr=cA.validity.notAfter.getDate();var cg=cA.validity.notAfter.getHours();var ct=cA.validity.notAfter.getMinutes();var co=cA.validity.notAfter.getSeconds();var cz=cd+"-"+(cx<10?"0"+cx:cx)+"-"+(cr<10?"0"+cr:cr)+" "+(cg<10?"0"+cg:cg)+":"+(ct<10?"0"+ct:ct)+":"+(co<10?"0"+co:co);var ca=a3(cA.getExtension("certificatePolicies"));var cm=ca.policy;var cl=ca.cps;var ck=ca.unotice;var cc=cv+"$"+(cA.version+1)+"$"+cA.serialNumber+"$"+(forge.pki.oids[cA.signatureOid]?forge.pki.oids[cA.signatureOid]:cA.signatureOid)+"$"+W(cA.issuer)+"$"+cj+"$"+cz+"$"+W(cA.subject)+"$"+(cA.publicKey.kcdsa?"KCDSA":"RSA")+" ("+cA.publicKey.bit+" Bits)"+"$"+cA.publicKey.obj+"$"+(cA.signature?forge.util.bytesToHex(cA.signature):"")+"$"+Q(cA.getExtension("authorityKeyIdentifier"))+"$"+cm+"$"+b6(cA.getExtension("keyUsage"))+"$"+J(cA.getExtension("basicConstraints"))+"$"+ar(cA.getExtension("subjectAltName"))+"$"+"URL="+a2(cA.getExtension("cRLDistributionPoints"))+"$"+ck+"$"+cl+"$"+aL(cA.getExtension({id:"1.3.6.1.5.5.7.1.1"}))+"\t\n";return cc}}function b7(ck,cc,ch,cf,ca,ci){var cj=[];var cb;var cg;var ce=true;if(ca==2){ce=false;ca=0}var cd=function(cm){if(ck==V&&aI==true){if(cm==-1){ci(null)}else{ci(cm)}return}if(!cm||cm.length<=0){if(ca==1){ci(-1);return-1}else{ci(null);return null}}if(ck==l){cb=cm[0];cg=0}else{for(cg=0;cg<cm.length;++cg){if(W(cm[cg].signCert.issuer).toLowerCase().indexOf(cc.toLowerCase())>=0){if(cm[cg].signCert.serialNumber.toLowerCase()==ch.toLowerCase()){cb=cm[cg];break}}}}if(!cb){if(ca==1){ci(-1);return-1}else{ci(null);return null}}if(ca==1){ci(cg)}else{ci(cb)}};if(ck==V){if(aI==true){var cl=function(cm){if(cm==-5e3){aI=false;aA.getCertKeyList(null,cd)}else{cd(cm)}};aA.getCertKeyListOpenCertWithPassword(null,ch,cf,ce,cl)}else{aA.getCertKeyList(null,cd)}}else{if(ck==r){aA.getCertKeyList("session",cd)}else{if(ck==l){cj=aA.getMemCertKeyList();cd(cj)}else{if(ck==Y){cj=aA.getXfsCertKeyList();cd(cj)}}}}}function w(ca){ae.setError(ca)}function a9(ca){ae.addError(ca)}function bs(){ae.resetError()}function aU(){return ae.getError()}function M(){return ae.getError().code}function bV(){if(bP==ai){return ae.getError().msg_koKR?ae.getError().msg_koKR:ae.getError().internal}else{return ae.getError().msg_enUS?ae.getError().msg_enUS:ae.getError().internal}}function aw(){return ae.getError().internal}function b5(ca){b._setSecureInput(ca);X._setSecureInput(ca);aA._setSecureInput(ca);E._setSecureInput(ca)}function bJ(){return b._getSecureInput()}function n(ca){if(bP==ai){return aR[ca]?aR[ca]:ca}else{return br[ca]?br[ca]:ca}}function Z(ca){if(bP==ai){return H[ca]?H[ca]:B}else{return c[ca]?c[ca]:A}}function aV(ca,cc,cb,cd){if(cd==0){aR[ca]=cc}else{br[ca]=cc}return 0}function aE(cc,cb,ca,cd){if(cd==0){H[cc]=cb}else{c[cc]=cb}return 0}function bR(ca,cb){var cc=function(cd){if(cd!=0){a9(ae.XCRYPTO_SOFO_STORAGE_SETLOCALSTORAGE)}cb(cd)};aA.setLocalStorage("lastLocation",ca,cc)}function bK(ca){aA.getLocalStorage("lastLocation",ca)}function ax(cb,ca){return b.generateRandom(cb)}function aZ(ca,cb){var cc=function(cd){if(cd!=0){a9(ae.XCRYPTO_SOFO_STORAGE_SETSESSIONSTORAGE)}cb(cd)};aA.setSessionStorage("cacheCertLocation",ca,0,cc)}function T(ca,cc){var cb=function(cd){if(cd==null||cd==""){cc(0)}else{if(ca=="undefined"||ca==null||ca==0){cc(parseInt(cd/100))}else{cc(cd)}}};aA.getSessionStorage("cacheCertLocation",0,cb)}function be(ca){if(aj.length>0){if(aj.indexOf(ca)>=0){return true}else{return false}}return false}function e(cb,cd,cc,ca,cg,ce){var cf;if(cb==l){cf=b.certificateToPKCS12(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,cg,cg,0);cd=null;cc=null}else{cf=null}var ch=function(ci){if(ci!=0){a9(ae.INTERFACE_SIGNDATA+ae.XCRYPTO_SOFO_STORAGE_SETCACHEDCERT)}ce(ci)};aA.setCachedCert(cb,cd,cc,cf,cg,b._getSecureInput(),ch)}function af(ca,cc){var cb=function(cg){if(cg){if(cg.mediaID!=ca){a9(ae.XCRYPTO_SOFO_STORAGE_GETCACHEDCERT);cc(null)}if(cg.secureInput){var cj=b._getSecureInput();if(cj){var ch=cg.secureInput.split("|");var ck=cj.split("$");var cd=false;for(var ci=0;ci<ck.length;ci++){var cf=ck[ci].split("|");if(cf[0]==ch[0]){cd=true}}if(!cd){cj+="$";cj+=cg.secureInput;b5(cj)}}else{b5(cg.secureInput)}}if(cg.mediaID==V){var ce=function(cl){cg.cert=cl;cc(cg)};b7(cg.mediaID,cg.issuerRDN,cg.serialNumber,cg.keyword,0,ce)}else{if(cg.mediaID==l){cg.cert=b.certificateFromPFX(cg.cert,cg.keyword);cc(cg)}else{a9(ae.XCRYPTO_SOFO_STORAGE_GETCACHEDCERT);cc(null)}}}else{a9(ae.XCRYPTO_SOFO_STORAGE_GETCACHEDCERT);cc(null)}};aA.getCachedCert(cb)}function G(cb,ca){var cc=function(cd){if(cd!=0){a9(ae.XCRYPTO_SOFO_STORAGE_SETSESSIONSTORAGE)}ca(cd)};aA.setSessionStorage("cachedData",cb,1,cc)}function aN(ca){return aA.getSessionStorage("cachedData",1,ca)}function F(cb){var ca=function(cc){if(cc==null||cc==""){cb(-1)}else{cb(0)}};aA.getSessionStorage("cachedData",0,ca)}function bg(cb){var ca=function(cc){if(cc==null||cc==""){cb(-1)}else{aA.deleteSessionStorage("cachedData",cb)}};aA.getSessionStorage("cachedData",0,ca)}function ac(cg){aW=cg;au();x.enable=false;x.desktop=false;x.mobile=false;K.enable=false;K.desktop=false;K.mobile=false;L.enable=false;L.desktop=false;L.mobile=false;var cf=b.verifySignedData(cg,"",0);if(!cf){w(ae.INTERFACE_SETLICENSE+ae.ERROR_SETLICENSE_FAIL);return-1}var cc="e=camaster@softforum.com,cn=Softforum Root Authority,o=Softforum Corporation,c=KR";if(cc!=W(cf.cert[0].issuer)){w(ae.INTERFACE_SETLICENSE+ae.ERROR_SETLICENSE_FAIL);return-1}var ce=window.location.hostname;if(window.location.port){ce+=":"+window.location.port}if(cf.plain.indexOf(ce)<0){w(ae.INTERFACE_SETLICENSE+ae.ERROR_SETLICENSE_FAIL);return-1}var cb=cf.plain.toLowerCase().split(",");for(var cd=0;cd<cb.length;cd++){if(cb[cd].indexOf(bO)>=0){x.enable=true;var ca=cb[cd].split("=");if(ca.length==2){if(ca[1]==bx){x.desktop=true}else{if(ca[1]==u){x.mobile=true}}}else{x.desktop=true;x.mobile=true}}if(cb[cd].indexOf(y)>=0){K.enable=true;var ca=cb[cd].split("=");if(ca.length==2){if(ca[1]==bx){K.desktop=true}else{if(ca[1]==u){K.mobile=true}}}else{K.desktop=true;K.mobile=true}}if(cb[cd].indexOf(aD)>=0){L.enable=true;var ca=cb[cd].split("=");if(ca.length==2){if(ca[1]==bx){L.desktop=true}else{if(ca[1]==u){L.mobile=true}}}else{L.desktop=true;L.mobile=true}}if(cb[cd].indexOf("anypin_servercert")>=0){var ca=cb[cd].split("=");if(ca.length==2){K.cert=ca[1];E.setLicense(K.cert)}}}return 0}function p(){return aW}function a5(){if(!aG){au()}if(x.enable){if(aG==bx&&x.desktop){return true}if(aG==u&&x.mobile){return true}}return false}function bh(){if(!aG){au()}if(K.enable){if(aG==bx&&K.desktop){return true}if(aG==u&&K.mobile){return true}}return false}function bi(){if(!aG){au()}if(L.enable){if(aG==bx&&L.desktop){return true}if(aG==u&&L.mobile){return true}}return false}function U(cd,cf){var cc=cf.toLowerCase().split(":");if(cc.length<2){w(ae.INTERFACE_SETSECURITYCONTEXT+ae.ERROR_INCORRECT_PARAM);return-1}var ca=Number(cc[0]);if(!(ca&512)){return 0}var cb=[];for(var ch=1;ch<cc.length;ch++){if(cc[ch]=="browser"){cb.push(V);cb.push(l)}}if(cb.length==0){return 0}var cj;var ci;if(ca&128){var ce=cd.split(";");if(ce.length<2){w(ae.INTERFACE_SETSECURITYCONTEXT+ae.ERROR_INCORRECT_PARAM);return-1}cj=ce[1];ci=ce[0]}else{cj=cd;ci=window.location.protocol+"//"+window.location.hostname+":"+(window.location.port?window.location.port:"80")}var ck=b.verifySignedData(cj,"",0);if(!ck){a9(ae.INTERFACE_SETSECURITYCONTEXT+ae.XCRYPTO_SOFO_PKI_VERIFYSIGNEDDATA);return-1}if(ci.indexOf(ck.plain)<0){w(ae.INTERFACE_SETSECURITYCONTEXT+ae.ERROR_GETPLAINDATAOFSIGNDATA);return-1}var cg="e=camaster@softforum.com,cn=Softforum Root Authority,o=Softforum Corporation,c=KR";if(cg!=W(ck.cert[0].issuer)){w(ae.INTERFACE_SETSECURITYCONTEXT+ae.ERROR_GETPLAINDATAOFSIGNDATA);return-1}bF=cj;aa=ca;aj=cb;return 0}function ap(cd,cc,ca){var ce=0;if(cd==l){aA.clearMemCertKeyList();if(ca){ca(0)}else{return 0}}else{if(cd==Y){aA.clearXfsCertKeyList();if(ca){var cb=function(cf){if(cf!=0){a9(ae.INTERFACE_GETMEDIALIST+ae.XCRYPTO_SOFO_XFS_USEREXTENSION)}ca(cf)};X.userExtension(cb)}else{ce=X.userExtension();if(ce!=0){a9(ae.INTERFACE_GETMEDIALIST+ae.XCRYPTO_SOFO_XFS_USEREXTENSION)}return ce}}else{if(!window.localStorage||typeof localStorage=="undefined"){ce=-1;w(ae.INTERFACE_GETMEDIALIST+ae.ERROR_NOT_SUPPORTED_MEDIA)}if(ca){ca(ce)}else{return ce}}}}function bp(cg,ck,cj,ch){var cl=[];var cb=[];var cm=false;var cc=false;if(typeof ck==="string"&&ck!=""){cl=ck.split(",")}if(typeof cj==="string"&&cj!=""){cb=cj.split(",")}if(cl.length>0&&ch!=I){if(ch==bz){for(var cf=0;cf<cl.length;++cf){var ce;var ca;if(aI==true&&typeof cg.issuer=="string"){var ci=cg.issuer.split(",");ce=ci[0].substring(3);if(ce){ce=forge.util.decodeUtf8(ce);if(cl[cf].indexOf(ce)>=0){if(cl[cf].indexOf(":")>=0){if(cl[cf].indexOf(cg.policyOID)>=0){cm=true;return cm}}else{cm=true;return cm}}}}else{ce=cg.issuer.getField("CN");if(ce){ce=forge.util.decodeUtf8(ce.value);var cd=cl[cf].split(":");if(cd[0]==ce){if(cl[cf].indexOf(":")>=0){ca=a3(cg.getExtension("certificatePolicies"));if(cl[cf].indexOf(ca.policy)>=0){cm=true;break}}else{cm=true;break}}}}}}else{if(ch==aP){if(W(cg.issuer).toLowerCase()==ck.toLowerCase()){cm=true}}}}else{cm=true}if(cm){if(cb.length>0){for(var cf=0;cf<cb.length;++cf){if(cg.serialNumber.toLowerCase()==cb[cf].toLowerCase()){cc=true;break}}}else{cc=true}}return cc}function bw(cm,cb,ce,cq,ci,cl){var ch=function(cs){var cv=[];if(!cs||cs.length==0||cs==-1){if(cl){cl("")}return""}var cx="";if(cm==V&&aI==true){if(cs.length==undefined){cx+=by(cs.signCert,ci)}else{if(ci==bN){for(var ct=0;ct<cs.length;ct++){if(bp(cs[ct],ce,cq,cb)){cx+=aB(cs[ct],ci)}}}else{if(cs==-1){if(cl){cl("")}return""}cx+=aB(cs.signCert,ci)}}}else{for(var ct=0;ct<cs.length;ct++){var cr,cw=null;if(cm==Y&&ci==bN){cr=cs[ct].cert;var cu,cy;if(!cr){continue}else{if(cr.charAt(0)=="3"){cy=forge.util.hexToBytes(cr)}else{if(cr.charAt(0)=="M"){cy=forge.util.decode64(cr)}else{continue}}}cu=forge.asn1.fromDer(cy);cr=forge.pki.certificateFromAsn1(cu);if(cs[ct].kmCert){if(cs[ct].kmCert.charAt(0)=="3"){cy=forge.util.hexToBytes(cs[ct].kmCert);cu=forge.asn1.fromDer(cy);cw=forge.pki.certificateFromAsn1(cu)}else{if(cs[ct].kmCert.charAt(0)=="M"){cy=forge.util.decode64(cs[ct].kmCert);cu=forge.asn1.fromDer(cy);cw=forge.pki.certificateFromAsn1(cu)}}}aA.saveXfsCertKey(cr,null,cw,null);if(cs[ct].statusCode==201){if(cs[ct].expireMsg==203){cr.status="0"}else{if(cs[ct].expireMsg==205){cr.status="1"}else{if(cs[ct].expireMsg==204){cr.status="2"}else{cr.status="2"}}}}else{if(cs[ct].statusCode==202){cr.status="3"}else{cr.status="2"}}}else{cr=cs[ct].signCert}if(bp(cr,ce,cq,cb)){cv=cv.concat(cr)}}for(var ct=0;ct<cv.length;ct++){cx+=by(cv[ct],ci)}}if(cl){cl(cx)}return cx};if(cm==V){if(aI==true){var cp=function(cr){if(cr==-5e3){aI=false;return aA.getCertKeyList(null,ch)}else{ch(cr)}};if(cq.length==0){return aA.getCertKeyListOpenCert(null,cp)}else{return aA.getCertKeyListOpenCertWithPassword(null,cq,"",true,cp)}}else{return aA.getCertKeyList(null,ch)}}else{if(cm==r){return aA.getCertKeyList("session",ch)}else{if(cm==l){var ck=aA.getMemCertKeyList();return ch(ck)}else{if(cm==Y){if(ci==bN){if(cl){X.certList(ch)}else{var ck=X.certList();return ch(ck)}}else{var ck=aA.getXfsCertKeyList();return ch(ck)}}else{if(cm==bH){var ck=[];if(bT.type==0){if(!bT.certList){if(cl){cl("")}return""}var ca=JSON.parse(bT.certList);if(!ca||!ca.item||ca.item.length==0){if(cl){cl("")}return""}for(var cf=0;cf<ca.item.length;cf++){var cd=ca.item[cf].cert;var cc,cj;if(!cd){continue}else{if(cd.charAt(0)=="3"){cj=forge.util.hexToBytes(cd)}else{if(cd.charAt(0)=="M"){
cj=forge.util.decode64(cd)}else{continue}}}cc=forge.asn1.fromDer(cj);var cg={};cg.signCert=forge.pki.certificateFromAsn1(cc);ck.push(cg)}}else{var co=document.getElementById(bT.storageElementID);if(!co){if(cl){cl("")}return""}var cn=co.getElementsByClassName("list");if(!cn||cn.length==0){if(cl){cl("")}return""}for(var cf=0;cf<cn.length;cf++){var cd=cn[cf].getAttribute("data-cert");var cc,cj;if(!cd){continue}else{if(cd.charAt(0)=="3"){cj=forge.util.hexToBytes(cd);cc=forge.asn1.fromDer(cj)}else{if(cd.charAt(0)=="M"){cj=forge.util.decode64(cd);cc=forge.asn1.fromDer(cj)}else{continue}}}var cg={};cg.signCert=forge.pki.certificateFromAsn1(cc);ck.push(cg)}}if(ck.length==0){if(cl){cl("")}return""}return ch(ck)}else{if(cl){cl("")}return""}}}}}}function bc(ca,cc,cb,cf,ce){var cd=function(cg){if(!cg){w(ae.INTERFACE_VERIFYCERT+ae.ERROR_GETCERTIFICATE);if(ce){ce(-1)}return-1}var ch=b.verifyCertificate(cg.signCert,cf);if(ch!=0&&ch!=1){a9(ae.INTERFACE_VERIFYCERT+ae.XCRYPTO_SOFO_PKI_VERIFYCERTIFICATE)}if(ce){ce(ch)}return ch};return b7(ca,cc,cb,"",2,cd)}function a7(ca,cc,cb,cf,cg,ce){var cd=function(ch){if(!ch){w(ae.INTERFACE_VERIFYCERTOWNER+ae.ERROR_GETCERTIFICATE);if(ce){ce(-1)}return-1}var ci=b.identifyVID(ch.signCert,ch.signKey,cf,cg);if(ci!=0){a9(ae.INTERFACE_VERIFYCERTOWNER+ae.XCRYPTO_SOFO_PKI_IDENTIFYVID)}if(ce){ce(ci)}return ci};return b7(ca,cc,cb,cf,2,cd)}function a8(ca,ce,cc,cg,cb){var cf=function(ci){if(!ci){if(M()==0){w(ae.INTERFACE_VERIFYCERTPWD+ae.ERROR_GETCERTIFICATE)}if(cb){cb(-1)}return-1}if(b.checkPrivateKey(ci.signKey,cg)!=0){if(M()==0){a9(ae.INTERFACE_VERIFYCERTPWD+ae.XCRYPTO_SOFO_PKI_CHECKPRIVATEKEY)}if(cb){cb(-1)}return-1}if(ci.kmCert&&ci.kmKey){if(b.checkPrivateKey(ci.kmKey,cg)!=0){if(M()==0){w(ae.INTERFACE_VERIFYCERTPWD+ae.ERROR_INCORRECT_PASSWORD_KMCERT)}if(cb){cb(-1)}return-1}}if(cb){cb(0)}return 0};if(ca==Y){if(cb){var cd=function(ci){if(ci!=0){a9(ae.INTERFACE_VERIFYCERTPWD+ae.XCRYPTO_SOFO_XFS_CERTPASSWORDCONFIRM)}cb(ci)};X.certPasswordConfirm(ce,cc,cg,cd)}else{var ch=X.certPasswordConfirm(ce,cc,cg);if(ch!=0){a9(ae.INTERFACE_VERIFYCERTPWD+ae.XCRYPTO_SOFO_XFS_CERTPASSWORDCONFIRM)}return ch}}else{return b7(ca,ce,cc,cg,2,cf)}}function t(cc,ca,cb){var cd;if(cb&2){if(cb&1){cd=b.checkKeyword2(cc,ca,1)}else{cd=b.checkKeyword2(cc,ca,0)}if(cd!=0){a9(ae.INTERFACE_CHECKPWD+ae.XCRYPTO_SOFO_PKI_CHECKKEYWORD2)}}else{if(cb&1){cd=b.checkKeyword(cc,ca,1)}else{cd=b.checkKeyword(cc,ca,0)}if(cd!=0){a9(ae.INTERFACE_CHECKPWD+ae.XCRYPTO_SOFO_PKI_CHECKKEYWORD)}}return cd}function aS(cj,cc,ce,ca,cb,ch,cf){var cd=function(ck){if(!ck){w(ae.INTERFACE_CHANGECERTPWD+ae.ERROR_GETCERTIFICATE);if(cf){cf(-1)}return-1}var co=b.changeEncryptPrivateKey(ck.signKey,ca,cb);var cn=null;if(!co){a9(ae.INTERFACE_CHANGECERTPWD+ae.XCRYPTO_SOFO_PKI_CHANGEENCRYPTPRIVATEKEY);if(cf){cf(-1)}return-1}if(ck.kmCert&&ck.kmKey){cn=b.changeEncryptPrivateKey(ck.kmKey,ca,cb);if(!cn){a9(ae.INTERFACE_CHANGECERTPWD+ae.XCRYPTO_SOFO_PKI_CHANGEENCRYPTPRIVATEKEY);if(cf){cf(-1)}return-1}}var cl=function(cp){if(cp>=0){if(cf){cf(0)}return 0}else{a9(ae.INTERFACE_CHANGECERTPWD+ae.XCRYPTO_SOFO_STORAGE_CHANGECERTPRIKEY);if(cf){cf(-1)}return-1}};if(cj==r){aA.changeCertPriKey(ck.signCert,co,ck.kmCert,cn,"session",cl)}else{if(aI==true){var cm=function(cp){if(cp==-5e3){aI=false;aA.changeCertPriKey(ck.signCert,co,ck.kmCert,cn,null,cl)}else{cl(cp)}};aA.changeOpenCertPriKey(ck.signCert,co,ck.kmCert,cn,ca,cb,null,cm)}else{aA.changeCertPriKey(ck.signCert,co,ck.kmCert,cn,null,cl)}}};if(cj==V){return b7(V,cc,ce,ca,0,cd)}else{if(cj==r){return b7(r,cc,ce,"",0,cd)}else{if(cj==Y){if(cf){var cg=function(ck){if(ck!=0){a9(ae.INTERFACE_CHANGECERTPWD+ae.XCRYPTO_SOFO_XFS_CERTPASSWORDUPDATE)}cf(ck)};X.certPasswordUpdate(cc,ce,ca,cb,ch,cg)}else{var ci=X.certPasswordUpdate(cc,ce,ca,cb,ch);if(ci!=0){a9(ae.INTERFACE_CHANGECERTPWD+ae.XCRYPTO_SOFO_XFS_CERTPASSWORDUPDATE)}return ci}}else{w(ae.INTERFACE_CHANGECERTPWD+ae.ERROR_INCORRECT_PARAM);if(cf){cf(-1)}return-1}}}}function ag(cg,cb,cc,cd){var ca=function(ck){if(ck<0){w(ae.INTERFACE_DELETECERT+ae.ERROR_GETCERTIFICATE);if(cd){cd(-1)}return-1}var cj=function(cm){if(cm==0){if(cd){cd(0)}return 0}else{a9(ae.INTERFACE_DELETECERT+ae.XCRYPTO_SOFO_STORAGE_DELETECERT);if(cd){cd(-1)}return-1}};if(cg==r){aA.deleteCert(ck,"session",cj)}else{if(aI==true){var cl=function(cm){if(cm==-5e3){aI=false;aA.deleteCert(ck,null,cj)}else{certListCallbackSecond(cm)}};aA.deleteOpenCert(ck,null,cl)}else{aA.deleteCert(ck,null,cj)}}};if(cg==V){if(aI==true){var ch=function(cj){if(cj==0){if(cd){cd(0)}return 0}else{a9(ae.INTERFACE_DELETECERT+ae.XCRYPTO_SOFO_STORAGE_DELETECERT);if(cd){cd(-1)}return-1}};var ci=function(cj){if(cj==-5e3){aI=false;return b7(V,cb,cc,"",1,ca)}else{ch(cj)}};aA.deleteOpenCertFromID(cc,null,ci)}else{return b7(V,cb,cc,"",1,ca)}}else{if(cg==r){return b7(r,cb,cc,"",1,ca)}else{if(cg==l){aA.clearMemCertKeyList();if(cd){cd(0)}return 0}else{if(cg==Y){if(cd){var ce=function(cj){if(cj!=0){a9(ae.INTERFACE_DELETECERT+ae.XCRYPTO_SOFO_XFS_CERTDELETE)}cd(cj)};X.certDelete(cb,cc,ce)}else{var cf=X.certDelete(cb,cc);if(cf!=0){a9(ae.INTERFACE_DELETECERT+ae.XCRYPTO_SOFO_XFS_CERTDELETE)}return cf}}else{w(ae.INTERFACE_DELETECERT+ae.ERROR_INCORRECT_PARAM);if(cd){cd(-1)}return-1}}}}}function b9(ci,ca,cl,cf,cj,cb,cd,cm,cc,ch){var ce=b.certificateFromDer(ci,ca,cl,cf,cj);if(!ce){a9(ae.INTERFACE_SETCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMDER);if(ch){ch(-1)}return-1}if(!bp(ce.signCert,cd,cm,cb)){w(ae.INTERFACE_SETCERT+ae.ERROR_USE_CERT_FAIL);if(ch){ch(-1)}return-1}aA.clearMemCertKeyList();aA.saveMemCertKey(ce.signCert,ce.signKey,ce.kmCert,ce.kmKey);if(cc&1){var cg=function(cp){if(cp==1){if(o(av)==true){var co=function(cq){if(cq!=0){a9(ae.INTERFACE_SETCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY)}if(ch){ch(cq)}};if(aI==true){var cn=function(cq){if(cq==-5e3){aI=false;aA.saveCertKey(ce.signCert,ce.signKey,ce.kmCert,ce.kmKey,null,1,co)}else{co(cq)}};aA.saveOpenCertKey(ce.signCert,ce.signKey,ce.kmCert,ce.kmKey,cj,null,1,0,cn)}else{aA.saveCertKey(ce.signCert,ce.signKey,ce.kmCert,ce.kmKey,null,1,co)}}else{if(ch){ch(1)}}}else{if(cp!=0){a9(ae.INTERFACE_SETCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY)}if(ch){ch(cp)}}};if(aI==true){var ck=function(cn){if(cn==-5e3){aI=false;aA.saveCertKey(ce.signCert,ce.signKey,ce.kmCert,ce.kmKey,null,0,cg)}else{cg(cn)}};aA.saveOpenCertKey(ce.signCert,ce.signKey,ce.kmCert,ce.kmKey,cj,null,0,0,ck)}else{aA.saveCertKey(ce.signCert,ce.signKey,ce.kmCert,ce.kmKey,null,0,cg)}}else{if(ch){ch(0)}return 0}}function ay(ch,cg,ca,cc,cj,cb,cf){var cd=b.certificateFromPFX(ch,cg);if(!cd){a9(ae.INTERFACE_SETCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMPFX);if(cf){cf(-1)}return-1}if(!bp(cd.signCert,cc,cj,ca)){w(ae.INTERFACE_SETCERT+ae.ERROR_USE_CERT_FAIL);if(cf){cf(-1)}return-1}aA.clearMemCertKeyList();aA.saveMemCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey);if(cb&1){var ce=function(cm){if(cm==1){if(o(av)==true){var cl=function(cn){if(cn!=0){a9(ae.INTERFACE_SETCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY)}if(cf){cf(cn)}};if(aI==true){var ck=function(cn){if(cn==-5e3){aI=false;aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,1,cl)}else{cl(cn)}};aA.saveOpenCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,cg,null,1,0,ck)}else{aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,1,cl)}}else{if(cf){cf(1)}}}else{if(cm!=0){a9(ae.INTERFACE_SETCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY)}if(cf){cf(cm)}}};if(aI==true){var ci=function(ck){if(ck==-5e3){aI=false;aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,0,ce)}else{ce(ck)}};aA.saveOpenCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,cg,null,0,0,ci)}else{aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,0,ce)}}else{if(cf){cf(0)}return 0}}function aY(cg,ca,ch,ck,cf,cj,ci,cb,ce){var cd=b.certificateFromCMP(cg,ca,ck,cf,cj,ch);if(!cd){a9(ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMCMP);ce(-1);return-1}var cc=function(cl){var cm=function(){if(ci==l){aA.clearMemCertKeyList();aA.saveMemCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey);if(cb&2){if(ce){ce(by(cd.signCert,bN))}return 0}else{if(ce){ce(0)}return 0}}var cr=function(cu){if(cu==1){if(o(av)==true){var ct=function(cw){if(cw==0){if(cb&2){if(ce){ce(by(cd.signCert,bN))}return 0}else{ce(0);return 0}}else{a9(ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY);ce(-1);return-1}if(ci==r){aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,"session",1,ct)}else{if(aI==true){var cv=function(cx){if(cx==-5e3){aI=false;aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,1,ct)}else{ct(cx)}};aA.saveOpenCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,cj,null,1,0,cv)}else{aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,1,ct)}}}}else{ce(1);return 1}}else{if(cu!=0){a9(ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY);ce(cu);return cu}if(cb&2){if(ce){ce(by(cd.signCert,bN))}return cu}else{ce(cu);return cu}}};if(ci==r){aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,"session",0,cr)}else{if(aI==true){var cs=function(ct){if(ct==-5e3){aI=false;aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,0,cr)}else{cr(ct)}};aA.saveOpenCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,cj,null,0,0,cs)}else{aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,0,cr)}}};var cq=false;if(cl.length>0){for(var cn=0;cn<cl.length;++cn){if(W(cl[cn].signCert.issuer).toLowerCase().indexOf(W(cd.signCert.issuer).toLowerCase())>=0){if(W(cl[cn].signCert.subject).toLowerCase().indexOf(W(cd.signCert.subject).toLowerCase())>=0){cq=true;var cp=function(cr){if(cr!=0){a9(ae.XCRYPTO_SOFO_STORAGE_DELETECERT);ce(-1);return-1}cm()};if(ci==r){aA.deleteCert(cn,"session",cp)}else{if(aI==true){var co=function(cr){if(cr==-5e3){aI=false;aA.deleteCert(cn,null,cp)}else{cp(cr)}};aA.deleteOpenCertFromIndex(cn,null,co)}else{aA.deleteCert(cn,null,cp)}}}}}}if(cq===false){cm()}};if(ci==r){aA.getCertKeyList("session",cc)}else{aA.getCertKeyList(null,cc)}}function aC(cn,cl,ck,cm,cb,cg){if(ck==l){var cd=b.certificateFromPFX(cn,cl,cm);if(!cd){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMPFX);if(cg){cg(-1)}return-1}aA.clearMemCertKeyList();aA.saveMemCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey);if(cg){cg(0)}return 0}else{if(ck==V){var cd=b.certificateFromPFX(cn,cl,cm);if(!cd){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMPFX);if(cg){cg(-1)}return-1}var ch=function(cr){if(cr==1){if(o(av)==true){var cq=function(cs){if(cs==0){if(cg){cg(0)}}else{a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY);if(cg){cg(-1)}}};if(aI==true){var cp=function(cs){if(cs==-5e3){aI=false;aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,1,cq)}else{cq(cs)}};aA.saveOpenCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,cl,null,1,0,cp)}else{aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,1,cq)}}else{if(cg){cg(1)}}}else{if(cr!=0){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY)}if(cg){cg(cr)}return cr}};if(aI==true){var co=function(cp){if(cp==-5e3){aI=false;aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,0,ch)}else{ch(cp)}};aA.saveOpenCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,cl,null,0,0,co)}else{aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,0,ch)}}else{if(ck==Y){if(cb&1){var cd=b.certificateFromPFX(cn,cl,cm);if(!cd){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMPFX);if(cg){cg(-1)}return-1}var ca=function(cp){aA.deleteXfsCertKey(cp);aA.saveXfsCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey);if(cg){cg(0)}return 0};b7(Y,W(cd.signCert.issuer),cd.signCert.serialNumber,"",1,ca)}else{var cc;try{if(typeof cn=="string"){if(cn.charAt(0)=="3"){var cf=forge.util.hexToBytes(cn);cc=forge.util.encode64(cf)}else{if(cn.charAt(0)=="M"){cc=cn}else{w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cg){cg(-1)}return-1}}}else{var cf=forge.util.createBuffer(cn);cc=forge.util.encode64(cf.getBytes())}}catch(ce){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM,ce);if(cg){cg(-1)}return-1}if(cg){var ci=function(cp){if(cp!=0){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_XFS_CERTPFXIMPORT)}cg(cp)};X.certPfxImport(cc,cm,ci)}else{var cj=X.certPfxImport(cc,cm);if(cj!=0){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_XFS_CERTPFXIMPORT)}return cj}}}else{w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cg){cg(-1)}return-1}}}}function a(cj,ca,cp,cf,cm,cl,cn,cb,ch){if(cl==l||cl==V){var cd=b.certificateFromDer(cj,ca,cp,cf,cm,cn);if(!cd){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMDER);if(ch){ch(-1)}return-1}if(cl==l){aA.clearMemCertKeyList();aA.saveMemCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey);if(ch){ch(0)}return 0}else{var cg=function(cs){if(cs==1){if(o(av)==true){var cr=function(ct){if(ct==0){if(ch){ch(0)}return 0}else{a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY);if(ch){ch(-1)}return-1}};if(aI==true){var cq=function(ct){if(ct==-5e3){aI=false;aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,1,cr)}else{cr(ct)}};aA.saveOpenCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,cm,null,1,0,cq)}else{aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,1,cr)}}else{if(ch){ch(1)}}}else{if(cs!=0){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY);if(ch){ch(-1)}return-1}if(ch){ch(cs)}}};if(aI==true){var co=function(cq){if(cq==-5e3){aI=false;aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,0,cg)}else{cg(cq)}return};aA.saveOpenCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,cm,null,0,0,co)}else{aA.saveCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,null,0,cg)}}}else{if(cl==Y){if(cb&1){var cd=b.certificateFromDer(cj,ca,cp,cf,cm,cn);if(!cd){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMDER);if(ch){ch(-1)}return-1}var ce=b7(Y,W(cd.signCert.issuer),cd.signCert.serialNumber,"",1);aA.deleteXfsCertKey(ce);aA.saveXfsCertKey(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey);if(ch){ch(0)}return 0}else{var cd=b.certificateFromDer(cj,ca,cp,cf,cm,cm);if(!cd){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMDER);if(ch){ch(-1)}return-1}var cc=b.certificateToPKCS12(cd.signCert,cd.signKey,cd.kmCert,cd.kmKey,cm,cm,1);if(!cc){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATETOPKCS12);if(ch){ch("")}return""}if(ch){var ci=function(cq){if(cq!=0){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_XFS_CERTPFXIMPORT)}ch(cq)};X.certPfxImport(cc,cn,ci)}else{var ck=X.certPfxImport(cc,cn);if(ck!=0){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_XFS_CERTPFXIMPORT)}return ck}}}else{w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(ch){ch(-1)}return-1}}}function ao(ca,cd,cc,ch,cg,cb,cf){var ce=function(ck){if(!ck){cf(-1)}var cl=b.certificateToPKCS12(ck.signCert,ck.signKey,ck.kmCert,ck.kmKey,ch,cg,0);if(!cl){cf(-1)}var ci;if(cb){ci=cb}else{ci=forge.util.decodeUtf8(ck.signCert.subject.getField("CN").value);if(ci){ci+=".pfx"}else{ci="cert.pfx"}}var cj=document.createElement("a");if("download"in cj){cj.setAttribute("href","data:application/x-pkcs12;base64,"+cl);cj.setAttribute("download",ci);cj.style.display="none";document.body.appendChild(cj);cj.click();document.body.removeChild(cj)}else{cf(-1)}cf(0)};b7(ca,cd,cc,ch,2,ce)}function b8(ck,cd,ce,cg,ch,cc,ci){var ca=function(cl){if(!cl){w(ae.INTERFACE_EXPORTCERT+ae.ERROR_GETCERTIFICATE);if(ci){ci("")}return""}var cm=b.certificateToPKCS12(cl.signCert,cl.signKey,cl.kmCert,cl.kmKey,cg,ch,cc);if(!cm){a9(ae.INTERFACE_EXPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATETOPKCS12);if(ci){ci("")}return""}if(ci){ci(cm)}return cm};if(ck==l||ck==V){var cb=b7(ck,cd,ce,cg,2,ca)}else{if(ck==Y){var cj=function(cl){var cm;if(cl.charAt(0)=="3"){if(cc&1){var cn=forge.util.hexToBytes(cl);cm=forge.util.encode64(cn)}else{cm=cl}}else{if(cl.charAt(0)=="M"){if(cc&1){cm=cl}else{var cn=forge.util.decode64(cl);cm=forge.util.bytesToHex(cn)}}else{cm="";a9(ae.INTERFACE_EXPORTCERT+ae.XCRYPTO_SOFO_XFS_CERTPFXEXPORT)}}if(ci){ci(cm)}else{return cm}};if(ci){X.certPfxExport(cd,ce,cg,cj)}else{var cf=X.certPfxExport(cd,ce,cg);return cj(cf)}}else{w(ae.INTERFACE_EXPORTCERT+ae.ERROR_INCORRECT_PARAM);if(ci){ci("")}return""}}}function aM(ca){if(!ca){return-1}switch(ca.toLowerCase()){case"md5":return 0;case"sha1":return 1;case"sha256":return 2;case"sha384":return 3;case"sha512":return 4;default:return-1}}function aq(cs,ct,cl,cv,cb,ch,ck,cw,cp){var cg;if(ck==0){cg=ae.INTERFACE_SIGNDATA}else{if(ck==1){cg=ae.INTERFACE_SIGNDATAADD}else{if(ck==2){cg=ae.INTERFACE_SIGNDATA_UCPID}else{bB.log("_signData error");return}}}if(cs==Y&&an.signType!=k){var cm=null;if(!ct||!cl||!cv){w(cg+ae.ERROR_INCORRECT_PARAM);if(cw){cw("")}return""}var cr=function(cy){if(!cy){if(an.signType==v){a9(cg+ae.XCRYPTO_SOFO_XFS_CERTDIGESTSIGN)}else{a9(cg+ae.XCRYPTO_SOFO_XFS_CERTSIGN)}if(cw){cw("")}return""}var cx=b.convertSignedData(cy,cm,ch,at);if(!cx){a9(cg+ae.XCRYPTO_SOFO_PKI_CONVERTSIGNEDDATA);if(cw){cw("")}return""}if(cw){cw(cx)}return cx};if(an.signType==k){}else{if(an.signType==v){var co=function(cz){if(!cz||cz.length==0){a9(cg+ae.XCRYPTO_SOFO_XFS_CERTDETAIL);if(cw){cw("")}return""}cz=cz[0];if(!cz.signatureAlgId){w(cg+ae.ERROR_GETCERTIFICATE);if(cw){cw("")}return""}var cy;if(cz.signatureAlgId.indexOf(" ")>0){cy=cz.signatureAlgId.split(" ")[0]}else{if(cz.signatureAlgId.indexOf("+")>0){cy=cz.signatureAlgId.split("+")[0]}else{cy=cz.signatureAlgId}}var cx=aM(cy);if(cx==-1){w(cg+ae.ERROR_GETCERTIFICATE);if(cw){cw("")}return""}cm=cb;var cB=b.hashData(cx,cb,0,at);if(cw){X.certDigestSign(ct,cl,cv,cB,ch,cr)}else{var cA=X.certDigestSign(ct,cl,cv,cB,ch);return cr(cA)}};if(cw){X.certDetail(ct,cl,co)}else{var cu=X.certDetail(ct,cl);return co(cu)}}else{if(cw){X.certSign(ct,cl,cv,cb,ch,at,cr)}else{var cj=X.certSign(ct,cl,cv,cb,ch,at);return cr(cj)}}}}else{var ce=be(cs);var ca;var ci;var cd;var cf;var cn;var cc;var cq=function(cy){if(cs==V&&ct&&cl&&cv||cs==r&&ct&&cl&&cv||cs==l&&cv||cs==Y&&an.signType==k&&ct&&cl&&cv){ca=cy}else{if(!ce){w(cg+ae.ERROR_INCORRECT_PARAM);if(cw){cw("")}return""}ci=cy;if(!ci){w(cg+ae.ERROR_GETCERTIFICATE);if(cw){cw("")}return""}cv=ci.keyword;ca=ci.cert}if(!ca){w(cg+ae.ERROR_GETCERTIFICATE);if(cw){cw("")}return""}if(typeof cb=="object"){cd=ca.signCert.md.algorithm.trim().toLowerCase();cf=cb.hash.split("$");for(var cz=0;cz<cf.length;cz++){cn=cf[cz].split("|");if(cn.length<2){break}if(cn[0].trim().toLowerCase()==cd){cc=cn[1];break}}cb=cb.info+"|"+cc}var cA;if(ck==0){cA=b.signDataCMS(ca.signCert,ca.signKey,cv,cb,ch,at)}else{if(ck==1){cA=b.signDataAddition(ca.signCert,ca.signKey,cv,cb,ch,at)}else{if(ck==2){cA=b.signDataUCPID(ca.signCert,ca.signKey,cv,ct,cb,cp,ch,at)}}}if(cA){if(ce&&!ci){var cx=function(cB){if(cB!=0){a9(cg+ae.XCRYPTO_SOFO_STORAGE_SETCACHEDCERT);if(cw){cw("")}return""}else{if(cw){cw(cA)}return cA}};e(cs,ct,cl,ca,cv,cx)}else{if(cw){cw(cA)}return cA}}else{if(ck==0){a9(cg+ae.XCRYPTO_SOFO_PKI_SIGNDATA)}else{a9(cg+ae.XCRYPTO_SOFO_PKI_SIGNDATAADDITION)}if(cw){cw("")}return""}};if(cs==V&&ct&&cl&&cv||cs==r&&ct&&cl&&cv||cs==l&&cv||cs==Y&&an.signType==k&&ct&&cl&&cv){return b7(cs,ct,cl,cv,2,cq)}else{return af(cs,cq)}}}function bu(cd,cc,cb){var ca=b.verifySignedData(cd,cc,cb,at);if(ca){if(typeof ca.plain=="string"){if(M()!=0){a9(ae.INTERFACE_VERIFYDATA+ae.XCRYPTO_SOFO_PKI_VERIFYSIGNEDDATA)}return ca.plain}else{a9(ae.INTERFACE_VERIFYDATA+ae.XCRYPTO_SOFO_PKI_VERIFYSIGNEDDATA);return""}}else{a9(ae.INTERFACE_VERIFYDATA+ae.XCRYPTO_SOFO_PKI_VERIFYSIGNEDDATA);return""}}function bq(cd,cc,cb){var ca=b.convertSignedData(cd,cc,cb,at);if(ca){return ca}else{a9(ae.INTERFACE_GETSIGNEDDATA+ae.XCRYPTO_SOFO_PKI_CONVERTSIGNEDDATA);return""}}function a6(cj,cd,cg,ck,cf,ch,ci){var cb=be(cj);var cc;var ce;var ca=function(cm){if(cj==V&&cd&&cg&&ck||cj==l&&ck||cj==Y&&an.signType==k&&cd&&cg&&ck){cc=cm}else{if(!cb){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_INCORRECT_PARAM);if(ci){ci("")}return""}ce=cm;if(!ce){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_GETCERTIFICATE);if(ci){ci("")}return""}ck=ce.keyword;cc=ce.cert}if(!cc){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_GETCERTIFICATE);if(ci){ci("")}return""}var cl=b.envelopeIdNum(cc.signCert,cc.signKey,ck,cf,ch);if(cl){if(ci){ci(cl)}return cl}else{a9(ae.INTERFACE_ENVELOPIDNUM+ae.XCRYPTO_SOFO_PKI_ENVELOPEIDNUM);if(ci){ci("")}return""}};if(cj==V&&cd&&cg&&ck||cj==l&&ck||cj==Y&&an.signType==k&&cd&&cg&&ck){return b7(cj,cd,cg,ck,2,ca)}else{return af(cj,ca)}}function bS(cc,cd,ce,cb){var ca=b.envelopeIdNumFincert(cc,cd,ce);if(ca){if(cb){cb(ca)}return ca}else{a9(ae.INTERFACE_ENVELOPIDNUM+ae.XCRYPTO_SOFO_PKI_ENVELOPEIDNUM);if(cb){cb("")}return""}}function j(cj,ck,ch,cn,cd,ci){var cg=[];var cm=[];var cf=0;var cc=cj.split("\t\n");var cl=ck.split("\t\n");var cb=ch.split("\t\n");if(cc.length!=cl.length||cc.length!=cb.length){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);ci("")}for(var ce=0;ce<cc.length;ce++){if(cc[ce]==""){continue}if(cc[ce]==V&&(!cl[ce]||!cb[ce])){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);ci("")}if(cc[ce]==Y&&(!cl[ce]||!cb[ce])){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);ci("")}if(cc[ce]!=l&&cc[ce]!=V&&cc[ce]!=Y){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_NOT_SUPPORTED_MEDIA);ci("")}cg.push({mediaIDList:cc[ce],issuerRDNList:cl[ce],certSerialList:cb[ce]})}var ca=function(cp){if(!cp){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_GETCERTIFICATE);ci("")}cm.push(cp.kmCert?cp.kmCert:cp.signCert);cg.splice(cf,1);if(cg.length!=0){b7(cg[cf].mediaIDList,cg[cf].issuerRDNList,cg[cf].certSerialList,"",2,ca)}if(!cm||cm.length<=0){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_GETCERTIFICATE);ci("")}var co=b.envelopeData(cm,null,cn,cd,at);if(co){ci(co)}else{a9(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.XCRYPTO_SOFO_PKI_ENVELOPEDATA);ci("")}};b7(cg[cf].mediaIDList,cg[cf].issuerRDNList,cg[cf].certSerialList,"",2,ca)}function bU(cc,cf,cd){var cb=[];try{var ch=cc.split(";");for(var ce=0;ce<ch.length;ce++){cb.push(forge.pki.certificateFromPem(ch[ce]))}}catch(cg){w(ae.INTERFACE_ENVELOPEDATAWITHPEM+ae.ERROR_INCORRECT_PARAM,cg);return""}var ca=b.envelopeData(cb,null,cf,cd,at);if(ca){return ca}else{a9(ae.INTERFACE_ENVELOPEDATAWITHPEM+ae.XCRYPTO_SOFO_PKI_ENVELOPEDATA);return""}}function bI(cb,cd,cc){var ca=b.envelopeData(null,cb,cd,cc,at);if(ca){return ca}else{a9(ae.INTERFACE_ENVELOPEDATAWITHPWD+ae.XCRYPTO_SOFO_PKI_ENVELOPEDATA);return""}}function bd(ci,ce,cg,cj,cb,ch){var cc=be(ci);var cd;var cf;var ca=function(cl){if(ci==V&&ce&&cg&&cj||ci==l&&cj||ci==Y&&an.signType==k&&ce&&cg&&cj){cd=cl}else{if(!cc){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);if(ch){ch("")}return""}cf=cl;if(!cf){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_GETCERTIFICATE);if(ch){ch("")}return""}cj=cf.keyword;cd=cf.cert}if(!cd){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_GETCERTIFICATE);if(ch){ch("")}return""}var ck;if(cd.kmCert&&cd.kmKey){ck=b.deenvelopeData(cd.kmCert,cd.kmKey,cj,null,cb,0,at)}else{ck=b.deenvelopeData(cd.signCert,cd.signKey,cj,null,cb,0,at)}if(typeof ck=="string"){if(ch){ch(ck)}return ck}else{a9(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.XCRYPTO_SOFO_PKI_DEENVELOPEDATA);if(ch){ch("")}return""}};if(ci==V&&ce&&cg&&cj||ci==l&&cj||ci==Y&&an.signType==k&&ce&&cg&&cj){return b7(ci,ce,cg,cj,2,ca)}else{return af(ci,ca)}}function N(cb,cc){var ca=b.deenvelopeData(null,null,null,cb,cc,0,at);if(typeof ca=="string"){return ca}else{a9(ae.INTERFACE_DEENVELOPEDATAWITHPWD+ae.XCRYPTO_SOFO_PKI_DEENVELOPEDATA);return""}}function bA(cl,cd,cq,cp,cn,co,cg,ck,cb,cm){try{cg=parseInt(cg);if(typeof cg=="number"){if(cg<0||cg>8){w(ae.INTERFACE_REQUESTCERT+ae.ERROR_INCORRECT_PARAM);if(cm){cm(-1);return}else{return-1}}}else{cg=4}var cj=bW.getWebCMPType(cl);var ca=bW.getWebCMPpKeyID(cl);var cf=bW.getWebCMPOnlySignCert(cl);var ci=bW.getCmpClient(cj,ca,cd,cg,ck,cf);ci.issue(cq,cp,function(cr){if(cr===ae){w(ae.INTERFACE_REQUESTCERT+ae.ERROR_REQUESTCERT);cm(-1);return}aY(cr[0].certificate,cr[0].privateKey,cr[0].vid,cr[1]?cr[1].certificate:null,cr[1]?cr[1].privateKey:null,co,cn,cb,cm)})}catch(ce){var cc="";for(var ch in ce){cc+=ch+" : "+ce[ch]+"\n"}bB.log(cc);w(ae.INTERFACE_REQUESTCERT+ae.ERROR_REQUESTCERT);cm(-1)}}function aK(cf,ci,cl,co,cg,cq,cc,cd,cb,ce,cp){try{cd=parseInt(cd);if(typeof cd=="number"){if(cd<0||cd>8){w(ae.INTERFACE_REQUESTCERT+ae.ERROR_INCORRECT_PARAM);if(cp){cp(-1);return}else{return-1}}}else{cd=4}var cr=bW.getWebCMPType(cf);var cs=bW.getWebCMPpKeyID(cf);var cm=bW.getWebCMPOnlySignCert(cf);var cj=bW.getCmpClient(cr,cs,ci,cd,cb,cm);var ck=function(ct){if(!ct){cp(-1);w(ae.INTERFACE_RENEWCERT+ae.ERROR_GETCERTIFICATE);return}if(aI==true){cg=ct.signCert.serialNumber}cj.update(ct.signCert,ct.signKey,ct.kmCert,ct.kmKey,cg,cq,0,function(cv){if(cv===ae){w(ae.INTERFACE_RENEWCERT+ae.ERROR_RENEWCERT);cp(-1);return}var cu=function(cw){if(ce&2){if(cw==-1||cw==1){a9(ae.INTERFACE_RENEWCERT)}else{cp(cw)}}else{if(cw!=0){a9(ae.INTERFACE_RENEWCERT)}else{cp(0)}}};aY(cv[0].certificate,cv[0].privateKey,cv[0].vid,cv[1]?cv[1].certificate:null,cv[1]?cv[1].privateKey:null,cc,cl,ce,cu)})};b7(cl,co,cg,cq,0,ck)}catch(ch){var ca="";for(var cn in ch){ca+=cn+" : "+ch[cn]+"\n"}bB.log(ca);w(ae.INTERFACE_RENEWCERT+ae.ERROR_RENEWCERT);cp(-1)}}function bY(ca,cd,cb,cc,cf){var ce=function(cg){if(!cg){w(ae.INTERFACE_GETCERT+ae.ERROR_GETCERTIFICATE);return""}if(cc&16){cg=cg.kmCert}else{cg=cg.signCert}if(!cg){w(ae.INTERFACE_GETCERT+ae.ERROR_GETCERTIFICATE);return""}try{var ci;if(cc&2){ci=forge.pki.certificateToPem(cg)}else{if(cc&1){ci=forge.util.encode64(forge.asn1.toDer(forge.pki.certificateToAsn1(cg)).getBytes())}else{ci=forge.util.bytesToHex(forge.asn1.toDer(forge.pki.certificateToAsn1(cg)).getBytes())}}if(ci){cf(ci)}else{w(ae.INTERFACE_GETCERT+ae.ERROR_GETCERTIFICATE);cf("")}}catch(ch){w(ae.INTERFACE_GETCERT+ae.ERROR_GETCERTIFICATE,ch);cf("")}};b7(ca,cd,cb,"",2,ce)}function f(cd,cb,ca){var cc=b.hashData(cd,cb,ca,at);if(cc){return cc}else{a9(ae.INTERFACE_HASHDATA+ae.XCRYPTO_SOFO_PKI_HASHDATA);return""}}function bL(ca,cc,cb){var ch,ce,ci,cf,cg;try{ch=bm.hexToBytes(cc);ce=forge.asn1.fromDer(ch);ci=forge.pki.rsa.publicKeyFromAsn1(ce);cf=ci.encrypt(ca,"RSA-OAEP",{md:forge.md.sha256.create()});cg=bm.bytesToHex(cf)}catch(cd){bB.log("xcrypto._publicKeyEncrypt Fail")}return cg}function b1(ce,cf,cd){var ch="",cb="";var ca=[];var cc="";try{if(Array.isArray(ce)){ca=ce.map(function(cj,ci){ch=forge.util.decode64(cj[2]);cb=bn.decrypt(ch,cf,"\0","seedCBC");cc=bm.decodeUTF8(cb); cj[2]=cc;return cj});return ca}else{ch=forge.util.decode64(ce);cb=bn.decrypt(ch,cf,"\0","seedCBC");cc=bm.decodeUTF8(cb); return cc}}catch(cg){bB.log("xcrypto._seedDecrypt Fail")}return""}function D(cd,cb,cc,ca){return aA.syncOpenCert(cd,cb,cc,ca)}function ba(ca){return aA.setOpenColudTray(ca)}function az(cc,ce,ch,cf,ca,cb,cd,cg){var ci=function(ck){if(ck!=0){cg(ck);return}var cj=function(cm){if(cm!=0){cg(cm);return}var cl=function(co){if(!co){a9(ae.INTERFACE_ANYCERTRELAY_EXPORT+ae.ERROR_GETCERTIFICATE);if(cg){cg(-1)}return-1}if(co.signCert.subject.getField("OU").value.toUpperCase().indexOf("PERSONALB")>=0||co.signCert.subject.getField("OU").value.toUpperCase().indexOf("CORPORATION4ECB")>=0){w(ae.ERROR_NOT_SUPPORTED_BROWSERCERT);if(cg){cg(-1)}return-1}var cq=null;var cp=null;if(ca!=cb){cq=b.changeEncryptPrivateKey(co.signKey,ca,cb);if(!cq){a9(ae.INTERFACE_ANYCERTRELAY_EXPORT+ae.XCRYPTO_SOFO_PKI_CHANGEENCRYPTPRIVATEKEY);if(cg){cg(-1)}return-1}if(co.kmCert&&co.kmKey){cp=b.changeEncryptPrivateKey(co.kmKey,ca,cb);if(!cp){a9(ae.INTERFACE_ANYCERTRELAY_EXPORT+ae.XCRYPTO_SOFO_PKI_CHANGEENCRYPTPRIVATEKEY);if(cg){cg(-1)}return-1}}}else{cq=co.signKey;if(co.kmCert&&co.kmKey){cp=co.kmKey}}var cn=function(cs){if(!cs){if(cg){cg(-1)}return-1}var cu=b.certificateToPKCS12ForCertRelay(co.signCert,cq,co.kmCert,cp,cs,0);if(!cu){a9(ae.INTERFACE_ANYCERTRELAY_EXPORT+ae.XCRYPTO_SOFO_PKI_CERTIFICATETOPKCS12);if(cg){cg(-1)}return-1}var ct=W(co.signCert.subject)+new Date;var cr=b.signDataCMS(co.signCert,cq,cb,ct,0,at);if(!cr){a9(ae.INTERFACE_ANYCERTRELAY_EXPORT+ae.XCRYPTO_SOFO_PKI_SIGNDATA);if(cg){cg(-1)}return-1}var cv=function(cw){if(cw!=0){cg(cw);return}if(cg){cg(cw)}return 0};a4.exportCertRelay(cc,ce,cu,cr,cd,cv)};return a4.generatePKCS12Password(ce,cn)};return b7(V,ch,cf,ca,2,cl)};return a4.registerAuthCode(cc,ce,cd,cj)};return a4.getServerCert(cc,cd,ci)}function R(cb,ce,cd,ca){var cc=function(cg){if(cg!=0){ca(cg);return}var cf=function(ci){if(!ci){if(ca){ca(-1)}return-1}var ch=function(cj){if(cj==-1){ca(-1);return-1}var cl=b.certificateFromPFXForCertRelay(cj,ci);if(!cl){w(ae.INTERFACE_ANYCERTRELAY_IMPORT+ae.ERROR_ACR_CERTIFICATEFROMPFX);if(ca){ca(-1)}return-1}var ck=function(cn){if(cn==1){if(o(av)==true){var cm=function(co){if(co==0){if(ca){ca(0)}return 0}else{if(ca){ca(-1)}return-1}};return aA.saveCertKey(cl.signCert,cl.signKey,cl.kmCert,cl.kmKey,null,1,cm)}else{if(ca){ca(1)}return-1}}else{if(ca){ca(cn)}return cn}};return aA.saveCertKey(cl.signCert,cl.signKey,cl.kmCert,cl.kmKey,null,0,ck)};return a4.importCertRelay(cb,ce,cd,ch)};return a4.generatePKCS12Password(ce,cf)};return a4.getServerCert(cb,cd,cc)}function ah(cb,ce,cd,ca){var cc=function(cg){if(cg!=0){ca(cg);return}var cf=function(ch){if(ch!=0){ca(ch);return}else{ca(ch);return}};return a4.registerAuthCode(cb,ce,cd,cf)};return a4.getServerCert(cb,cd,cc)}function aT(ch,cg,cc,cb,cf,ca,ce,cd){X.init(ch,cg,cc,cd);an.signType=cb;bT.type=cf;bT.certList=ca;bT.storageElementID=ce}function al(cb,cf,ce,cd,ca){if(ca){var cc=function(ch){if(ch!=0){a9(ae.INTERFACE_XFSLOGIN+ae.XCRYPTO_SOFO_XFS_USERLOGIN)}ca(ch)};X.userLogin(cb,cf,ce,cd,cc)}else{var cg=X.userLogin(cb,cf,ce,cd);if(cg!=0){a9(ae.INTERFACE_XFSLOGIN+ae.XCRYPTO_SOFO_XFS_USERLOGIN)}return cg}}function bj(cb,ca){if(ca){var cc=function(ce){if(ce!=0){a9(ae.INTERFACE_XFSOTPREQUEST+ae.XCRYPTO_SOFO_XFS_OTPREQUEST)}ca(ce)};X.otpRequest(cb,cc)}else{var cd=X.otpRequest(cb);if(cd!=0){a9(ae.INTERFACE_XFSOTPREQUEST+ae.XCRYPTO_SOFO_XFS_OTPREQUEST)}return cd}}function bk(ca){if(ca){var cb=function(cd){if(cd!=0){a9(ae.INTERFACE_XFSLOGOUT+ae.XCRYPTO_SOFO_XFS_USERLOGOUT)}ca(cd)};X.userLogout(cb)}else{var cc=X.userLogout();if(cc!=0){a9(ae.INTERFACE_XFSLOGOUT+ae.XCRYPTO_SOFO_XFS_USERLOGOUT)}return cc}}function bC(cf,ce,cc,cd,cb,ca,cg){cd=parseInt(cd);if(typeof cd=="number"){if(cd<0||cd>8){cd=4}}else{cd=4}if(!aG){au()}E.init(cf,ce,cc,cd,cb,aH,ca,cg)}function bt(cc,ce,cd,ca){var cb=function(cf){if(!cf){a9(ae.INTERFACE_ANYPIN_GETPINIDLIST+ae.XCRYPTO_SOFO_ANYPIN_GETPINIDLIST)}if(ca){ca(cf)}return cf};return E.getPinIDList(cc,ce,cd,at,cb)}function bE(cc,ca){var cb=function(cd){if(cd!=0){a9(ae.INTERFACE_ANYPIN_UPDATEPINLASTTIME+ae.XCRYPTO_SOFO_ANYPIN_UPDATEPINLASTTIME)}if(ca){ca(cd)}return cd};return E.updatePinLastTime(cc,cb)}function bv(cd,cc,ca,cf,cb){var ce=E.checkPin(cd,cc,ca,cf,cb);if(ce!=0){a9(ae.INTERFACE_ANYPIN_CHECKPIN+ae.XCRYPTO_SOFO_ANYPIN_CHECKPIN)}return ce}function aJ(cd,cc,ca){var cb=function(ce){if(!ce){a9(ae.INTERFACE_ANYPIN_INITPIN+ae.XCRYPTO_SOFO_ANYPIN_INITPIN)}if(ca){ca(ce)}return ce};return E.initPin(cd,cc,cb)}function bf(cd,cc,ca){var cb=function(ce){if(!ce){a9(ae.INTERFACE_ANYPIN_INITREGIST+ae.XCRYPTO_SOFO_ANYPIN_INITREGIST)}if(ca){ca(ce)}return ce};return E.initRegist(cd,cc,cb)}function bZ(cc,ca,ci,cf,cj,ch,cb,cd,ce){var cg=function(ck){if(ck<0){a9(ae.INTERFACE_ANYPIN_REGISTPIN+ae.XCRYPTO_SOFO_ANYPIN_REGISTPIN)}if(ce){ce(ck)}return ck};return E.registPin(cc,ca,ci,at,cf,cj,ch,cb,cd,cg)}function b2(cd,cc,ca){var cb=function(ce){if(!ce){a9(ae.INTERFACE_ANYPIN_INITSESSION+ae.XCRYPTO_SOFO_ANYPIN_INITSESSION)}if(ca){ca(ce)}return ce};return E.initSession(cd,cc,cb)}function S(cd,cc,ca){var cb=function(ce){if(ce!=0){a9(ae.INTERFACE_ANYPIN_SETNODUEDAY+ae.XCRYPTO_SOFO_ANYPIN_SETNODUEDAY)}if(ca){ca(ce)}return ce};return E.setNoDueDay(cd,cc,cb)}function d(cb,ce,cd,ci,ch,ca,cc,cf){var cg=function(cj){if(cj!="success"&&cj!="update"){a9(ae.INTERFACE_ANYPIN_AUTHSESSION+ae.XCRYPTO_SOFO_ANYPIN_AUTHSESSION)}if(cf){cf(cj)}return cj};return E.authSession(cb,ce,cd,ci,ch,ca,at,cc,cg)}function ad(cc,ca){var cb=function(cd){if(cd!=0){a9(ae.INTERFACE_ANYPIN_ENDSESSION+ae.XCRYPTO_SOFO_ANYPIN_ENDSESSION)}if(ca){ca(cd)}return cd};return E.endSession(cc,cb)}function P(cf,ce,cd,cc,ca){
var cb=function(cg){if(!cg){a9(ae.INTERFACE_ANYPIN_SIGNPIN+ae.XCRYPTO_SOFO_ANYPIN_SIGNPIN)}if(ca){ca(cg)}return cg};return E.signPin(cf,ce,cd,at,cc,cb)}function bo(cd,cc,ca){var cb=function(ce){if(ce!=0){a9(ae.INTERFACE_ANYPIN_DELETEPIN+ae.XCRYPTO_SOFO_ANYPIN_DELETEPIN)}if(ca){ca(ce)}return ce};return E.deletePin(cd,cc,cb)}function O(cd,cc,ca){var cb=function(ce){if(ce!=0){a9(ae.INTERFACE_ANYPIN_DELETEALLPIN+ae.XCRYPTO_SOFO_ANYPIN_DELETEALLPIN)}if(ca){ca(ce)}return ce};return E.deleteAllPin(cd,cc,cb)}function bl(cd,cc,ca){var cb=function(ce){if(ce!=0){a9(ae.INTERFACE_ANYPIN_DELETEPIN+ae.XCRYPTO_SOFO_ANYPIN_DELETEPIN)}if(ca){ca(ce)}return ce};return E.deletePinLocal(cd,cc,cb)}function aO(cf,cd,ce,cc,ca){var cb=function(cg){if(cg!=0){a9(ae.INTERFACE_ANYPIN_CHANGEPIN+ae.XCRYPTO_SOFO_ANYPIN_CHANGEPIN)}if(ca){ca(cg)}return cg};return E.changePin(cf,cd,ce,cc,cb)}function z(cf,ce,cd,cc,ca){var cb=function(cg){if(cg!=0){a9(ae.INTERFACE_ANYPIN_READDEVICEINFOLIST+ae.XCRYPTO_SOFO_ANYPIN_READDEVICEINFOLIST)}if(ca){ca(cg)}return cg};return E.readDeviceInfoList(cf,ce,cd,cc,cb)}function bD(ce,cd,cc,ca){var cb=function(cf){if(cf!=0){a9(ae.INTERFACE_ANYPIN_READDEVICEINFO+ae.XCRYPTO_SOFO_ANYPIN_READDEVICEINFO)}if(ca){ca(cf)}return cf};return E.readDeviceInfo(ce,cd,cc,cb)}function bX(ce,cd,cc,ca){var cb=function(cf){if(cf!=0){a9(ae.INTERFACE_ANYPIN_DELETEDEVICE+ae.XCRYPTO_SOFO_ANYPIN_DELETEDEVICE)}if(ca){ca(cf)}return cf};return E.deleteDevice(ce,cd,cc,cb)}function ab(cd,cc,ca){var cb=function(ce){if(ce!=0){a9(ae.INTERFACE_ANYPIN_DELETEALLDEVICE+ae.XCRYPTO_SOFO_ANYPIN_DELETEALLDEVICE)}if(ca){ca(ce)}return ce};return E.deleteAllDevice(cd,cc,cb)}function aQ(cc,ck,cf,cg,cd,ch,ca,ce,cb,ci){var cj=function(cl){if(cl!=0){a9(ae.INTERFACE_ANYPIN_READAUDITINFOLIST+ae.XCRYPTO_SOFO_ANYPIN_READAUDITINFOLIST)}if(ci){ci(cl)}return cl};return E.readAuditInfoList(cc,ck,cf,cg,cd,ch,ca,ce,cb,cj)}function g(ce,ca,cd,cb){var cc=function(cf){if(cf!=0){a9(ae.INTERFACE_ANYPIN_READAUDITINFO+ae.XCRYPTO_SOFO_ANYPIN_READAUDITINFO)}if(cb){cb(cf)}return cf};return E.readAuditInfo(ce,ca,cd,cc)}function b0(ca,cb){return E.testCERTMODEGenPubKey(ca,cb)}function aX(cc,ca,cd,cb,ce){return E.testSaveCertAndKey(cc,ca,cd,cb,ce)}return{checkXCrypto:function(){return ak()},isMobilePlatform:function(){return b3()},getDeviceInfo:function(ca){bs();if(typeof ca!="function"){ca=null}if(!a5()){w(ae.INTERFACE_GETDEVICEINFO+ae.ERROR_SETLICENSE_FAIL);if(ca){ca("");return}else{return""}}var cb=am();if(ca){ca(cb)}else{return cb}},getLastErrCode:function(){return M()},getLastErrMsg:function(){return bV()},getLastErrInternal:function(){return aw()},resetErrAndMsg:function(){bs()},setError:function(cb,ca){if(typeof ca!="function"){ca=null}cb=parseInt(cb);w(cb);if(ca){ca()}},resetError:function(ca){if(typeof ca!="function"){ca=null}bs();if(ca){ca()}},getError:function(ca){if(typeof ca!="function"){ca=null}var cb=aU();if(ca){ca(cb)}else{return cb}},setLanguage:function(cb,ca){if(typeof ca!="function"){ca=null}bG(cb);if(ca){ca()}},setCharset:function(cb,ca){if(typeof ca!="function"){ca=null}C(cb);if(ca){ca()}},setLicense:function(cc,ca){bs();if(typeof ca!="function"){ca=null}if(!cc){w(ae.INTERFACE_SETLICENSE+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1)}return-1}var cb=ac(cc);if(ca){ca(cb)}else{return cb}},setProperty:function(cd,cb,cc,ca){if(typeof ca!="function"){ca=null}bG(cd);C(cb);ac(cc);if(ca){ca()}},setSecurityContext:function(cc,cb,ca){bs();if(typeof ca!="function"){ca=null}if(!cc){w(ae.INTERFACE_SETSECURITYCONTEXT+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1)}return-1}var cd=U(cc,cb);if(ca){ca(cd)}else{return cd}},setCrossStorage:function(cb,cd,ca){bs();if(typeof ca!="function"){ca=null}var cc=function(ce){if(ce!=0){a9(ae.INTERFACE_SETCROSSSTORAGE)}if(ca){ca(ce)}else{return ce}};b4(cb,cd,cc)},setOpenStorage:function(cb,cg,ce,ca,cc){bs();if(typeof cc!="function"){cc=null}var cf=function(ch){if(ch!==0){a9(ae.INTERFACE_SETOPENSTORAGE)}if(cc){cc(ch)}else{return ch}};var cd=m(cb);bQ(cd,cg,ce,ca,cf)},setIssuerConvertTable:function(cb,cd,cc,cf,ca){bs();if(typeof ca!="function"){ca=null}if(!cb||!cd){w(ae.INTERFACE_SETISSUERCONVERTTABLE+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1)}return-1}if(!cc){cc=""}cf=parseInt(cf);var ce=aV(cb,cd,cc,cf);if(ca){ca(ce)}else{return ce}},setPolicyConvertTable:function(cd,cc,cb,cf,ca){bs();if(typeof ca!="function"){ca=null}if(!cd||!cc){w(ae.INTERFACE_SETPOLICYCONVERTTABLE+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1)}return-1}if(!cb){cb=""}cf=parseInt(cf);var ce=aE(cd,cc,cb,cf);if(ca){ca(ce)}else{return ce}},setSecureInput:function(cb,ca){bs();if(typeof ca!="function"){ca=null}b5(cb);if(ca){ca()}},getSecureInput:function(ca){bs();if(typeof ca!="function"){ca=null}var cb=bJ();if(ca){ca(cb)}else{return cb}},setLastLocation:function(ca,cb){bs();if(typeof cb!="function"){cb=null}var cc=function(cd){if(cd!=0){a9(ae.INTERFACE_SETLASTLOCATION)}if(cb){cb(cd)}};bR(ca,cc)},getLastLocation:function(ca){bs();if(typeof ca!="function"){ca=null;return-1}bK(ca)},generateRandom:function(cc,cb,ca){bs();if(typeof ca!="function"){ca=null}var cd=ax(cc,cb);if(ca){ca(cd)}else{return cd}},setCacheCertLocation:function(ca,cb){bs();if(typeof cb!="function"){cb=null}var cc=function(cd){if(cd!=0){a9(ae.INTERFACE_SETCACHECERTLOCATION)}if(cb){cb(cd)}};aZ(ca,cc)},getCacheCertLocation:function(cb,ca){bs();if(typeof ca!="function"){ca=null;return-1}T(cb,ca)},hasCachedData:function(ca){bs();if(typeof ca!="function"){ca=null}var cb=function(cc){if(cc==0){ca(1)}else{ca(0)}};F(cb)},clearCachedData:function(ca){bs();if(typeof ca!="function"){ca=null}bg(ca)},getMediaList:function(cc,cb,ca){bs();if(!a5()){w(ae.INTERFACE_GETMEDIALIST+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}cc=parseInt(cc);if(typeof ca!="function"){ca=null}return ap(cc,cb,ca)},getCertTree:function(cb,ca,cd,ce,cf,cg,cc){bs();if(!a5()){w(ae.INTERFACE_GETCERTTREE+ae.ERROR_SETLICENSE_FAIL);if(cc){cc("");return}else{return""}}cb=parseInt(cb);if(typeof cc!="function"){cc=null}if(cb!=l&&cb!=V&&cb!=r&&cb!=Y&&cb!=bH){w(ae.INTERFACE_GETCERTTREE+ae.ERROR_INCORRECT_PARAM);if(cc){cc("");return}else{return""}}return bw(cb,cd,ce,cf,cg,cc)},setCert:function(ci,cg,ca,ck,ce,ch,cb,cd,cj,cc,cf){bs();if(!a5()){w(ae.INTERFACE_SETCERT+ae.ERROR_SETLICENSE_FAIL);if(cf){cf(-1);return}else{return-1}}if(typeof cf!="function"){cf=null}if(!ch){w(ae.INTERFACE_SETCERT+ae.ERROR_INCORRECT_PARAM);if(cf){cf(-1);return}else{return-1}}if(ci){if(!(typeof ci==="string"||typeof ci==="object")){w(ae.INTERFACE_SETCERT+ae.ERROR_INCORRECT_PARAM);if(cf){cf(-1);return}else{return-1}}return ay(ci,ch,cb,cd,cj,cc,cf)}else{if(cg&&ca){if(!(typeof cg==="string"||typeof cg==="object")){w(ae.INTERFACE_SETCERT+ae.ERROR_INCORRECT_PARAM);if(cf){cf(-1);return}else{return-1}}if(!(typeof ca==="string"||typeof ca==="object")){w(ae.INTERFACE_SETCERT+ae.ERROR_INCORRECT_PARAM);if(cf){cf(-1);return}else{return-1}}return b9(cg,ca,ck,ce,ch,cb,cd,cj,cc,cf)}else{w(ae.INTERFACE_SETCERT+ae.ERROR_INCORRECT_PARAM);if(cf){cf(-1);return}else{return-1}}}},getCert:function(ca,ce,cc,cd,cb){bs();if(!a5()){w(ae.INTERFACE_GETCERT+ae.ERROR_SETLICENSE_FAIL);if(cb){cb("");return}else{return""}}ca=parseInt(ca);if(typeof cb!="function"){cb=null}if(ca!=l&&ca!=V&&ca!=Y){w(ae.INTERFACE_GETCERT+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}if((ca==V||ca==Y)&&(!ce||!cc)){w(ae.INTERFACE_GETCERT+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}var cf=function(cg){if(cb){cb(cg)}else{return cg}};bY(ca,ce,cc,cd,cf)},importCert:function(ch,ce,ca,cj,cc,ci,cf,cg,cb,cd){bs();if(!a5()){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_SETLICENSE_FAIL);if(cd){cd(-1);return}else{return-1}}cf=parseInt(cf);if(typeof cd!="function"){cd=null}if(cf!=l&&cf!=V&&cf!=Y){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cd){cd(-1);return}else{return-1}}if(!ci){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cd){cd(-1);return}else{return-1}}if(ch){if(!(typeof ch==="string"||typeof ch==="object")){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cd){cd(-1);return}else{return-1}}return aC(ch,ci,cf,cg,cb,cd)}else{if(ce&&ca){if(!(typeof ce==="string"||typeof ce==="object")){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cd){cd(-1);return}else{return-1}}if(!(typeof ca==="string"||typeof ca==="object")){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cd){cd(-1);return}else{return-1}}return a(ce,ca,cj,cc,ci,cf,cg,cb,cd)}else{w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cd){cd(-1);return}else{return-1}}}},exportCert:function(ca,ce,cc,cg,cf,cd,cb){bs();if(!a5()){w(ae.INTERFACE_EXPORTCERT+ae.ERROR_SETLICENSE_FAIL);if(cb){cb("");return}else{return""}}ca=parseInt(ca);if(typeof cb!="function"){cb=null}if(ca!=l&&ca!=V&&ca!=Y){w(ae.INTERFACE_EXPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}if(!ce||!cc||!cg){w(ae.INTERFACE_EXPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}if((ca==l||ca==V)&&!cf){w(ae.INTERFACE_EXPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}return b8(ca,ce,cc,cg,cf,cd,cb)},deleteCert:function(cb,ca,cf,cd,ce,cc){bs();if(!a5()){w(ae.INTERFACE_DELETECERT+ae.ERROR_SETLICENSE_FAIL);if(cc){cc(-1);return}else{return-1}}cb=parseInt(cb);if(typeof cc!="function"){cc=null}if(cb!=l&&cb!=V&&cb!=r&&cb!=Y){w(ae.INTERFACE_DELETECERT+ae.ERROR_INCORRECT_PARAM);if(cc){cc(-1);return}else{return-1}}if((cb==V||cb==Y||cb==r)&&(!cf||!cd)){w(ae.INTERFACE_DELETECERT+ae.ERROR_INCORRECT_PARAM);if(cc){cc(-1);return}else{return-1}}return ag(cb,cf,cd,cc)},checkPwd:function(cd,cb,cc,ca){bs();if(!a5()){w(ae.INTERFACE_CHECKPWD+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}if(typeof ca!="function"){ca=null}if(!cd){w(ae.INTERFACE_CHECKPWD+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1);return}else{return-1}}var ce=t(cd,cb,cc);if(ca){ca(ce)}else{return ce}},verifyCertPwd:function(ca,ce,cc,cf,cd,cb){bs();if(!a5()){w(ae.INTERFACE_VERIFYCERTPWD+ae.ERROR_SETLICENSE_FAIL);if(cb){cb(-1);return}else{return-1}}ca=parseInt(ca);if(typeof cb!="function"){cb=null}if(ca!=l&&ca!=V&&ca!=r&&ca!=Y){w(ae.INTERFACE_VERIFYCERTPWD+ae.ERROR_INCORRECT_PARAM);if(cb){cb(-1);return}else{return-1}}if(ca==l&&!cf){w(ae.INTERFACE_VERIFYCERTPWD+ae.ERROR_INCORRECT_PARAM);if(cb){cb(-1);return}else{return-1}}if((ca==V||ca==Y)&&(!ce||!cc||!cf)){w(ae.INTERFACE_VERIFYCERTPWD+ae.ERROR_INCORRECT_PARAM);if(cb){cb(-1);return}else{return-1}}return a8(ca,ce,cc,cf,cb)},changeCertPwd:function(ca,cg,cd,cc,ch,cf,ce,cb){bs();if(!a5()){w(ae.INTERFACE_CHANGECERTPWD+ae.ERROR_SETLICENSE_FAIL);if(cb){cb(-1);return}else{return-1}}ca=parseInt(ca);if(typeof cb!="function"){cb=null}if(ca!=V&&ca!=r&&ca!=Y){w(ae.INTERFACE_CHANGECERTPWD+ae.ERROR_INCORRECT_PARAM);if(cb){cb(-1);return}else{return-1}}if(!cg||!cd||!cc||!ch){w(ae.INTERFACE_CHANGECERTPWD+ae.ERROR_INCORRECT_PARAM);if(cb){cb(-1);return}else{return-1}}return aS(ca,cg,cd,cc,ch,cf,cb)},verifyCert:function(cb,ca,ce,cd,cg,cc){bs();if(!a5()){w(ae.INTERFACE_VERIFYCERT+ae.ERROR_SETLICENSE_FAIL);if(cc){cc(-1);return}else{return-1}}cb=parseInt(cb);if(typeof cc!="function"){cc=null}if(cb!=l&&cb!=V&&cb!=Y){w(ae.INTERFACE_VERIFYCERT+ae.ERROR_INCORRECT_PARAM);if(cc){cc(-1);return}else{return-1}}if((cb==V||cb==Y)&&(!ce||!cd)){w(ae.INTERFACE_VERIFYCERT+ae.ERROR_INCORRECT_PARAM);if(cc){cc(-1);return}else{return-1}}var cf=function(ch){if(cc){cc(ch)}else{return ch}};return bc(cb,ce,cd,cg,cf)},verifyCertOwner:function(ca,ce,cc,cg,ch,cd,cb){bs();if(!a5()){w(ae.INTERFACE_VERIFYCERTOWNER+ae.ERROR_SETLICENSE_FAIL);if(cb){cb(-1);return}else{return-1}}ca=parseInt(ca);if(typeof cb!="function"){cb=null}if(ca!=l&&ca!=V&&ca!=Y){w(ae.INTERFACE_VERIFYCERTOWNER+ae.ERROR_INCORRECT_PARAM);if(cb){cb(-1);return}else{return-1}}if(ca==l&&!cg){w(ae.INTERFACE_VERIFYCERTOWNER+ae.ERROR_INCORRECT_PARAM);if(cb){cb(-1);return}else{return-1}}if((ca==V||ca==Y)&&(!ce||!cc||!cg)){w(ae.INTERFACE_VERIFYCERTOWNER+ae.ERROR_INCORRECT_PARAM);if(cb){cb(-1);return}else{return-1}}if(ca==Y&&an.signType!=k){w(ae.INTERFACE_VERIFYCERTOWNER+ae.ERROR_INCORRECT_PARAM);if(cb){cb(-1);return}else{return-1}}var cf=function(ci){if(cb){cb(ci)}else{return ci}};return a7(ca,ce,cc,cg,ch,cf)},signData:function(ca,cf,cc,cg,ce,cd,cb){bs();if(!a5()){w(ae.INTERFACE_SIGNDATA+ae.ERROR_SETLICENSE_FAIL);if(cb){cb("");return}else{return""}}ca=parseInt(ca);if(typeof cb!="function"){cb=null}if(ca!=l&&ca!=V&&ca!=r&&ca!=Y){w(ae.INTERFACE_SIGNDATA+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}return aq(ca,cf,cc,cg,ce,cd,0,cb)},signDataUCPID:function(ca,cf,cc,ch,cd,cg,ce,cb){bs();if(!a5()){w(ae.INTERFACE_SIGNDATA_UCPID+ae.ERROR_SETLICENSE_FAIL);if(cb){cb("");return}else{return""}}ca=parseInt(ca);if(typeof cb!="function"){cb=null}if(ca!=l&&ca!=V&&ca!=r&&ca!=Y){w(ae.INTERFACE_SIGNDATA_UCPID+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}return aq(ca,cf,cc,ch,cd,ce,2,cb,cg)},signDataAdd:function(ca,ce,cc,cg,cf,cd,cb){bs();if(!a5()){w(ae.INTERFACE_SIGNDATAADD+ae.ERROR_SETLICENSE_FAIL);if(cb){cb("");return}else{return""}}ca=parseInt(ca);if(typeof cb!="function"){cb=null}if(ca!=l&&ca!=V&&ca!=r&&ca!=Y){w(ae.INTERFACE_SIGNDATAADD+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}if(ca==Y&&an.signType!=k){w(ae.INTERFACE_SIGNDATAADD+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}return aq(ca,ce,cc,cg,cf,cd,1,cb)},signFileInfo:function(ca,ce,cc,cf,cg,cd,cb){bs();if(!a5()){w(ae.INTERFACE_SIGNDATA+ae.ERROR_SETLICENSE_FAIL);if(cb){cb("");return}else{return""}}ca=parseInt(ca);if(typeof cb!="function"){cb=null}if(ca!=l&&ca!=V&&ca!=r&&ca!=Y){w(ae.INTERFACE_SIGNDATA+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}if(!(cd&512)){cd|=512}if(!(cd&2048)){cd|=2048}if(!(cd&4096)){cd|=4096}if(cd&32){return aq(ca,ce,cc,cf,cg,cd,1,cb)}else{return aq(ca,ce,cc,cf,cg,cd,0,cb)}},signFileInfoCacheCert:function(ca,cf,cd,cc,cb){bs();if(!a5()){w(ae.INTERFACE_SIGNDATA+ae.ERROR_SETLICENSE_FAIL);if(cb){cb("");return}else{return""}}ca=parseInt(ca);if(typeof cb!="function"){cb=null}if(ca!=l&&ca!=V&&ca!=r&&ca!=Y){w(ae.INTERFACE_SIGNDATA+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}var ce={info:cf,hash:cd};if(!(cc&512)){cc|=512}if(!(cc&2048)){cc|=2048}if(!(cc&4096)){cc|=4096}return aq(ca,"","","",ce,cc,0,cb)},verifyData:function(cd,cc,cb,ca){bs();if(!a5()){w(ae.INTERFACE_VERIFYDATA+ae.ERROR_SETLICENSE_FAIL);if(ca){ca("");return}else{return""}}if(typeof ca!="function"){ca=null}if(!cd){w(ae.INTERFACE_VERIFYDATA+ae.ERROR_INCORRECT_PARAM);if(ca){ca("");return}else{return""}}var ce=bu(cd,cc,cb);if(ca){ca(ce)}else{return ce}},getSignedData:function(cd,cc,cb,ca){bs();if(!a5()){w(ae.INTERFACE_GETSIGNEDDATA+ae.ERROR_SETLICENSE_FAIL);if(ca){ca("");return}else{return""}}if(typeof ca!="function"){ca=null}if(!cd){w(ae.INTERFACE_GETSIGNEDDATA+ae.ERROR_INCORRECT_PARAM);if(ca){ca("");return}else{return""}}var ce=bq(cd,cc,cb);if(ca){ca(ce)}else{return ce}},envelopIdNum:function(cg,cb,cd,ch,cc,ce,ca,cf){bs();if(!a5()){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_SETLICENSE_FAIL);if(cf){cf("");return}else{return""}}cg=parseInt(cg);if(typeof cf!="function"){cf=null}if(cg!=l&&cg!=V&&cg!=Y){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_INCORRECT_PARAM);if(cf){cf("");return}else{return""}}if(cg==Y&&an.signType!=k){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_INCORRECT_PARAM);if(cf){cf("");return}else{return""}}if(!ce){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_INCORRECT_PARAM);if(cf){cf("");return}else{return""}}var ci=function(cj){if(cf){cf(cj)}else{return cj}};return a6(cg,cb,cd,ch,cc,ce,ci)},envelopIdNumFincert:function(ca,cb,cc){bs();if(!ca){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_INCORRECT_PARAM);return""}if(!cb){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_INCORRECT_PARAM);return""}if(!cc){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_INCORRECT_PARAM);return""}var cd=function(ce){return ce};return bS(ca,cb,cc,cd)},envelopeDataWithCert:function(cb,cg,cf,ce,cc,ca){bs();if(!a5()){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_SETLICENSE_FAIL);if(ca){ca("");return}else{return""}}if(typeof ca!="function"){ca=null}cb=String(cb);if(cb=="undefined"||cb==""){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);if(ca){ca("");return}else{return""}}var cd=function(ch){if(ca){ca(ch)}else{return ch}};return j(cb,cg,cf,ce,cc,cd)},envelopeDataWithPEM:function(cb,cd,cc,ca){bs();if(!a5()){w(ae.INTERFACE_ENVELOPEDATAWITHPEM+ae.ERROR_SETLICENSE_FAIL);if(ca){ca("");return}else{return""}}if(typeof ca!="function"){ca=null}if(!cb){w(ae.INTERFACE_ENVELOPEDATAWITHPEM+ae.ERROR_INCORRECT_PARAM);if(ca){ca("");return}else{return""}}var ce=bU(cb,cd,cc);if(ca){ca(ce)}else{return ce}},envelopeDataWithPwd:function(ca,cd,cc,cb){bs();if(!a5()){w(ae.INTERFACE_ENVELOPEDATAWITHPWD+ae.ERROR_SETLICENSE_FAIL);if(cb){cb("");return}else{return""}}if(typeof cb!="function"){cb=null}if(!ca){w(ae.INTERFACE_ENVELOPEDATAWITHPWD+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}var ce=bI(ca,cd,cc);if(cb){cb(ce)}else{return ce}},deenvelopeDataWithCert:function(ca,ce,cc,cg,cf,cd,cb){bs();if(!a5()){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_SETLICENSE_FAIL);if(cb){cb("");return}else{return""}}ca=parseInt(ca);if(typeof cb!="function"){cb=null}if(ca!=l&&ca!=V&&ca!=Y){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}if(ca==Y&&an.signType!=k){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}if(!cf){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}var ch=function(ci){if(cb){cb(ci)}else{return ci}};return bd(ca,ce,cc,cg,cf,ch)},deenvelopeDataWithPwd:function(ca,cd,cc,cb){bs();if(!a5()){w(ae.INTERFACE_DEENVELOPEDATAWITHPWD+ae.ERROR_SETLICENSE_FAIL);if(cb){cb("");return}else{return""}}if(typeof cb!="function"){cb=null}if(!cd||!ca){w(ae.INTERFACE_DEENVELOPEDATAWITHPWD+ae.ERROR_INCORRECT_PARAM);if(cb){cb("");return}else{return""}}var ce=N(ca,cd);if(cb){cb(ce)}else{return ce}},requestCert:function(cd,ce,cj,ci,cg,ch,cb,cc,ca,cf){bs();if(!a5()){w(ae.INTERFACE_REQUESTCERT+ae.ERROR_SETLICENSE_FAIL);if(cf){cf(-1);return}else{return-1}}cg=parseInt(cg);if(cg!=V&&cg!=r){w(ae.INTERFACE_REQUESTCERT+ae.ERROR_INCORRECT_PARAM);if(cf){cf(-1);return}else{return-1}}if((cg==V||cg==r)&&(!cd||!ce||!cj||!ci||!ch||!cc)){w(ae.INTERFACE_REQUESTCERT+ae.ERROR_INCORRECT_PARAM);if(cf){cf(-1);return}else{return-1}}bA(cd,ce,cj,ci,cg,ch,cb,cc,ca,cf)},renewCert:function(cg,ci,ck,ce,ch,ca,cb,cc,cf,cd,cj){bs();if(!a5()){w(ae.INTERFACE_RENEWCERT+ae.ERROR_SETLICENSE_FAIL);if(cj){cj(-1);return}else{return-1}}ck=parseInt(ck);if(ck!=V&&ck!=r){w(ae.INTERFACE_RENEWCERT+ae.ERROR_INCORRECT_PARAM);if(cj){cj(-1);return}else{return-1}}if((ck==V||ck==r)&&(!cg||!ci||!ce||!ch||!ca||!cb||!cf)){w(ae.INTERFACE_RENEWCERT+ae.ERROR_INCORRECT_PARAM);if(cj){cj(-1);return}else{return-1}}aK(cg,ci,ck,ce,ch,ca,cb,cc,cf,cd,cj)},revokeCert:function(){return},hashData:function(ce,cc,cb,ca){bs();ce=parseInt(ce);if(typeof ca!="function"){ca=null}var cd=f(ce,cc,cb);if(ca){ca(cd)}else{return cd}},publicKeyEncrypt:function(cc,ce,cb,ca){bs();if(typeof ca!="function"){ca=null}var cd=bL(cc,ce,cb);if(ca){ca(cd)}else{return cd}},seedDecrypt:function(cc,cd,cb,ca){bs();if(typeof ca!="function"){ca=null}var ce=b1(cc,cd,cb);if(ca){ca(ce)}else{return ce}},SyncOpenCert:function(cd,cb,cc,ca){bs();if(!a5()){a9(ae.INTERFACE_SYNCOPENCERT);if(ca){ca(-1);return}else{return-1}}if(aI==false){w(ae.INTERFACE_SYNCOPENCERT);if(ca){ca(-1);return}else{return-1}}D(cd,cb,cc,ca)},SetCloudTrayView:function(ca){ba(ca)},exportCertRelayFromBrowser:function(cd,ch,ca,cc,cf,ce,cg,cb){bs();if(!bi()){w(ae.INTERFACE_ANYCERTRELAY_EXPORT+ae.ERROR_SETLICENSE_FAIL);if(cb){cb(-1);return}else{return-1}}az(cd,ch,ca,cc,cf,ce,cg,cb)},importCertRelayToBrowser:function(cb,cd,cc,ca){bs();if(!bi()){w(ae.INTERFACE_ANYCERTRELAY_IMPORT+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}R(cb,cd,cc,ca)},registerAuthCodeForImportCertRelay:function(cb,cd,cc,ca){bs();if(!bi()){w(ae.INTERFACE_ANYCERTRELAY_IMPORT+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}ah(cb,cd,cc,ca)},xfsInit:function(ch,cg,cc,cb,cf,ca,ce,cd){aT(ch,cg,cc,cb,cf,ca,ce,cd)},xfsLogin:function(cb,ce,cd,cc,ca){bs();if(!a5()){w(ae.INTERFACE_XFSLOGIN+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}if(typeof ca!="function"){ca=null}if(!cb||!ce){w(ae.INTERFACE_XFSLOGIN+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1);return}else{return-1}}al(cb,ce,cd,cc,ca)},xfsOtpRequest:function(cb,ca){bs();if(!a5()){w(ae.INTERFACE_XFSOTPREQUEST+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}if(typeof ca!="function"){ca=null}if(!cb){w(ae.INTERFACE_XFSOTPREQUEST+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1);return}else{return-1}}bj(cb,ca)},xfsLogout:function(ca){bs();if(!a5()){w(ae.INTERFACE_XFSLOGOUT+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}if(typeof ca!="function"){ca=null}bk(ca)},apnInitialize:function(cf,ce,cc,cd,cb,ca){bC(cf,ce,cc,cd,cb,ca)},apnGetPinIDList:function(cb,cd,cc,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_GETPINIDLIST+ae.ERROR_SETLICENSE_FAIL);if(ca){ca("");return}else{return""}}if(typeof ca!="function"){ca=null}return bt(cb,cd,cc,ca)},apnUpdatePinLastTime:function(cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_UPDATEPINLASTTIME+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}if(typeof ca!="function"){ca=null}return bE(cb,ca)},apnCheckPin:function(ce,cd,ca,cg,cc,cb){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_CHECKPIN+ae.ERROR_SETLICENSE_FAIL);if(cb){cb(-1);return}else{return-1}}ca=parseInt(ca);cg=parseInt(cg);if(typeof cb!="function"){cb=null}if(!ce){w(ae.INTERFACE_ANYPIN_CHECKPIN+ae.ERROR_INCORRECT_PARAM);if(cb){cb(-1);return}else{return-1}}if(!ca||ca<0||!cg||cg<0){w(ae.INTERFACE_ANYPIN_CHECKPIN+ae.ERROR_INCORRECT_PARAM);if(cb){cb(-1);return}else{return-1}}var cf=bv(ce,cd,ca,cg,cc);if(cb){cb(cf)}else{return cf}},apnInitPin:function(cc,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_INITPIN+ae.ERROR_SETLICENSE_FAIL);if(ca){ca("");return}else{return""}}return aJ(cc,cb,ca)},apnInitRegist:function(cc,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_INITREGIST+ae.ERROR_SETLICENSE_FAIL);if(ca){ca("");return}else{return""}}return bf(cc,cb,ca)},apnRegistPin:function(cc,ca,ch,cf,ci,cg,cb,cd,ce){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_REGISTPIN+ae.ERROR_SETLICENSE_FAIL);if(ce){ce(-1);return}else{return-1}}return bZ(cc,ca,ch,cf,ci,cg,cb,cd,ce)},apnInitSession:function(cc,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_INITSESSION+ae.ERROR_SETLICENSE_FAIL);if(ca){ca("");return}else{return""}}return b2(cc,cb,ca)},apnSetNoDueDay:function(cc,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_SETNODUEDAY+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}return S(cc,cb,ca)},apnAuthSession:function(ch,cf,cc,ce,cb,cg,cd,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_AUTHSESSION+ae.ERROR_SETLICENSE_FAIL);if(ca){ca("");return}else{return""}}return d(ch,cf,cc,ce,cb,cg,cd,ca)},apnEndSession:function(cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_ENDSESSION+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}return ad(cb,ca)},apnSignPin:function(ce,cd,cc,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_SIGNPIN+ae.ERROR_SETLICENSE_FAIL);if(ca){ca("");return}else{return""}}return P(ce,cd,cc,cb,ca)},apnDeletePin:function(cc,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_DELETEPIN+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}return bo(cc,cb,ca)},apnDeleteAllPin:function(cc,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_DELETEALLPIN+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}return O(cc,cb,ca)},apnDeletePinLocal:function(cc,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_DELETEPIN+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}return bl(cc,cb,ca)},apnChangePin:function(ce,cc,cd,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_CHANGEPIN+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}return aO(ce,cc,cd,cb,ca)},apnReadDeviceInfoList:function(ce,cd,cc,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_READDEVICEINFOLIST+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}return z(ce,cd,cc,cb,ca)},apnReadDeviceInfo:function(cd,cc,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_READDEVICEINFO+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}return bD(cd,cc,cb,ca)},apnDeleteDevice:function(cd,cc,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_DELETEDEVICE+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}return bX(cd,cc,cb,ca)},apnDeleteAllDevice:function(cc,cb,ca){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_DELETEALLDEVICE+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}return ab(cc,cb,ca)},apnReadAuditInfoList:function(cc,cj,cf,cg,cd,ch,ca,ce,cb,ci){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_READAUDITINFOLIST+ae.ERROR_SETLICENSE_FAIL);if(ci){ci(-1);return}else{return-1}}return aQ(cc,cj,cf,cg,cd,ch,ca,ce,cb,ci)},apnReadAuditInfo:function(cd,ca,cc,cb){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_READAUDITINFO+ae.ERROR_SETLICENSE_FAIL);if(cb){cb(-1);return}else{return-1}}return g(cd,ca,cc,cb)}}}();